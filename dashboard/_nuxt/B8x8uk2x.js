import{u as q,s as cs,a as he,b as ge,_ as Te,l as G}from"./D_KLllqK.js";import A from"./EMQtV2L1.js";import ps from"./Cs1LqoAY.js";import{Y as ye,Q as P,M as c,t as r,v as g,R as M,x as e,z as t,V as $e,_ as pe,N as O,T as me,y as N,c as L,P as T,O as R,r as S,A as m,W as le,U as K,X as ms,B as j,$ as vs,S as fs,o as Le,C as _s,D as bs,a0 as Se,G as ve,i as Be,a1 as hs,a2 as Me,a3 as gs,a4 as ys,L as $s,Z as ce,a5 as Ss}from"./BhnSTmPV.js";import je from"./F-8eTktO.js";import ws from"./BsYGPtj0.js";import ie from"./DPCO1pic.js";import xs from"./CioRBB5B.js";import Ie from"./CG7Ijn69.js";import ks from"./DMLlXc3x.js";import Ne from"./DzkvqcrG.js";import Oe from"./C6Z13gNj.js";import Cs from"./DFc22ezK.js";import{a as Ee,u as we,_ as qe}from"./Bkcg_QjG.js";import xe from"./DDtTlRze.js";import Ae from"./MDmqO-G7.js";import Vs from"./DkznZSYP.js";import Pe from"./BbdoyxeE.js";import Ds from"./BV-WlDSl.js";import He from"./BGh4yjrq.js";import ke from"./BGRjJqkQ.js";import Rs from"./CslKNPjs.js";import Us from"./BtLdJJ85.js";import Fe from"./BzvqyIqN.js";import We from"./Oyb4e9Uj.js";import Ke from"./Cv6aN48o.js";import Ts from"./BPHt-qMK.js";import Ls from"./Bmt8wyhI.js";import Bs from"./DSFmPsaf.js";import Ms from"./DSgfIdlQ.js";function js(o){return o?Object.keys(o).map(n=>({key:n,value:o[n]})):[]}function Is(o){return o.reduce((n,l)=>(n[l.key]=l.value,n),{})}const Ns={key:0},Os={key:1,class:"ml-auto flex align-items-center gap-2 mr-2"},Es=e("label",{for:"show-duplicates"},"Hide Duplicates",-1),qs={class:"pi pi-info-circle"},As={__name:"HideDuplicates",setup(o){const n=q(),{hideDuplicatedSessions:l,servers:s}=ye(n);return n.$subscribe((a,p)=>{cs(p.hideDuplicatedSessions)}),(a,p)=>{const i=ps,u=P("tooltip");return c(s)&&c(s).length<2?(r(),g("div",Ns)):(r(),g("div",Os,[Es,M(e("i",qs,null,512),[[u,`Show NOT STOPPED sessions with the same "name" and "me".
Useful when you use multiple workers with the same database`]]),t(i,{id:"show-duplicates",modelValue:c(l),"onUpdate:modelValue":p[0]||(p[0]=_=>$e(l)?l.value=_:null)},null,8,["modelValue"])]))}}},Ps={class:"metadata"},Hs={__name:"Metadata",props:["metadata"],setup(o){return(n,l)=>(r(),g("div",Ps,[(r(!0),g(O,null,me(o.metadata,(s,a)=>(r(),g("pre",{key:a},N(a)+"="+N(s),1))),128))]))}},Fs=pe(Hs,[["__scopeId","data-v-cb7cbf08"]]),Ws={class:"text-center p-1"},Ks={class:"text-center"},Qe={__name:"SessionChip",props:{session:Object,image:String},setup(o){const n=o,l=L(()=>{if(n.session.me)return`${n.session.me.id}`});return(s,a)=>{var i,u;const p=ks;return r(),g("div",null,[e("div",Ws,[e("b",Ks,N((u=(i=n.session)==null?void 0:i.me)==null?void 0:u.pushName),1)]),c(l)?(r(),T(p,{key:0,label:c(l),image:o.image},null,8,["label","image"])):R("",!0)])}}},Ce={__name:"RefreshButton",props:["refreshing"],setup(o){const n=o,l=L(()=>n.refreshing?"pi pi-refresh pi-spin":"pi pi-refresh");return(s,a)=>{const p=A;return r(),T(p,{icon:c(l),rounded:"",text:"",disabled:o.refreshing},null,8,["icon","disabled"])}}},Qs=["src"],ze={__name:"Base64Img",props:{data:String,mimetype:String},setup(o){const n=o,l=L(()=>`data:${n.mimetype};base64, ${n.data}`);return(s,a)=>(r(),g("img",{src:l.value,style:{"max-width":"100%"}},null,8,Qs))}},zs={key:2,style:{"background-color":"#f8f9fa",padding:"1rem",color:"red","white-space":"pre-wrap"}},Ge={__name:"SessionScreenshot",props:{session:Object},setup(o,{expose:n}){const l=q(),s=o,{data:a,pending:p,error:i,refresh:u}=he(`session-screenshot-${s.session.server.id}-${s.session.name}`,async()=>(await ge(1e3),await l.getScreenshot(s.session.server.id,s.session.name)));return n({refresh:u}),(_,v)=>{const w=Ne,x=Oe,y=ze;return r(),g(O,null,[c(p)?(r(),g(O,{key:0},[t(w,{mode:"indeterminate",style:{height:"3px"}}),!c(a)&&!c(i)?(r(),T(x,{key:0,width:"100%",height:"20rem"})):R("",!0)],64)):R("",!0),c(a)?(r(),T(y,{key:1,data:c(a).data,mimetype:c(a).mimetype},null,8,["data","mimetype"])):R("",!0),c(i)?(r(),g("pre",zs,""+N(c(i).cause.response.data.message||c(i).cause.response.data||c(i))+`
  `,1)):R("",!0)],64)}}},Gs={class:"",style:{"min-width":"20rem"}},Ys={class:"flex justify-content-center align-items-center"},Js=e("h5",{class:"m-0"},"Screenshot",-1),Xs={class:"m-auto w-full"},Zs={__name:"ScreenshotButton",props:["session"],setup(o){const n=o,l=S(null),s=S(null),a=u=>{l.value.toggle(u)},p=()=>{s.value.refresh()},i=L(()=>n.session.status==="STOPPED");return(u,_)=>{const v=A,w=Ce,x=Ge,y=Cs,k=P("tooltip");return r(),g(O,null,[M(t(v,{disabled:c(i),type:"button",icon:"pi pi-camera",onClick:a,rounded:"",outlined:"",severity:"help"},null,8,["disabled"]),[[k,"Screenshot / QR",void 0,{top:!0}]]),t(y,{ref_key:"op",ref:l,appendTo:"body",showCloseIcon:!0},{default:m(()=>[e("div",Gs,[e("div",Ys,[Js,t(w,{onClick:p})]),e("div",Xs,[t(x,{ref_key:"screenshot",ref:s,session:o.session},null,8,["session"])])])]),_:1},512)],64)}}},et={class:"ml-1"},st={key:1},tt={class:"ml-1"},Ye={__name:"ServerDropdown",props:le({showClear:Boolean,placeholder:String,required:Boolean,invalid:Boolean,disabled:Boolean},{server:{},serverModifiers:{}}),emits:["update:server"],setup(o){const n=K(o,"server"),l=q();return(s,a)=>{const p=Ee,i=xe;return r(),T(i,{optionValue:"id",modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=u=>n.value=u),options:c(l).servers,onChange:a[1]||(a[1]=u=>s.$emit("change",n.value)),placeholder:o.placeholder,class:"p-column-filter",showClear:o.showClear,required:o.required,invalid:o.invalid,disabled:o.disabled},{value:m(u=>[u.value?(r(),g(O,{key:0},[t(p,{connected:c(l).getServer(u.value).connected},null,8,["connected"]),e("span",et,N(c(l).getServer(u.value).name),1)],64)):(r(),g("span",st,N(u.placeholder),1))]),option:m(u=>[t(p,{connected:u.option.connected},null,8,["connected"]),e("span",tt,N(u.option.name)+" ("+N(u.option.connection.url)+") ",1)]),_:1},8,["modelValue","options","placeholder","showClear","required","invalid","disabled"])}}},ot={class:"flex flex-row gap-2 justify-content-end"},Je={__name:"SessionActionButtons",props:["name","isStarting","isRestarting","isStopping","isLoggingOut","isRemoving","allDisabled","hideActions","skipConfirmation","group"],emits:["view","start","restart","stop","logout","delete"],setup(o,{emit:n}){const l=ms(),s=o,a=n;function p(y){return s.skipConfirmation?!s.skipConfirmation.includes(y):!0}async function i(){if(!p("start")){a("start");return}l.require({group:s.group,target:event.target,message:`Start ${s.name}?`,icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-success p-button-sm",rejectLabel:"No",acceptLabel:"Yes, Start",accept:()=>{a("start")},reject:()=>{}})}const u=L(()=>s.hideActions?!s.hideActions.includes("view"):!0);function _(y){l.require({group:s.group,target:y.target,message:`Restart ${s.name}?`,icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-info p-button-sm",rejectLabel:"No",acceptLabel:"Yes, Restart",accept:()=>{a("restart")},reject:()=>{}})}function v(y){l.require({group:s.group,target:y.target,message:`Stop ${s.name}?`,icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-warning p-button-sm",rejectLabel:"No",acceptLabel:"Yes, Stop",accept:async()=>{a("stop")},reject:()=>{}})}function w(y){l.require({group:s.group,target:y.target,message:`Logout ${s.name}?`,icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-warning p-button-sm",rejectLabel:"No",acceptLabel:"Yes, Logout",accept:async()=>{a("logout")},reject:()=>{}})}function x(y){l.require({group:s.group,target:y.target,message:`Delete ${s.name}?`,icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-danger p-button-sm",rejectLabel:"No",acceptLabel:"Yes, Delete",accept:async()=>{a("delete")},reject:()=>{}})}return(y,k)=>{const C=A,V=Ae,d=Vs,f=P("tooltip");return r(),g(O,null,[e("div",ot,[c(u)?M((r(),T(C,{key:0,icon:"pi pi-cog",severity:"help",rounded:"",outlined:"",onClick:k[0]||(k[0]=I=>y.$emit("view")),disabled:o.allDisabled},null,8,["disabled"])),[[f,"Configuration",void 0,{top:!0}]]):R("",!0),M(t(C,{icon:"pi pi-play",severity:"success",rounded:"",outlined:"",onClick:i,loading:o.isStarting,disabled:o.allDisabled},null,8,["loading","disabled"]),[[f,"Start",void 0,{top:!0}]]),M(t(C,{icon:"pi pi-replay",severity:"info",rounded:"",outlined:"",onClick:k[1]||(k[1]=I=>_(I)),loading:o.isRestarting,disabled:o.allDisabled},null,8,["loading","disabled"]),[[f,"Restart",void 0,{top:!0}]]),M(t(C,{icon:"pi pi-stop",severity:"secondary",rounded:"",outlined:"",onClick:k[2]||(k[2]=I=>v(I)),loading:o.isStopping,disabled:o.allDisabled},null,8,["loading","disabled"]),[[f,"Stop",void 0,{top:!0}]]),M(t(C,{icon:"pi pi-sign-out",severity:"warning",rounded:"",outlined:"",onClick:k[3]||(k[3]=I=>w(I)),loading:o.isLoggingOut,disabled:o.allDisabled},null,8,["loading","disabled"]),[[f,"Logout",void 0,{top:!0}]]),M(t(C,{icon:"pi pi-trash",severity:"danger",rounded:"",outlined:"",onClick:k[4]||(k[4]=I=>x(I)),loading:o.isRemoving,disabled:o.allDisabled},null,8,["loading","disabled"]),[[f,"Delete",void 0,{top:!0}]])]),o.group==="popup"?(r(),T(V,{key:0,group:"popup"})):R("",!0),o.group==="dialog"?(r(),T(d,{key:1,group:"dialog"})):R("",!0)],64)}}},nt={class:"flex flex-row gap-2 justify-content-end"},lt={__name:"SessionActions",props:["session","disabled"],setup(o,{expose:n}){const l=o,s=q(),a=we(),p=S(!1),i=S(!1),u=S(!1),_=S(!1),v=S(!1),w=L(()=>l.disabled||p.value||i.value||u.value||_.value||v.value);async function x(){const d=l.session;_.value=!0,await a(s.startSession(d.server.id,d.name),"Started","Failed to start session",d.name,d.name).finally(()=>_.value=!1)}async function y(){const d=l.session;v.value=!0,await a(s.restartSession(d.server.id,d.name),"Restarted","Failed to restart session",d.name,d.name).finally(()=>v.value=!1)}async function k(){const d=l.session;p.value=!0,await a(s.stopSession(d.server.id,d.name),"Stopped","Failed to stop session",d.name,d.name).finally(()=>p.value=!1)}async function C(){const d=l.session;i.value=!0,await a(s.logoutSession(d.server.id,d.name),"Logged out","Failed to logout session",d.name,d.name).finally(()=>i.value=!1)}async function V(){const d=l.session;u.value=!0,await a(s.deleteSession(d.server.id,d.name),"Deleted","Failed to delete session",d.name,d.name).finally(()=>u.value=!1)}return n({startSession:x,restartSession:y,stopSession:k,logoutSession:C,deleteSession:V}),(d,f)=>{const I=Je;return r(),g("div",nt,[t(I,{group:"popup",name:`'${o.session.name}' session`,onView:f[0]||(f[0]=Y=>d.$emit("view",o.session)),onStart:x,onRestart:y,onStop:k,onLogout:C,onDelete:V,"is-starting":c(_),"is-restarting":c(v),"is-stopping":c(p),"is-logging-out":c(i),"is-removing":c(u),"all-disabled":c(w),"hide-actions":[],"skip-confirmation":["start"]},null,8,["name","is-starting","is-restarting","is-stopping","is-logging-out","is-removing","all-disabled"])])}}},it={class:"p-dialog-title flex gap-2 align-items-center"},at=e("i",{class:"pi pi-whatsapp"},null,-1),rt=e("span",null,"(",-1),dt={class:"ml-1"},ut=e("span",null,")",-1),ct=["disabled"],pt=e("i",{class:"pi pi-refresh"},null,-1),mt=[pt],Ve={__name:"SessionHeader",props:{session:Object,refresh:Boolean},setup(o){const n=o,l=q(),{refreshing:s}=ye(l),a=L(()=>n.session.server.id?n.session.server:l.getServer(n.session.server));async function p(){await l.refresh()}return(i,u)=>{var y,k;const _=qe,v=Ee,w=Te,x=P("tooltip");return r(),g("div",it,[at,e("span",null,N((y=o.session)==null?void 0:y.name),1),t(_,{status:o.session.status,value:(k=o.session.status)==null?void 0:k.toUpperCase()},null,8,["status","value"]),e("div",null,[rt,t(v,{connected:a.value.connected},null,8,["connected"]),e("span",dt,N(a.value.name),1),ut]),o.refresh?M((r(),g("button",{key:0,onClick:u[0]||(u[0]=C=>p()),class:"p-link layout-topbar-button",disabled:c(s)},mt,8,ct)),[[x,"Refresh",void 0,{top:!0}]]):R("",!0),t(w,{refreshing:c(s)},null,8,["refreshing"])])}}},vt={class:"-mt-4 p-0 line-height-3 block",style:{"font-family":"monaco, Consolas, 'Lucida Console', monospace"}},ft={__name:"CodeHighlight",props:["invalid"],setup(o){const n=o,l=L(()=>n.invalid?"p-invalid p-component p-inputtext":"");return(s,a)=>(r(),g("pre",{class:fs(["border-round surface-ground text-900 p-5 overflow-auto",l.value])},[j("        "),e("code",vt,[vs(s.$slots,"default")])],2))}},De=o=>(_s("data-v-aa1b18ec"),o=o(),bs(),o),_t={class:"h-full flex flex-column"},bt={class:"flex justify-content-center align-items-center"},ht=De(()=>e("h5",{class:"m-0"},"Request",-1)),gt={class:"flex flex-column justify-content-between h-full"},yt={class:"flex flex-column gap-2"},$t={class:"flex gap-2"},St={class:"text-center"},wt=De(()=>e("div",{class:"mb-2"},"Body",-1)),xt={class:"text-center mt-2"},kt={class:"flex flex-column h-full"},Ct={class:"flex justify-content-center align-items-center"},Vt=De(()=>e("h5",{class:"m-0"},"Response",-1)),Dt={__name:"SessionRequestResponse",props:["session"],setup(o){const n=q(),l=o,s=S(null),a=S("POST"),p=S("/api/sendText"),i=S(""),u=S(!1),_=S(!1);function v(d){return JSON.stringify(d,null,2)}function w(d){try{return JSON.parse(d)}catch{return d}}const x=L(()=>({method:a.value,uri:p.value,params:void 0,body:w(i.value)})),y=["GET","POST","PUT","DELETE","PATCH"];async function k(d){await navigator.clipboard.writeText(s.value),d.preventDefault()}async function C(d){await navigator.clipboard.writeText(v(x.value)),d.preventDefault()}async function V(){try{_.value=!1,u.value=!0;const d=await n.callServerAPI(l.session.server.id,x.value);s.value=v(d)}catch(d){_.value=!0,d.response?s.value=v(d.response.data):s.value=v(d)}finally{u.value=!1}}return Le(()=>{const d={chatId:"11111111111@c.us",text:"Hi there!",session:l.session.name};i.value=v(d),s.value="..."}),(d,f)=>{const I=A,Y=xe,E=ie,ae=Ds,H=He,Z=ft,J=P("tooltip");return r(),g(O,null,[e("div",null,[e("div",_t,[e("div",bt,[ht,M(t(I,{rounded:"",text:"",tabindex:0,icon:"pi pi-copy",onClick:f[0]||(f[0]=$=>C($))},null,512),[[J,{value:"Copied to clipboard"},void 0,{focus:!0,bottom:!0}]])]),e("div",gt,[e("div",yt,[e("div",$t,[t(Y,{modelValue:a.value,"onUpdate:modelValue":f[1]||(f[1]=$=>a.value=$),options:y},null,8,["modelValue"]),t(E,{type:"text",class:"w-full",modelValue:p.value,"onUpdate:modelValue":f[2]||(f[2]=$=>p.value=$),placeholder:"API Endpoint"},null,8,["modelValue"])]),e("div",St,[wt,t(ae,{modelValue:i.value,"onUpdate:modelValue":f[3]||(f[3]=$=>i.value=$),rows:"8",class:"w-full",placeholder:"Request"},null,8,["modelValue"])])]),e("div",xt,[t(I,{onClick:V,loading:u.value,label:"Send",icon:"pi pi-send","icon-pos":"right"},null,8,["loading"])])])])]),t(H),e("div",null,[e("div",kt,[e("div",Ct,[Vt,M(t(I,{rounded:"",text:"",tabindex:0,icon:"pi pi-copy",onClick:f[4]||(f[4]=$=>k($))},null,512),[[J,{value:"Copied to clipboard"},void 0,{focus:!0,bottom:!0}]])]),t(Z,{class:"m-0 p-4 pretty",invalid:_.value},{default:m(()=>[j(N(s.value),1)]),_:1},8,["invalid"])])])],64)}}},Rt=pe(Dt,[["__scopeId","data-v-aa1b18ec"]]),Ut={class:"grid pt-4"},Tt={class:"col-12 sm:col-6 h-full"},Lt={class:"grid"},Bt={class:"col-12"},Mt={class:""},jt={class:"flex justify-content-center align-items-center"},It={class:"col-12"},Nt={class:""},Ot={class:"flex justify-content-center align-items-center"},Et=e("h5",{class:"m-0"},"Screenshot",-1),qt={class:"m-auto w-full"},At={class:"col-12 sm:col-6 h-full card"},Pt={__name:"SessionControl",props:["session"],setup(o){const n=q(),l=o,s=S(null),a=()=>{s.value.refresh()},p=S(null);return Le(()=>{var i,u;(u=(i=l.session)==null?void 0:i.me)!=null&&u.id&&n.getProfilePicture(l.session.server.id,l.session.name,l.session.me.id).then(_=>{p.value=_.profilePictureURL})}),(i,u)=>{const _=Qe,v=Ce,w=Ge,x=Rt;return r(),g("div",Ut,[e("div",Tt,[e("div",Lt,[e("div",Bt,[e("div",Mt,[e("div",jt,[o.session.me?(r(),T(_,{key:0,session:o.session,image:c(p)},null,8,["session","image"])):R("",!0)])])]),e("div",It,[e("div",Nt,[e("div",Ot,[Et,t(v,{onClick:a})]),e("div",qt,[t(w,{ref_key:"screenshot",ref:s,session:o.session},null,8,["session"])])])])])]),e("div",At,[t(x,{session:o.session},null,8,["session"])])])}}},Ht={__name:"SessionControlDialog",props:{visible:{},visibleModifiers:{},session:{},sessionModifiers:{}},emits:["update:visible","update:session"],setup(o){const n=K(o,"visible"),l=K(o,"session");return Se(),(s,a)=>{const p=Ve,i=Pt,u=ke;return r(),T(u,{visible:n.value,"onUpdate:visible":a[0]||(a[0]=_=>n.value=_),modal:!0,maximizable:""},{header:m(()=>[t(p,{session:l.value},null,8,["session"])]),default:m(()=>[t(i,{session:l.value},null,8,["session"])]),_:1},8,["visible"])}}},Ft={class:"card p-fluid"},Wt={class:"flex flex-grow-1 justify-content-center"},Kt={class:"flex flex-grow-1 justify-content-center"},Xe={__name:"KeyValueTable",props:le(["keyColumn","keyColumnName","prefix"],{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(o){const n=K(o,"modelValue"),l=o,s=S([]),a=_=>{let{newData:v,index:w}=_;n.value[w]=v},p=_=>{let{data:v,newValue:w,field:x}=_;v[x]=w};function i(){const _=n.value.length+1,v=`${l.prefix}${_}`;n.value.unshift({[l.keyColumn]:v,value:"123"})}function u(_){n.value.splice(_,1)}return(_,v)=>{const w=ie,x=Ie,y=A,k=Pe,C=P("tooltip");return r(),g("div",Ft,[t(k,{editingRows:s.value,"onUpdate:editingRows":v[0]||(v[0]=V=>s.value=V),value:n.value,editMode:"cell",dataKey:l.keyColumn,onRowEditSave:a,onCellEditComplete:p,pt:{table:{style:"min-width: 50rem"},column:{bodycell:({state:V})=>({style:V.d_editing&&"padding-top: 0.6rem; padding-bottom: 0.6rem"})}}},{default:m(()=>[t(x,{field:l.keyColumn,header:l.keyColumnName,style:{width:"40%"}},{editor:m(({data:V,field:d})=>[t(w,{modelValue:V[d],"onUpdate:modelValue":f=>V[d]=f},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["field","header"]),t(x,{style:{width:"40%"},field:"value",header:"Value"},{editor:m(({data:V,field:d})=>[t(w,{modelValue:V[d],"onUpdate:modelValue":f=>V[d]=f},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(x,{style:{"min-width":"1rem"}},{header:m(()=>[e("div",Wt,[M(t(y,{label:"",rounded:"",text:"",style:{height:"2rem",width:"2rem"},icon:"pi pi-plus",severity:"success",onClick:i},null,512),[[C,"Add",void 0,{top:!0}]])])]),body:m(({index:V})=>[e("div",Kt,[M(t(y,{label:"",rounded:"",text:"",style:{height:"2rem",width:"2rem"},icon:"pi pi-trash",severity:"warning",onClick:d=>u(V)},null,8,["onClick"]),[[C,"Delete",void 0,{top:!0}]])])]),_:1})]),_:1},8,["editingRows","value","dataKey","pt"])])}}},Qt={class:"flex justify-content-between align-items-center w-full"},zt={class:"field"},Gt=e("label",{for:"url"},"URL",-1),Yt={class:"field mb-4"},Jt=e("label",{for:"events"},"Events",-1),Xt=e("div",{class:"font-bold mb-2"},"Retries",-1),Zt={class:"flex gap-3"},eo={class:"field"},so=e("label",{for:"retries-attempts"},"Attempts",-1),to=e("span",{class:"pi pi-plus"},null,-1),oo=e("span",{class:"pi pi-minus"},null,-1),no={class:"field"},lo=e("label",{for:"retries-delay-seconds"},"Delay, seconds",-1),io=e("span",{class:"pi pi-plus"},null,-1),ao=e("span",{class:"pi pi-minus"},null,-1),ro={class:"field"},uo=e("label",{for:"hmac"},"HMAC Key (optional)",-1),co={class:"field"},po={class:"field flex justify-content-between align-items-center"},mo=e("div",null,[e("label",{for:"hmac"},"Custom Headers (optional)")],-1),vo={__name:"SessionWebhook",props:le({disabled:Boolean,index:Number},{webhook:{},webhookModifiers:{}}),emits:["update:webhook"],setup(o){const n=K(o,"webhook"),l=o,s=["session.status","message","message.any","message.reaction","message.ack","message.revoked","chat.archive","group.join","group.leave","presence.update","poll.vote","poll.vote.failed","call.received","call.accepted","call.rejected","label.upsert","label.deleted","label.chat.added","label.chat.deleted"],a=S(n.value.customHeaders&&n.value.customHeaders.length>0);return ve(a,(p,i)=>{if(i&&!p){n.value.customHeaders=null;return}!i&&p&&(n.value.customHeaders=[{name:"X-Header-1",value:"123"}])}),(p,i)=>{const u=A,_=ie,v=je,w=Ts,x=Be("font-awesome-icon"),y=Fe,k=Xe,C=We,V=Ke,d=P("tooltip");return r(),T(V,{activeIndex:0},{default:m(()=>[t(C,null,{header:m(()=>[e("div",Qt,[e("div",null," Webhook "+N(l.index+1),1),e("div",null,[M(t(u,{label:"",text:"",rounded:"",style:{height:"2rem",width:"2rem"},icon:"pi pi-trash",severity:"warning",onClick:i[0]||(i[0]=f=>p.$emit("remove"))},null,512),[[d,"Delete Webhook",void 0,{top:!0}]])])])]),default:m(()=>[e("div",zt,[Gt,t(_,{id:"url",modelValue:n.value.url,"onUpdate:modelValue":i[1]||(i[1]=f=>n.value.url=f),modelModifiers:{trim:!0},required:"true",disabled:o.disabled},null,8,["modelValue","disabled"])]),e("div",Yt,[Jt,t(v,{id:"events",modelValue:n.value.events,"onUpdate:modelValue":i[2]||(i[2]=f=>n.value.events=f),options:s,placeholder:"Select Events","max-selected-labels":1,selectedItemsLabel:"{0} events selected",disabled:o.disabled},null,8,["modelValue","disabled"]),e("ul",null,[(r(!0),g(O,null,me(n.value.events,f=>(r(),g("li",{key:f},N(f),1))),128))])]),e("div",null,[Xt,e("div",Zt,[e("div",eo,[so,t(w,{modelValue:n.value.retries.attempts,"onUpdate:modelValue":i[3]||(i[3]=f=>n.value.retries.attempts=f),inputId:"retries-delay-attempts",showButtons:"",buttonLayout:"horizontal",min:1,step:1,disabled:o.disabled},{incrementbuttonicon:m(()=>[to]),decrementbuttonicon:m(()=>[oo]),_:1},8,["modelValue","disabled"])]),e("div",no,[lo,t(w,{modelValue:n.value.retries.delaySeconds,"onUpdate:modelValue":i[4]||(i[4]=f=>n.value.retries.delaySeconds=f),inputId:"retries-delay-seconds",showButtons:"",buttonLayout:"horizontal",min:1,step:1,disabled:o.disabled},{incrementbuttonicon:m(()=>[io]),decrementbuttonicon:m(()=>[ao]),_:1},8,["modelValue","disabled"])])])]),e("div",ro,[uo,t(_,{id:"hmac",modelValue:n.value.hmac.key,"onUpdate:modelValue":i[5]||(i[5]=f=>n.value.hmac.key=f),modelModifiers:{trim:!0},disabled:o.disabled},null,8,["modelValue","disabled"])]),e("div",co,[e("div",po,[mo,t(y,{modelValue:a.value,"onUpdate:modelValue":i[6]||(i[6]=f=>a.value=f),id:"customHeaders",onLabel:"Headers On",offLabel:"Headers Off"},{icon:m(()=>[t(x,{icon:"fa-solid fa-fingerprint",class:"mr-2"})]),_:1},8,["modelValue"])]),a.value?(r(),T(k,{key:0,modelValue:n.value.customHeaders,"onUpdate:modelValue":i[7]||(i[7]=f=>n.value.customHeaders=f),"key-column":"name","key-column-name":"Header",prefix:"X-Header-"},null,8,["modelValue"])):R("",!0)])]),_:1})]),_:1})}}},fo={class:"flex flex-column gap-2"},_o={class:"flex justify-content-between align-items-center w-full"},bo=e("h5",null,"ðŸ”„ Webhooks",-1),ho={class:"pr-2"},go={key:0,class:"text-300 text-center"},yo={__name:"SessionWebhooksField",props:le({disabled:Boolean},{webhooks:{},webhooksModifiers:{}}),emits:["update:webhooks"],setup(o){const n=K(o,"webhooks");function l(){const a={url:"https://httpbin.org/post",events:["session.status","message"],hmac:{key:null},retries:{delaySeconds:2,attempts:15},customHeaders:null};n.value.push(a)}function s(a){n.value.splice(a,1)}return(a,p)=>{const i=A,u=vo;return r(),g("div",fo,[e("div",_o,[bo,e("div",ho,[t(i,{label:"Add Webhook",text:"",icon:"pi pi-plus",severity:"success",onClick:l})])]),n.value.length===0?(r(),g("div",go," No webhooks configured ")):(r(!0),g(O,{key:1},me(n.value,(_,v)=>(r(),T(u,{webhook:n.value[v],"onUpdate:webhook":w=>n.value[v]=w,index:v,total:n.value.length,onRemove:w=>s(v),disabled:o.disabled},null,8,["webhook","onUpdate:webhook","index","total","onRemove","disabled"]))),256))])}}},$o=e("div",null,[e("h5",null,[e("i",{class:"pi pi-whatsapp"}),j(" Create Session ")])],-1),So={class:"mb-2"},wo=e("b",null,"Server",-1),xo=e("b",null,"Name",-1),ko={class:"field"},Co=e("label",{for:"server"},"Server",-1),Vo={key:0,class:"p-invalid"},Do={class:"field"},Ro=e("label",{for:"name"},"Name (optional)",-1),Uo={key:0,class:"mb-4"},To=e("div",{class:"mb-3"},[e("h5",null,"ðŸ­ Engine Settings ")],-1),Lo={class:"flex flex-column gap-2"},Bo=e("div",null,[e("a",{href:"https://waha.devlike.pro/docs/engines/noweb",target:"_blank"},"Read more about NOWEB settings")],-1),Mo={class:"pi pi-info-circle"},jo={class:"field mt-4"},Io={class:"field flex justify-content-between align-items-center"},No=e("div",null,[e("h5",null,[e("label",{for:"proxy"},"ðŸŒ Proxy")])],-1),Oo={key:0,class:"card mb-4"},Eo={class:"field"},qo=e("label",{for:"proxy-server"},"Server",-1),Ao={key:0,class:"p-invalid"},Po={class:"flex gap-3"},Ho={class:"field w-full"},Fo=e("label",{for:"proxy-username"},"Username (optional)",-1),Wo={class:"field w-full"},Ko=e("label",{for:"proxy-password"},"Password (optional)",-1),Qo={class:"field flex justify-content-between align-items-center"},zo=e("div",null,[e("h5",null,[e("label",{for:"debug"},"ðŸ› ï¸ Debug")])],-1),Go={class:"w-full flex flex-column gap-2"},Yo={class:"flex justify-content-end"},Jo={__name:"SessionDialog",props:le({mode:String},{visible:{},visibleModifiers:{},session:{},sessionModifiers:{}}),emits:["update:visible","update:session"],setup(o){var Z,J;const n=Se(),l=K(o,"visible"),s=K(o,"session"),a=o,p=L(()=>a.mode==="new"),i=L(()=>a.mode==="update"),u=L(()=>i.value),_=we(),v=q(),w=L(()=>v.getServer(s.value.server)),x=L(()=>{var $,h;return((h=($=w.value)==null?void 0:$.version)==null?void 0:h.engine)==="NOWEB"});L(()=>{var $,h;return((h=($=w.value)==null?void 0:$.version)==null?void 0:h.engine)==="WEBJS"});const y=S([]),k=S(!!((J=(Z=s.value.config)==null?void 0:Z.proxy)!=null&&J.server));ve(s,async($,h)=>{var Q,F,ee;k.value=(F=(Q=$==null?void 0:$.config)==null?void 0:Q.proxy)==null?void 0:F.server,y.value=js((ee=$.config)==null?void 0:ee.metadata)});const C=S(!1),V=S(!1),d=L(()=>{const $=G.cloneDeep(s.value.config);return k.value||($.proxy=void 0),$.metadata=Is(y.value),$}),f=L(()=>{const $={...d.value};return x.value||delete $.noweb,{name:s.value.name,config:$}});async function I(){C.value=!0;try{V.value=!0;const $=G.cloneDeep(f.value);await _(v.updateSession(s.value.server,s.value.name,$.config),void 0,"Failed to update session"),n.add({severity:"success",summary:"Updated",detail:s.value.name,life:3e3})}finally{V.value=!1}s.value=void 0,E()}async function Y($){C.value=!0;try{V.value=!0;const h=G.cloneDeep(f.value);h.start=$;const Q=await _(v.createSession(s.value.server,h),void 0,"Failed to start session"),F=$?"Started":"Created";n.add({severity:"success",summary:F,detail:Q.name,life:3e3})}finally{V.value=!1}s.value=void 0,E()}function E(){C.value=!1,l.value=!1}const ae=L(()=>s.value.status==="STOPPED");async function H($){await navigator.clipboard.writeText(JSON.stringify({method:"POST",uri:"/api/sessions",body:f.value},null,2)),$.preventDefault()}return($,h)=>{const Q=Ve,F=Rs,ee=Ye,re=ie,fe=Us,se=Be("font-awesome-icon"),te=Fe,_e=We,B=Ke,D=Xe,de=yo,ue=Ls,oe=A,be=ke,ne=P("tooltip");return r(),T(be,{visible:l.value,"onUpdate:visible":h[14]||(h[14]=U=>l.value=U),modal:!0,class:"p-fluid",maximizable:""},hs({footer:m(()=>[e("div",Go,[e("div",null,[i.value&&!ae.value?(r(),T(F,{key:0,severity:"warn"},{default:m(()=>[j(" The session is in '"),e("b",null,N(s.value.status)+"'",1),j(" status, in order to save configuration the session will be restarted. ")]),_:1})):R("",!0)]),e("div",Yo,[M(t(oe,{label:"Copy",text:"",tabindex:0,icon:"pi pi-copy",severity:"secondary",onClick:h[11]||(h[11]=U=>H(U))},null,512),[[ne,{value:"Copied to clipboard"},void 0,{focus:!0,bottom:!0}]]),i.value?R("",!0):(r(),T(oe,{key:0,label:"Create",icon:"pi pi-plus",text:"",onClick:h[12]||(h[12]=U=>Y(!1)),loading:V.value},null,8,["loading"])),i.value?R("",!0):(r(),T(oe,{key:1,label:"Create & Start",icon:"pi pi-play",text:"",onClick:h[13]||(h[13]=U=>Y(!0)),loading:V.value},null,8,["loading"])),i.value?(r(),T(oe,{key:2,label:"Update",icon:"pi pi-save",text:"",onClick:I,loading:V.value},null,8,["loading"])):R("",!0)])])]),default:m(()=>[e("div",So,[i.value?(r(),T(F,{key:0,severity:"info"},{default:m(()=>[j(" To change the "),wo,j(" or "),xo,j(" - please remove the session and run again. ")]),_:1})):R("",!0)]),e("div",ko,[Co,t(ee,{placeholder:"Select Server",modelValue:s.value.server,"onUpdate:modelValue":h[0]||(h[0]=U=>s.value.server=U),showClear:!1,required:!0,invalid:C.value&&!s.value.server,disabled:u.value},null,8,["modelValue","invalid","disabled"]),C.value&&!s.value.server?(r(),g("small",Vo,"Server is required.")):R("",!0)]),e("div",Do,[Ro,t(re,{id:"name",modelValue:s.value.name,"onUpdate:modelValue":h[1]||(h[1]=U=>s.value.name=U),modelModifiers:{trim:!0},required:"false",autofocus:"",placeholder:"session_1111111111111",disabled:!p.value},null,8,["modelValue","disabled"])]),x.value?(r(),g("div",Uo,[To,t(B,{activeIndex:0},{default:m(()=>[t(_e,{header:"NOWEB"},{header:m(()=>[j(" Â "),t(fe,{value:"New"})]),default:m(()=>[e("div",Lo,[Bo,e("div",null,[M((r(),T(te,{modelValue:s.value.config.noweb.store.enabled,"onUpdate:modelValue":h[2]||(h[2]=U=>s.value.config.noweb.store.enabled=U),onLabel:"Store: Enabled",offLabel:"Store: Disabled",disabled:u.value},{icon:m(()=>[t(se,{icon:"fa-solid fa-folder",class:"mr-2"})]),_:1},8,["modelValue","disabled"])),[[ne,"Store contacts, chats, messages in the database, so you can get it in API"]])]),e("div",null,[M((r(),T(te,{modelValue:s.value.config.noweb.store.fullSync,"onUpdate:modelValue":h[3]||(h[3]=U=>s.value.config.noweb.store.fullSync=U),onLabel:"Store: Full Sync On",offLabel:"Store: Full Sync Off",disabled:u.value},{icon:m(()=>[t(se,{icon:"fa-solid fa-sync",class:"mr-2"})]),_:1},8,["modelValue","disabled"])),[[ne,`Sync all contacts, chats, messages from the phone at the start.
Otherwise the store can miss some information.`]])])])]),_:1})]),_:1})])):R("",!0),e("div",null,[e("div",null,[e("h5",null,[j("ðŸ“ Metadata "),M(e("i",Mo,null,512),[[ne,"Key value pairs you can attach to Session and will receive it in webhooks, API and search the values on Dashboard."]])])]),t(D,{modelValue:y.value,"onUpdate:modelValue":h[4]||(h[4]=U=>y.value=U),"key-column":"key","key-column-name":"Key",prefix:"user.id."},null,8,["modelValue"])]),e("div",jo,[t(de,{ref:"webhooks",webhooks:s.value.config.webhooks,"onUpdate:webhooks":h[5]||(h[5]=U=>s.value.config.webhooks=U)},null,8,["webhooks"])]),e("div",null,[e("div",Io,[No,t(te,{modelValue:k.value,"onUpdate:modelValue":h[6]||(h[6]=U=>k.value=U),id:"proxy",onLabel:"Proxy On",offLabel:"Proxy Off"},{icon:m(()=>[t(se,{icon:"fa-solid fa-server",class:"mr-2"})]),_:1},8,["modelValue"])]),k.value?(r(),g("div",Oo,[e("div",Eo,[qo,t(re,{id:"proxy-server",modelValue:s.value.config.proxy.server,"onUpdate:modelValue":h[7]||(h[7]=U=>s.value.config.proxy.server=U),modelModifiers:{trim:!0},required:"true",invalid:C.value&&!s.value.config.proxy.server,placeholder:"host:port"},null,8,["modelValue","invalid"]),C.value&&!s.value.config.proxy.server?(r(),g("small",Ao,"Server is required.")):R("",!0)]),e("div",Po,[e("div",Ho,[Fo,t(re,{id:"proxy-username",modelValue:s.value.config.proxy.username,"onUpdate:modelValue":h[8]||(h[8]=U=>s.value.config.proxy.username=U),modelModifiers:{trim:!0}},null,8,["modelValue"])]),e("div",Wo,[Ko,t(ue,{id:"proxy-password",modelValue:s.value.config.proxy.password,"onUpdate:modelValue":h[9]||(h[9]=U=>s.value.config.proxy.password=U),modelModifiers:{trim:!0},feedback:!1,toggleMask:""},null,8,["modelValue"])])])])):R("",!0)]),e("div",Qo,[zo,t(te,{modelValue:s.value.config.debug,"onUpdate:modelValue":h[10]||(h[10]=U=>s.value.config.debug=U),onLabel:"Debug Enabled",offLabel:"Debug Disabled",onIcon:"fa fa-bug"},{icon:m(()=>[t(se,{icon:"fa-solid fa-bug",class:"mr-2"})]),_:1},8,["modelValue"])])]),_:2},[p.value?{name:"header",fn:m(()=>[$o]),key:"0"}:void 0,p.value?void 0:{name:"header",fn:m(()=>[e("div",null,[t(Q,{session:s.value},null,8,["session"])])]),key:"1"}]),1032,["visible"])}}},Xo=["WORKING","FAILED","STARTING","SCAN_QR_CODE","STOPPED"],Zo={class:"",style:{"min-width":"20rem"}},en={class:"flex justify-content-center align-items-center"},sn=e("h5",{class:"m-0"},"QR",-1),tn={class:"m-auto w-full"},on={class:"flex justify-content-center"},nn={key:1,style:{"background-color":"#f8f9fa",padding:"1rem",color:"red","white-space":"pre-wrap"}},ln={__name:"QRImage",props:{session:Object},setup(o){const n=q(),l=o,{data:s,pending:a,error:p,refresh:i}=he(`session-qr-${l.session.server.id}-${l.session.name}`,async()=>(await ge(1e3),await n.getQR(l.session.server.id,l.session.name)));return(u,_)=>{const v=Ce,w=Ne,x=Oe,y=ze;return r(),g("div",Zo,[e("div",en,[sn,t(v,{onClick:c(i)},null,8,["onClick"])]),e("div",tn,[c(a)?(r(),g(O,{key:0},[t(w,{mode:"indeterminate",style:{height:"3px"}}),!c(s)&&!c(p)?(r(),T(x,{key:0,width:"100%",height:"20rem"})):R("",!0)],64)):R("",!0),e("div",on,[c(s)?(r(),T(y,{key:0,data:c(s).data,mimetype:c(s).mimetype},null,8,["data","mimetype"])):R("",!0),c(p)?(r(),g("pre",nn,""+N(c(p).cause.response.data.message||c(p).cause.response.data||c(p))+`
  `,1)):R("",!0)])])])}}},an={},rn={class:"pl-4"},dn=Me('<li> Open <b>WhatsApp</b> on your phone </li><li> Tap <b>More options</b> <i class="pi pi-ellipsis-v"></i> or <b>Settings</b> <i class="pi pi-cog"></i></li><li> Tap <b>Linked Devices</b> &gt; <b>Link a device</b></li><li><b>Link with phone number instead</b> and enter the code </li>',4),un=[dn];function cn(o,n){return r(),g("ul",rn,un)}const pn=pe(an,[["render",cn]]),mn={class:"flex flex-column gap-2 mt-4"},vn={class:"flex justify-content-between gap-2"},fn={class:"field"},_n={class:"card flex justify-content-center align-items-center"},bn={class:"mx-1",style:{"font-size":"2rem"}},hn={__name:"PairingCodeSteps",props:["session"],setup(o){const n=o,l=S(null),s=S(!1),a=S(""),p=we(),i=q();function u(v){return v.replace(/\D/g,"")}async function _(){l.value=u(l.value),s.value=!0;try{await ge(1e3);const v=await p(i.getPairingCode(n.session.server.id,n.session.name,l.value),"Request sent","Failed to request code",n.session.name,n.session.name);a.value=v.code}finally{s.value=!1}}return ve(l,G.debounce(v=>{l.value=u(v)},1e3)),(v,w)=>{const x=ie,y=A,k=He;return r(),g(O,null,[e("div",mn,[e("form",{onSubmit:gs(_,["prevent"])},[e("div",vn,[e("div",fn,[t(x,{id:"phone","input-id":"phone",name:"phone",modelValue:c(l),"onUpdate:modelValue":w[0]||(w[0]=C=>$e(l)?l.value=C:null),modelModifiers:{trim:!0},useGrouping:!1,required:"true",autofocus:"",placeholder:"1213213213 (no +, no dashes -)"},null,8,["modelValue"])]),e("div",null,[t(y,{type:"submit",label:"Show Code",icon:"pi pi-send",loading:c(s)},null,8,["loading"])])])],32)]),c(a)?(r(),g(O,{key:0},[t(k),e("div",null,[t(pn)]),e("div",_n,[e("div",null,[c(a)?(r(!0),g(O,{key:0},me(c(a),C=>(r(),g("span",bn,N(C),1))),256)):R("",!0)])])],64)):R("",!0)],64)}}},gn={},yn={class:"pl-4"},$n=Me('<li> Open <b>WhatsApp</b> on your phone </li><li> Tap <b>More options</b> <i class="pi pi-ellipsis-v"></i> or <b>Settings</b> <i class="pi pi-cog"></i></li><li> Tap <b>Linked Devices</b> and <b>Link a device</b></li><li> Point your phone to this screen to capture <b>QR code</b></li>',4),Sn=[$n];function wn(o,n){return r(),g("ul",yn,Sn)}const xn=pe(gn,[["render",wn]]),kn=e("i",{class:"pi pi-qrcode mr-2"},null,-1),Cn=e("p",null,[j(" Scan "),e("b",null,"QR Code"),j(" to authorize this session. ")],-1),Vn=e("i",{class:"pi pi-send mr-2"},null,-1),Dn=e("p",{class:"m-0"},[j(" Enter "),e("b",null,"Your Phone number"),j(": ")],-1),Rn={__name:"SessionLoginDialog",props:le(["session"],{visible:{},visibleModifiers:{}}),emits:["update:visible"],setup(o){const n=K(o,"visible");return(l,s)=>{const a=Bs,p=Ms,i=ke;return r(),T(i,{visible:n.value,"onUpdate:visible":s[0]||(s[0]=u=>n.value=u),modal:!0,class:"p-fluid",maximizable:""},{header:m(()=>[t(Ve,{session:o.session},null,8,["session"])]),default:m(()=>[t(p,null,{default:m(()=>[t(a,null,{header:m(()=>[kn,j(" Scan QR ")]),default:m(()=>[Cn,t(xn),e("div",null,[t(ln,{session:o.session},null,8,["session"])])]),_:1}),t(a,null,{header:m(()=>[Vn,j(" Enter Code ")]),default:m(()=>[Dn,e("div",null,[t(hn,{session:o.session},null,8,["session"])])]),_:1})]),_:1})]),_:1},8,["visible"])}}},Un={__name:"SessionLogin",props:["session"],setup(o){const n=S(!1);return(l,s)=>{const a=A,p=P("tooltip");return r(),g(O,null,[M(t(a,{icon:"pi pi-sign-in",severity:"",rounded:"",outlined:"",onClick:s[0]||(s[0]=i=>n.value=!0),disabled:o.session.status!=="SCAN_QR_CODE"},null,8,["disabled"]),[[p,"Login",void 0,{top:!0}]]),t(Rn,{visible:c(n),"onUpdate:visible":s[1]||(s[1]=i=>$e(n)?n.value=i:null),session:o.session},null,8,["visible","session"])],64)}}},Tn={class:"flex justify-content-between"},Ln={class:"flex align-items-center gap-1"},Bn=e("i",{class:"pi pi-whatsapp"},null,-1),Mn=e("span",{class:"mr-1"}," Sessions ",-1),jn=["disabled"],In=e("i",{class:"pi pi-refresh"},null,-1),Nn=[In],On={class:"flex justify-content-between flex-column sm:flex-row gap-2 sm:gap-0"},En={class:"flex flex-column"},qn={class:"flex justify-content-between flex-column sm:flex-row gap-2 sm:gap-2"},An={style:{"text-align":"left"},class:"flex flex-column"},Pn={class:"text-center"},Hn={class:"flex gap-2"},Fn={class:"my-auto"},Wn={class:"flex flex-row gap-2 justify-content-end",style:{order:"2"}},Sl={__name:"SessionTable",setup(o){const n=Se(),l=q(),{visibleSessions:s,refreshing:a,servers:p}=ye(l),i=S({config:{webhooks:[]}}),u=S(!1),_=S(void 0),v=S(!1),w=S(10);S(null);const x=S({}),y=S(null),k=S([]),C=L(()=>k.value.filter(B=>V.value[`session-action-${B.server.id}-${B.name}`])),V=S({});function d(B){C.value.forEach(D=>{V.value[`session-action-${D.server.id}-${D.name}`][B]()})}ys(()=>{V.value=[]}),$s(()=>{ee()});const f=S([{field:"name",header:"Name"},{field:"metadata",header:"Metadata"},{field:"me",header:"Me"},{field:"status",header:"Status"},{field:"server",header:"Server"}]);function I(){return JSON.parse(localStorage.getItem("sessions.table.columns.hidden"))||[]}const Y=I(),E=S(G.differenceBy(f.value,Y,"field")),ae=B=>{E.value=f.value.filter(D=>B.includes(D))};function H(B){return!E.value||E.value.length===0?!0:G.find(E.value,{field:B})}const Z=L(()=>H("name")),J=L(()=>H("metadata")),$=L(()=>H("me")),h=L(()=>H("status")),Q=L(()=>H("server")),F=L(()=>G.differenceBy(f.value,E.value,"field"));ve(()=>F.value,B=>{localStorage.setItem("sessions.table.columns.hidden",JSON.stringify(B))},{deep:!0});const ee=()=>{x.value={global:{value:null,matchMode:ce.CONTAINS},status:{value:null,matchMode:ce.EQUALS},"server.id":{value:null,matchMode:ce.EQUALS},name:{operator:Ss.AND,constraints:[{value:null,matchMode:ce.STARTS_WITH}]}}};function re(){const B=p.value.find(D=>D.connected);if(!B){n.add({severity:"error",summary:"No connected server",detail:"Please connect to a server first",life:3e3});return}i.value={server:B.id,name:"",config:{metadata:{"user.id":"123"},webhooks:[{url:"https://httpbin.org/post",events:["session.status","message"],hmac:{key:null},retries:{delaySeconds:2,attempts:15},customHeaders:null}],noweb:{store:{enabled:!0,fullSync:!1}},proxy:{}}},_.value="new",u.value=!0}function fe(B){i.value=G.cloneDeep({name:B.name,status:B.status,server:B.server.id,config:B.config}),_.value="update",u.value=!0}function se(){he("store",async()=>await l.refresh())}function te(B){v.value=!0,i.value=B}const _e=L(()=>["name","me.id","me.pushName","_metadata"]);return(B,D)=>{const de=Te,ue=A,oe=As,be=je,ne=ws,U=ie,Ze=xs,X=Ie,es=Fs,ss=Qe,ts=Zs,Re=qe,os=xe,ns=Ye,ls=Je,is=lt,as=Pe,rs=Ae,ds=Ht,us=Jo,Ue=P("tooltip");return r(),g(O,null,[e("div",Tn,[e("div",null,[e("h5",Ln,[Bn,Mn,t(de,{refreshing:c(a)},null,8,["refreshing"])])]),e("div",null,[M((r(),g("button",{onClick:se,class:"p-link layout-topbar-button",disabled:c(a)},Nn,8,jn)),[[Ue,"Refresh",void 0,{top:!0}]])])]),t(as,{selection:k.value,"onUpdate:selection":D[6]||(D[6]=b=>k.value=b),value:c(s).length>0?c(s):[],paginator:!0,rows:w.value,rowsPerPageOptions:[5,10,20,50,100,500],dataKey:b=>`${b.server.id}-${b.name}`,rowHover:!0,filters:x.value,"onUpdate:filters":D[7]||(D[7]=b=>x.value=b),filterDisplay:"row",loading:y.value,globalFilterFields:c(_e),showGridlines:"",style:{"white-space":"nowrap"},sortField:"name",sortOrder:1},{header:m(()=>[e("div",On,[e("div",En,[t(ue,{label:"Start New",icon:"pi pi-play",severity:"success",onClick:re})]),e("div",qn,[t(oe),e("div",An,[t(be,{placeholder:"Columns",modelValue:E.value,options:f.value,optionLabel:"header",selectedItemsLabel:"Columns",maxSelectedLabels:0,"onUpdate:modelValue":ae},null,8,["modelValue","options"])]),t(Ze,{iconPosition:"left"},{default:m(()=>[t(ne,{class:"pi pi-search"}),t(U,{modelValue:x.value.global.value,"onUpdate:modelValue":D[0]||(D[0]=b=>x.value.global.value=b),placeholder:"Search by name, phone, metadata",style:{width:"100%"}},null,8,["modelValue"])]),_:1})])])]),empty:m(()=>[j(" No sessions found")]),loading:m(()=>[j(" Loading sessions...")]),default:m(()=>[t(X,{selectionMode:"multiple",headerStyle:"width: 3rem"}),c(Z)?(r(),T(X,{key:0,field:"name",header:"Name",sortable:""})):R("",!0),c(J)?(r(),T(X,{key:1,header:"Metadata"},{body:m(({data:b})=>{var W;return[t(es,{metadata:(W=b.config)==null?void 0:W.metadata},null,8,["metadata"])]}),_:1})):R("",!0),c($)?(r(),T(X,{key:2,header:"Me"},{body:m(({data:b})=>[e("div",Pn,[t(ss,{session:b},null,8,["session"])])]),_:1})):R("",!0),c(h)?(r(),T(X,{key:3,field:"status",header:"Status",showFilterMenu:!1,style:{width:"9rem"}},{body:m(({data:b})=>[e("div",Hn,[e("div",null,[t(Un,{session:b},null,8,["session"])]),e("div",null,[t(ts,{session:b},null,8,["session"])]),e("div",null,[M(t(ue,{icon:"pi pi-whatsapp",severity:"",rounded:"",outlined:"",onClick:W=>te(b)},null,8,["onClick"]),[[Ue,"Send Request",void 0,{top:!0}]])]),e("div",Fn,[t(Re,{status:b.status,value:b.status.toUpperCase()},null,8,["status","value"])])])]),filter:m(({filterModel:b,filterCallback:W})=>[t(os,{modelValue:b.value,"onUpdate:modelValue":z=>b.value=z,options:c(Xo),onChange:z=>W(),placeholder:"Any",class:"p-column-filter",showClear:!0},{option:m(({option:z})=>[t(Re,{status:z,value:z},null,8,["status","value"])]),_:2},1032,["modelValue","onUpdate:modelValue","options","onChange"])]),_:1})):R("",!0),c(Q)?(r(),T(X,{key:4,field:"server.name",filterField:"server.id",header:"Server",showFilterMenu:!1},{filter:m(({filterModel:b,filterCallback:W})=>[t(ns,{placeholder:"Any",onChange:z=>W(),modelValue:b.value,"onUpdate:modelValue":z=>b.value=z,showClear:!0,required:!1},null,8,["onChange","modelValue","onUpdate:modelValue"])]),body:m(({data:b})=>[j(N(b.server.name),1)]),_:1})):R("",!0),t(X,{showFilterMenu:!1},{filter:m(()=>[e("div",Wn,[t(ls,{group:"dialog",name:`'${c(C).length}' sessions`,"all-disabled":c(C).length===0,"hide-actions":["view"],onStart:D[1]||(D[1]=b=>d("startSession")),onRestart:D[2]||(D[2]=b=>d("restartSession")),onStop:D[3]||(D[3]=b=>d("stopSession")),onLogout:D[4]||(D[4]=b=>d("logoutSession")),onDelete:D[5]||(D[5]=b=>d("deleteSession"))},null,8,["name","all-disabled"])])]),body:m(({data:b})=>[t(is,{ref:W=>{V.value[`session-action-${b.server.id}-${b.name}`]=W},session:b,disabled:c(C).length!==0,onView:fe},null,8,["session","disabled"])]),_:1})]),_:1},8,["selection","value","rows","dataKey","filters","loading","globalFilterFields"]),t(rs),t(ds,{visible:v.value,"onUpdate:visible":D[8]||(D[8]=b=>v.value=b),session:i.value,"onUpdate:session":D[9]||(D[9]=b=>i.value=b)},null,8,["visible","session"]),t(us,{visible:u.value,"onUpdate:visible":D[10]||(D[10]=b=>u.value=b),session:i.value,"onUpdate:session":D[11]||(D[11]=b=>i.value=b),mode:_.value},null,8,["visible","session","mode"])],64)}}};export{As as _,Sl as a};
