import{u as Ce,_ as et}from"./Cnmo1OAV.js";import q from"./CaWnzDcw.js";import Ht from"./b-kUBtim.js";import{u as z,a as Ft,s as pe,C as de,W as Kt,l as le}from"./58LrC_IB.js";import{R as He,O as Y,N as f,t as a,v as _,P as N,x as e,z as o,W as Ve,_ as oe,T as W,X as be,y as B,U as S,L as U,A as p,r as g,o as Ae,c as L,Y as tt,B as T,Z as te,M as Je,H as se,$ as zt,a0 as st,a1 as X,Q as ge,a2 as Yt,C as me,D as ve,a3 as ye,i as ot,a4 as Gt,a5 as nt,d as Ie,a6 as Qt,V as Xt,S as he}from"./CFUq_nD1.js";import Jt from"./BDKx1mWm.js";import ne from"./D6atgbJh.js";import Zt from"./DqN_nw6n.js";import lt from"./CuNUIqjd.js";import De from"./DKrTESMM.js";import it from"./Br2Oe7LO.js";import at from"./BVFZ2kfw.js";import rt from"./NAJEcTwn.js";import es from"./DwA-pA8X.js";import{u as fe,_ as ut}from"./2iudWBMv.js";import $e from"./5LNSU-Of.js";import{_ as ts,a as ss,b as ct}from"./D3EH4CUD.js";import Fe from"./D2yyVtSF.js";import os from"./529VZ_cP.js";import Re from"./C6mLBRuZ.js";import{_ as ns}from"./7jNAbCRE.js";import ls from"./DbwJzi5I.js";import is from"./BtRwAZIn.js";import as from"./D659h6uF.js";import _e from"./C-xU0BFv.js";import dt from"./DiP61T-9.js";import pt from"./BkLJGcjB.js";import mt from"./BGbt5Q3r.js";import vt from"./mRb4B-OV.js";import Ke from"./-u4fFqwA.js";import ze from"./FjyJwtSb.js";import ft from"./DMXf8i43.js";import _t from"./6g5OKpU4.js";import rs from"./Br00tGgL.js";import us from"./CANRtCc7.js";function ht(t="app"){const l="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let n="";for(let s=0;s<8;s++)n+=l.charAt(Math.floor(Math.random()*l.length));return`${t}_${n}`}function cs(t){return t?Object.keys(t).map(l=>({key:l,value:t[l]})):[]}function ds(t){return t.reduce((l,n)=>(l[n.key]=n.value,l),{})}const ps={key:0},ms={key:1,class:"ml-auto flex align-items-center gap-2 mr-2"},vs=e("label",{for:"show-duplicates"},"Hide Duplicates",-1),fs={class:"pi pi-info-circle"},_s={__name:"HideDuplicates",setup(t){const l=z(),{hideDuplicatedSessions:n,servers:s}=He(l);return l.$subscribe((r,c)=>{Ft(c.hideDuplicatedSessions)}),(r,c)=>{const i=Ht,d=Y("tooltip");return f(s)&&f(s).length<2?(a(),_("div",ps)):(a(),_("div",ms,[vs,N(e("i",fs,null,512),[[d,`Hide STOPPED sessions with the same "name" .
Useful when you use multiple workers with the same database`]]),o(i,{id:"show-duplicates",modelValue:f(n),"onUpdate:modelValue":c[0]||(c[0]=u=>Ve(n)?n.value=u:null)},null,8,["modelValue"])]))}}},hs={class:"metadata"},bs={__name:"Metadata",props:["metadata"],setup(t){return(l,n)=>(a(),_("div",hs,[(a(!0),_(W,null,be(t.metadata,(s,r)=>(a(),_("pre",{key:r},B(r)+"="+B(s),1))),128))]))}},gs=oe(bs,[["__scopeId","data-v-cb7cbf08"]]),ys={key:0,class:"text-center p-1"},$s={class:"text-center"},ws=e("i",{class:"mr-3 pi pi-user",style:{color:"#34d399"}},null,-1),Se={__name:"ContactChip",props:{id:String,name:String,image:String},setup(t){return(l,n)=>{const s=it;return a(),_("div",null,[t.name?(a(),_("div",ys,[e("b",$s,B(t.name),1)])):S("",!0),t.id?(a(),U(s,{key:1,label:t.id,image:t.image,icon:"pi pi-user"},{icon:p(()=>[ws]),_:1},8,["label","image"])):S("",!0)])}}},Ye={__name:"SessionChip",props:{session:Object},setup(t){const l=t,n=z(),s=g(null);return Ae(()=>{var r,c,i;(c=(r=l.session)==null?void 0:r.me)!=null&&c.id&&((i=l.session)==null?void 0:i.status)==="WORKING"&&n.getProfilePicture(l.session.server.id,l.session.name,l.session.me.id).then(d=>{s.value=d.profilePictureURL})}),(r,c)=>{var i,d,u,m;return a(),U(Se,{id:(d=(i=l.session)==null?void 0:i.me)==null?void 0:d.id,name:(m=(u=l.session)==null?void 0:u.me)==null?void 0:m.pushName,image:f(s)},null,8,["id","name","image"])}}},we={__name:"RefreshButton",props:["refreshing"],setup(t){const l=t,n=L(()=>l.refreshing?"pi pi-refresh pi-spin":"pi pi-refresh");return(s,r)=>{const c=q;return a(),U(c,{icon:f(n),rounded:"",text:"",disabled:t.refreshing},null,8,["icon","disabled"])}}},ks=["src"],bt={__name:"Base64Img",props:{data:String,mimetype:String},setup(t){const l=t,n=L(()=>`data:${l.mimetype};base64, ${l.data}`);return(s,r)=>(a(),_("img",{src:n.value,style:{"max-width":"100%"}},null,8,ks))}},xs={key:2,style:{"background-color":"#f8f9fa",padding:"1rem",color:"red","white-space":"pre-wrap"}},gt={__name:"SessionScreenshot",props:{session:Object},setup(t,{expose:l}){const n=z(),s=t,{data:r,pending:c,error:i,refresh:d}=Ce(`session-screenshot-${s.session.server.id}-${s.session.name}`,async()=>(await pe(1e3),await n.getScreenshot(s.session.server.id,s.session.name)));return l({refresh:d}),(u,m)=>{const b=at,y=rt,k=bt;return a(),_(W,null,[f(c)?(a(),_(W,{key:0},[o(b,{mode:"indeterminate",style:{height:"3px"}}),!f(r)&&!f(i)?(a(),U(y,{key:0,width:"100%",height:"20rem"})):S("",!0)],64)):S("",!0),f(r)?(a(),U(k,{key:1,data:f(r).data,mimetype:f(r).mimetype},null,8,["data","mimetype"])):S("",!0),f(i)?(a(),_("pre",xs,""+B(f(i).cause.response.data.message||f(i).cause.response.data||f(i))+`
  `,1)):S("",!0)],64)}}},Ss={class:"",style:{"min-width":"20rem"}},Cs={class:"flex justify-content-center align-items-center"},Vs=e("h5",{class:"m-0"},"Screenshot",-1),As={class:"m-auto w-full"},Is={__name:"ScreenshotButton",props:["session"],setup(t){const l=t,n=g(null),s=g(null),r=d=>{n.value.toggle(d)},c=()=>{s.value.refresh()},i=L(()=>l.session.status==="STOPPED");return(d,u)=>{const m=q,b=we,y=gt,k=es,x=Y("tooltip");return a(),_(W,null,[N(o(m,{disabled:f(i),type:"button",icon:"pi pi-camera",onClick:r,rounded:"",outlined:"",severity:"help"},null,8,["disabled"]),[[x,"Screenshot / QR",void 0,{top:!0}]]),o(k,{ref_key:"op",ref:n,appendTo:"body",showCloseIcon:!0},{default:p(()=>[e("div",Ss,[e("div",Cs,[Vs,o(b,{onClick:c})]),e("div",As,[o(y,{ref_key:"screenshot",ref:s,session:t.session},null,8,["session"])])])]),_:1},512)],64)}}},Ds={class:"flex flex-row gap-2 justify-content-end"},yt={__name:"SessionActionButtons",props:["name","isStarting","isRestarting","isStopping","isLoggingOut","isRemoving","allDisabled","hideActions","skipConfirmation","group"],emits:["view","start","restart","stop","logout","delete","apps"],setup(t,{emit:l}){const n=tt(),s=t,r=l;function c(x){return s.skipConfirmation?!s.skipConfirmation.includes(x):!0}async function i(){if(!c("start")){r("start");return}n.require({group:s.group,target:event.target,message:`Start ${s.name}?`,icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-success p-button-sm",rejectLabel:"No",acceptLabel:"Yes, Start",accept:()=>{r("start")},reject:()=>{}})}const d=L(()=>s.hideActions?!s.hideActions.includes("view"):!0),u=L(()=>s.hideActions?!s.hideActions.includes("apps"):!0);function m(x){n.require({group:s.group,target:x.target,message:`Restart ${s.name}?`,icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-info p-button-sm",rejectLabel:"No",acceptLabel:"Yes, Restart",accept:()=>{r("restart")},reject:()=>{}})}function b(x){n.require({group:s.group,target:x.target,message:`Stop ${s.name}?`,icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-warning p-button-sm",rejectLabel:"No",acceptLabel:"Yes, Stop",accept:async()=>{r("stop")},reject:()=>{}})}function y(x){n.require({group:s.group,target:x.target,message:`Logout ${s.name}?`,icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-warning p-button-sm",rejectLabel:"No",acceptLabel:"Yes, Logout",accept:async()=>{r("logout")},reject:()=>{}})}function k(x){n.require({group:s.group,target:x.target,message:`Delete ${s.name}?`,icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-danger p-button-sm",rejectLabel:"No",acceptLabel:"Yes, Delete",accept:async()=>{r("delete")},reject:()=>{}})}return(x,h)=>{const I=q,R=Fe,v=os,E=Y("tooltip");return a(),_(W,null,[e("div",Ds,[f(d)?N((a(),U(I,{key:0,icon:"pi pi-cog",severity:"help",rounded:"",outlined:"",onClick:h[0]||(h[0]=D=>x.$emit("view")),disabled:t.allDisabled},null,8,["disabled"])),[[E,"Configuration",void 0,{top:!0}]]):S("",!0),f(u)?N((a(),U(I,{key:1,icon:"pi pi-th-large",severity:"info",rounded:"",outlined:"",onClick:h[1]||(h[1]=D=>x.$emit("apps")),disabled:t.allDisabled},null,8,["disabled"])),[[E,"Apps",void 0,{top:!0}]]):S("",!0),N(o(I,{icon:"pi pi-play",severity:"success",rounded:"",outlined:"",onClick:i,loading:t.isStarting,disabled:t.allDisabled},null,8,["loading","disabled"]),[[E,"Start",void 0,{top:!0}]]),N(o(I,{icon:"pi pi-replay",severity:"info",rounded:"",outlined:"",onClick:h[2]||(h[2]=D=>m(D)),loading:t.isRestarting,disabled:t.allDisabled},null,8,["loading","disabled"]),[[E,"Restart",void 0,{top:!0}]]),N(o(I,{icon:"pi pi-stop",severity:"secondary",rounded:"",outlined:"",onClick:h[3]||(h[3]=D=>b(D)),loading:t.isStopping,disabled:t.allDisabled},null,8,["loading","disabled"]),[[E,"Stop",void 0,{top:!0}]]),N(o(I,{icon:"pi pi-sign-out",severity:"warning",rounded:"",outlined:"",onClick:h[4]||(h[4]=D=>y(D)),loading:t.isLoggingOut,disabled:t.allDisabled},null,8,["loading","disabled"]),[[E,"Logout",void 0,{top:!0}]]),N(o(I,{icon:"pi pi-trash",severity:"danger",rounded:"",outlined:"",onClick:h[5]||(h[5]=D=>k(D)),loading:t.isRemoving,disabled:t.allDisabled},null,8,["loading","disabled"]),[[E,"Delete",void 0,{top:!0}]])]),t.group==="popup"?(a(),U(R,{key:0,group:"popup"})):S("",!0),t.group==="dialog"?(a(),U(v,{key:1,group:"dialog"})):S("",!0)],64)}}},Rs={class:"flex flex-row gap-2 justify-content-end"},Us={__name:"SessionActions",props:["session","disabled"],emits:["view","apps"],setup(t,{expose:l,emit:n}){const s=t,r=z(),c=fe(),i=g(!1),d=g(!1),u=g(!1),m=g(!1),b=g(!1),y=L(()=>s.disabled||i.value||d.value||u.value||m.value||b.value);async function k(){const v=s.session;m.value=!0,await c(r.startSession(v.server.id,v.name),"Started","Failed to start session",v.name,v.name).finally(()=>m.value=!1)}async function x(){const v=s.session;b.value=!0,await c(r.restartSession(v.server.id,v.name),"Restarted","Failed to restart session",v.name,v.name).finally(()=>b.value=!1)}async function h(){const v=s.session;i.value=!0,await c(r.stopSession(v.server.id,v.name),"Stopped","Failed to stop session",v.name,v.name).finally(()=>i.value=!1)}async function I(){const v=s.session;d.value=!0,await c(r.logoutSession(v.server.id,v.name),"Logged out","Failed to logout session",v.name,v.name).finally(()=>d.value=!1)}async function R(){const v=s.session;u.value=!0,await c(r.deleteSession(v.server.id,v.name),"Deleted","Failed to delete session",v.name,v.name).finally(()=>u.value=!1)}return l({startSession:k,restartSession:x,stopSession:h,logoutSession:I,deleteSession:R}),(v,E)=>{const D=yt;return a(),_("div",Rs,[o(D,{group:"popup",name:`'${t.session.name}' session`,onView:E[0]||(E[0]=C=>v.$emit("view",t.session)),onApps:E[1]||(E[1]=C=>v.$emit("apps",t.session)),onStart:k,onRestart:x,onStop:h,onLogout:I,onDelete:R,"is-starting":f(m),"is-restarting":f(b),"is-stopping":f(i),"is-logging-out":f(d),"is-removing":f(u),"all-disabled":f(y),"hide-actions":[],"skip-confirmation":["start"]},null,8,["name","is-starting","is-restarting","is-stopping","is-logging-out","is-removing","all-disabled"])])}}},Ts={class:"p-dialog-title flex gap-2 align-items-center"},Es=e("i",{class:"pi pi-whatsapp"},null,-1),Ls=e("span",null,"(",-1),Ns={class:"ml-1"},Os=e("span",null,")",-1),Ms=["disabled"],Ps=e("i",{class:"pi pi-refresh"},null,-1),js=[Ps],ke={__name:"SessionHeader",props:{session:Object,refresh:Boolean},setup(t){const l=t,n=z(),{refreshing:s}=He(n),r=L(()=>l.session.server.id?l.session.server:n.getServer(l.session.server));async function c(){await n.refresh()}return(i,d)=>{var k,x;const u=ut,m=ns,b=et,y=Y("tooltip");return a(),_("div",Ts,[Es,e("span",null,B((k=t.session)==null?void 0:k.name),1),o(u,{status:t.session.status,value:(x=t.session.status)==null?void 0:x.toUpperCase()},null,8,["status","value"]),e("div",null,[Ls,o(m,{connected:r.value.connected},null,8,["connected"]),e("span",Ns,B(r.value.name),1),Os]),t.refresh?N((a(),_("button",{key:0,onClick:d[0]||(d[0]=h=>c()),class:"p-link layout-topbar-button",disabled:f(s)},js,8,Ms)),[[y,"Refresh",void 0,{top:!0}]]):S("",!0),o(b,{refreshing:f(s)},null,8,["refreshing"])])}}},Bs=e("b",null,"Chats UI",-1),Ws=e("br",null,null,-1),qs=e("b",null,"Live Chat",-1),Hs=e("b",null,"Multiple Agents",-1),Fs=e("a",{href:"https://waha.devlike.pro/",target:"_blank"},[e("b",null," WAHA API ")],-1),Ks=e("br",null,null,-1),zs=e("ul",null,[e("li",null,[e("a",{href:"https://waha.devlike.pro/docs/how-to/chats/",target:"_blank"},[e("b",null,"Chats API")]),T(" to get chats overview and messages ")]),e("li",null,[e("a",{href:"https://waha.devlike.pro/docs/how-to/send-messages/",target:"_blank"},[e("b",null,"Send API")]),T(" to send messages to chats ")]),e("li",null,[e("a",{href:"https://waha.devlike.pro/docs/how-to/webhooks/#messageack",target:"_blank"},[e("b",null,"Message ACK")]),T(" to get message status ")]),e("li",null,[e("a",{href:"https://waha.devlike.pro/docs/how-to/webhooks/#websockets",target:"_blank"},[e("b",null,"Websockets")]),T(" to get real-time messages on client side ")])],-1),Ys=e("a",{href:"https://github.com/devlikeapro/waha-hub/tree/main/ui/components/chat",target:"_blank"},[e("b",null,"Source Code on Github")],-1),Gs=e("a",{href:"https://waha.devlike.pro/pricing/#tier-pro",target:"_blank"}," WAHA PRO ",-1),Qs={__name:"ChatPromo",emits:["close"],setup(t,{emit:l}){const n=l;return(s,r)=>{const c=ls;return a(),U(c,{onClose:r[0]||(r[0]=i=>n("close"))},{default:p(()=>[T(" It's an example "),Bs,T("."),Ws,T(" You can implement "),qs,T(", "),Hs,T(", and more features using "),Fs,T(" :"),Ks,zs,T(" ðŸ‘‰ "),Ys,T(" (Vue3 + PrimeVue) available for "),Gs,T(" supporters! ")]),_:1})}}},Xs={class:"flex"},$t={__name:"MessageAck",props:{ack:Number},setup(t){const l=t,n={ERROR:-1,PENDING:0,SERVER:1,DEVICE:2,READ:3,PLAYED:4},s=L(()=>{switch(l.ack){case n.ERROR:return"pi-exclamation-circle";case n.PENDING:return"pi-clock";case n.SERVER:return"pi-check";case n.DEVICE:return"pi-check";case n.READ:return"pi-check";case n.PLAYED:return"pi-microphone"}}),r=L(()=>{switch(l.ack){case n.ERROR:return"color: red";case n.PENDING:return"color: blue";case n.SERVER:return"";case n.DEVICE:return"";case n.READ:return"color: blue";case n.PLAYED:return"color: blue"}});return(c,i)=>(a(),_("div",Xs,[e("i",{class:te(["pi",f(s)]),style:Je(f(r))},null,6),t.ack===n.READ||t.ack===n.DEVICE?(a(),_("i",{key:0,class:te(["pi",f(s)]),style:Je([f(r),{"margin-left":"-0.7rem"}])},null,6)):S("",!0)]))}},Js={class:"p-2"},Zs=["innerHTML"],eo={class:"flex flex-column justify-content-end",style:{height:"100%"}},to={__name:"ChatMessage",props:{message:Object},setup(t){return(l,n)=>{const s=it;return a(),U(s,null,{default:p(()=>[e("div",Js,[e("p",{innerHTML:t.message.body.replace(/\n/g,"<br>")},null,8,Zs)]),e("div",eo,[o($t,{ack:t.message.ack,class:"pb-2"},null,8,["ack"])])]),_:1})}}},so={class:"flex flex-column gap-2"},oo={__name:"ChatMessages",props:{messages:Array},setup(t){const l=t,n=g(null);async function s(){await pe(10),n.value&&(n.value.scrollTop=n.value.scrollHeight)}return se(()=>l.messages,s),(r,c)=>{const i=to;return a(),_("div",{class:"my-2 pb-3",style:{width:"100%",height:"100%",overflow:"auto"},ref_key:"scroll",ref:n},[e("div",so,[(a(!0),_(W,null,be(t.messages,d=>(a(),_(W,null,[d.body?(a(),_("div",{key:0,class:te({"flex justify-content-end":d.fromMe})},[(a(),U(i,{key:d.key,message:d},null,8,["message"]))],2)):S("",!0)],64))),256))])],512)}}},no={class:"flex justify-content-between gap-2 my-2"},lo={class:"flex gap-2 align-items-center"},io={__name:"ChatHeader",props:{chat:Object,me:Object,mePicture:Object,fetching:Boolean,fetch:Function},setup(t){return(l,n)=>{var r;const s=we;return a(),_("div",no,[e("div",lo,[o(Se,{id:t.chat.name||t.chat.id,image:t.chat.picture},null,8,["id","image"])]),o(s,{onClick:t.fetch,refreshing:t.fetching},null,8,["onClick","refreshing"]),o(Se,{id:(r=t.me)==null?void 0:r.pushName,image:t.mePicture},null,8,["id","image"])])}}},ao={class:"flex gap-1 mt-1"},Ze=60,ro={__name:"ChatPreview",props:{id:String,name:String,picture:String,message:Object},setup(t){const l=t,n=L(()=>{var r,c,i;return((r=l.message)==null?void 0:r.body)?((i=(c=l.message)==null?void 0:c.body)==null?void 0:i.length)>Ze?l.message.body.slice(0,Ze)+"...":l.message.body:""});return(s,r)=>(a(),_(W,null,[o(Se,{id:l.name||l.id,image:l.picture},null,8,["id","image"]),e("div",ao,[f(n)?(a(),U($t,{key:0,ack:t.message.ack,class:"pb-2"},null,8,["ack"])):S("",!0),T(" "+B(f(n)),1)])],64))}},uo={class:"flex justify-content-center align-items-center gap-1"},co=e("div",null," Last 20 Chats ",-1),po={__name:"ChatList",props:{chats:Array,pending:Boolean},emits:["clickOnChat","refreshChats"],setup(t,{emit:l}){const n=l;return(s,r)=>{const c=we,i=ro,d=De,u=Re;return a(),U(u,{value:t.chats,loading:t.pending,class:"p-datatable--clickable",onRowClick:r[1]||(r[1]=m=>n("clickOnChat",m.data)),scrollable:"",scrollHeight:"100%",rowHover:!0},{default:p(()=>[o(d,null,{header:p(()=>[e("div",uo,[co,o(c,{onClick:r[0]||(r[0]=m=>n("refreshChats")),refreshing:t.pending},null,8,["refreshing"])])]),body:p(({data:m})=>[o(i,{id:m.id,name:m.name,picture:m.picture,message:m.lastMessage},null,8,["id","name","picture","message"])]),_:1})]),_:1},8,["value","loading"])}}},mo={class:"flex justify-content-end",style:{width:"100%"}},vo={style:{width:"100%"}},fo={class:"my-auto pl-2"},_o={__name:"ChatInputFooter",props:{disabled:Boolean,sendText:Function},setup(t){const l=t,n=g(!1),s=g("");function r(){n.value=!0,l.sendText(s.value).then(()=>{s.value=""}).finally(()=>{n.value=!1})}return(c,i)=>{const d=dt,u=q;return a(),_("div",mo,[e("div",vo,[o(d,{modelValue:f(s),"onUpdate:modelValue":i[0]||(i[0]=m=>Ve(s)?s.value=m:null),rows:"2",cols:"50",onKeydown:zt(st(r,["ctrl"]),["enter"]),style:{width:"100%"}},null,8,["modelValue","onKeydown"])]),e("div",fo,[o(u,{onClick:r,disabled:t.disabled||!f(s),loading:f(n),label:"",icon:"pi pi-send",class:"p-button-success"},null,8,["disabled","loading"])])])}}},ho={class:"pb-3 flex"},bo={class:"flex align-items-center gap-1"},go={class:"m-auto pb-2"},yo={class:"text-center"},$o=e("b",null,"â„¹ï¸ About Chat UI",-1),wo=[$o],ko={class:"flex flex-column justify-content-between",style:{height:"100%"}},xo=e("hr",null,null,-1),So={__name:"SessionChatDialog",props:{visible:{},visibleModifiers:{},session:{},sessionModifiers:{}},emits:["update:visible","update:session"],setup(t){const l=X(t,"visible"),n=X(t,"session");se(l,()=>{l.value||(u.value=null,m.value=[],E())}),ge();const s=z(),{data:r,pending:c,error:i,refresh:d}=Ce(`session-${n.value.name}-chats`,async()=>await s.getChatsOverview(n.value.server.id,n.value.name,20)),u=g(null),m=g([]),b=g(null);se(u,()=>{u.value&&D()});const y=g(!1),k=g(20),x=g(0);let h=null;const I=g(de.DISCONNECTED);function R(){const P=s.getServer(n.value.server.id),j=["message.any"];h=new Kt(P,j,n.value.name),h.connect(),I.value=de.CONNECTING,h.on("open",()=>{I.value=de.CONNECTED}),h.on("close",()=>{I.value=de.DISCONNECTED}),h.on("error",()=>{I.value=de.ERROR}),h.on("event",v)}async function v(P){var V;await pe(100);const j=(V=u.value)==null?void 0:V.id;j&&((P.payload.from===j||P.payload.to===j)&&D(),d())}function E(){h==null||h.stop(),h=null,I.value=de.DISCONNECTED}function D(){y.value=!0,s.getChatsMessages(n.value.server.id,n.value.name,u.value.id,k.value,x.value,!1).then(P=>{m.value=P.reverse()}).finally(()=>{y.value=!1})}se(n,()=>{var P,j;(j=(P=n.value)==null?void 0:P.me)!=null&&j.id&&(E(),R(),d(),s.getProfilePicture(n.value.server.id,n.value.name,n.value.me.id).then(V=>{b.value=V.profilePictureURL}))});function C(P){u.value=P}function F(P){return s.sendText(n.value.server.id,n.value.name,u.value.id,P).then(()=>{pe(100)})}const K=g(!1);return(P,j)=>{const V=ke,w=Ye,G=Qs,J=is,Q=as,ie=_e;return a(),U(ie,{visible:l.value,"onUpdate:visible":j[2]||(j[2]=H=>l.value=H),modal:!0,maximizable:"",style:{width:"90%",height:"90%"}},{header:p(()=>[e("div",null,[o(V,{session:n.value},null,8,["session"])])]),default:p(()=>[e("div",ho,[e("div",bo,[n.value.me?(a(),U(w,{key:0,session:n.value,image:b.value},null,8,["session","image"])):S("",!0),o(ts,{status:I.value},null,8,["status"])]),e("div",go,[e("div",yo,[e("a",{href:"#",onClick:j[0]||(j[0]=H=>K.value=!0)},wo)]),K.value?(a(),U(G,{key:0,style:{"max-width":"50em"},onClose:j[1]||(j[1]=H=>K.value=!1)})):S("",!0)])]),o(Q,{style:{"max-height":"90%"}},{default:p(()=>[o(J,{size:30,class:"flex items-center justify-center"},{default:p(()=>[o(po,{chats:f(r),loading:f(c),onClickOnChat:C,onRefreshChats:f(d)},null,8,["chats","loading","onRefreshChats"])]),_:1}),o(J,{size:70,class:"flex flex-column gap-2 justify-content-between p-2"},{default:p(()=>[e("div",ko,[u.value?(a(),_(W,{key:0},[o(io,{chat:u.value,me:n.value.me,mePicture:b.value,fetch:D,fetching:y.value},null,8,["chat","me","mePicture","fetching"]),xo,o(oo,{messages:m.value},null,8,["messages"]),o(_o,{disabled:!u.value||y.value,sendText:F},null,8,["disabled"])],64)):S("",!0)])]),_:1})]),_:1})]),_:1},8,["visible"])}}},Co={class:"-mt-4 p-0 line-height-3 block",style:{"font-family":"monaco, Consolas, 'Lucida Console', monospace"}},Vo={__name:"CodeHighlight",props:["invalid"],setup(t){const l=t,n=L(()=>l.invalid?"p-invalid p-component p-inputtext":"");return(s,r)=>(a(),_("pre",{class:te(["border-round surface-ground text-900 p-5 overflow-auto",n.value])},[T("        "),e("code",Co,[Yt(s.$slots,"default")])],2))}},Ge=t=>(me("data-v-aa1b18ec"),t=t(),ve(),t),Ao={class:"h-full flex flex-column"},Io={class:"flex justify-content-center align-items-center"},Do=Ge(()=>e("h5",{class:"m-0"},"Request",-1)),Ro={class:"flex flex-column justify-content-between h-full"},Uo={class:"flex flex-column gap-2"},To={class:"flex gap-2"},Eo={class:"text-center"},Lo=Ge(()=>e("div",{class:"mb-2"},"Body",-1)),No={class:"text-center mt-2"},Oo={class:"flex flex-column h-full"},Mo={class:"flex justify-content-center align-items-center"},Po=Ge(()=>e("h5",{class:"m-0"},"Response",-1)),jo={__name:"SessionRequestResponse",props:["session"],setup(t){const l=z(),n=t,s=g(null),r=g("POST"),c=g("/api/sendText"),i=g(""),d=g(!1),u=g(!1);function m(R){return JSON.stringify(R,null,2)}function b(R){try{return JSON.parse(R)}catch{return R}}const y=L(()=>({method:r.value,uri:c.value,params:void 0,body:b(i.value)})),k=["GET","POST","PUT","DELETE","PATCH"];async function x(R){await navigator.clipboard.writeText(s.value),R.preventDefault()}async function h(R){await navigator.clipboard.writeText(m(y.value)),R.preventDefault()}async function I(){try{u.value=!1,d.value=!0;const R=await l.callServerAPI(n.session.server.id,y.value);s.value=m(R)}catch(R){u.value=!0,R.response?s.value=m(R.response.data):s.value=m(R)}finally{d.value=!1}}return Ae(()=>{const R={chatId:"11111111111@c.us",text:"Hi there!",session:n.session.name};i.value=m(R),s.value="..."}),(R,v)=>{const E=q,D=$e,C=ne,F=dt,K=pt,P=Vo,j=Y("tooltip");return a(),_(W,null,[e("div",null,[e("div",Ao,[e("div",Io,[Do,N(o(E,{rounded:"",text:"",tabindex:0,icon:"pi pi-copy",onClick:v[0]||(v[0]=V=>h(V))},null,512),[[j,{value:"Copied to clipboard"},void 0,{focus:!0,bottom:!0}]])]),e("div",Ro,[e("div",Uo,[e("div",To,[o(D,{modelValue:r.value,"onUpdate:modelValue":v[1]||(v[1]=V=>r.value=V),options:k},null,8,["modelValue"]),o(C,{type:"text",class:"w-full",modelValue:c.value,"onUpdate:modelValue":v[2]||(v[2]=V=>c.value=V),placeholder:"API Endpoint"},null,8,["modelValue"])]),e("div",Eo,[Lo,o(F,{modelValue:i.value,"onUpdate:modelValue":v[3]||(v[3]=V=>i.value=V),rows:"8",class:"w-full",placeholder:"Request"},null,8,["modelValue"])])]),e("div",No,[o(E,{onClick:I,loading:d.value,label:"Send",icon:"pi pi-send","icon-pos":"right"},null,8,["loading"])])])])]),o(K),e("div",null,[e("div",Oo,[e("div",Mo,[Po,N(o(E,{rounded:"",text:"",tabindex:0,icon:"pi pi-copy",onClick:v[4]||(v[4]=V=>x(V))},null,512),[[j,{value:"Copied to clipboard"},void 0,{focus:!0,bottom:!0}]])]),o(P,{class:"m-0 p-4 pretty",invalid:u.value},{default:p(()=>[T(B(s.value),1)]),_:1},8,["invalid"])])])],64)}}},Bo=oe(jo,[["__scopeId","data-v-aa1b18ec"]]),Wo={class:"grid pt-4"},qo={class:"col-12 sm:col-6 h-full"},Ho={class:"grid"},Fo={class:"col-12"},Ko={class:""},zo={class:"flex justify-content-center align-items-center"},Yo={class:"col-12"},Go={class:""},Qo={class:"flex justify-content-center align-items-center"},Xo=e("h5",{class:"m-0"},"Screenshot",-1),Jo={class:"m-auto w-full"},Zo={class:"col-12 sm:col-6 h-full card"},en={__name:"SessionControl",props:["session"],setup(t){const l=g(null),n=()=>{l.value.refresh()};return(s,r)=>{const c=Ye,i=we,d=gt,u=Bo;return a(),_("div",Wo,[e("div",qo,[e("div",Ho,[e("div",Fo,[e("div",Ko,[e("div",zo,[t.session.me?(a(),U(c,{key:0,session:t.session},null,8,["session"])):S("",!0)])])]),e("div",Yo,[e("div",Go,[e("div",Qo,[Xo,o(i,{onClick:n})]),e("div",Jo,[o(d,{ref_key:"screenshot",ref:l,session:t.session},null,8,["session"])])])])])]),e("div",Zo,[o(u,{session:t.session},null,8,["session"])])])}}},tn={__name:"SessionControlDialog",props:{visible:{},visibleModifiers:{},session:{},sessionModifiers:{}},emits:["update:visible","update:session"],setup(t){const l=X(t,"visible"),n=X(t,"session");return ge(),(s,r)=>{const c=ke,i=en,d=_e;return a(),U(d,{visible:l.value,"onUpdate:visible":r[0]||(r[0]=u=>l.value=u),modal:!0,maximizable:""},{header:p(()=>[o(c,{session:n.value},null,8,["session"])]),default:p(()=>[o(i,{session:n.value},null,8,["session"])]),_:1},8,["visible"])}}},sn={class:"card p-fluid"},on={class:"flex flex-grow-1 justify-content-center"},nn={class:"flex flex-grow-1 justify-content-center"},wt={__name:"KeyValueTable",props:ye(["keyColumn","keyColumnName","prefix","entityName"],{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const l=X(t,"modelValue"),n=t,s=g([]),r=u=>{let{newData:m,index:b}=u;l.value[b]=m},c=u=>{let{data:m,newValue:b,field:y}=u;m[y]=b};function i(){const u=l.value.length+1,m=`${n.prefix}${u}`;l.value.unshift({[n.keyColumn]:m,value:"123"})}function d(u){l.value.splice(u,1)}return(u,m)=>{const b=ne,y=De,k=q,x=Re,h=Y("tooltip");return a(),_("div",sn,[o(x,{editingRows:s.value,"onUpdate:editingRows":m[0]||(m[0]=I=>s.value=I),value:l.value,editMode:"cell",dataKey:n.keyColumn,onRowEditSave:r,onCellEditComplete:c,pt:{table:{style:"min-width: 50rem"},column:{bodycell:({state:I})=>({style:I.d_editing&&"padding-top: 0.6rem; padding-bottom: 0.6rem"})}},resizableColumns:""},{default:p(()=>[o(y,{field:n.keyColumn,header:n.keyColumnName,style:{width:"40%"}},{editor:p(({data:I,field:R})=>[o(b,{modelValue:I[R],"onUpdate:modelValue":v=>I[R]=v},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["field","header"]),o(y,{style:{width:"40%"},field:"value",header:"Value"},{editor:p(({data:I,field:R})=>[o(b,{modelValue:I[R],"onUpdate:modelValue":v=>I[R]=v},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),o(y,{style:{"min-width":"1rem"}},{header:p(()=>[e("div",on,[N(o(k,{label:t.entityName,text:"",icon:"pi pi-plus",severity:"success",onClick:i},null,8,["label"]),[[h,`Add ${t.entityName}`,void 0,{top:!0}]])])]),body:p(({index:I})=>[e("div",nn,[N(o(k,{label:"",rounded:"",text:"",style:{height:"2rem",width:"2rem"},icon:"pi pi-trash",severity:"warning",onClick:R=>d(I)},null,8,["onClick"]),[[h,"Delete",void 0,{top:!0}]])])]),_:1})]),_:1},8,["editingRows","value","dataKey","pt"])])}}},ln={class:"flex justify-content-between align-items-center w-full"},an={class:"field"},rn=e("label",{for:"url"},"URL",-1),un={class:"field mb-4"},cn=e("label",{for:"events"},"Events",-1),dn=e("div",{class:"font-bold mb-2"},"Retries",-1),pn={class:"flex gap-3"},mn={class:"field",style:{width:"10em"}},vn=e("label",{for:"retries-attempts"},"Attempts",-1),fn=e("span",{class:"pi pi-plus"},null,-1),_n=e("span",{class:"pi pi-minus"},null,-1),hn={class:"field",style:{width:"10em"}},bn=e("label",{for:"retries-delay-seconds"},"Delay, seconds",-1),gn=e("span",{class:"pi pi-plus"},null,-1),yn=e("span",{class:"pi pi-minus"},null,-1),$n={class:"field"},wn={for:"retries-delay-policy"},kn={class:"pi pi-info-circle"},xn={style:{"text-transform":"capitalize"}},Sn={style:{"text-transform":"capitalize"}},Cn={class:"field"},Vn=e("label",{for:"hmac"},"HMAC Key (optional)",-1),An={class:"field"},In={class:"field flex justify-content-between align-items-center"},Dn=e("div",null,[e("label",{for:"hmac"},"Custom Headers (optional)")],-1),Rn={__name:"SessionWebhook",props:ye({disabled:Boolean,index:Number},{webhook:{},webhookModifiers:{}}),emits:["update:webhook"],setup(t){const l=X(t,"webhook"),n=t,s=["constant","linear","exponential"],r=L(()=>{var k;const d=((k=l.value.retries)==null?void 0:k.delaySeconds)??2,u=4,m=Array.from({length:u},(x,h)=>d),b=Array.from({length:u},(x,h)=>d*(h+1)),y=Array.from({length:u},(x,h)=>d*2**h);return[`Constant: ${m.join(", ")}`,`Linear: ${b.join(", ")}`,`Exponential: ${y.join(", ")}`].join(`
`)}),c=ss,i=g(l.value.customHeaders&&l.value.customHeaders.length>0);return se(i,(d,u)=>{if(u&&!d){l.value.customHeaders=null;return}!u&&d&&(l.value.customHeaders=[{name:"X-Header-1",value:"123"}])}),(d,u)=>{const m=q,b=ne,y=lt,k=ft,x=$e,h=ot("font-awesome-icon"),I=vt,R=wt,v=Ke,E=ze,D=Y("tooltip");return a(),U(E,{activeIndex:0},{default:p(()=>[o(v,null,{header:p(()=>[e("div",ln,[e("div",null," Webhook "+B(n.index+1),1),e("div",null,[N(o(m,{label:"",text:"",rounded:"",style:{height:"2rem",width:"2rem"},icon:"pi pi-trash",severity:"warning",onClick:u[0]||(u[0]=C=>d.$emit("remove"))},null,512),[[D,"Delete Webhook",void 0,{top:!0}]])])])]),default:p(()=>[e("div",an,[rn,o(b,{id:"url",modelValue:l.value.url,"onUpdate:modelValue":u[1]||(u[1]=C=>l.value.url=C),modelModifiers:{trim:!0},required:"true",disabled:t.disabled},null,8,["modelValue","disabled"])]),e("div",un,[cn,o(y,{id:"events",modelValue:l.value.events,"onUpdate:modelValue":u[2]||(u[2]=C=>l.value.events=C),options:f(c),placeholder:"Select Events","max-selected-labels":1,selectedItemsLabel:"{0} events selected",disabled:t.disabled},null,8,["modelValue","options","disabled"]),e("ul",null,[(a(!0),_(W,null,be(l.value.events,C=>(a(),_("li",{key:C},B(C),1))),128))])]),e("div",null,[dn,e("div",pn,[e("div",mn,[vn,o(k,{modelValue:l.value.retries.attempts,"onUpdate:modelValue":u[3]||(u[3]=C=>l.value.retries.attempts=C),inputId:"retries-delay-attempts",showButtons:"",buttonLayout:"horizontal",min:1,step:1,disabled:t.disabled},{incrementbuttonicon:p(()=>[fn]),decrementbuttonicon:p(()=>[_n]),_:1},8,["modelValue","disabled"])]),e("div",hn,[bn,o(k,{modelValue:l.value.retries.delaySeconds,"onUpdate:modelValue":u[4]||(u[4]=C=>l.value.retries.delaySeconds=C),inputId:"retries-delay-seconds",showButtons:"",buttonLayout:"horizontal",min:1,step:1,disabled:t.disabled},{incrementbuttonicon:p(()=>[gn]),decrementbuttonicon:p(()=>[yn]),_:1},8,["modelValue","disabled"])]),e("div",$n,[e("label",wn,[T(" Retry Policy "),N(e("i",kn,null,512),[[D,f(r)]])]),o(x,{id:"retries-delay-policy",modelValue:l.value.retries.policy,"onUpdate:modelValue":u[5]||(u[5]=C=>l.value.retries.policy=C),options:s,placeholder:"Select Retry Policy","max-selected-labels":1,disabled:t.disabled},{option:p(C=>[e("span",xn,B(C.option),1)]),value:p(C=>[e("span",Sn,B(C.value),1)]),_:1},8,["modelValue","disabled"])])])]),e("div",Cn,[Vn,o(b,{id:"hmac",modelValue:l.value.hmac.key,"onUpdate:modelValue":u[6]||(u[6]=C=>l.value.hmac.key=C),modelModifiers:{trim:!0},disabled:t.disabled},null,8,["modelValue","disabled"])]),e("div",An,[e("div",In,[Dn,o(I,{modelValue:i.value,"onUpdate:modelValue":u[7]||(u[7]=C=>i.value=C),id:"customHeaders",onLabel:"Headers On",offLabel:"Headers Off"},{icon:p(()=>[o(h,{icon:"fa-solid fa-fingerprint",class:"mr-2"})]),_:1},8,["modelValue"])]),i.value?(a(),U(R,{key:0,modelValue:l.value.customHeaders,"onUpdate:modelValue":u[8]||(u[8]=C=>l.value.customHeaders=C),"entity-name":"Header","key-column":"name","key-column-name":"Header",prefix:"X-Header-"},null,8,["modelValue"])):S("",!0)])]),_:1})]),_:1})}}},Un={class:"flex flex-column gap-2"},Tn={class:"flex justify-content-between align-items-center w-full"},En=e("h5",null,"ðŸ”„ Webhooks",-1),Ln={class:"pr-2"},Nn={key:0,class:"text-300 text-center"},On={__name:"SessionWebhooksField",props:ye({disabled:Boolean},{webhooks:{},webhooksModifiers:{}}),emits:["update:webhooks"],setup(t){const l=X(t,"webhooks");function n(){const r={url:"https://httpbin.org/post",events:["session.status","message"],hmac:{key:null},retries:{delaySeconds:2,attempts:15,policy:"exponential"},customHeaders:null};l.value.push(r)}function s(r){l.value.splice(r,1)}return(r,c)=>{const i=q,d=Rn,u=Y("tooltip");return a(),_("div",Un,[e("div",Tn,[En,e("div",Ln,[N(o(i,{label:"Webhook",text:"",icon:"pi pi-plus",severity:"success",onClick:n},null,512),[[u,"Add Webhook",void 0,{top:!0}]])])]),l.value.length===0?(a(),_("div",Nn," No webhooks configured ")):(a(!0),_(W,{key:1},be(l.value,(m,b)=>(a(),U(d,{webhook:l.value[b],"onUpdate:webhook":y=>l.value[b]=y,index:b,total:l.value.length,onRemove:y=>s(b),disabled:t.disabled},null,8,["webhook","onUpdate:webhook","index","total","onRemove","disabled"]))),256))])}}},Mn=e("div",null,[e("h5",null,[e("i",{class:"pi pi-whatsapp"}),T(" Create Session ")])],-1),Pn={class:"mb-2"},jn=e("b",null,"Server",-1),Bn=e("b",null,"Name",-1),Wn={class:"field"},qn=e("label",{for:"server"},"Server",-1),Hn={key:0,class:"p-invalid"},Fn={class:"field"},Kn=e("label",{for:"name"},"Name (optional)",-1),zn={key:0,class:"mb-4"},Yn=e("div",{class:"mb-3"},[e("h5",null,"ðŸ­ Engine Settings ")],-1),Gn={class:"flex flex-column gap-2"},Qn=e("div",null,[e("a",{href:"https://waha.devlike.pro/docs/engines/noweb",target:"_blank"},"Read more about NOWEB settings")],-1),Xn={class:"flex gap-2"},Jn={class:"pi pi-info-circle"},Zn={class:"field mt-4"},el={class:"field flex justify-content-between align-items-center"},tl=e("div",null,[e("h5",null,[e("label",{for:"proxy"},"ðŸŒ Proxy")])],-1),sl={key:0,class:"card mb-4"},ol={class:"field"},nl=e("label",{for:"proxy-server"},"Server",-1),ll={key:0,class:"p-invalid"},il={class:"flex gap-3"},al={class:"field w-full"},rl=e("label",{for:"proxy-username"},"Username (optional)",-1),ul={class:"field w-full"},cl=e("label",{for:"proxy-password"},"Password (optional)",-1),dl={class:"field flex justify-content-between align-items-center"},pl=e("div",null,[e("h5",null,[e("label",{for:"debug"},"ðŸ› ï¸ Debug")])],-1),ml={class:"w-full flex flex-column gap-2"},vl={class:"flex justify-content-end"},fl={__name:"SessionDialog",props:ye({mode:String},{visible:{},visibleModifiers:{},session:{},sessionModifiers:{}}),emits:["update:visible","update:session"],setup(t){var P,j;const l=ge(),n=X(t,"visible"),s=X(t,"session"),r=t,c=L(()=>r.mode==="new"),i=L(()=>r.mode==="update"),d=L(()=>i.value),u=fe(),m=z(),b=L(()=>m.getServer(s.value.server)),y=L(()=>{var V,w;return((w=(V=b.value)==null?void 0:V.version)==null?void 0:w.engine)==="NOWEB"});L(()=>{var V,w;return((w=(V=b.value)==null?void 0:V.version)==null?void 0:w.engine)==="WEBJS"});const k=g([]),x=g(!!((j=(P=s.value.config)==null?void 0:P.proxy)!=null&&j.server));se(s,async(V,w)=>{var G,J,Q;x.value=(J=(G=V==null?void 0:V.config)==null?void 0:G.proxy)==null?void 0:J.server,k.value=cs((Q=V.config)==null?void 0:Q.metadata)});const h=g(!1),I=g(!1),R=L(()=>{const V=le.cloneDeep(s.value.config);return x.value||(V.proxy=void 0),V.metadata=ds(k.value),V}),v=L(()=>{const V={...R.value};return y.value||delete V.noweb,{name:s.value.name,config:V}});async function E(){h.value=!0;try{I.value=!0;const V=le.cloneDeep(v.value);await u(m.updateSession(s.value.server,s.value.name,V.config),void 0,"Failed to update session"),l.add({severity:"success",summary:"Updated",detail:s.value.name,life:3e3})}finally{I.value=!1}s.value=void 0,C()}async function D(V){h.value=!0;try{I.value=!0;const w=le.cloneDeep(v.value);w.start=V;const G=await u(m.createSession(s.value.server,w),void 0,"Failed to start session"),J=V?"Started":"Created";l.add({severity:"success",summary:J,detail:G.name,life:3e3})}finally{I.value=!1}s.value=void 0,C()}function C(){h.value=!1,n.value=!1}const F=L(()=>s.value.status==="STOPPED");async function K(V){await navigator.clipboard.writeText(JSON.stringify({method:"POST",uri:"/api/sessions",body:v.value},null,2)),V.preventDefault()}return(V,w)=>{const G=ke,J=mt,Q=ct,ie=ne,H=ot("font-awesome-icon"),ae=vt,Le=Ke,Ne=ze,Oe=wt,Me=On,Pe=_t,ce=q,je=_e,re=Y("tooltip");return a(),U(je,{visible:n.value,"onUpdate:visible":w[15]||(w[15]=M=>n.value=M),modal:!0,class:"p-fluid",maximizable:""},Gt({footer:p(()=>[e("div",ml,[e("div",null,[i.value&&!F.value?(a(),U(J,{key:0,severity:"warn"},{default:p(()=>[T(" The session is in '"),e("b",null,B(s.value.status)+"'",1),T(" status, in order to save configuration the session will be restarted. ")]),_:1})):S("",!0)]),e("div",vl,[N(o(ce,{label:"Copy",text:"",tabindex:0,icon:"pi pi-copy",severity:"secondary",onClick:w[12]||(w[12]=M=>K(M))},null,512),[[re,{value:"Copied to clipboard"},void 0,{focus:!0,bottom:!0}]]),i.value?S("",!0):(a(),U(ce,{key:0,label:"Create",icon:"pi pi-plus",text:"",onClick:w[13]||(w[13]=M=>D(!1)),loading:I.value},null,8,["loading"])),i.value?S("",!0):(a(),U(ce,{key:1,label:"Create & Start",icon:"pi pi-play",text:"",onClick:w[14]||(w[14]=M=>D(!0)),loading:I.value},null,8,["loading"])),i.value?(a(),U(ce,{key:2,label:"Update",icon:"pi pi-save",text:"",onClick:E,loading:I.value},null,8,["loading"])):S("",!0)])])]),default:p(()=>[e("div",Pn,[i.value?(a(),U(J,{key:0,severity:"info"},{default:p(()=>[T(" To change the "),jn,T(" or "),Bn,T(" - please remove the session and run again. ")]),_:1})):S("",!0)]),e("div",Wn,[qn,o(Q,{placeholder:"Select Server",modelValue:s.value.server,"onUpdate:modelValue":w[0]||(w[0]=M=>s.value.server=M),showClear:!1,required:!0,invalid:h.value&&!s.value.server,disabled:d.value},null,8,["modelValue","invalid","disabled"]),h.value&&!s.value.server?(a(),_("small",Hn,"Server is required.")):S("",!0)]),e("div",Fn,[Kn,o(ie,{id:"name",modelValue:s.value.name,"onUpdate:modelValue":w[1]||(w[1]=M=>s.value.name=M),modelModifiers:{trim:!0},required:"false",autofocus:"",placeholder:"session_1111111111111",disabled:!c.value},null,8,["modelValue","disabled"])]),y.value?(a(),_("div",zn,[Yn,o(Ne,{activeIndex:0},{default:p(()=>[o(Le,{header:"NOWEB"},{default:p(()=>[e("div",Gn,[Qn,e("div",null,[N((a(),U(ae,{modelValue:s.value.config.noweb.markOnline,"onUpdate:modelValue":w[2]||(w[2]=M=>s.value.config.noweb.markOnline=M),onLabel:"Presence: online",offLabel:"Presence: offline"},{icon:p(()=>[o(H,{icon:"fa-solid fa-sync",class:"mr-2"})]),_:1},8,["modelValue"])),[[re,"Send presence when connect for the connected session. If presence online - you don not get notifications in your phone"]])]),e("div",Xn,[e("div",null,[N((a(),U(ae,{modelValue:s.value.config.noweb.store.enabled,"onUpdate:modelValue":w[3]||(w[3]=M=>s.value.config.noweb.store.enabled=M),onLabel:"Store: Enabled",offLabel:"Store: Disabled"},{icon:p(()=>[o(H,{icon:"fa-solid fa-folder",class:"mr-2"})]),_:1},8,["modelValue"])),[[re,"Store contacts, chats, messages in the database, so you can get it in API"]])]),e("div",null,[N((a(),U(ae,{modelValue:s.value.config.noweb.store.fullSync,"onUpdate:modelValue":w[4]||(w[4]=M=>s.value.config.noweb.store.fullSync=M),onLabel:"Store: Full Sync On",offLabel:"Store: Full Sync Off"},{icon:p(()=>[o(H,{icon:"fa-solid fa-sync",class:"mr-2"})]),_:1},8,["modelValue"])),[[re,`Sync all contacts, chats, messages from the phone at the start.
Otherwise the store can miss some information.`]])])])])]),_:1})]),_:1})])):S("",!0),e("div",null,[e("div",null,[e("h5",null,[T("ðŸ“ Metadata "),N(e("i",Jn,null,512),[[re,"Key value pairs you can attach to Session and will receive it in webhooks, API and search the values on Dashboard."]])])]),o(Oe,{modelValue:k.value,"onUpdate:modelValue":w[5]||(w[5]=M=>k.value=M),"entity-name":"Metadata","key-column":"key","key-column-name":"Key",prefix:"user.id."},null,8,["modelValue"])]),e("div",Zn,[o(Me,{ref:"webhooks",webhooks:s.value.config.webhooks,"onUpdate:webhooks":w[6]||(w[6]=M=>s.value.config.webhooks=M)},null,8,["webhooks"])]),e("div",null,[e("div",el,[tl,o(ae,{modelValue:x.value,"onUpdate:modelValue":w[7]||(w[7]=M=>x.value=M),id:"proxy",onLabel:"Proxy On",offLabel:"Proxy Off"},{icon:p(()=>[o(H,{icon:"fa-solid fa-server",class:"mr-2"})]),_:1},8,["modelValue"])]),x.value?(a(),_("div",sl,[e("div",ol,[nl,o(ie,{id:"proxy-server",modelValue:s.value.config.proxy.server,"onUpdate:modelValue":w[8]||(w[8]=M=>s.value.config.proxy.server=M),modelModifiers:{trim:!0},required:"true",invalid:h.value&&!s.value.config.proxy.server,placeholder:"host:port"},null,8,["modelValue","invalid"]),h.value&&!s.value.config.proxy.server?(a(),_("small",ll,"Server is required.")):S("",!0)]),e("div",il,[e("div",al,[rl,o(ie,{id:"proxy-username",modelValue:s.value.config.proxy.username,"onUpdate:modelValue":w[9]||(w[9]=M=>s.value.config.proxy.username=M),modelModifiers:{trim:!0}},null,8,["modelValue"])]),e("div",ul,[cl,o(Pe,{id:"proxy-password",modelValue:s.value.config.proxy.password,"onUpdate:modelValue":w[10]||(w[10]=M=>s.value.config.proxy.password=M),modelModifiers:{trim:!0},feedback:!1,toggleMask:""},null,8,["modelValue"])])])])):S("",!0)]),e("div",dl,[pl,o(ae,{modelValue:s.value.config.debug,"onUpdate:modelValue":w[11]||(w[11]=M=>s.value.config.debug=M),onLabel:"Debug Enabled",offLabel:"Debug Disabled",onIcon:"fa fa-bug"},{icon:p(()=>[o(H,{icon:"fa-solid fa-bug",class:"mr-2"})]),_:1},8,["modelValue"])])]),_:2},[c.value?{name:"header",fn:p(()=>[Mn]),key:"0"}:void 0,c.value?void 0:{name:"header",fn:p(()=>[e("div",null,[o(G,{session:s.value},null,8,["session"])])]),key:"1"}]),1032,["visible"])}}},_l=["WORKING","FAILED","STARTING","SCAN_QR_CODE","STOPPED"],hl={class:"",style:{"min-width":"20rem"}},bl={class:"flex justify-content-center align-items-center"},gl=e("h5",{class:"m-0"},"QR",-1),yl={class:"m-auto w-full"},$l={class:"flex justify-content-center"},wl={key:1,style:{"background-color":"#f8f9fa",padding:"1rem",color:"red","white-space":"pre-wrap"}},kl={__name:"QRImage",props:{session:Object},setup(t){const l=z(),n=t,{data:s,pending:r,error:c,refresh:i}=Ce(`session-qr-${n.session.server.id}-${n.session.name}`,async()=>(await pe(1e3),await l.getQR(n.session.server.id,n.session.name)));return(d,u)=>{const m=we,b=at,y=rt,k=bt;return a(),_("div",hl,[e("div",bl,[gl,o(m,{onClick:f(i)},null,8,["onClick"])]),e("div",yl,[f(r)?(a(),_(W,{key:0},[o(b,{mode:"indeterminate",style:{height:"3px"}}),!f(s)&&!f(c)?(a(),U(y,{key:0,width:"100%",height:"20rem"})):S("",!0)],64)):S("",!0),e("div",$l,[f(s)?(a(),U(k,{key:0,data:f(s).data,mimetype:f(s).mimetype},null,8,["data","mimetype"])):S("",!0),f(c)?(a(),_("pre",wl,""+B(f(c).cause.response.data.message||f(c).cause.response.data||f(c))+`
  `,1)):S("",!0)])])])}}},xl={},Sl={class:"pl-4"},Cl=nt('<li> Open <b>WhatsApp</b> on your phone </li><li> Tap <b>More options</b> <i class="pi pi-ellipsis-v"></i> or <b>Settings</b> <i class="pi pi-cog"></i></li><li> Tap <b>Linked Devices</b> &gt; <b>Link a device</b></li><li><b>Link with phone number instead</b> and enter the code </li>',4),Vl=[Cl];function Al(t,l){return a(),_("ul",Sl,Vl)}const Il=oe(xl,[["render",Al]]),Dl={class:"flex flex-column gap-2 mt-4"},Rl={class:"flex justify-content-between gap-2"},Ul={class:"field"},Tl={class:"card flex justify-content-center align-items-center"},El={class:"mx-1",style:{"font-size":"2rem"}},Ll={__name:"PairingCodeSteps",props:["session"],setup(t){const l=t,n=g(null),s=g(!1),r=g("XXXX-XXXX"),c=fe(),i=z();function d(m){return m.replace(/\D/g,"")}async function u(){n.value=d(n.value),s.value=!0;try{await pe(1e3);const m=await c(i.getPairingCode(l.session.server.id,l.session.name,n.value),"Request sent","Failed to request code",l.session.name,l.session.name);r.value=m.code}finally{s.value=!1}}return se(n,le.debounce(m=>{n.value=d(m)},1e3)),(m,b)=>{const y=ne,k=q,x=pt;return a(),_(W,null,[e("div",Dl,[e("form",{onSubmit:st(u,["prevent"])},[e("div",Rl,[e("div",Ul,[o(y,{id:"phone","input-id":"phone",name:"phone",modelValue:f(n),"onUpdate:modelValue":b[0]||(b[0]=h=>Ve(n)?n.value=h:null),modelModifiers:{trim:!0},useGrouping:!1,required:"true",autofocus:"",placeholder:"1213213213 (no +, no dashes -)"},null,8,["modelValue"])]),e("div",null,[o(k,{type:"submit",label:"Show Code",icon:"pi pi-send",loading:f(s)},null,8,["loading"])])])],32)]),f(r)?(a(),_(W,{key:0},[o(x),e("div",null,[o(Il)]),e("div",Tl,[e("div",null,[f(r)?(a(!0),_(W,{key:0},be(f(r),h=>(a(),_("span",El,B(h),1))),256)):S("",!0)])])],64)):S("",!0)],64)}}},Nl={},Ol={class:"pl-4"},Ml=nt('<li> Open <b>WhatsApp</b> on your phone </li><li> Tap <b>More options</b> <i class="pi pi-ellipsis-v"></i> or <b>Settings</b> <i class="pi pi-cog"></i></li><li> Tap <b>Linked Devices</b> and <b>Link a device</b></li><li> Point your phone to this screen to capture <b>QR code</b></li>',4),Pl=[Ml];function jl(t,l){return a(),_("ul",Ol,Pl)}const Bl=oe(Nl,[["render",jl]]),Wl=e("i",{class:"pi pi-qrcode mr-2"},null,-1),ql=e("p",null,[T(" Scan "),e("b",null,"QR Code"),T(" to authorize this session. ")],-1),Hl=e("i",{class:"pi pi-send mr-2"},null,-1),Fl=e("p",{class:"m-0"},[T(" Enter "),e("b",null,"Your Phone number"),T(": ")],-1),Kl={__name:"SessionLoginDialog",props:ye(["session"],{visible:{},visibleModifiers:{}}),emits:["update:visible"],setup(t){const l=X(t,"visible");return(n,s)=>{const r=rs,c=us,i=_e;return a(),U(i,{visible:l.value,"onUpdate:visible":s[0]||(s[0]=d=>l.value=d),modal:!0,class:"p-fluid",maximizable:""},{header:p(()=>[o(ke,{session:t.session},null,8,["session"])]),default:p(()=>[o(c,null,{default:p(()=>[o(r,null,{header:p(()=>[Wl,T(" Scan QR ")]),default:p(()=>[ql,o(Bl),e("div",null,[o(kl,{session:t.session},null,8,["session"])])]),_:1}),o(r,null,{header:p(()=>[Hl,T(" Enter Code ")]),default:p(()=>[Fl,e("div",null,[o(Ll,{session:t.session},null,8,["session"])])]),_:1})]),_:1})]),_:1},8,["visible"])}}},zl={__name:"SessionLogin",props:["session"],setup(t){const l=g(!1);return(n,s)=>{const r=q,c=Y("tooltip");return a(),_(W,null,[N(o(r,{icon:"pi pi-sign-in",severity:"",rounded:"",outlined:"",onClick:s[0]||(s[0]=i=>l.value=!0),disabled:t.session.status!=="SCAN_QR_CODE"},null,8,["disabled"]),[[c,"Login",void 0,{top:!0}]]),o(Kl,{visible:f(l),"onUpdate:visible":s[1]||(s[1]=i=>Ve(l)?l.value=i:null),session:t.session},null,8,["visible","session"])],64)}}},Ue=t=>(me("data-v-730b0920"),t=t(),ve(),t),Yl={class:"chatwoot-config"},Gl={class:"field"},Ql=Ue(()=>e("label",{for:"url"},"ChatWoot URL",-1)),Xl={key:0,class:"p-error"},Jl={class:"grid"},Zl={class:"col-6"},ei={class:"field"},ti=Ue(()=>e("label",{for:"accountId"},"Account ID",-1)),si={key:0,class:"p-error"},oi={class:"col-6"},ni={class:"field"},li=Ue(()=>e("label",{for:"accountToken"},"Account Token",-1)),ii={key:0,class:"p-error"},ai={class:"grid"},ri={class:"col-6"},ui={class:"field"},ci={for:"inboxId"},di={class:"pi pi-info-circle"},pi={key:0,class:"p-error"},mi={class:"col-6"},vi={class:"field"},fi=Ue(()=>e("label",{for:"inboxIdentifier"},"Inbox Identifier",-1)),_i={key:0,class:"p-error"},hi={class:"field"},bi={for:"locale"},gi={class:"pi pi-info-circle"},yi={key:0,class:"p-error"},$i=Ie({__name:"AppConfigChatWoot",props:{modelValue:{type:Object,required:!0},server:{type:Object,required:!0},submitted:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(t,{emit:l}){const n=t,s=l,r=z(),c=fe(),i=L({get:()=>n.modelValue||{url:"",accountId:0,accountToken:"",inboxId:0,inboxIdentifier:"",locale:"en-US"},set:b=>s("update:modelValue",b)}),d=g([]),u=g(!1);Ae(async()=>{await m()});async function m(){if(!(!n.server||!n.server.id))try{u.value=!0,d.value=await c(r.getAppChatWootLocales(n.server.id),void 0,"Failed to load locales")}catch(b){console.error("Error loading locales:",b)}finally{u.value=!1}}return(b,y)=>{const k=ne,x=ft,h=_t,I=$e,R=Y("tooltip");return a(),_("div",Yl,[e("div",Gl,[Ql,o(k,{id:"url",modelValue:i.value.url,"onUpdate:modelValue":y[0]||(y[0]=v=>i.value.url=v),placeholder:"https://app.chatwoot.com",class:te({"p-invalid":t.submitted&&!i.value.url})},null,8,["modelValue","class"]),t.submitted&&!i.value.url?(a(),_("small",Xl,"URL is required.")):S("",!0)]),e("div",Jl,[e("div",Zl,[e("div",ei,[ti,o(x,{id:"accountId",modelValue:i.value.accountId,"onUpdate:modelValue":y[1]||(y[1]=v=>i.value.accountId=v),placeholder:"Your Account ID",class:te({"p-invalid":t.submitted&&!i.value.accountId})},null,8,["modelValue","class"]),t.submitted&&!i.value.accountId?(a(),_("small",si,"Account ID is required.")):S("",!0)])]),e("div",oi,[e("div",ni,[li,o(h,{id:"accountToken",modelValue:i.value.accountToken,"onUpdate:modelValue":y[2]||(y[2]=v=>i.value.accountToken=v),placeholder:"Your account token",feedback:!1,toggleMask:"",class:te({"p-invalid":t.submitted&&!i.value.accountToken})},null,8,["modelValue","class"]),t.submitted&&!i.value.accountToken?(a(),_("small",ii,"Account Token is required.")):S("",!0)])])]),e("div",ai,[e("div",ri,[e("div",ui,[e("label",ci,[T(" Inbox ID "),N(e("i",di,null,512),[[R,"Create and use different inboxes for every WhatsApp phone/session you're using"]])]),o(x,{id:"inboxId",modelValue:i.value.inboxId,"onUpdate:modelValue":y[3]||(y[3]=v=>i.value.inboxId=v),placeholder:"Your Inbox ID",class:te({"p-invalid":t.submitted&&!i.value.inboxId})},null,8,["modelValue","class"]),t.submitted&&!i.value.inboxId?(a(),_("small",pi,"Inbox ID is required.")):S("",!0)])]),e("div",mi,[e("div",vi,[fi,o(h,{id:"inboxIdentifier",modelValue:i.value.inboxIdentifier,"onUpdate:modelValue":y[4]||(y[4]=v=>i.value.inboxIdentifier=v),placeholder:"Your inbox identifier",feedback:!1,toggleMask:"",class:te({"p-invalid":t.submitted&&!i.value.inboxIdentifier})},null,8,["modelValue","class"]),t.submitted&&!i.value.inboxIdentifier?(a(),_("small",_i,"Inbox Identifier is required.")):S("",!0)])])]),e("div",hi,[e("label",bi,[T(" Language "),N(e("i",gi,null,512),[[R,"This is the integration language, not the Chatwoot account language. They can be different."]])]),o(I,{id:"locale",modelValue:i.value.locale,"onUpdate:modelValue":y[5]||(y[5]=v=>i.value.locale=v),options:d.value,optionLabel:"name",optionValue:"locale",placeholder:"Select Locale",loading:u.value,class:te({"p-invalid":t.submitted&&!i.value.locale})},null,8,["modelValue","options","loading","class"]),t.submitted&&!i.value.locale?(a(),_("small",yi,"Language is required.")):S("",!0)])])}}}),wi=oe($i,[["__scopeId","data-v-730b0920"]]),Te=t=>(me("data-v-1fb98872"),t=t(),ve(),t),ki={class:"chatwoot-faq"},xi=Te(()=>e("div",{class:"mb-3"},[e("a",{href:"https://waha.devlike.pro/docs/apps/chatwoot",target:"_blank"}," Learn more about WAHA ChatWoot App ")],-1)),Si={class:"mb-4"},Ci=Te(()=>e("p",{class:"mb-1"},[T(" Use this "),e("strong",null,"Webhook URL"),T(" for your "),e("b",null,"ChatWoot Inbox"),T(": ")],-1)),Vi={class:"p-inputgroup mb-1"},Ai=Te(()=>e("small",{class:"p-message-secondary"},[T("ðŸ‘‰ Replace "),e("b",null,"WAHA_BASE_URL"),T(" with "),e("b",null,"Your WAHA URL")],-1)),Ii={class:"mt-4"},Di=Te(()=>e("p",null,[T("Example (if you're using "),e("b",null,"docker-compose"),T(" default setup):")],-1)),Ri={class:"p-inputgroup"},Ui=Ie({__name:"AppFAQChatWoot",props:{app:{type:Object,required:!0},session:{type:String,required:!0}},setup(t){const l=t,n=L(()=>`/webhooks/chatwoot/${l.session}/${l.app.id}`),s=L(()=>`http://waha:3000${n.value}`),r=L(()=>`{WAHA_BASE_URL}${n.value}`);async function c(){await navigator.clipboard.writeText(r.value)}async function i(){await navigator.clipboard.writeText(s.value)}return(d,u)=>{const m=Ke,b=ne,y=q,k=ze,x=Y("tooltip");return a(),_("div",ki,[o(k,{multiple:!0,activeIndex:[1]},{default:p(()=>[o(m,{header:"About WAHA ChatWoot App"},{default:p(()=>[xi]),_:1}),o(m,{header:"ChatWoot Inbox - Webhook URL"},{default:p(()=>[e("div",Si,[Ci,e("div",Vi,[o(b,{value:r.value,disabled:"",placeholder:"Webhook URL"},null,8,["value"]),N(o(y,{label:"Copy",icon:"pi pi-copy",onClick:c},null,512),[[x,{value:"Copied to clipboard"},void 0,{focus:!0,bottom:!0}]])]),Ai]),e("div",Ii,[Di,e("div",Ri,[o(b,{value:s.value,disabled:"",placeholder:"Example URL"},null,8,["value"]),N(o(y,{label:"Copy",icon:"pi pi-copy",onClick:i},null,512),[[x,{value:"Copied to clipboard"},void 0,{focus:!0,bottom:!0}]])])])]),_:1})]),_:1})])}}}),Ti=oe(Ui,[["__scopeId","data-v-1fb98872"]]),Ei="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_378_9639)'%3e%3cpath%20d='M12%2024C18.6274%2024%2024%2018.6274%2024%2012C24%205.37258%2018.6274%200%2012%200C5.37258%200%200%205.37258%200%2012C0%2018.6274%205.37258%2024%2012%2024Z'%20fill='%232781F6'%3e%3c/path%3e%3cpath%20d='M17.1256%2017.1258H11.5622C8.4955%2017.1258%205.99976%2014.6299%205.99976%2011.5624C5.99976%208.49591%208.4955%206%2011.5623%206C14.6298%206%2017.1256%208.49591%2017.1256%2011.5624V17.1258Z'%20fill='white'%20stroke='white'%20stroke-width='0.28125'%3e%3c/path%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_378_9639'%3e%3crect%20width='24'%20height='24'%20fill='white'%3e%3c/rect%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",kt=t=>(me("data-v-50742726"),t=t(),ve(),t),Li={class:"chatwoot-label"},Ni=kt(()=>e("img",{src:Ei,alt:"ChatWoot Icon",class:"chatwoot-icon"},null,-1)),Oi=kt(()=>e("span",null,"ChatWoot",-1)),Mi=[Ni,Oi],Pi={__name:"ChatWootLabel",setup(t){return(l,n)=>(a(),_("span",Li,Mi))}},qe=oe(Pi,[["__scopeId","data-v-50742726"]]),Ee=t=>(me("data-v-fed52900"),t=t(),ve(),t),ji={class:"app-edit"},Bi={class:"field"},Wi=Ee(()=>e("label",{for:"id"},[e("b",null,"App ID")],-1)),qi={key:0,class:"p-error"},Hi={class:"field"},Fi=Ee(()=>e("label",{for:"app-type"},[e("b",null,"App Type")],-1)),Ki={key:0},zi={key:1},Yi={key:0,class:"p-error"},Gi={key:0,class:"field"},Qi=Ee(()=>e("label",null,[e("b",null,"App FAQ")],-1)),Xi=Ee(()=>e("label",null,[e("b",null,"App Configuration")],-1)),Ji={class:"card app-config"},Zi=Ie({__name:"AppEdit",props:{modelValue:{type:Object,required:!0},server:{type:Object,required:!0},visible:{type:Boolean,default:!1},isNewApp:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},emits:["update:modelValue","update:visible","save","cancel"],setup(t,{emit:l}){const n=t,s=L({get:()=>n.visible,set:k=>c("update:visible",k)}),r=L(()=>!n.modelValue.id),c=l;z(),fe();const i=L({get:()=>n.modelValue,set:k=>c("update:modelValue",k)}),d=g([{name:"ChatWoot",value:"chatwoot",label:"chatwoot"}]),u=g(!1);se(()=>i.value,k=>{k.id||(i.value={...k,id:m()})},{immediate:!0});function m(){return ht()}function b(){if(u.value=!0,!(!i.value.id||!i.value.app||!i.value.session)){if(i.value.app==="chatwoot"){const k=i.value.config;if(!k||!k.url||!k.accountId||!k.accountToken||!k.inboxId||!k.inboxIdentifier||!k.locale)return}c("save",i.value)}}function y(){u.value=!1,c("update:visible",!1),c("cancel")}return(k,x)=>{const h=ne,I=$e,R=q,v=_e;return a(),U(v,{visible:s.value,"onUpdate:visible":x[3]||(x[3]=E=>s.value=E),modal:!0,class:"p-fluid",header:n.isNewApp?"Add App":"Edit App"},{footer:p(()=>[o(R,{label:"Cancel",icon:"pi pi-times",onClick:y,text:"",severity:"secondary"}),o(R,{label:r.value?"Add":"Save",icon:r.value?"pi pi-plus":"pi pi-check",onClick:b,loading:n.loading,text:""},null,8,["label","icon","loading"])]),default:p(()=>[e("div",ji,[e("div",Bi,[Wi,o(h,{id:"id",modelValue:i.value.id,"onUpdate:modelValue":x[0]||(x[0]=E=>i.value.id=E),disabled:!n.isNewApp,placeholder:"Automatically generated"},null,8,["modelValue","disabled"]),u.value&&!i.value.id?(a(),_("small",qi,"ID is required.")):S("",!0)]),e("div",Hi,[Fi,o(I,{id:"app-type",modelValue:i.value.app,"onUpdate:modelValue":x[1]||(x[1]=E=>i.value.app=E),options:d.value,optionLabel:"name",optionValue:"value",placeholder:"Select App Type",class:te({"p-invalid":u.value&&!i.value.app}),disabled:!n.isNewApp},{value:p(E=>[E.value?(a(),_("div",Ki,[E.value==="chatwoot"?(a(),U(qe,{key:0})):S("",!0)])):(a(),_("span",zi,B(E.placeholder),1))]),option:p(E=>[E.option.value==="chatwoot"?(a(),U(qe,{key:0})):S("",!0)]),_:1},8,["modelValue","options","class","disabled"]),u.value&&!i.value.app?(a(),_("small",Yi,"App Type is required.")):S("",!0)]),i.value.app?(a(),_("div",Gi,[Qi,i.value.app==="chatwoot"?(a(),U(Ti,{key:0,app:i.value,session:i.value.session||""},null,8,["app","session"])):S("",!0),Xi,e("div",Ji,[i.value.app==="chatwoot"?(a(),U(wi,{key:0,modelValue:i.value.config,"onUpdate:modelValue":x[2]||(x[2]=E=>i.value.config=E),server:t.server,submitted:u.value},null,8,["modelValue","server","submitted"])):S("",!0)])])):S("",!0)])]),_:1},8,["visible","header"])}}}),ea=oe(Zi,[["__scopeId","data-v-fed52900"]]),ta=t=>(me("data-v-93ac0ddd"),t=t(),ve(),t),sa={class:"app-list"},oa={class:"flex justify-content-between align-items-center w-full mb-2"},na={class:"mb-0"},la={class:"pi pi-info-circle"},ia=ta(()=>e("div",{class:"text-center p-4"},' No apps found. Click "Add App" to create one. ',-1)),aa={class:"flex gap-2 justify-content-end"},ra=Ie({__name:"AppList",props:{server:Object,session:Object,isNewSession:{type:Boolean,default:!1}},setup(t){const l=ge(),n=tt(),s=z(),r=fe(),c=t,i=g([]),d=g(!1),u=g(!1),m=g(null),b=g(!1);Ae(async()=>{await y()}),se(()=>[c.server,c.session],async()=>{await y()},{deep:!0});async function y(){if(!c.server||!c.session||!c.session.name){i.value=[];return}try{d.value=!0,i.value=await r(s.getApps(c.server.id,c.session.name),void 0,"Failed to load apps")}catch(D){console.error("Error loading apps:",D)}finally{d.value=!1}}function k(){if(c.isNewSession){l.add({severity:"info",summary:"Info",detail:"Create session first to add Apps",life:3e3});return}m.value={id:R(),session:c.session.name,app:"chatwoot",config:{}},b.value=!0,u.value=!0}function x(D){m.value={...D},b.value=!1,u.value=!0}function h(D,C){const F=E(D.app);n.require({target:C.currentTarget,message:`Delete ${F} (${D.id})?`,icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-danger p-button-sm",rejectLabel:"No",acceptLabel:"Yes, Delete",accept:async()=>{await I(D)},reject:()=>{}})}async function I(D){try{await r(s.deleteApp(c.server.id,D.id),void 0,"Failed to delete app");const C=E(D.app);l.add({severity:"success",summary:"App Deleted",detail:`${C} (${D.id})`,life:3e3}),await y()}catch(C){console.error("Error deleting app:",C)}}function R(){return ht()}async function v(D){try{const C=E(D.app);return b.value?(await r(s.createApp(c.server.id,D),void 0,"Failed to create app"),l.add({severity:"success",summary:"App Created",detail:`${C} (${D.id})`,life:3e3})):(await r(s.updateApp(c.server.id,D),void 0,"Failed to update app"),l.add({severity:"success",summary:"App Updated",detail:`${C} (${D.id})`,life:3e3})),await y(),u.value=!1,!0}catch(C){return console.error("Error saving app:",C),!1}}function E(D){switch(D){case"chatwoot":return"ChatWoot";default:return D}}return(D,C)=>{const F=q,K=De,P=Re,j=Fe,V=Y("tooltip");return a(),_("div",sa,[e("div",oa,[e("div",null,[e("h5",na,[T(" ðŸ§© Apps "),N(e("i",la,null,512),[[V,"Built-in integrations"]])])]),e("div",null,[o(F,{label:"Add App",icon:"pi pi-plus",onClick:k,severity:"success",text:""})])]),o(P,{value:i.value,loading:d.value,dataKey:"id",paginator:i.value.length>10,rows:10,showGridlines:""},{empty:p(()=>[ia]),default:p(()=>[o(K,{field:"app",header:"App Type"},{body:p(({data:w})=>[w.app==="chatwoot"?(a(),U(qe,{key:0})):(a(),_(W,{key:1},[T(B(E(w.app)),1)],64))]),_:1}),o(K,{field:"id",header:"ID"}),o(K,{style:{width:"10rem","text-align":"right"}},{body:p(({data:w})=>[e("div",aa,[N(o(F,{icon:"pi pi-pencil",onClick:G=>x(w),outlined:"",rounded:"",severity:"success"},null,8,["onClick"]),[[V,"Edit App",void 0,{top:!0}]]),N(o(F,{icon:"pi pi-trash",onClick:G=>h(w,G),outlined:"",rounded:"",severity:"danger"},null,8,["onClick"]),[[V,"Delete App",void 0,{top:!0}]])])]),_:1})]),_:1},8,["value","loading","paginator"]),o(j),m.value?(a(),U(ea,{key:0,modelValue:m.value,"onUpdate:modelValue":C[0]||(C[0]=w=>m.value=w),server:t.server,visible:u.value,"onUpdate:visible":C[1]||(C[1]=w=>u.value=w),isNewApp:b.value,loading:d.value,onSave:v,onCancel:C[2]||(C[2]=w=>u.value=!1)},null,8,["modelValue","server","visible","isNewApp","loading"])):S("",!0)])}}}),ua=oe(ra,[["__scopeId","data-v-93ac0ddd"]]),ca={class:"w-full flex flex-column gap-2"},da={key:0},pa={class:"flex justify-content-end"},ma={__name:"AppsDialog",props:{visible:{},visibleModifiers:{},session:{},sessionModifiers:{},server:{},serverModifiers:{}},emits:["update:visible","update:session","update:server"],setup(t){const l=X(t,"visible"),n=X(t,"session"),s=X(t,"server"),r=L(()=>n.value.status==="STOPPED");function c(){l.value=!1}return(i,d)=>{const u=q,m=_e;return a(),U(m,{visible:l.value,"onUpdate:visible":d[0]||(d[0]=b=>l.value=b),modal:!0,class:"p-fluid",maximizable:"",style:{"min-width":"50%"}},{header:p(()=>[o(ke,{session:n.value},null,8,["session"])]),footer:p(()=>[e("div",ca,[r.value?S("",!0):(a(),_("div",da,[o(f(mt),{severity:"warn"},{default:p(()=>[T(" The session is in '"),e("b",null,B(n.value.status),1),T("' status, in order to change apps or their configuration, the session will be restarted. ")]),_:1})])),e("div",pa,[o(u,{label:"Close",icon:"pi pi-times",text:"",onClick:c,severity:"secondary"})])])]),default:p(()=>[o(ua,{server:s.value,session:n.value,isNewSession:!1},null,8,["server","session"])]),_:1},8,["visible"])}}},va={class:"flex justify-content-between"},fa={class:"flex align-items-center gap-1"},_a=e("i",{class:"pi pi-whatsapp"},null,-1),ha=e("span",{class:"mr-1"}," Sessions ",-1),ba=["disabled"],ga=e("i",{class:"pi pi-refresh"},null,-1),ya=[ga],$a={class:"flex justify-content-between flex-column sm:flex-row gap-2 sm:gap-0"},wa={class:"flex flex-column"},ka={class:"flex justify-content-between flex-column sm:flex-row gap-2 sm:gap-2"},xa={style:{"text-align":"left"},class:"flex flex-column"},Sa={class:"text-center"},Ca={class:"flex gap-2"},Va={class:"my-auto"},Aa={key:0,class:"pi pi-info-circle text-orange-400"},Ia={class:"flex flex-row gap-2 justify-content-end",style:{order:"2"}},dr={__name:"SessionTable",setup(t){const l=ge(),n=z(),{visibleSessions:s,refreshing:r,servers:c}=He(n),i=g({config:{webhooks:[]}}),d=g(!1),u=g(void 0),m=g(!1),b=g(!1),y=g(!1),k=g(null),x=g(10);g(null);const h=g({}),I=g(null),R=g([]),v=L(()=>R.value.filter(O=>P.value[`session-action-${O.server.id}-${O.name}`])),E=g(!1),D=g(!1),C=g(!1),F=g(!1),K=g(!1),P=g({});function j(O,A){switch(O){case"startSession":E.value=A;break;case"restartSession":D.value=A;break;case"stopSession":C.value=A;break;case"logoutSession":F.value=A;break;case"deleteSession":K.value=A;break}}async function V(O){j(O,!0);try{for(const A of v.value)await P.value[`session-action-${A.server.id}-${A.name}`][O]()}finally{j(O,!1)}}Qt(()=>{P.value=[]}),Xt(()=>{ce()});const w=g([{field:"name",header:"Name"},{field:"metadata",header:"Metadata"},{field:"me",header:"Me"},{field:"status",header:"Status"},{field:"server",header:"Server"}]);function G(){return JSON.parse(localStorage.getItem("sessions.table.columns.hidden"))||[]}const J=G(),Q=g(le.differenceBy(w.value,J,"field")),ie=O=>{Q.value=w.value.filter(A=>O.includes(A))};function H(O){return!Q.value||Q.value.length===0?!0:le.find(Q.value,{field:O})}const ae=L(()=>H("name")),Le=L(()=>H("metadata")),Ne=L(()=>H("me")),Oe=L(()=>H("status")),Me=L(()=>H("server")),Pe=L(()=>le.differenceBy(w.value,Q.value,"field"));se(()=>Pe.value,O=>{localStorage.setItem("sessions.table.columns.hidden",JSON.stringify(O))},{deep:!0});const ce=()=>{h.value={global:{value:null,matchMode:he.CONTAINS},status:{value:null,matchMode:he.EQUALS},"server.id":{value:null,matchMode:he.EQUALS},name:{value:null,matchMode:he.CONTAINS},"me.id":{value:null,matchMode:he.CONTAINS}}};function je(){const O=c.value.find(A=>A.connected);if(!O){l.add({severity:"error",summary:"No connected server",detail:"Please connect to a server first",life:3e3});return}i.value={server:O.id,name:"",config:{metadata:{},webhooks:[],noweb:{markOnline:!0,store:{enabled:!0,fullSync:!1}},proxy:{}}},u.value="new",d.value=!0}function re(O){i.value=le.cloneDeep({name:O.name,status:O.status,server:O.server.id,config:O.config}),u.value="update",d.value=!0}function M(){Ce("store",async()=>await n.refresh())}function xt(O){m.value=!0,i.value=O}function St(O){i.value=O,b.value=!0}function Ct(O){i.value=O,k.value=O.server,y.value=!0}se(b,O=>{O||(i.value={config:{webhooks:[]}})});const Vt=L(()=>["name","me.id","me.pushName","_metadata"]);return(O,A)=>{const Qe=et,Be=q,At=_s,It=Jt,We=ne,Dt=Zt,Rt=lt,ue=De,Ut=gs,Tt=Ye,Et=Is,Xe=ut,Lt=$e,Nt=ct,Ot=yt,Mt=Us,Pt=Re,jt=Fe,Bt=So,Wt=tn,qt=fl,xe=Y("tooltip");return a(),_(W,null,[e("div",va,[e("div",null,[e("h5",fa,[_a,ha,o(Qe,{refreshing:f(r)},null,8,["refreshing"])])]),e("div",null,[N((a(),_("button",{onClick:M,class:"p-link layout-topbar-button",disabled:f(r)},ya,8,ba)),[[xe,"Refresh",void 0,{top:!0}]])])]),o(Pt,{selection:R.value,"onUpdate:selection":A[8]||(A[8]=$=>R.value=$),value:f(s).length>0?f(s):[],paginator:!0,rows:x.value,rowsPerPageOptions:[5,10,20,50,100,500],dataKey:$=>`${$.server.id}-${$.name}`,rowHover:!0,filters:h.value,"onUpdate:filters":A[9]||(A[9]=$=>h.value=$),filterDisplay:"row",loading:I.value,globalFilterFields:f(Vt),showGridlines:"",style:{"white-space":"nowrap"},sortField:"name",sortOrder:1,resizableColumns:""},{header:p(()=>[e("div",$a,[e("div",wa,[o(Be,{label:"Start New",icon:"pi pi-play",severity:"success",onClick:je})]),e("div",ka,[o(At),e("div",null,[o(Dt,{iconPosition:"left"},{default:p(()=>[o(It,{class:"pi pi-search"}),o(We,{modelValue:h.value.global.value,"onUpdate:modelValue":A[0]||(A[0]=$=>h.value.global.value=$),placeholder:"Search by Name, Phone, Metadata",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),e("div",xa,[o(Rt,{placeholder:"Columns",modelValue:Q.value,options:w.value,optionLabel:"header",selectedItemsLabel:"Columns",maxSelectedLabels:0,"onUpdate:modelValue":ie},null,8,["modelValue","options"])])])])]),empty:p(()=>[T(" No sessions found")]),loading:p(()=>[T(" Loading sessions...")]),default:p(()=>[o(ue,{selectionMode:"multiple",headerStyle:"width: 3rem"}),f(ae)?(a(),U(ue,{key:0,field:"name",header:"Name","show-filter-menu":!1,sortable:""},{filter:p(({filterModel:$,filterCallback:Z})=>[o(We,{modelValue:h.value.name.value,"onUpdate:modelValue":A[1]||(A[1]=ee=>h.value.name.value=ee),type:"text",placeholder:"Session"},null,8,["modelValue"])]),_:1})):S("",!0),f(Le)?(a(),U(ue,{key:1,header:"Metadata"},{body:p(({data:$})=>{var Z;return[o(Ut,{metadata:(Z=$.config)==null?void 0:Z.metadata},null,8,["metadata"])]}),_:1})):S("",!0),f(Ne)?(a(),U(ue,{key:2,header:"Me"},{body:p(({data:$})=>[e("div",Sa,[o(Tt,{session:$},null,8,["session"])])]),filter:p(({filterModel:$,filterCallback:Z})=>[o(We,{modelValue:h.value["me.id"].value,"onUpdate:modelValue":A[2]||(A[2]=ee=>h.value["me.id"].value=ee),type:"text",placeholder:"Me (Phone Number)"},null,8,["modelValue"])]),_:1})):S("",!0),f(Oe)?(a(),U(ue,{key:3,field:"status",header:"Status",showFilterMenu:!1,style:{width:"9rem"}},{body:p(({data:$})=>[e("div",Ca,[e("div",null,[o(zl,{session:$},null,8,["session"])]),e("div",null,[o(Et,{session:$},null,8,["session"])]),e("div",null,[N(o(Be,{icon:"pi pi-whatsapp",severity:"",rounded:"",outlined:"",disabled:$.status!=="WORKING",onClick:Z=>St($)},null,8,["disabled","onClick"]),[[xe,"Chat UI",void 0,{top:!0}]])]),e("div",null,[N(o(Be,{icon:"pi pi-code",severity:"secondary",rounded:"",outlined:"",onClick:Z=>xt($)},null,8,["onClick"]),[[xe,"Send Request",void 0,{top:!0}]])]),e("div",Va,[o(Xe,{status:$.status,value:$.status.toUpperCase()},null,8,["status","value"])])])]),filter:p(({filterModel:$,filterCallback:Z})=>[o(Lt,{modelValue:$.value,"onUpdate:modelValue":ee=>$.value=ee,options:f(_l),onChange:ee=>Z(),placeholder:"Any",class:"p-column-filter",showClear:!0},{option:p(({option:ee})=>[o(Xe,{status:ee,value:ee},null,8,["status","value"])]),_:2},1032,["modelValue","onUpdate:modelValue","options","onChange"])]),_:1})):S("",!0),f(Me)?(a(),U(ue,{key:4,field:"server.name",filterField:"server.id",header:"Server",showFilterMenu:!1},{filter:p(({filterModel:$,filterCallback:Z})=>[o(Nt,{placeholder:"Any",onChange:ee=>Z(),modelValue:$.value,"onUpdate:modelValue":ee=>$.value=ee,showClear:!0,required:!1},null,8,["onChange","modelValue","onUpdate:modelValue"])]),body:p(({data:$})=>[T(B($.server.name)+" ",1),$.assignedWorker&&$.server.name!==$.assignedWorker?N((a(),_("i",Aa,null,512)),[[xe,`Assigned Worker ID does not match

ðŸ‘‰ Assigned Worker ID: ${$.assignedWorker}`]]):S("",!0)]),_:1})):S("",!0),o(ue,{showFilterMenu:!1},{filter:p(()=>[e("div",Ia,[o(Ot,{group:"dialog",name:`'${f(v).length}' sessions`,"all-disabled":f(v).length===0,"hide-actions":["view","apps"],"is-starting":E.value,"is-restarting":D.value,"is-stopping":C.value,"is-logging-out":F.value,"is-removing":K.value,onStart:A[3]||(A[3]=$=>V("startSession")),onRestart:A[4]||(A[4]=$=>V("restartSession")),onStop:A[5]||(A[5]=$=>V("stopSession")),onLogout:A[6]||(A[6]=$=>V("logoutSession")),onDelete:A[7]||(A[7]=$=>V("deleteSession"))},null,8,["name","all-disabled","is-starting","is-restarting","is-stopping","is-logging-out","is-removing"])])]),body:p(({data:$})=>[o(Mt,{ref:Z=>{P.value[`session-action-${$.server.id}-${$.name}`]=Z},session:$,disabled:f(v).length!==0,onView:re,onApps:Ct},null,8,["session","disabled"])]),_:1})]),_:1},8,["selection","value","rows","dataKey","filters","loading","globalFilterFields"]),o(jt),o(Bt,{visible:b.value,"onUpdate:visible":A[10]||(A[10]=$=>b.value=$),session:i.value,"onUpdate:session":A[11]||(A[11]=$=>i.value=$)},null,8,["visible","session"]),o(Wt,{visible:m.value,"onUpdate:visible":A[12]||(A[12]=$=>m.value=$),session:i.value,"onUpdate:session":A[13]||(A[13]=$=>i.value=$)},null,8,["visible","session"]),o(qt,{visible:d.value,"onUpdate:visible":A[14]||(A[14]=$=>d.value=$),session:i.value,"onUpdate:session":A[15]||(A[15]=$=>i.value=$),mode:u.value},null,8,["visible","session","mode"]),o(ma,{visible:y.value,"onUpdate:visible":A[16]||(A[16]=$=>y.value=$),session:i.value,"onUpdate:session":A[17]||(A[17]=$=>i.value=$),server:k.value,"onUpdate:server":A[18]||(A[18]=$=>k.value=$)},null,8,["visible","session","server"])],64)}}};export{_s as _,dr as a};
