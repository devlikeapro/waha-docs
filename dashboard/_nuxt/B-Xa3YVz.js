import{u as ys,_ as Pn}from"./Dk-r_1mC.js";import ne from"./Bd7ASKiw.js";import Rn from"./BHHpaNgW.js";import{u as he,a as ai,s as dt,C as st,W as ri,l as pe}from"./B09Vh1_i.js";import{O as Q,S as on,P as ae,N as u,t as v,v as L,x as r,y as w,Q as K,z as p,X as vs,_ as me,U as te,Y as mt,c as R,A as C,Z as le,C as Je,D as Qe,r as E,o as _s,L as P,V as B,$ as qn,B as G,M as Sn,i as gt,a0 as xt,H as se,a1 as ci,a2 as be,R as Mt,a3 as ui,l as di,a4 as Ut,a5 as fi,d as Ye,a6 as Kn,a7 as pi,W as hi,T as Lt}from"./BJH8QkQz.js";import mi from"./D-Qj_xKj.js";import Ae from"./DMxLEi9q.js";import gi from"./Ds1Wd8DC.js";import ln from"./mdHWUB7r.js";import ws from"./Dvv1-hKi.js";import Fn from"./Bzmqo93D.js";import Wn from"./DllRpuEi.js";import Hn from"./Dcj-iZ8g.js";import bi from"./DxsgSPQp.js";import{u as bt,_ as Gn}from"./DvA4AQL6.js";import yt from"./BFuRBBmW.js";import{_ as yi,a as vi,b as Jn}from"./CSUaz4lO.js";import an from"./TtRdJW1M.js";import _i from"./5xkTMfpE.js";import ks from"./CnmwqEH0.js";import{_ as wi}from"./Cm-9_Kty.js";import ki from"./BC66Id3X.js";import $i from"./C0Tg_1bI.js";import Si from"./76zyLiAy.js";import vt from"./BFm-2PXr.js";import ft from"./DRh8VjEO.js";import $s from"./DIfdcvBh.js";import Qn from"./BBN3TOVO.js";import _t from"./Cz_NB2Cp.js";import Ss from"./Bt_k5xh8.js";import Cs from"./COi-2mEj.js";import Yn from"./BWryaZJJ.js";import zn from"./D94ooCM9.js";import Ci from"./B9MJPu8O.js";import Ni from"./CCi09s4j.js";import Oi from"./BdnA8qOn.js";function Cn(s){return s<1e12?s*1e3:s}function Nn(s){if(s==null)return null;if(s instanceof Date)return Number.isNaN(s.getTime())?null:s;if(typeof s=="number"){const e=new Date(Cn(s));return Number.isNaN(e.getTime())?null:e}if(typeof s=="string"){const e=s.trim();if(e==="")return null;const n=Number(e),o=Number.isNaN(n)?new Date(e):new Date(Cn(n));return Number.isNaN(o.getTime())?null:o}const t=new Date(s);return Number.isNaN(t.getTime())?null:t}function Ti(){const{locale:s}=Q();return{toDate:Nn,formatChatTimestamp:e=>{const n=Nn(e);if(!n)return e!=null?String(e):"";const o=s.value||void 0,i=new Date,l=new Intl.DateTimeFormat(o,n.getFullYear()===i.getFullYear()?{day:"2-digit",month:"short"}:{day:"2-digit",month:"short",year:"numeric"});return`${new Intl.DateTimeFormat(o,{hour:"2-digit",minute:"2-digit"}).format(n)}, ${l.format(n)}`}}}const ie=[];for(let s=0;s<256;++s)ie.push((s+256).toString(16).slice(1));function Li(s,t=0){return(ie[s[t+0]]+ie[s[t+1]]+ie[s[t+2]]+ie[s[t+3]]+"-"+ie[s[t+4]]+ie[s[t+5]]+"-"+ie[s[t+6]]+ie[s[t+7]]+"-"+ie[s[t+8]]+ie[s[t+9]]+"-"+ie[s[t+10]]+ie[s[t+11]]+ie[s[t+12]]+ie[s[t+13]]+ie[s[t+14]]+ie[s[t+15]]).toLowerCase()}let qs;const Ii=new Uint8Array(16);function Ai(){if(!qs){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");qs=crypto.getRandomValues.bind(crypto)}return qs(Ii)}const Ei=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),On={randomUUID:Ei};function Vi(s,t,e){var o;s=s||{};const n=s.random??((o=s.rng)==null?void 0:o.call(s))??Ai();if(n.length<16)throw new Error("Random bytes length must be >= 16");if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,t){if(e=e||0,e<0||e+16>t.length)throw new RangeError(`UUID byte range ${e}:${e+15} is out of buffer bounds`);for(let i=0;i<16;++i)t[e+i]=n[i];return t}return Li(n)}function xi(s,t,e){return On.randomUUID&&!t&&!s?On.randomUUID():Vi(s,t,e)}function Xn(s="app"){const t=xi().replace(/-/g,"");return`${s}_${t}`}function Di(s){return s?Object.keys(s).map(t=>({key:t,value:s[t]})):[]}function Bi(s){return s.reduce((t,e)=>(t[e.key]=e.value,t),{})}const ji={key:0},Mi={key:1,class:"ml-auto flex align-items-center gap-2 mr-2"},Ui={for:"show-duplicates"},Pi={class:"pi pi-info-circle"},Ri={__name:"HideDuplicates",setup(s){const{t}=Q(),e=he(),{hideDuplicatedSessions:n,servers:o}=on(e);return e.$subscribe((i,l)=>{ai(l.hideDuplicatedSessions)}),(i,l)=>{const a=Rn,c=ae("tooltip");return u(o)&&u(o).length<2?(v(),L("div",ji)):(v(),L("div",Mi,[r("label",Ui,w(u(t)("sessions.hideDuplicates")),1),K(r("i",Pi,null,512),[[c,u(t)("sessions.hideDuplicatesTooltip")]]),p(a,{id:"show-duplicates",modelValue:u(n),"onUpdate:modelValue":l[0]||(l[0]=d=>vs(n)?n.value=d:null)},null,8,["modelValue"])]))}}},qi={class:"metadata"},Ki={__name:"Metadata",props:["metadata"],setup(s){return(t,e)=>(v(),L("div",qi,[(v(!0),L(te,null,mt(s.metadata,(n,o)=>(v(),L("pre",{key:o},w(o)+"="+w(n),1))),128))]))}},Fi=me(Ki,[["__scopeId","data-v-cb7cbf08"]]),Wi=s=>(Je("data-v-3d726b2b"),s=s(),Qe(),s),Hi={class:"contact-chip"},Gi={class:"contact-chip__content"},Ji=["src","alt"],Qi={key:1,class:"contact-chip__avatar-icon contact-chip__avatar-icon--group pi pi-users"},Yi={key:2,class:"contact-chip__avatar-icon pi pi-user contact-chip__avatar-icon--single"},zi={class:"contact-chip__info","data-pc-section":"label"},Xi=Wi(()=>r("br",null,null,-1)),Zi={__name:"ContactChip",props:{id:String,name:String,image:String,id2:String},setup(s){const t=s,e=R(()=>[t.id,t.id2].filter(Boolean));return(n,o)=>{const i=Fn;return v(),L("div",Hi,[p(i,{label:s.id,image:s.image,icon:"pi pi-user"},{default:C(()=>{var l;return[r("div",Gi,[r("div",{class:le(["contact-chip__avatar p-chip-text p-chip-icon",{"contact-chip__avatar--icon":!s.image}])},[s.image?(v(),L("img",{key:0,class:"contact-chip__avatar-image",src:s.image,alt:s.name||s.id},null,8,Ji)):(l=s.id)!=null&&l.includes("@g.us")?(v(),L("i",Qi)):(v(),L("i",Yi))],2),r("div",zi,[r("b",null,w(s.name||s.id),1),Xi,r("div",null,[(v(!0),L(te,null,mt(u(e),a=>(v(),L("div",{key:a,class:"p-text-secondary contact-chip__id"},w(a),1))),128))])])])]}),_:1},8,["label","image"])])}}},ps=me(Zi,[["__scopeId","data-v-3d726b2b"]]),rn={__name:"SessionChip",props:{session:Object},setup(s){const t=s,e=he(),n=E(null);return _s(()=>{var o,i,l;(i=(o=t.session)==null?void 0:o.me)!=null&&i.id&&((l=t.session)==null?void 0:l.status)==="WORKING"&&e.getProfilePicture(t.session.server.id,t.session.name,t.session.me.id).then(a=>{n.value=a.profilePictureURL})}),(o,i)=>{var l,a,c,d,h,f,g,b;return(a=(l=t.session)==null?void 0:l.me)!=null&&a.id?(v(),P(ps,{key:0,id:(d=(c=t.session)==null?void 0:c.me)==null?void 0:d.id,id2:(f=(h=t.session)==null?void 0:h.me)==null?void 0:f.lid,name:(b=(g=t.session)==null?void 0:g.me)==null?void 0:b.pushName,image:u(n)},null,8,["id","id2","name","image"])):B("",!0)}}},Pt={__name:"RefreshButton",props:["refreshing"],setup(s){const t=s,e=R(()=>t.refreshing?"pi pi-refresh pi-spin":"pi pi-refresh");return(n,o)=>{const i=ne;return v(),P(i,{icon:u(e),rounded:"",text:"",disabled:s.refreshing},null,8,["icon","disabled"])}}},el=["src"],Zn={__name:"Base64Img",props:{data:String,mimetype:String},setup(s){const t=s,e=R(()=>`data:${t.mimetype};base64, ${t.data}`);return(n,o)=>(v(),L("img",{src:e.value,style:{"max-width":"100%"}},null,8,el))}},tl={key:2,style:{"background-color":"#f8f9fa",padding:"1rem",color:"red","white-space":"pre-wrap"}},eo={__name:"SessionScreenshot",props:{session:Object},setup(s,{expose:t}){const e=he(),n=s,{data:o,pending:i,error:l,refresh:a}=ys(`session-screenshot-${n.session.server.id}-${n.session.name}`,async()=>(await dt(1e3),await e.getScreenshot(n.session.server.id,n.session.name)));return t({refresh:a}),(c,d)=>{const h=Wn,f=Hn,g=Zn;return v(),L(te,null,[u(i)?(v(),L(te,{key:0},[p(h,{mode:"indeterminate",style:{height:"3px"}}),!u(o)&&!u(l)?(v(),P(f,{key:0,width:"100%",height:"20rem"})):B("",!0)],64)):B("",!0),u(o)?(v(),P(g,{key:1,data:u(o).data,mimetype:u(o).mimetype},null,8,["data","mimetype"])):B("",!0),u(l)?(v(),L("pre",tl,""+w(u(l).cause.response.data.message||u(l).cause.response.data||u(l))+`
  `,1)):B("",!0)],64)}}},sl={class:"",style:{"min-width":"20rem"}},nl={class:"flex justify-content-center align-items-center"},ol={class:"m-0"},il={class:"m-auto w-full"},ll={__name:"ScreenshotButton",props:["session"],setup(s){const{t}=Q(),e=s,n=E(null),o=E(null),i=c=>{n.value.toggle(c)},l=()=>{o.value.refresh()},a=R(()=>e.session.status==="STOPPED");return(c,d)=>{const h=ne,f=Pt,g=eo,b=bi,_=ae("tooltip");return v(),L(te,null,[K(p(h,{disabled:u(a),type:"button",icon:"pi pi-camera",onClick:i,rounded:"",outlined:"",severity:"help"},null,8,["disabled"]),[[_,u(t)("screenshot.screenshotQR"),void 0,{top:!0}]]),p(b,{ref_key:"op",ref:n,appendTo:"body",showCloseIcon:!0},{default:C(()=>[r("div",sl,[r("div",nl,[r("h5",ol,w(u(t)("screenshot.screenshot")),1),p(f,{onClick:l})]),r("div",il,[p(g,{ref_key:"screenshot",ref:o,session:s.session},null,8,["session"])])])]),_:1},512)],64)}}},al={class:"flex flex-row gap-2 justify-content-end"},to={__name:"SessionActionButtons",props:["name","isStarting","isRestarting","isStopping","isLoggingOut","isRemoving","allDisabled","hideActions","skipConfirmation","group"],emits:["view","start","restart","stop","logout","delete","apps"],setup(s,{emit:t}){const{t:e}=Q(),n=qn(),o=s,i=t;function l(_){return o.skipConfirmation?!o.skipConfirmation.includes(_):!0}async function a(){if(!l("start")){i("start");return}n.require({group:o.group,target:event.target,message:e("sessions.startConfirm",{name:o.name}),icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-success p-button-sm",rejectLabel:e("sessions.no"),acceptLabel:e("sessions.yesStart"),accept:()=>{i("start")},reject:()=>{}})}const c=R(()=>o.hideActions?!o.hideActions.includes("view"):!0),d=R(()=>o.hideActions?!o.hideActions.includes("apps"):!0);function h(_){n.require({group:o.group,target:_.target,message:e("sessions.restartConfirm",{name:o.name}),icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-info p-button-sm",rejectLabel:e("sessions.no"),acceptLabel:e("sessions.yesRestart"),accept:()=>{i("restart")},reject:()=>{}})}function f(_){n.require({group:o.group,target:_.target,message:e("sessions.stopConfirm",{name:o.name}),icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-warning p-button-sm",rejectLabel:e("sessions.no"),acceptLabel:e("sessions.yesStop"),accept:async()=>{i("stop")},reject:()=>{}})}function g(_){n.require({group:o.group,target:_.target,message:e("sessions.logoutConfirm",{name:o.name}),icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-warning p-button-sm",rejectLabel:e("sessions.no"),acceptLabel:e("sessions.yesLogout"),accept:async()=>{i("logout")},reject:()=>{}})}function b(_){n.require({group:o.group,target:_.target,message:e("sessions.deleteConfirm",{name:o.name}),icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-danger p-button-sm",rejectLabel:e("sessions.no"),acceptLabel:e("sessions.yesDelete"),accept:async()=>{i("delete")},reject:()=>{}})}return(_,m)=>{const y=ne,N=an,$=_i,S=ae("tooltip");return v(),L(te,null,[r("div",al,[u(c)?K((v(),P(y,{key:0,icon:"pi pi-cog",severity:"help",rounded:"",outlined:"",onClick:m[0]||(m[0]=O=>_.$emit("view")),disabled:s.allDisabled},null,8,["disabled"])),[[S,u(e)("sessions.configuration"),void 0,{top:!0}]]):B("",!0),u(d)?K((v(),P(y,{key:1,icon:"pi pi-th-large",severity:"info",rounded:"",outlined:"",onClick:m[1]||(m[1]=O=>_.$emit("apps")),disabled:s.allDisabled},null,8,["disabled"])),[[S,u(e)("sessions.apps"),void 0,{top:!0}]]):B("",!0),K(p(y,{icon:"pi pi-play",severity:"success",rounded:"",outlined:"",onClick:a,loading:s.isStarting,disabled:s.allDisabled},null,8,["loading","disabled"]),[[S,u(e)("sessions.start"),void 0,{top:!0}]]),K(p(y,{icon:"pi pi-replay",severity:"info",rounded:"",outlined:"",onClick:m[2]||(m[2]=O=>h(O)),loading:s.isRestarting,disabled:s.allDisabled},null,8,["loading","disabled"]),[[S,u(e)("sessions.restart"),void 0,{top:!0}]]),K(p(y,{icon:"pi pi-stop",severity:"secondary",rounded:"",outlined:"",onClick:m[3]||(m[3]=O=>f(O)),loading:s.isStopping,disabled:s.allDisabled},null,8,["loading","disabled"]),[[S,u(e)("sessions.stop"),void 0,{top:!0}]]),K(p(y,{icon:"pi pi-sign-out",severity:"warning",rounded:"",outlined:"",onClick:m[4]||(m[4]=O=>g(O)),loading:s.isLoggingOut,disabled:s.allDisabled},null,8,["loading","disabled"]),[[S,u(e)("sessions.logout"),void 0,{top:!0}]]),K(p(y,{icon:"pi pi-trash",severity:"danger",rounded:"",outlined:"",onClick:m[5]||(m[5]=O=>b(O)),loading:s.isRemoving,disabled:s.allDisabled},null,8,["loading","disabled"]),[[S,u(e)("sessions.delete"),void 0,{top:!0}]])]),s.group==="popup"?(v(),P(N,{key:0,group:"popup"})):B("",!0),s.group==="dialog"?(v(),P($,{key:1,group:"dialog"})):B("",!0)],64)}}},rl={class:"flex flex-row gap-2 justify-content-end"},cl={__name:"SessionActions",props:["session","disabled"],emits:["view","apps"],setup(s,{expose:t,emit:e}){const{t:n}=Q(),o=s,i=he(),l=bt(),a=E(!1),c=E(!1),d=E(!1),h=E(!1),f=E(!1),g=R(()=>o.disabled||a.value||c.value||d.value||h.value||f.value);async function b(){const $=o.session;h.value=!0,await l(i.startSession($.server.id,$.name),n("sessions.started"),n("sessions.failedToStartSession"),$.name,$.name).finally(()=>h.value=!1)}async function _(){const $=o.session;f.value=!0,await l(i.restartSession($.server.id,$.name),n("sessions.restarted"),n("sessions.failedToRestartSession"),$.name,$.name).finally(()=>f.value=!1)}async function m(){const $=o.session;a.value=!0,await l(i.stopSession($.server.id,$.name),n("sessions.stopped"),n("sessions.failedToStopSession"),$.name,$.name).finally(()=>a.value=!1)}async function y(){const $=o.session;c.value=!0,await l(i.logoutSession($.server.id,$.name),n("sessions.loggedOut"),n("sessions.failedToLogoutSession"),$.name,$.name).finally(()=>c.value=!1)}async function N(){const $=o.session;d.value=!0,await l(i.deleteSession($.server.id,$.name),n("sessions.deleted"),n("sessions.failedToDeleteSession"),$.name,$.name).finally(()=>d.value=!1)}return t({startSession:b,restartSession:_,stopSession:m,logoutSession:y,deleteSession:N}),($,S)=>{const O=to;return v(),L("div",rl,[p(O,{group:"popup",name:`'${s.session.name}' ${u(n)("sessions.session")}`,onView:S[0]||(S[0]=k=>$.$emit("view",s.session)),onApps:S[1]||(S[1]=k=>$.$emit("apps",s.session)),onStart:b,onRestart:_,onStop:m,onLogout:y,onDelete:N,"is-starting":u(h),"is-restarting":u(f),"is-stopping":u(a),"is-logging-out":u(c),"is-removing":u(d),"all-disabled":u(g),"hide-actions":[],"skip-confirmation":["start"]},null,8,["name","is-starting","is-restarting","is-stopping","is-logging-out","is-removing","all-disabled"])])}}},ul={class:"p-dialog-title flex gap-2 align-items-center"},dl=r("i",{class:"pi pi-whatsapp"},null,-1),fl=r("span",null,"(",-1),pl={class:"ml-1"},hl=r("span",null,")",-1),ml=["disabled"],gl=r("i",{class:"pi pi-refresh"},null,-1),bl=[gl],Rt={__name:"SessionHeader",props:{session:Object,refresh:Boolean},setup(s){const{t}=Q(),e=s,n=he(),{refreshing:o}=on(n),i=R(()=>e.session.server.id?e.session.server:n.getServer(e.session.server));async function l(){await n.refresh()}async function a(c){var d;await navigator.clipboard.writeText(((d=e.session)==null?void 0:d.name)||""),c&&c.preventDefault&&c.preventDefault()}return(c,d)=>{var m;const h=ne,f=Gn,g=wi,b=Pn,_=ae("tooltip");return v(),L("div",ul,[dl,r("span",null,w((m=s.session)==null?void 0:m.name),1),K(p(h,{text:"",tabindex:0,icon:"pi pi-copy",severity:"secondary",onClick:d[0]||(d[0]=y=>a(y))},null,512),[[_,{value:u(t)("sessions.copiedToClipboard")},void 0,{focus:!0,bottom:!0}]]),p(f,{status:s.session.status},null,8,["status"]),r("div",null,[fl,p(g,{connected:i.value.connected},null,8,["connected"]),r("span",pl,w(i.value.name),1),hl]),s.refresh?K((v(),L("button",{key:0,onClick:d[1]||(d[1]=y=>l()),class:"p-link layout-topbar-button",disabled:u(o)},bl,8,ml)),[[_,u(t)("sessions.refresh"),void 0,{top:!0}]]):B("",!0),p(b,{refreshing:u(o)},null,8,["refreshing"])])}}},yl=r("br",null,null,-1),vl={href:"https://waha.devlike.pro/",target:"_blank"},_l=r("br",null,null,-1),wl={href:"https://waha.devlike.pro/docs/how-to/chats/",target:"_blank"},kl={href:"https://waha.devlike.pro/docs/how-to/send-messages/",target:"_blank"},$l={href:"https://waha.devlike.pro/docs/how-to/webhooks/#messageack",target:"_blank"},Sl={href:"https://waha.devlike.pro/docs/how-to/webhooks/#websockets",target:"_blank"},Cl={href:"https://github.com/devlikeapro/waha-hub/tree/main/ui/components/chat",target:"_blank"},Nl={href:"https://waha.devlike.pro/pricing/#tier-pro",target:"_blank"},Ol={__name:"ChatPromo",emits:["close"],setup(s,{emit:t}){const e=t;return(n,o)=>{const i=ki;return v(),P(i,{onClose:o[0]||(o[0]=l=>e("close"))},{default:C(()=>[G(w(n.$t("chat.promo.exampleChatsUI")),1),yl,G(" "+w(n.$t("chat.promo.implementFeatures"))+" ",1),r("a",vl,[r("b",null,w(n.$t("chat.promo.wahaAPI")),1)]),G(" :"),_l,r("ul",null,[r("li",null,[r("a",wl,[r("b",null,w(n.$t("chat.promo.chatsAPI")),1)]),G(" "+w(n.$t("chat.promo.getChatsOverview")),1)]),r("li",null,[r("a",kl,[r("b",null,w(n.$t("chat.promo.sendAPI")),1)]),G(" "+w(n.$t("chat.promo.sendMessages")),1)]),r("li",null,[r("a",$l,[r("b",null,w(n.$t("chat.promo.messageACK")),1)]),G(" "+w(n.$t("chat.promo.getMessageStatus")),1)]),r("li",null,[r("a",Sl,[r("b",null,w(n.$t("chat.promo.websockets")),1)]),G(" "+w(n.$t("chat.promo.getRealTimeMessages")),1)])]),G(" ðŸ‘‰ "),r("a",Cl,[r("b",null,w(n.$t("chat.promo.sourceCodeOnGithub")),1)]),G(" "+w(n.$t("chat.promo.availableFor"))+" ",1),r("a",Nl,w(n.$t("chat.promo.wahaPro")),1),G(" "+w(n.$t("chat.promo.supporters")),1)]),_:1})}}},Tl={class:"flex"},so={__name:"MessageAck",props:{ack:Number},setup(s){const t=s,e={ERROR:-1,PENDING:0,SERVER:1,DEVICE:2,READ:3,PLAYED:4},n=R(()=>{switch(t.ack){case e.ERROR:return"pi-exclamation-circle";case e.PENDING:return"pi-clock";case e.SERVER:return"pi-check";case e.DEVICE:return"pi-check";case e.READ:return"pi-check";case e.PLAYED:return"pi-microphone"}}),o=R(()=>{switch(t.ack){case e.ERROR:return"color: #fb923c";case e.PENDING:return"color: #4a97dd";case e.SERVER:return"";case e.DEVICE:return"";case e.READ:return"color: #4a97dd";case e.PLAYED:return"color: #4a97dd"}});return(i,l)=>(v(),L("div",Tl,[r("i",{class:le(["pi",u(n)]),style:Sn(u(o))},null,6),s.ack===e.READ||s.ack===e.DEVICE?(v(),L("i",{key:0,class:le(["pi",u(n)]),style:Sn([u(o),{"margin-left":"-0.7rem"}])},null,6)):B("",!0)]))}},Ll={class:"flex gap-2"},Il={style:{"margin-top":"-0.75rem"}},Al={style:{"max-width":"100%"}},El={__name:"JsonDataViewer",props:["data"],setup(s){const t=s,{t:e}=Q();async function n(o){await navigator.clipboard.writeText(JSON.stringify(t.data,null,2)),o.preventDefault()}return(o,i)=>{const l=ne,a=gt("vue-json-pretty"),c=ae("tooltip");return v(),L("div",Ll,[r("div",Il,[K(p(l,{rounded:"",text:"",icon:"pi pi-copy",severity:"secondary",onClick:i[0]||(i[0]=d=>n(d))},null,512),[[c,{value:u(e)("ui.copiedToClipboard")},void 0,{focus:!0,bottom:!0}]])]),r("div",Al,[p(a,{data:s.data,deep:2,showLine:!1,showIcon:!0,theme:"dark"},null,8,["data"])])])}}},no=s=>(Je("data-v-509db76d"),s=s(),Qe(),s),Vl={key:0},xl={class:"p-text-secondary my-1",style:{"font-size":"0.9rem"}},Dl={class:"flex"},Bl={class:"flex-1"},jl=["innerHTML"],Ml=["innerHTML"],Ul=no(()=>r("i",{class:"pi pi-image mr-2"},null,-1)),Pl=["innerHTML"],Rl={key:0,class:"flex flex-column justify-content-end",style:{height:"100%"}},ql={class:"flex align-items-center justify-content-end my-1"},Kl={class:"p-text-secondary",style:{"font-size":"0.7rem"}},Fl={class:"ml-2"},Wl={key:1,class:"my-2"},Hl=no(()=>r("hr",null,null,-1)),Gl={__name:"ChatMessage",props:{message:Object},setup(s){const{t}=Q(),e=s,{formatChatTimestamp:n}=Ti(),o=R(()=>{var a;return n((a=e.message)==null?void 0:a.timestamp)}),i=E(!1);function l(){i.value=!i.value}return(a,c)=>{const d=Fn;return v(),L("div",{class:le({"flex justify-content-end":s.message.fromMe})},[p(d,{class:le([u(i)?"chip-100":"chip-70","py-1 px-3"])},{default:C(()=>{var h;return[r("div",null,[!s.message.fromMe&&s.message.participant?(v(),L("div",Vl,[r("div",xl,w(s.message.participant),1)])):B("",!0),r("div",Dl,[r("div",Bl,[s.message.body||s.message.hasMedia?(v(),L("p",{key:0,innerHTML:(h=s.message.body)==null?void 0:h.replace(/\n/g,"<br>")},null,8,jl)):(v(),P(u(ft),{key:1,severity:"warn",class:"mt-2"},{default:C(()=>[r("p",{innerHTML:u(t)("chat.message.not-supported")},null,8,Ml)]),_:1})),s.message.hasMedia?(v(),P(u(ft),{key:2,severity:"info"},{icon:C(()=>[Ul]),default:C(()=>[r("p",{innerHTML:u(t)("chat.message.media")},null,8,Pl)]),_:1})):B("",!0)]),s.message.fromMe?(v(),L("div",Rl,[p(so,{ack:s.message.ack,class:"mt-1 ml-2"},null,8,["ack"])])):B("",!0)]),r("div",ql,[r("div",Kl,w(o.value),1),r("div",Fl,[r("a",{href:"#",onClick:xt(l,["prevent"])},[r("i",{class:le(["pi",(u(i),"pi-code")])},null,2)])])]),u(i)?(v(),L("div",Wl,[Hl,p(El,{data:s.message},null,8,["data"])])):B("",!0)])]}),_:1},8,["class"])],2)}}},Jl=me(Gl,[["__scopeId","data-v-509db76d"]]),Ql={class:"flex flex-column gap-2"},Yl={__name:"ChatMessages",props:{messages:Array},setup(s){const t=s,e=E(null);async function n(){await dt(10),e.value&&(e.value.scrollTop=e.value.scrollHeight)}return se(()=>t.messages,n),(o,i)=>{const l=Jl;return v(),L("div",{class:"my-2 pb-3",style:{width:"100%",height:"100%",overflow:"auto"},ref_key:"scroll",ref:e},[r("div",Ql,[(v(!0),L(te,null,mt(s.messages,a=>(v(),L("div",null,[(v(),P(l,{key:a.key,message:a},null,8,["message"]))]))),256))])],512)}}},zl={class:"flex justify-content-between gap-2 my-2"},Xl={class:"flex gap-2 align-items-center"},Zl={__name:"ChatHeader",props:{chat:Object,me:Object,mePicture:Object,fetching:Boolean,fetch:Function},setup(s){return(t,e)=>{var o,i;const n=Pt;return v(),L("div",zl,[r("div",Xl,[p(ps,{id:s.chat.id,name:s.chat.name,image:s.chat.picture},null,8,["id","name","image"])]),p(n,{onClick:s.fetch,refreshing:s.fetching},null,8,["onClick","refreshing"]),p(ps,{name:((o=s.me)==null?void 0:o.pushName)||((i=s.me)==null?void 0:i.id),image:s.mePicture},null,8,["name","image"])])}}},ea={class:"flex gap-1 mt-1"},Tn=60,ta={__name:"ChatPreview",props:{id:String,name:String,picture:String,message:Object},setup(s){const t=s,e=R(()=>{var o,i,l;return((o=t.message)==null?void 0:o.body)?((l=(i=t.message)==null?void 0:i.body)==null?void 0:l.length)>Tn?t.message.body.slice(0,Tn)+"...":t.message.body:""});return(n,o)=>(v(),L(te,null,[p(ps,{id:t.id,name:t.name,image:t.picture},null,8,["id","name","image"]),r("div",ea,[u(e)&&s.message.fromMe?(v(),P(so,{key:0,ack:s.message.ack,class:"pb-2"},null,8,["ack"])):B("",!0),G(" "+w(u(e)),1)])],64))}},sa={class:"w-full flex align-items-center gap-3 flex-wrap justify-content-between"},na={class:"flex align-items-center gap-2"},oa={class:"flex align-items-center gap-2 ml-auto"},ia=r("i",{class:"pi pi-object-ungroup text-sm"},null,-1),la={class:"font-medium text-sm"},aa={__name:"ChatList",props:{chats:Array,pending:Boolean,merge:{type:Boolean,default:!0}},emits:["clickOnChat","refreshChats","update:merge"],setup(s,{emit:t}){const e=s,n=t;return(o,i)=>{const l=Pt,a=Rn,c=ta,d=ws,h=ks,f=ae("tooltip");return v(),P(h,{value:s.chats,loading:s.pending,style:{width:"100%"},class:"p-datatable--clickable",onRowClick:i[2]||(i[2]=g=>n("clickOnChat",g.data)),scrollable:"",scrollHeight:"100%",rowHover:!0},{default:C(()=>[p(d,null,{header:C(()=>[r("div",sa,[r("div",na,[r("div",null,w(o.$t("chat.last20Chats")),1),p(l,{onClick:i[0]||(i[0]=g=>n("refreshChats")),refreshing:s.pending},null,8,["refreshing"])]),K((v(),L("div",oa,[ia,r("span",la,w(o.$t("chat.mergeToggleLabel")),1),p(a,{modelValue:e.merge,"onUpdate:modelValue":i[1]||(i[1]=g=>n("update:merge",g))},null,8,["modelValue"])])),[[f,o.$t("chat.mergeToggleTooltip"),void 0,{bottom:!0}]])])]),body:C(({data:g})=>[p(c,{id:g.id,name:g.name,picture:g.picture,message:g.lastMessage},null,8,["id","name","picture","message"])]),_:1})]),_:1},8,["value","loading"])}}},ra={class:"flex justify-content-end",style:{width:"100%"}},ca={style:{width:"100%"}},ua={class:"my-auto pl-2"},da={__name:"ChatInputFooter",props:{disabled:Boolean,sendText:Function},setup(s){const t=s,e=E(!1),n=E("");function o(){e.value=!0,t.sendText(n.value).then(()=>{n.value=""}).finally(()=>{e.value=!1})}return(i,l)=>{const a=$s,c=ne;return v(),L("div",ra,[r("div",ca,[p(a,{modelValue:u(n),"onUpdate:modelValue":l[0]||(l[0]=d=>vs(n)?n.value=d:null),rows:"2",cols:"50",onKeydown:ci(xt(o,["ctrl"]),["enter"]),style:{width:"100%"}},null,8,["modelValue","onKeydown"])]),r("div",ua,[p(c,{onClick:o,disabled:s.disabled||!u(n),loading:u(e),label:"",icon:"pi pi-send",class:"p-button-success"},null,8,["disabled","loading"])])])}}},fa={class:"pb-3 flex"},pa={class:"flex align-items-center gap-1"},ha={class:"m-auto pb-2"},ma={class:"text-center"},ga={class:"flex flex-column justify-content-between",style:{height:"100%"}},ba=r("hr",null,null,-1),ya={__name:"SessionChatDialog",props:{visible:{},visibleModifiers:{},session:{},sessionModifiers:{}},emits:["update:visible","update:session"],setup(s){const t=be(s,"visible"),e=be(s,"session");se(t,()=>{t.value||(h.value=null,f.value=[],O())});const n=Mt(),o=he(),i=E(!0),{data:l,pending:a,error:c,refresh:d}=ys(`session-${e.value.name}-chats`,async()=>await o.getChatsOverview(e.value.server.id,e.value.name,20,void 0,i.value)),h=E(null),f=E([]),g=E(null);se(h,()=>{h.value&&k()});const b=E(!1),_=E(20),m=E(0);let y=null;const N=E(st.DISCONNECTED);function $(){const V=o.getServer(e.value.server.id),H=["message.any"];y=new ri(V,H,e.value.name),y.connect(),N.value=st.CONNECTING,y.on("open",()=>{N.value=st.CONNECTED}),y.on("close",()=>{N.value=st.DISCONNECTED}),y.on("error",()=>{N.value=st.ERROR}),y.on("event",S)}async function S(V){var q;await dt(100);const H=(q=h.value)==null?void 0:q.id;H&&((V.payload.from===H||V.payload.to===H)&&k(),d())}function O(){y==null||y.stop(),y=null,N.value=st.DISCONNECTED}function k(){b.value=!0,o.getChatsMessages(e.value.server.id,e.value.name,h.value.id,_.value,m.value,!1,i.value).then(V=>{f.value=V.reverse()}).finally(()=>{b.value=!1})}function A(V){i.value=V,d()}se(e,()=>{var V,H;(H=(V=e.value)==null?void 0:V.me)!=null&&H.id&&(i.value=!0,O(),$(),d(),o.getProfilePicture(e.value.server.id,e.value.name,e.value.me.id).then(q=>{g.value=q.profilePictureURL}))});function D(V){h.value=V}async function I(V){if(h.value){try{await o.readChatMessages(e.value.server.id,e.value.name,h.value.id)}catch(H){console.warn("Failed to mark chat as read before sending text",H),n.add({severity:"warn",summary:$t("chat.readFailedTitle"),detail:$t("chat.readFailedDescription"),life:4e3})}await o.sendText(e.value.server.id,e.value.name,h.value.id,V),await dt(100)}}const F=E(!1);return(V,H)=>{const q=Rt,J=rn,we=Ol,Ee=$i,Te=Si,Tt=vt;return v(),P(Tt,{visible:t.value,"onUpdate:visible":H[2]||(H[2]=Ve=>t.value=Ve),modal:!0,maximizable:"",style:{width:"90%",height:"90%"}},{header:C(()=>[r("div",null,[p(q,{session:e.value},null,8,["session"])])]),default:C(()=>[r("div",fa,[r("div",pa,[e.value.me?(v(),P(J,{key:0,session:e.value,image:g.value},null,8,["session","image"])):B("",!0),p(yi,{status:N.value},null,8,["status"])]),r("div",ha,[r("div",ma,[r("a",{href:"#",onClick:H[0]||(H[0]=Ve=>F.value=!0)},[r("b",null,w(V.$t("chat.aboutChatUI")),1)])]),F.value?(v(),P(we,{key:0,style:{"max-width":"50em"},onClose:H[1]||(H[1]=Ve=>F.value=!1)})):B("",!0)])]),p(Te,{style:{"max-height":"90%"}},{default:C(()=>[p(Ee,{size:30,class:"flex items-center justify-center"},{default:C(()=>[p(aa,{chats:u(l),pending:u(a),merge:i.value,onClickOnChat:D,onRefreshChats:u(d),"onUpdate:merge":A},null,8,["chats","pending","merge","onRefreshChats"])]),_:1}),p(Ee,{size:70,class:"flex flex-column gap-2 justify-content-between p-2"},{default:C(()=>[r("div",ga,[h.value?(v(),L(te,{key:0},[p(Zl,{chat:h.value,me:e.value.me,mePicture:g.value,fetch:k,fetching:b.value},null,8,["chat","me","mePicture","fetching"]),ba,p(Yl,{messages:f.value},null,8,["messages"]),p(da,{disabled:!h.value||b.value,sendText:I},null,8,["disabled"])],64)):B("",!0)])]),_:1})]),_:1})]),_:1},8,["visible"])}}},va={class:"-mt-4 p-0 line-height-3 block",style:{"font-family":"monaco, Consolas, 'Lucida Console', monospace"}},_a={__name:"CodeHighlight",props:["invalid"],setup(s){const t=s,e=R(()=>t.invalid?"p-invalid p-component p-inputtext":"");return(n,o)=>(v(),L("pre",{class:le(["border-round surface-ground text-900 p-5 overflow-auto",e.value])},[G("        "),r("code",va,[ui(n.$slots,"default")])],2))}},wa={class:"h-full flex flex-column"},ka={class:"flex justify-content-center align-items-center"},$a={class:"m-0"},Sa={class:"flex flex-column justify-content-between h-full"},Ca={class:"flex flex-column gap-2"},Na={class:"flex gap-2"},Oa={class:"text-center"},Ta={class:"mb-2"},La={class:"text-center mt-2"},Ia={class:"flex flex-column h-full"},Aa={class:"flex justify-content-center align-items-center"},Ea={class:"m-0"},Va={__name:"SessionRequestResponse",props:["session"],setup(s){const{t}=Q(),e=he(),n=s,o=E(null),i=E("POST"),l=E("/api/sendText"),a=E(""),c=E(!1),d=E(!1);function h(N){return JSON.stringify(N,null,2)}function f(N){try{return JSON.parse(N)}catch{return N}}const g=R(()=>({method:i.value,uri:l.value,params:void 0,body:f(a.value)})),b=["GET","POST","PUT","DELETE","PATCH"];async function _(N){await navigator.clipboard.writeText(o.value),N.preventDefault()}async function m(N){await navigator.clipboard.writeText(h(g.value)),N.preventDefault()}async function y(){try{d.value=!1,c.value=!0;const N=await e.callServerAPI(n.session.server.id,g.value);o.value=h(N)}catch(N){d.value=!0,N.response?o.value=h(N.response.data):o.value=h(N)}finally{c.value=!1}}return _s(()=>{const N={chatId:"11111111111@c.us",text:"Hi there!",session:n.session.name};a.value=h(N),o.value="..."}),(N,$)=>{const S=ne,O=yt,k=Ae,A=$s,D=Qn,I=_a,F=ae("tooltip");return v(),L(te,null,[r("div",null,[r("div",wa,[r("div",ka,[r("h5",$a,w(u(t)("sessions.request")),1),K(p(S,{rounded:"",text:"",tabindex:0,icon:"pi pi-copy",onClick:$[0]||($[0]=V=>m(V))},null,512),[[F,{value:u(t)("sessions.copiedToClipboard")},void 0,{focus:!0,bottom:!0}]])]),r("div",Sa,[r("div",Ca,[r("div",Na,[p(O,{modelValue:i.value,"onUpdate:modelValue":$[1]||($[1]=V=>i.value=V),options:b},null,8,["modelValue"]),p(k,{type:"text",class:"w-full",modelValue:l.value,"onUpdate:modelValue":$[2]||($[2]=V=>l.value=V),placeholder:u(t)("sessions.apiEndpoint")},null,8,["modelValue","placeholder"])]),r("div",Oa,[r("div",Ta,w(u(t)("sessions.body")),1),p(A,{modelValue:a.value,"onUpdate:modelValue":$[3]||($[3]=V=>a.value=V),rows:"8",class:"w-full",placeholder:u(t)("sessions.request")},null,8,["modelValue","placeholder"])])]),r("div",La,[p(S,{onClick:y,loading:c.value,label:u(t)("sessions.send"),icon:"pi pi-send","icon-pos":"right"},null,8,["loading","label"])])])])]),p(D),r("div",null,[r("div",Ia,[r("div",Aa,[r("h5",Ea,w(u(t)("sessions.response")),1),K(p(S,{rounded:"",text:"",tabindex:0,icon:"pi pi-copy",onClick:$[4]||($[4]=V=>_(V))},null,512),[[F,{value:u(t)("sessions.copiedToClipboard")},void 0,{focus:!0,bottom:!0}]])]),p(I,{class:"m-0 p-4 pretty",invalid:d.value},{default:C(()=>[G(w(o.value),1)]),_:1},8,["invalid"])])])],64)}}},xa=me(Va,[["__scopeId","data-v-1e461245"]]),Da={class:"grid pt-4"},Ba={class:"col-12 sm:col-6 h-full"},ja={class:"grid"},Ma={class:"col-12"},Ua={class:""},Pa={class:"flex justify-content-center align-items-center"},Ra={class:"col-12"},qa={class:""},Ka={class:"flex justify-content-center align-items-center"},Fa=r("h5",{class:"m-0"},"Screenshot",-1),Wa={class:"m-auto w-full"},Ha={class:"col-12 sm:col-6 h-full card"},Ga={__name:"SessionControl",props:["session"],setup(s){const t=E(null),e=()=>{t.value.refresh()};return(n,o)=>{const i=rn,l=Pt,a=eo,c=xa;return v(),L("div",Da,[r("div",Ba,[r("div",ja,[r("div",Ma,[r("div",Ua,[r("div",Pa,[s.session.me?(v(),P(i,{key:0,session:s.session},null,8,["session"])):B("",!0)])])]),r("div",Ra,[r("div",qa,[r("div",Ka,[Fa,p(l,{onClick:e})]),r("div",Wa,[p(a,{ref_key:"screenshot",ref:t,session:s.session},null,8,["session"])])])])])]),r("div",Ha,[p(c,{session:s.session},null,8,["session"])])])}}},Ja={__name:"SessionControlDialog",props:{visible:{},visibleModifiers:{},session:{},sessionModifiers:{}},emits:["update:visible","update:session"],setup(s){const t=be(s,"visible"),e=be(s,"session");return Mt(),(n,o)=>{const i=Rt,l=Ga,a=vt;return v(),P(a,{visible:t.value,"onUpdate:visible":o[0]||(o[0]=c=>t.value=c),modal:!0,maximizable:"",style:{"max-width":"100%"}},{header:C(()=>[p(i,{session:e.value},null,8,["session"])]),default:C(()=>[p(l,{session:e.value},null,8,["session"])]),_:1},8,["visible"])}}},Qa={class:"linked-device-icon"},Ya=["src","alt"],za={key:1,class:"linked-device-placeholder"},Xa={class:"linked-device-text"},Za={class:"linked-device-title"},er={class:"linked-device-status"},tr={__name:"LinkedDevice",props:{deviceName:String,browserName:String},setup(s){var g;const t=s,{t:e}=Q(),o=((g=di().app)==null?void 0:g.baseURL)||"/",i={Chrome:`${o}icons/browsers/chrome.svg`,Firefox:`${o}icons/browsers/firefox.svg`,IE:`${o}icons/browsers/ie.svg`,Opera:`${o}icons/browsers/opera.svg`,Safari:`${o}icons/browsers/safari.svg`},l=R(()=>t.browserName&&Object.prototype.hasOwnProperty.call(i,t.browserName)),a=R(()=>!t.browserName||!l),c=R(()=>t.deviceName||e("sessions.linkedDeviceGenericDevice")),d=R(()=>a.value?c.value:l.value?`${t.browserName} (${c.value})`:`${t.browserName} (${c.value})`),h=R(()=>!l.value),f=R(()=>l.value?i[t.browserName]:null);return(b,_)=>(v(),L("div",{class:le(["linked-device-card",{muted:h.value}])},[r("div",Qa,[f.value?(v(),L("img",{key:0,src:f.value,alt:t.browserName},null,8,Ya)):(v(),L("div",za))]),r("div",Xa,[r("div",Za,w(d.value),1),r("div",er,w(u(e)("sessions.linkedDeviceActive")),1)])],2))}},sr=me(tr,[["__scopeId","data-v-aa0097ef"]]),nr={class:"card p-fluid"},or={class:"flex flex-grow-1 justify-content-center"},ir={class:"flex flex-grow-1 justify-content-center"},oo={__name:"KeyValueTable",props:Ut(["keyColumn","keyColumnName","prefix","entityName"],{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(s){const{t}=Q(),e=be(s,"modelValue"),n=s,o=E([]),i=d=>{let{newData:h,index:f}=d;e.value[f]=h},l=d=>{let{data:h,newValue:f,field:g}=d;h[g]=f};function a(){const d=e.value.length+1,h=`${n.prefix}${d}`;e.value.unshift({[n.keyColumn]:h,value:"123"})}function c(d){e.value.splice(d,1)}return(d,h)=>{const f=Ae,g=ws,b=ne,_=ks,m=ae("tooltip");return v(),L("div",nr,[p(_,{editingRows:o.value,"onUpdate:editingRows":h[0]||(h[0]=y=>o.value=y),value:e.value,editMode:"cell",dataKey:n.keyColumn,onRowEditSave:i,onCellEditComplete:l,pt:{table:{style:"min-width: 50rem"},column:{bodycell:({state:y})=>({style:y.d_editing&&"padding-top: 0.6rem; padding-bottom: 0.6rem"})}},resizableColumns:""},{default:C(()=>[p(g,{field:n.keyColumn,header:n.keyColumnName,style:{width:"40%"}},{editor:C(({data:y,field:N})=>[p(f,{modelValue:y[N],"onUpdate:modelValue":$=>y[N]=$},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["field","header"]),p(g,{style:{width:"40%"},field:"value",header:u(t)("common.value")},{editor:C(({data:y,field:N})=>[p(f,{modelValue:y[N],"onUpdate:modelValue":$=>y[N]=$},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),p(g,{style:{"min-width":"1rem"}},{header:C(()=>[r("div",or,[K(p(b,{label:s.entityName,text:"",icon:"pi pi-plus",severity:"success",onClick:a},null,8,["label"]),[[m,`${u(t)("common.add")} ${s.entityName}`,void 0,{top:!0}]])])]),body:C(({index:y})=>[r("div",ir,[K(p(b,{label:"",rounded:"",text:"",style:{height:"2rem",width:"2rem"},icon:"pi pi-trash",severity:"warning",onClick:N=>c(y)},null,8,["onClick"]),[[m,u(t)("common.delete"),void 0,{top:!0}]])])]),_:1})]),_:1},8,["editingRows","value","dataKey","pt"])])}}},lr={class:"flex justify-content-between align-items-center w-full"},ar={class:"field"},rr={for:"url"},cr={class:"field mb-4"},ur={for:"events"},dr={class:"font-bold mb-2"},fr={class:"flex gap-3"},pr={class:"field",style:{width:"10em"}},hr={for:"retries-attempts"},mr=r("span",{class:"pi pi-plus"},null,-1),gr=r("span",{class:"pi pi-minus"},null,-1),br={class:"field",style:{width:"10em"}},yr={for:"retries-delay-seconds"},vr=r("span",{class:"pi pi-plus"},null,-1),_r=r("span",{class:"pi pi-minus"},null,-1),wr={class:"field"},kr={for:"retries-delay-policy"},$r={class:"pi pi-info-circle"},Sr={style:{"text-transform":"capitalize"}},Cr={style:{"text-transform":"capitalize"}},Nr={class:"field"},Or={for:"hmac"},Tr={class:"field"},Lr={class:"field flex justify-content-between align-items-center"},Ir={for:"hmac"},Ar={__name:"SessionWebhook",props:Ut({disabled:Boolean,index:Number},{webhook:{},webhookModifiers:{}}),emits:["update:webhook"],setup(s){const{t}=Q(),e=be(s,"webhook"),n=s,o=["constant","linear","exponential"],i=R(()=>{var b;const c=((b=e.value.retries)==null?void 0:b.delaySeconds)??2,d=4,h=Array.from({length:d},(_,m)=>c),f=Array.from({length:d},(_,m)=>c*(m+1)),g=Array.from({length:d},(_,m)=>c*2**m);return[t("sessions.webhooks.constant",{values:h.join(", ")}),t("sessions.webhooks.linear",{values:f.join(", ")}),t("sessions.webhooks.exponential",{values:g.join(", ")})].join(`
`)}),l=vi,a=E(e.value.customHeaders&&e.value.customHeaders.length>0);return se(a,(c,d)=>{if(d&&!c){e.value.customHeaders=null;return}!d&&c&&(e.value.customHeaders=[{name:"X-Header-1",value:"123"}])}),(c,d)=>{const h=ne,f=Ae,g=ln,b=Yn,_=yt,m=gt("font-awesome-icon"),y=_t,N=oo,$=Ss,S=Cs,O=ae("tooltip");return v(),P(S,{activeIndex:0},{default:C(()=>[p($,null,{header:C(()=>[r("div",lr,[r("div",null,w(u(t)("sessions.webhooks.webhookNumber",{number:n.index+1})),1),r("div",null,[K(p(h,{label:"",text:"",rounded:"",style:{height:"2rem",width:"2rem"},icon:"pi pi-trash",severity:"warning",onClick:d[0]||(d[0]=k=>c.$emit("remove"))},null,512),[[O,u(t)("sessions.webhooks.deleteWebhook"),void 0,{top:!0}]])])])]),default:C(()=>[r("div",ar,[r("label",rr,w(u(t)("sessions.webhooks.url")),1),p(f,{id:"url",modelValue:e.value.url,"onUpdate:modelValue":d[1]||(d[1]=k=>e.value.url=k),modelModifiers:{trim:!0},required:"true",disabled:s.disabled},null,8,["modelValue","disabled"])]),r("div",cr,[r("label",ur,w(u(t)("sessions.webhooks.events")),1),p(g,{id:"events",modelValue:e.value.events,"onUpdate:modelValue":d[2]||(d[2]=k=>e.value.events=k),options:u(l),placeholder:u(t)("sessions.webhooks.selectEvents"),"max-selected-labels":1,selectedItemsLabel:u(t)("sessions.webhooks.eventsSelected"),disabled:s.disabled},null,8,["modelValue","options","placeholder","selectedItemsLabel","disabled"]),r("ul",null,[(v(!0),L(te,null,mt(e.value.events,k=>(v(),L("li",{key:k},w(k),1))),128))])]),r("div",null,[r("div",dr,w(u(t)("sessions.webhooks.retries")),1),r("div",fr,[r("div",pr,[r("label",hr,w(u(t)("sessions.webhooks.attempts")),1),p(b,{modelValue:e.value.retries.attempts,"onUpdate:modelValue":d[3]||(d[3]=k=>e.value.retries.attempts=k),inputId:"retries-delay-attempts",showButtons:"",buttonLayout:"horizontal",min:1,step:1,disabled:s.disabled},{incrementbuttonicon:C(()=>[mr]),decrementbuttonicon:C(()=>[gr]),_:1},8,["modelValue","disabled"])]),r("div",br,[r("label",yr,w(u(t)("sessions.webhooks.delaySeconds")),1),p(b,{modelValue:e.value.retries.delaySeconds,"onUpdate:modelValue":d[4]||(d[4]=k=>e.value.retries.delaySeconds=k),inputId:"retries-delay-seconds",showButtons:"",buttonLayout:"horizontal",min:1,step:1,disabled:s.disabled},{incrementbuttonicon:C(()=>[vr]),decrementbuttonicon:C(()=>[_r]),_:1},8,["modelValue","disabled"])]),r("div",wr,[r("label",kr,[G(w(u(t)("sessions.webhooks.retryPolicy"))+" Â  ",1),K(r("i",$r,null,512),[[O,u(i)]])]),p(_,{id:"retries-delay-policy",modelValue:e.value.retries.policy,"onUpdate:modelValue":d[5]||(d[5]=k=>e.value.retries.policy=k),options:o,placeholder:u(t)("sessions.webhooks.selectRetryPolicy"),"max-selected-labels":1,disabled:s.disabled},{option:C(k=>[r("span",Sr,w(k.option),1)]),value:C(k=>[r("span",Cr,w(k.value),1)]),_:1},8,["modelValue","placeholder","disabled"])])])]),r("div",Nr,[r("label",Or,w(u(t)("sessions.webhooks.hmacKey")),1),p(f,{id:"hmac",modelValue:e.value.hmac.key,"onUpdate:modelValue":d[6]||(d[6]=k=>e.value.hmac.key=k),modelModifiers:{trim:!0},disabled:s.disabled},null,8,["modelValue","disabled"])]),r("div",Tr,[r("div",Lr,[r("div",null,[r("label",Ir,w(u(t)("sessions.webhooks.customHeaders")),1)]),p(y,{modelValue:a.value,"onUpdate:modelValue":d[7]||(d[7]=k=>a.value=k),id:"customHeaders",onLabel:u(t)("sessions.webhooks.headersOn"),offLabel:u(t)("sessions.webhooks.headersOff")},{icon:C(()=>[p(m,{icon:"fa-solid fa-fingerprint",class:"mr-2"})]),_:1},8,["modelValue","onLabel","offLabel"])]),a.value?(v(),P(N,{key:0,modelValue:e.value.customHeaders,"onUpdate:modelValue":d[8]||(d[8]=k=>e.value.customHeaders=k),"entity-name":"Header","key-column":"name","key-column-name":"Header",prefix:"X-Header-"},null,8,["modelValue"])):B("",!0)])]),_:1})]),_:1})}}},Er={class:"flex flex-column gap-2"},Vr={class:"flex justify-content-between align-items-center w-full"},xr={class:"pr-2"},Dr={key:0,class:"text-300 text-center"},Br={__name:"SessionWebhooksField",props:Ut({disabled:Boolean},{webhooks:{},webhooksModifiers:{}}),emits:["update:webhooks"],setup(s){const{t}=Q(),e=be(s,"webhooks");function n(){const i={url:"https://httpbin.org/post",events:["session.status","message"],hmac:{key:null},retries:{delaySeconds:2,attempts:15,policy:"exponential"},customHeaders:null};e.value.push(i)}function o(i){e.value.splice(i,1)}return(i,l)=>{const a=ne,c=Ar,d=ae("tooltip");return v(),L("div",Er,[r("div",Vr,[r("h5",null,w(u(t)("sessions.webhooks.title")),1),r("div",xr,[K(p(a,{label:u(t)("sessions.webhooks.webhook"),text:"",icon:"pi pi-plus",severity:"success",onClick:n},null,8,["label"]),[[d,u(t)("sessions.webhooks.addWebhook"),void 0,{top:!0}]])])]),e.value.length===0?(v(),L("div",Dr,w(u(t)("sessions.webhooks.noWebhooksConfigured")),1)):(v(!0),L(te,{key:1},mt(e.value,(h,f)=>(v(),P(c,{webhook:e.value[f],"onUpdate:webhook":g=>e.value[f]=g,index:f,total:e.value.length,onRemove:g=>o(f),disabled:s.disabled},null,8,["webhook","onUpdate:webhook","index","total","onRemove","disabled"]))),256))])}}},jr=r("i",{class:"pi pi-whatsapp"},null,-1),Mr={class:"mb-2"},Ur={class:"mb-3"},Pr={class:"field"},Rr={for:"server"},qr={key:0,class:"p-invalid"},Kr={class:"field"},Fr={for:"name"},Wr={class:"mb-4"},Hr={class:"field flex justify-content-between align-items-center"},Gr={key:0,class:"card mb-4"},Jr={key:0,class:"mb-3"},Qr=r("br",null,null,-1),Yr={class:"flex gap-3"},zr={class:"field w-full"},Xr={for:"client-device-name"},Zr={class:"pi pi-info-circle"},ec={class:"field w-full"},tc={for:"client-browser-name"},sc={class:"pi pi-info-circle"},nc={class:"mt-3"},oc={class:"text-color-secondary"},ic={class:"mt-2"},lc={key:0,class:"mb-4"},ac={class:"mb-3"},rc={class:"flex flex-column gap-2"},cc={href:"https://waha.devlike.pro/docs/engines/noweb",target:"_blank"},uc={class:"flex gap-2"},dc={key:1,class:"mb-4"},fc={class:"mb-3"},pc={class:"flex flex-column gap-2"},hc={class:"flex gap-2 flex-wrap"},mc={key:2,class:"mb-4"},gc={class:"mb-3"},bc={class:"flex flex-column gap-2"},yc={class:"pi pi-info-circle"},vc={class:"field mt-4"},_c={class:"field flex justify-content-between align-items-center"},wc={for:"chats-filter"},kc={class:"pi pi-info-circle"},$c={key:0,class:"card mb-4"},Sc={class:"flex gap-2"},Cc={class:"field flex justify-content-between align-items-center"},Nc={for:"proxy"},Oc={key:0,class:"card mb-4"},Tc={class:"field"},Lc={for:"proxy-server"},Ic={key:0,class:"p-invalid"},Ac={class:"flex gap-3"},Ec={class:"field w-full"},Vc={for:"proxy-username"},xc={class:"field w-full"},Dc={for:"proxy-password"},Bc={class:"field flex justify-content-between align-items-center"},jc={for:"debug"},Mc={class:"w-full flex flex-column gap-2"},Uc={class:"flex justify-content-end"},Pc={__name:"SessionDialog",props:Ut({mode:String},{visible:{},visibleModifiers:{},session:{},sessionModifiers:{}}),emits:["update:visible","update:session"],setup(s){var Ve,Ht,Gt,Jt,Qt,Yt,zt,Xt,Zt,es,ts,ss;const t=Mt(),{t:e}=Q(),n=be(s,"visible"),o=be(s,"session"),i=s,l=R(()=>i.mode==="new"),a=R(()=>i.mode==="update"),c=R(()=>a.value),d=bt(),h=he(),f=R(()=>h.getServer(o.value.server)),g=R(()=>{var x,T;return((T=(x=f.value)==null?void 0:x.version)==null?void 0:T.engine)==="GOWS"}),b=R(()=>{var x,T;return((T=(x=f.value)==null?void 0:x.version)==null?void 0:T.engine)==="NOWEB"}),_=R(()=>{var x,T;return((T=(x=f.value)==null?void 0:x.version)==null?void 0:T.engine)==="WEBJS"}),m=E([]),y=["Mac OS","Windows","Android","Ubuntu"],N=["Chrome","Firefox","IE","Opera","Safari"],$=E(!!((Ht=(Ve=o.value.config)==null?void 0:Ve.proxy)!=null&&Ht.server)),S=E(((Gt=o.value.config)==null?void 0:Gt.client)!=null),O=E(((Jt=o.value.config)==null?void 0:Jt.ignore)!=null),k=E(!((Yt=(Qt=o.value.config)==null?void 0:Qt.ignore)!=null&&Yt.status)),A=E(!((Xt=(zt=o.value.config)==null?void 0:zt.ignore)!=null&&Xt.groups)),D=E(!((es=(Zt=o.value.config)==null?void 0:Zt.ignore)!=null&&es.channels)),I=E(!((ss=(ts=o.value.config)==null?void 0:ts.ignore)!=null&&ss.broadcast));se(o,async(x,T)=>{var M,ke,xe,De,oe,X,Re,Ze,de,Be,et,tt,qe;$.value=!!((ke=(M=x==null?void 0:x.config)==null?void 0:M.proxy)!=null&&ke.server),S.value=((xe=x==null?void 0:x.config)==null?void 0:xe.client)!=null,m.value=Di((De=x.config)==null?void 0:De.metadata),O.value=((oe=x==null?void 0:x.config)==null?void 0:oe.ignore)!=null,k.value=!((Re=(X=x==null?void 0:x.config)==null?void 0:X.ignore)!=null&&Re.status),A.value=!((de=(Ze=x==null?void 0:x.config)==null?void 0:Ze.ignore)!=null&&de.groups),D.value=!((et=(Be=x==null?void 0:x.config)==null?void 0:Be.ignore)!=null&&et.channels),I.value=!((qe=(tt=x==null?void 0:x.config)==null?void 0:tt.ignore)!=null&&qe.broadcast),x!=null&&x.config&&g.value&&(x.config.gows||(x.config.gows={storage:{}}),x.config.gows.storage||(x.config.gows.storage={}))}),se(S,x=>{var T;(T=o.value)!=null&&T.config&&(x&&!o.value.config.client&&(o.value.config.client={}),x||(o.value.config.client=null))});const F=E(!1),V=E(!1),H=R(()=>{const x=pe.cloneDeep(o.value.config);return $.value||(x.proxy=void 0),S.value?x.client||(x.client={}):x.client=null,O.value?x.ignore={status:!k.value,groups:!A.value,channels:!D.value,broadcast:!I.value}:x.ignore=void 0,x.metadata=Bi(m.value),x}),q=R(()=>{const x={...H.value};return b.value||delete x.noweb,_.value||delete x.webjs,g.value||delete x.gows,{name:o.value.name,config:x}});async function J(){F.value=!0;try{V.value=!0;const x=pe.cloneDeep(q.value);await d(h.updateSession(o.value.server,o.value.name,x.config),void 0,e("sessions.failedToUpdateSession")),t.add({severity:"success",summary:e("sessions.updated"),detail:o.value.name,life:3e3})}finally{V.value=!1}o.value=void 0,Ee()}async function we(x){F.value=!0;try{V.value=!0;const T=pe.cloneDeep(q.value);T.start=x;const M=await d(h.createSession(o.value.server,T),void 0,e("sessions.failedToStartSession")),ke=e(x?"sessions.started":"sessions.created");t.add({severity:"success",summary:ke,detail:M.name,life:3e3})}finally{V.value=!1}o.value=void 0,Ee()}function Ee(){F.value=!1,n.value=!1}const Te=R(()=>o.value.status==="STOPPED");async function Tt(x){await navigator.clipboard.writeText(JSON.stringify(q.value,null,2)),x.preventDefault()}return(x,T)=>{const M=Rt,ke=ft,xe=Jn,De=Ae,oe=gt("font-awesome-icon"),X=_t,Re=yt,Ze=sr,de=Ss,Be=Cs,et=oo,tt=Br,qe=zn,Ke=ne,Rs=vt,ce=ae("tooltip");return v(),P(Rs,{visible:n.value,"onUpdate:visible":T[28]||(T[28]=U=>n.value=U),modal:!0,class:"p-fluid",maximizable:""},fi({footer:C(()=>[r("div",Mc,[r("div",null,[a.value&&!Te.value?(v(),P(ke,{key:0,severity:"warn"},{default:C(()=>[G(w(u(e)("sessions.sessionRestartWarning",{status:o.value.status})),1)]),_:1})):B("",!0)]),r("div",Uc,[p(Ke,{label:u(e)("common.cancel"),icon:"pi pi-times",text:"",onClick:Ee,severity:"secondary"},null,8,["label"]),K(p(Ke,{label:u(e)("sessions.copy"),text:"",tabindex:0,icon:"pi pi-copy",severity:"secondary",onClick:T[25]||(T[25]=U=>Tt(U))},null,8,["label"]),[[ce,{value:u(e)("sessions.copiedToClipboard")},void 0,{focus:!0,bottom:!0}]]),a.value?B("",!0):(v(),P(Ke,{key:0,label:u(e)("sessions.create"),icon:"pi pi-plus",text:"",onClick:T[26]||(T[26]=U=>we(!1)),loading:V.value},null,8,["label","loading"])),a.value?B("",!0):(v(),P(Ke,{key:1,label:u(e)("sessions.createAndStart"),icon:"pi pi-play",text:"",onClick:T[27]||(T[27]=U=>we(!0)),loading:V.value},null,8,["label","loading"])),a.value?(v(),P(Ke,{key:2,label:u(e)("sessions.update"),icon:"pi pi-save",text:"",onClick:J,loading:V.value},null,8,["label","loading"])):B("",!0)])])]),default:C(()=>[r("div",Mr,[a.value?(v(),P(ke,{key:0,severity:"info"},{default:C(()=>[G(w(u(e)("sessions.changeServerOrNameInfo")),1)]),_:1})):B("",!0)]),r("div",Ur,[r("h5",null,w(u(e)("sessions.sessionSection")),1)]),r("div",Pr,[r("label",Rr,w(u(e)("sessions.server")),1),p(xe,{placeholder:u(e)("sessions.selectServer"),modelValue:o.value.server,"onUpdate:modelValue":T[0]||(T[0]=U=>o.value.server=U),showClear:!1,required:!0,invalid:F.value&&!o.value.server,disabled:c.value},null,8,["placeholder","modelValue","invalid","disabled"]),F.value&&!o.value.server?(v(),L("small",qr,w(u(e)("sessions.serverRequired")),1)):B("",!0)]),r("div",Kr,[r("label",Fr,w(u(e)("sessions.nameOptional")),1),p(De,{id:"name",modelValue:o.value.name,"onUpdate:modelValue":T[1]||(T[1]=U=>o.value.name=U),modelModifiers:{trim:!0},required:"false",autofocus:"",placeholder:u(e)("sessions.sessionIdPlaceholder"),disabled:!l.value},null,8,["modelValue","placeholder","disabled"])]),r("div",Wr,[r("div",Hr,[p(X,{modelValue:S.value,"onUpdate:modelValue":T[2]||(T[2]=U=>S.value=U),id:"client",onLabel:u(e)("sessions.clientOn"),offLabel:u(e)("sessions.clientOff")},{icon:C(()=>[p(oe,{icon:"fa-solid fa-desktop",class:"mr-2"})]),_:1},8,["modelValue","onLabel","offLabel"])]),S.value?(v(),L("div",Gr,[g.value?(v(),L("div",Jr,[p(ke,{severity:"warn"},{default:C(()=>[G(w(u(e)("sessions.gowsClientConfigWarning.1"))+" ",1),Qr,G(" "+w(u(e)("sessions.gowsClientConfigWarning.2")),1)]),_:1})])):B("",!0),r("div",Yr,[r("div",zr,[r("label",Xr,[G(w(u(e)("sessions.clientDeviceName"))+"Â  ",1),K(r("i",Zr,null,512),[[ce,u(e)("sessions.clientDeviceNameTooltip")]])]),p(Re,{id:"client-device-name",modelValue:o.value.config.client.deviceName,"onUpdate:modelValue":T[3]||(T[3]=U=>o.value.config.client.deviceName=U),editable:"",options:y,placeholder:u(e)("sessions.clientDeviceNamePlaceholder"),class:"w-full"},null,8,["modelValue","placeholder"])]),r("div",ec,[r("label",tc,[G(w(u(e)("sessions.clientBrowserName"))+"Â  ",1),K(r("i",sc,null,512),[[ce,u(e)("sessions.clientBrowserNameTooltip")]])]),p(Re,{id:"client-browser-name",modelValue:o.value.config.client.browserName,"onUpdate:modelValue":T[4]||(T[4]=U=>o.value.config.client.browserName=U),editable:"",options:N,placeholder:u(e)("sessions.clientBrowserNamePlaceholder"),class:"w-full"},null,8,["modelValue","placeholder"])])]),r("div",nc,[r("small",oc,[G(w(u(e)("sessions.linkedDevicePreviewLabelPrefix"))+" ",1),r("b",null,w(u(e)("sessions.linkedDevicePreviewLabelLinkedDevices")),1)])]),r("div",ic,[p(Ze,{"device-name":o.value.config.client.deviceName,"browser-name":o.value.config.client.browserName},null,8,["device-name","browser-name"])])])):B("",!0)]),b.value?(v(),L("div",lc,[r("div",ac,[r("h5",null,"ðŸ­ "+w(u(e)("sessions.engineSettings")),1)]),p(Be,{activeIndex:0},{default:C(()=>[p(de,{header:"NOWEB"},{default:C(()=>[r("div",rc,[r("div",null,[r("a",cc,w(u(e)("sessions.readMoreAboutNOWEB")),1)]),r("div",null,[K((v(),P(X,{modelValue:o.value.config.noweb.markOnline,"onUpdate:modelValue":T[5]||(T[5]=U=>o.value.config.noweb.markOnline=U),onLabel:u(e)("sessions.presenceOnline"),offLabel:u(e)("sessions.presenceOffline")},{icon:C(()=>[p(oe,{icon:"fa-solid fa-sync",class:"mr-2"})]),_:1},8,["modelValue","onLabel","offLabel"])),[[ce,u(e)("sessions.presenceTooltip")]])]),r("div",uc,[r("div",null,[K((v(),P(X,{modelValue:o.value.config.noweb.store.enabled,"onUpdate:modelValue":T[6]||(T[6]=U=>o.value.config.noweb.store.enabled=U),onLabel:u(e)("sessions.storeEnabled"),offLabel:u(e)("sessions.storeDisabled")},{icon:C(()=>[p(oe,{icon:"fa-solid fa-folder",class:"mr-2"})]),_:1},8,["modelValue","onLabel","offLabel"])),[[ce,u(e)("sessions.storeTooltip")]])]),r("div",null,[K((v(),P(X,{modelValue:o.value.config.noweb.store.fullSync,"onUpdate:modelValue":T[7]||(T[7]=U=>o.value.config.noweb.store.fullSync=U),onLabel:u(e)("sessions.storeFullSyncOn"),offLabel:u(e)("sessions.storeFullSyncOff")},{icon:C(()=>[p(oe,{icon:"fa-solid fa-sync",class:"mr-2"})]),_:1},8,["modelValue","onLabel","offLabel"])),[[ce,u(e)("sessions.storeFullSyncTooltip")]])])])])]),_:1})]),_:1})])):B("",!0),g.value?(v(),L("div",dc,[r("div",fc,[r("h5",null,"ðŸ­ "+w(u(e)("sessions.engineSettings")),1)]),p(Be,{activeIndex:0},{default:C(()=>[p(de,{header:"GOWS"},{default:C(()=>[r("div",pc,[r("div",hc,[K((v(),P(X,{modelValue:o.value.config.gows.storage.messages,"onUpdate:modelValue":T[8]||(T[8]=U=>o.value.config.gows.storage.messages=U),onLabel:u(e)("sessions.gows.storage.messagesOn"),offLabel:u(e)("sessions.gows.storage.messagesOff")},{icon:C(()=>[p(oe,{icon:"fa-solid fa-message",class:"mr-2"})]),_:1},8,["modelValue","onLabel","offLabel"])),[[ce,u(e)("sessions.gows.storage.messagesTooltip")]]),K((v(),P(X,{modelValue:o.value.config.gows.storage.chats,"onUpdate:modelValue":T[9]||(T[9]=U=>o.value.config.gows.storage.chats=U),onLabel:u(e)("sessions.gows.storage.chatsOn"),offLabel:u(e)("sessions.gows.storage.chatsOff")},{icon:C(()=>[p(oe,{icon:"fa-solid fa-comments",class:"mr-2"})]),_:1},8,["modelValue","onLabel","offLabel"])),[[ce,u(e)("sessions.gows.storage.chatsTooltip")]]),K((v(),P(X,{modelValue:o.value.config.gows.storage.groups,"onUpdate:modelValue":T[10]||(T[10]=U=>o.value.config.gows.storage.groups=U),onLabel:u(e)("sessions.gows.storage.groupsOn"),offLabel:u(e)("sessions.gows.storage.groupsOff")},{icon:C(()=>[p(oe,{icon:"fa-solid fa-users",class:"mr-2"})]),_:1},8,["modelValue","onLabel","offLabel"])),[[ce,u(e)("sessions.gows.storage.groupsTooltip")]]),K((v(),P(X,{modelValue:o.value.config.gows.storage.labels,"onUpdate:modelValue":T[11]||(T[11]=U=>o.value.config.gows.storage.labels=U),onLabel:u(e)("sessions.gows.storage.labelsOn"),offLabel:u(e)("sessions.gows.storage.labelsOff")},{icon:C(()=>[p(oe,{icon:"fa-solid fa-tags",class:"mr-2"})]),_:1},8,["modelValue","onLabel","offLabel"])),[[ce,u(e)("sessions.gows.storage.labelsTooltip")]])])])]),_:1})]),_:1})])):B("",!0),_.value?(v(),L("div",mc,[r("div",gc,[r("h5",null,"ðŸ­ "+w(u(e)("sessions.engineSettings")),1)]),p(Be,{activeIndex:0},{default:C(()=>[p(de,{header:"WEBJS"},{default:C(()=>[r("div",bc,[r("div",null,[K((v(),P(X,{modelValue:o.value.config.webjs.tagsEventsOn,"onUpdate:modelValue":T[12]||(T[12]=U=>o.value.config.webjs.tagsEventsOn=U),onLabel:u(e)("sessions.webjs.tagsEventsOnOn"),offLabel:u(e)("sessions.webjs.tagsEventsOnOff")},{icon:C(()=>[p(oe,{icon:"fa-solid fa-tag",class:"mr-2"})]),_:1},8,["modelValue","onLabel","offLabel"])),[[ce,u(e)("sessions.webjs.tagsEventsOnTooltip")]])])])]),_:1})]),_:1})])):B("",!0),r("div",null,[r("div",null,[r("h5",null,[G("ðŸ“ "+w(u(e)("sessions.metadata"))+"Â  ",1),K(r("i",yc,null,512),[[ce,u(e)("sessions.metadataTooltip")]])])]),p(et,{modelValue:m.value,"onUpdate:modelValue":T[13]||(T[13]=U=>m.value=U),"entity-name":u(e)("sessions.metadata"),"key-column":"key","key-column-name":u(e)("sessions.key"),prefix:"user.id."},null,8,["modelValue","entity-name","key-column-name"])]),r("div",vc,[p(tt,{ref:"webhooks",webhooks:o.value.config.webhooks,"onUpdate:webhooks":T[14]||(T[14]=U=>o.value.config.webhooks=U)},null,8,["webhooks"])]),r("div",null,[r("div",_c,[r("div",null,[r("h5",null,[r("label",wc,w(u(e)("sessions.config.ignore.title")),1),G("Â  "),K(r("i",kc,null,512),[[ce,u(e)("sessions.config.ignore.tooltip")]])])]),p(X,{modelValue:O.value,"onUpdate:modelValue":T[15]||(T[15]=U=>O.value=U),id:"ignore",onLabel:u(e)("sessions.config.ignore.filterOn"),offLabel:u(e)("sessions.config.ignore.filterOff")},{icon:C(()=>[p(oe,{icon:"fa-solid fa-filter",class:"mr-2"})]),_:1},8,["modelValue","onLabel","offLabel"])]),O.value?(v(),L("div",$c,[r("div",Sc,[p(X,{modelValue:k.value,"onUpdate:modelValue":T[16]||(T[16]=U=>k.value=U),id:"include-status",onLabel:""+u(e)("sessions.config.ignore.status.title")+": "+u(e)("sessions.config.ignore.on"),offLabel:""+u(e)("sessions.config.ignore.status.title")+": "+u(e)("sessions.config.ignore.off")},null,8,["modelValue","onLabel","offLabel"]),p(X,{modelValue:A.value,"onUpdate:modelValue":T[17]||(T[17]=U=>A.value=U),id:"include-groups",onLabel:""+u(e)("sessions.config.ignore.groups.title")+": "+u(e)("sessions.config.ignore.on"),offLabel:""+u(e)("sessions.config.ignore.groups.title")+": "+u(e)("sessions.config.ignore.off")},null,8,["modelValue","onLabel","offLabel"]),p(X,{modelValue:D.value,"onUpdate:modelValue":T[18]||(T[18]=U=>D.value=U),id:"include-channels",onLabel:""+u(e)("sessions.config.ignore.channels.title")+": "+u(e)("sessions.config.ignore.on"),offLabel:""+u(e)("sessions.config.ignore.channels.title")+": "+u(e)("sessions.config.ignore.off")},null,8,["modelValue","onLabel","offLabel"]),p(X,{modelValue:I.value,"onUpdate:modelValue":T[19]||(T[19]=U=>I.value=U),id:"include-broadcast",onLabel:""+u(e)("sessions.config.ignore.broadcast.title")+": "+u(e)("sessions.config.ignore.on"),offLabel:""+u(e)("sessions.config.ignore.broadcast.title")+": "+u(e)("sessions.config.ignore.off")},null,8,["modelValue","onLabel","offLabel"])])])):B("",!0)]),r("div",null,[r("div",Cc,[r("div",null,[r("h5",null,[r("label",Nc,"ðŸŒ "+w(u(e)("sessions.proxy")),1)])]),p(X,{modelValue:$.value,"onUpdate:modelValue":T[20]||(T[20]=U=>$.value=U),id:"proxy",onLabel:u(e)("sessions.proxyOn"),offLabel:u(e)("sessions.proxyOff")},{icon:C(()=>[p(oe,{icon:"fa-solid fa-server",class:"mr-2"})]),_:1},8,["modelValue","onLabel","offLabel"])]),$.value?(v(),L("div",Oc,[r("div",Tc,[r("label",Lc,w(u(e)("sessions.server")),1),p(De,{id:"proxy-server",modelValue:o.value.config.proxy.server,"onUpdate:modelValue":T[21]||(T[21]=U=>o.value.config.proxy.server=U),modelModifiers:{trim:!0},required:"true",invalid:F.value&&!o.value.config.proxy.server,placeholder:u(e)("sessions.hostPort")},null,8,["modelValue","invalid","placeholder"]),F.value&&!o.value.config.proxy.server?(v(),L("small",Ic,w(u(e)("sessions.serverRequired")),1)):B("",!0)]),r("div",Ac,[r("div",Ec,[r("label",Vc,w(u(e)("sessions.usernameOptional")),1),p(De,{id:"proxy-username",modelValue:o.value.config.proxy.username,"onUpdate:modelValue":T[22]||(T[22]=U=>o.value.config.proxy.username=U),modelModifiers:{trim:!0}},null,8,["modelValue"])]),r("div",xc,[r("label",Dc,w(u(e)("sessions.passwordOptional")),1),p(qe,{id:"proxy-password",modelValue:o.value.config.proxy.password,"onUpdate:modelValue":T[23]||(T[23]=U=>o.value.config.proxy.password=U),modelModifiers:{trim:!0},feedback:!1,toggleMask:""},null,8,["modelValue"])])])])):B("",!0)]),r("div",Bc,[r("div",null,[r("h5",null,[r("label",jc,"ðŸ› ï¸ "+w(u(e)("sessions.debug")),1)])]),p(X,{modelValue:o.value.config.debug,"onUpdate:modelValue":T[24]||(T[24]=U=>o.value.config.debug=U),onLabel:u(e)("sessions.debugEnabled"),offLabel:u(e)("sessions.debugDisabled"),onIcon:"fa fa-bug"},{icon:C(()=>[p(oe,{icon:"fa-solid fa-bug",class:"mr-2"})]),_:1},8,["modelValue","onLabel","offLabel"])])]),_:2},[l.value?{name:"header",fn:C(()=>[r("div",null,[r("h5",null,[jr,G(" "+w(u(e)("sessions.createSession")),1)])])]),key:"0"}:void 0,l.value?void 0:{name:"header",fn:C(()=>[r("div",null,[p(M,{session:o.value},null,8,["session"])])]),key:"1"}]),1032,["visible"])}}},Rc=["WORKING","FAILED","STARTING","SCAN_QR_CODE","STOPPED"];var At=(s=>(s.OFF="OFF",s.LQ="LG",s.HQ="HG",s))(At||{});const qc={class:"",style:{"min-width":"20rem"}},Kc={class:"flex justify-content-center align-items-center"},Fc=r("h5",{class:"m-0"},"QR",-1),Wc={class:"m-auto w-full"},Hc={class:"flex justify-content-center"},Gc={key:1,style:{"background-color":"#f8f9fa",padding:"1rem",color:"red","white-space":"pre-wrap"}},Jc={__name:"QRImage",props:{session:Object},setup(s){const t=he(),e=s,{data:n,pending:o,error:i,refresh:l}=ys(`session-qr-${e.session.server.id}-${e.session.name}`,async()=>(await dt(1e3),await t.getQR(e.session.server.id,e.session.name)));return(a,c)=>{const d=Pt,h=Wn,f=Hn,g=Zn;return v(),L("div",qc,[r("div",Kc,[Fc,p(d,{onClick:u(l)},null,8,["onClick"])]),r("div",Wc,[u(o)?(v(),L(te,{key:0},[p(h,{mode:"indeterminate",style:{height:"3px"}}),!u(n)&&!u(i)?(v(),P(f,{key:0,width:"100%",height:"20rem"})):B("",!0)],64)):B("",!0),r("div",Hc,[u(n)?(v(),P(g,{key:0,data:u(n).data,mimetype:u(n).mimetype},null,8,["data","mimetype"])):B("",!0),u(i)?(v(),L("pre",Gc,""+w(u(i).cause.response.data.message||u(i).cause.response.data||u(i))+`
  `,1)):B("",!0)])])])}}},Qc={class:"pl-4"},Yc=r("b",null,"WhatsApp",-1),zc=r("i",{class:"pi pi-ellipsis-v"},null,-1),Xc=r("i",{class:"pi pi-cog"},null,-1),Zc={__name:"EnterCodeGuide",setup(s){const{t}=Q();return(e,n)=>{const o=gt("i18n-t");return v(),L("ul",Qc,[r("li",null,[p(o,{keypath:"sessions.guide.code.openWhatsApp"},{app:C(()=>[Yc]),_:1})]),r("li",null,[p(o,{keypath:"sessions.guide.code.tapMoreOptions"},{options:C(()=>[r("b",null,w(u(t)("whatsapp.MoreOptions")),1),G(),zc]),settings:C(()=>[r("b",null,w(u(t)("whatsapp.Settings")),1),G(),Xc]),_:1})]),r("li",null,[p(o,{keypath:"sessions.guide.code.tapLinkedDevices"},{linkedDevices:C(()=>[r("b",null,w(u(t)("whatsapp.LinkedDevices")),1)]),linkDevice:C(()=>[r("b",null,w(u(t)("whatsapp.LinkADevice")),1)]),_:1})]),r("li",null,[p(o,{keypath:"sessions.guide.code.linkWithPhone"},{linkWithPhone:C(()=>[r("b",null,w(u(t)("sessions.guide.code.linkWithPhoneText")),1)]),_:1})])])}}},eu={class:"flex flex-column gap-2 mt-4"},tu={class:"flex justify-content-between gap-2"},su={class:"field"},nu={class:"card flex justify-content-center align-items-center"},ou={class:"mx-1",style:{"font-size":"2rem"}},iu={__name:"PairingCodeSteps",props:["session"],setup(s){const t=s,e=E(null),n=E(!1),o=E("XXXX-XXXX"),i=bt(),l=he(),{t:a}=Q();function c(h){return h.replace(/\D/g,"")}async function d(){e.value=c(e.value),n.value=!0;try{await dt(1e3);const h=await i(l.getPairingCode(t.session.server.id,t.session.name,e.value),a("sessions.guide.code.requestSent"),a("sessions.guide.code.failedToRequestCode"),t.session.name,t.session.name);o.value=h.code}finally{n.value=!1}}return se(e,pe.debounce(h=>{e.value=c(h)},1e3)),(h,f)=>{const g=Ae,b=ne,_=Qn;return v(),L(te,null,[r("div",eu,[r("form",{onSubmit:xt(d,["prevent"])},[r("div",tu,[r("div",su,[p(g,{id:"phone","input-id":"phone",name:"phone",modelValue:u(e),"onUpdate:modelValue":f[0]||(f[0]=m=>vs(e)?e.value=m:null),modelModifiers:{trim:!0},useGrouping:!1,required:"true",autofocus:"",placeholder:u(a)("sessions.guide.code.phonePlaceholder")},null,8,["modelValue","placeholder"])]),r("div",null,[p(b,{type:"submit",label:u(a)("sessions.guide.code.showCode"),icon:"pi pi-send",loading:u(n)},null,8,["label","loading"])])])],32)]),u(o)?(v(),L(te,{key:0},[p(_),r("div",null,[p(Zc)]),r("div",nu,[r("div",null,[u(o)?(v(!0),L(te,{key:0},mt(u(o),m=>(v(),L("span",ou,w(m),1))),256)):B("",!0)])])],64)):B("",!0)],64)}}},lu={class:"pl-4"},au=r("b",null,"WhatsApp",-1),ru=r("i",{class:"pi pi-ellipsis-v"},null,-1),cu=r("i",{class:"pi pi-cog"},null,-1),uu={__name:"ScanQRCodeGuide",setup(s){const{t}=Q();return(e,n)=>{const o=gt("i18n-t");return v(),L("ul",lu,[r("li",null,[p(o,{keypath:"sessions.guide.qr.openWhatsApp"},{app:C(()=>[au]),_:1})]),r("li",null,[p(o,{keypath:"sessions.guide.qr.tapMoreOptions"},{options:C(()=>[r("b",null,w(u(t)("whatsapp.MoreOptions")),1),G(),ru]),settings:C(()=>[r("b",null,w(u(t)("whatsapp.Settings")),1),G(),cu]),_:1})]),r("li",null,[p(o,{keypath:"sessions.guide.qr.tapLinkedDevices"},{linkedDevices:C(()=>[r("b",null,w(u(t)("whatsapp.LinkedDevices")),1)]),linkDevice:C(()=>[r("b",null,w(u(t)("whatsapp.LinkADevice")),1)]),_:1})]),r("li",null,[p(o,{keypath:"sessions.guide.qr.pointPhone"},{qrCode:C(()=>[r("b",null,w(u(t)("sessions.qr")),1)]),_:1})])])}}},du=r("i",{class:"pi pi-qrcode mr-2"},null,-1),fu=r("i",{class:"pi pi-send mr-2"},null,-1),pu=["innerHTML"],hu={__name:"SessionLoginDialog",props:Ut(["session"],{visible:{},visibleModifiers:{}}),emits:["update:visible"],setup(s){const t=be(s,"visible"),{t:e}=Q();return(n,o)=>{const i=gt("i18n-t"),l=Ci,a=Ni,c=vt;return v(),P(c,{visible:t.value,"onUpdate:visible":o[0]||(o[0]=d=>t.value=d),modal:!0,class:"p-fluid",maximizable:""},{header:C(()=>[p(Rt,{session:s.session},null,8,["session"])]),default:C(()=>[p(a,null,{default:C(()=>[p(l,null,{header:C(()=>[du,G(" "+w(u(e)("sessions.scanQRTab")),1)]),default:C(()=>[p(i,{keypath:"sessions.scanQRCode",tag:"p"},{qr:C(()=>[r("b",null,w(u(e)("sessions.qr")),1)]),_:1}),p(uu),r("div",null,[p(Jc,{session:s.session},null,8,["session"])])]),_:1}),p(l,null,{header:C(()=>[fu,G(" "+w(u(e)("sessions.enterCodeTab")),1)]),default:C(()=>[r("p",{innerHTML:u(e)("sessions.enterPhoneNumber"),class:"m-0"},null,8,pu),r("div",null,[p(iu,{session:s.session},null,8,["session"])])]),_:1})]),_:1})]),_:1},8,["visible"])}}},mu={__name:"SessionLogin",props:["session"],setup(s){const{t}=Q(),e=E(!1);return(n,o)=>{const i=ne,l=ae("tooltip");return v(),L(te,null,[K(p(i,{icon:"pi pi-sign-in",severity:"",rounded:"",outlined:"",onClick:o[0]||(o[0]=a=>e.value=!0),disabled:s.session.status!=="SCAN_QR_CODE"},null,8,["disabled"]),[[l,u(t)("sessions.login"),void 0,{top:!0}]]),p(hu,{visible:u(e),"onUpdate:visible":o[1]||(o[1]=a=>vs(e)?e.value=a:null),session:s.session},null,8,["visible","session"])],64)}}},gu={__name:"AppStatusTag",props:{enabled:{type:Boolean,required:!1,default:!0}},setup(s){const{t}=Q(),e=s,n=R(()=>e.enabled?"success":"secondary"),o=R(()=>e.enabled?t("apps.enabled.on").toUpperCase():t("apps.enabled.off").toUpperCase());return(i,l)=>{const a=Oi;return v(),P(a,{value:o.value,severity:n.value},null,8,["value","severity"])}}},cn=Symbol.for("yaml.alias"),Ys=Symbol.for("yaml.document"),Me=Symbol.for("yaml.map"),io=Symbol.for("yaml.pair"),Oe=Symbol.for("yaml.scalar"),wt=Symbol.for("yaml.seq"),_e=Symbol.for("yaml.node.type"),Pe=s=>!!s&&typeof s=="object"&&s[_e]===cn,ze=s=>!!s&&typeof s=="object"&&s[_e]===Ys,kt=s=>!!s&&typeof s=="object"&&s[_e]===Me,z=s=>!!s&&typeof s=="object"&&s[_e]===io,Y=s=>!!s&&typeof s=="object"&&s[_e]===Oe,St=s=>!!s&&typeof s=="object"&&s[_e]===wt;function Z(s){if(s&&typeof s=="object")switch(s[_e]){case Me:case wt:return!0}return!1}function ee(s){if(s&&typeof s=="object")switch(s[_e]){case cn:case Me:case Oe:case wt:return!0}return!1}const lo=s=>(Y(s)||Z(s))&&!!s.anchor,fe=Symbol("break visit"),ao=Symbol("skip children"),Ne=Symbol("remove node");function Xe(s,t){const e=ro(t);ze(s)?it(null,s.contents,e,Object.freeze([s]))===Ne&&(s.contents=null):it(null,s,e,Object.freeze([]))}Xe.BREAK=fe;Xe.SKIP=ao;Xe.REMOVE=Ne;function it(s,t,e,n){const o=co(s,t,e,n);if(ee(o)||z(o))return uo(s,n,o),it(s,o,e,n);if(typeof o!="symbol"){if(Z(t)){n=Object.freeze(n.concat(t));for(let i=0;i<t.items.length;++i){const l=it(i,t.items[i],e,n);if(typeof l=="number")i=l-1;else{if(l===fe)return fe;l===Ne&&(t.items.splice(i,1),i-=1)}}}else if(z(t)){n=Object.freeze(n.concat(t));const i=it("key",t.key,e,n);if(i===fe)return fe;i===Ne&&(t.key=null);const l=it("value",t.value,e,n);if(l===fe)return fe;l===Ne&&(t.value=null)}}return o}async function Ns(s,t){const e=ro(t);ze(s)?await lt(null,s.contents,e,Object.freeze([s]))===Ne&&(s.contents=null):await lt(null,s,e,Object.freeze([]))}Ns.BREAK=fe;Ns.SKIP=ao;Ns.REMOVE=Ne;async function lt(s,t,e,n){const o=await co(s,t,e,n);if(ee(o)||z(o))return uo(s,n,o),lt(s,o,e,n);if(typeof o!="symbol"){if(Z(t)){n=Object.freeze(n.concat(t));for(let i=0;i<t.items.length;++i){const l=await lt(i,t.items[i],e,n);if(typeof l=="number")i=l-1;else{if(l===fe)return fe;l===Ne&&(t.items.splice(i,1),i-=1)}}}else if(z(t)){n=Object.freeze(n.concat(t));const i=await lt("key",t.key,e,n);if(i===fe)return fe;i===Ne&&(t.key=null);const l=await lt("value",t.value,e,n);if(l===fe)return fe;l===Ne&&(t.value=null)}}return o}function ro(s){return typeof s=="object"&&(s.Collection||s.Node||s.Value)?Object.assign({Alias:s.Node,Map:s.Node,Scalar:s.Node,Seq:s.Node},s.Value&&{Map:s.Value,Scalar:s.Value,Seq:s.Value},s.Collection&&{Map:s.Collection,Seq:s.Collection},s):s}function co(s,t,e,n){var o,i,l,a,c;if(typeof e=="function")return e(s,t,n);if(kt(t))return(o=e.Map)==null?void 0:o.call(e,s,t,n);if(St(t))return(i=e.Seq)==null?void 0:i.call(e,s,t,n);if(z(t))return(l=e.Pair)==null?void 0:l.call(e,s,t,n);if(Y(t))return(a=e.Scalar)==null?void 0:a.call(e,s,t,n);if(Pe(t))return(c=e.Alias)==null?void 0:c.call(e,s,t,n)}function uo(s,t,e){const n=t[t.length-1];if(Z(n))n.items[s]=e;else if(z(n))s==="key"?n.key=e:n.value=e;else if(ze(n))n.contents=e;else{const o=Pe(n)?"alias":"scalar";throw new Error(`Cannot replace node with ${o} parent`)}}const bu={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"},yu=s=>s.replace(/[!,[\]{}]/g,t=>bu[t]);class ue{constructor(t,e){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},ue.defaultYaml,t),this.tags=Object.assign({},ue.defaultTags,e)}clone(){const t=new ue(this.yaml,this.tags);return t.docStart=this.docStart,t}atDocument(){const t=new ue(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:ue.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},ue.defaultTags);break}return t}add(t,e){this.atNextDocument&&(this.yaml={explicit:ue.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},ue.defaultTags),this.atNextDocument=!1);const n=t.trim().split(/[ \t]+/),o=n.shift();switch(o){case"%TAG":{if(n.length!==2&&(e(0,"%TAG directive should contain exactly two parts"),n.length<2))return!1;const[i,l]=n;return this.tags[i]=l,!0}case"%YAML":{if(this.yaml.explicit=!0,n.length!==1)return e(0,"%YAML directive should contain exactly one part"),!1;const[i]=n;if(i==="1.1"||i==="1.2")return this.yaml.version=i,!0;{const l=/^\d+\.\d+$/.test(i);return e(6,`Unsupported YAML version ${i}`,l),!1}}default:return e(0,`Unknown directive ${o}`,!0),!1}}tagName(t,e){if(t==="!")return"!";if(t[0]!=="!")return e(`Not a valid tag: ${t}`),null;if(t[1]==="<"){const l=t.slice(2,-1);return l==="!"||l==="!!"?(e(`Verbatim tags aren't resolved, so ${t} is invalid.`),null):(t[t.length-1]!==">"&&e("Verbatim tags must end with a >"),l)}const[,n,o]=t.match(/^(.*!)([^!]*)$/s);o||e(`The ${t} tag has no suffix`);const i=this.tags[n];if(i)try{return i+decodeURIComponent(o)}catch(l){return e(String(l)),null}return n==="!"?t:(e(`Could not resolve tag: ${t}`),null)}tagString(t){for(const[e,n]of Object.entries(this.tags))if(t.startsWith(n))return e+yu(t.substring(n.length));return t[0]==="!"?t:`!<${t}>`}toString(t){const e=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],n=Object.entries(this.tags);let o;if(t&&n.length>0&&ee(t.contents)){const i={};Xe(t.contents,(l,a)=>{ee(a)&&a.tag&&(i[a.tag]=!0)}),o=Object.keys(i)}else o=[];for(const[i,l]of n)i==="!!"&&l==="tag:yaml.org,2002:"||(!t||o.some(a=>a.startsWith(l)))&&e.push(`%TAG ${i} ${l}`);return e.join(`
`)}}ue.defaultYaml={explicit:!1,version:"1.2"};ue.defaultTags={"!!":"tag:yaml.org,2002:"};function fo(s){if(/[\x00-\x19\s,[\]{}]/.test(s)){const e=`Anchor must not contain whitespace or control characters: ${JSON.stringify(s)}`;throw new Error(e)}return!0}function po(s){const t=new Set;return Xe(s,{Value(e,n){n.anchor&&t.add(n.anchor)}}),t}function ho(s,t){for(let e=1;;++e){const n=`${s}${e}`;if(!t.has(n))return n}}function vu(s,t){const e=[],n=new Map;let o=null;return{onAnchor:i=>{e.push(i),o??(o=po(s));const l=ho(t,o);return o.add(l),l},setAnchors:()=>{for(const i of e){const l=n.get(i);if(typeof l=="object"&&l.anchor&&(Y(l.node)||Z(l.node)))l.node.anchor=l.anchor;else{const a=new Error("Failed to resolve repeated object (this should not happen)");throw a.source=i,a}}},sourceObjects:n}}function at(s,t,e,n){if(n&&typeof n=="object")if(Array.isArray(n))for(let o=0,i=n.length;o<i;++o){const l=n[o],a=at(s,n,String(o),l);a===void 0?delete n[o]:a!==l&&(n[o]=a)}else if(n instanceof Map)for(const o of Array.from(n.keys())){const i=n.get(o),l=at(s,n,o,i);l===void 0?n.delete(o):l!==i&&n.set(o,l)}else if(n instanceof Set)for(const o of Array.from(n)){const i=at(s,n,o,o);i===void 0?n.delete(o):i!==o&&(n.delete(o),n.add(i))}else for(const[o,i]of Object.entries(n)){const l=at(s,n,o,i);l===void 0?delete n[o]:l!==i&&(n[o]=l)}return s.call(t,e,n)}function ve(s,t,e){if(Array.isArray(s))return s.map((n,o)=>ve(n,String(o),e));if(s&&typeof s.toJSON=="function"){if(!e||!lo(s))return s.toJSON(t,e);const n={aliasCount:0,count:1,res:void 0};e.anchors.set(s,n),e.onCreate=i=>{n.res=i,delete e.onCreate};const o=s.toJSON(t,e);return e.onCreate&&e.onCreate(o),o}return typeof s=="bigint"&&!(e!=null&&e.keep)?Number(s):s}class un{constructor(t){Object.defineProperty(this,_e,{value:t})}clone(){const t=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(t.range=this.range.slice()),t}toJS(t,{mapAsMap:e,maxAliasCount:n,onAnchor:o,reviver:i}={}){if(!ze(t))throw new TypeError("A document argument is required");const l={anchors:new Map,doc:t,keep:!0,mapAsMap:e===!0,mapKeyWarned:!1,maxAliasCount:typeof n=="number"?n:100},a=ve(this,"",l);if(typeof o=="function")for(const{count:c,res:d}of l.anchors.values())o(d,c);return typeof i=="function"?at(i,{"":a},"",a):a}}class Os extends un{constructor(t){super(cn),this.source=t,Object.defineProperty(this,"tag",{set(){throw new Error("Alias nodes cannot have tags")}})}resolve(t,e){let n;e!=null&&e.aliasResolveCache?n=e.aliasResolveCache:(n=[],Xe(t,{Node:(i,l)=>{(Pe(l)||lo(l))&&n.push(l)}}),e&&(e.aliasResolveCache=n));let o;for(const i of n){if(i===this)break;i.anchor===this.source&&(o=i)}return o}toJSON(t,e){if(!e)return{source:this.source};const{anchors:n,doc:o,maxAliasCount:i}=e,l=this.resolve(o,e);if(!l){const c=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new ReferenceError(c)}let a=n.get(l);if(a||(ve(l,null,e),a=n.get(l)),!a||a.res===void 0){const c="This should not happen: Alias anchor was not resolved?";throw new ReferenceError(c)}if(i>=0&&(a.count+=1,a.aliasCount===0&&(a.aliasCount=cs(o,l,n)),a.count*a.aliasCount>i)){const c="Excessive alias count indicates a resource exhaustion attack";throw new ReferenceError(c)}return a.res}toString(t,e,n){const o=`*${this.source}`;if(t){if(fo(this.source),t.options.verifyAliasOrder&&!t.anchors.has(this.source)){const i=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new Error(i)}if(t.implicitKey)return`${o} `}return o}}function cs(s,t,e){if(Pe(t)){const n=t.resolve(s),o=e&&n&&e.get(n);return o?o.count*o.aliasCount:0}else if(Z(t)){let n=0;for(const o of t.items){const i=cs(s,o,e);i>n&&(n=i)}return n}else if(z(t)){const n=cs(s,t.key,e),o=cs(s,t.value,e);return Math.max(n,o)}return 1}const mo=s=>!s||typeof s!="function"&&typeof s!="object";class W extends un{constructor(t){super(Oe),this.value=t}toJSON(t,e){return e!=null&&e.keep?this.value:ve(this.value,t,e)}toString(){return String(this.value)}}W.BLOCK_FOLDED="BLOCK_FOLDED";W.BLOCK_LITERAL="BLOCK_LITERAL";W.PLAIN="PLAIN";W.QUOTE_DOUBLE="QUOTE_DOUBLE";W.QUOTE_SINGLE="QUOTE_SINGLE";const _u="tag:yaml.org,2002:";function wu(s,t,e){if(t){const n=e.filter(i=>i.tag===t),o=n.find(i=>!i.format)??n[0];if(!o)throw new Error(`Tag ${t} not found`);return o}return e.find(n=>{var o;return((o=n.identify)==null?void 0:o.call(n,s))&&!n.format})}function Dt(s,t,e){var f,g,b;if(ze(s)&&(s=s.contents),ee(s))return s;if(z(s)){const _=(g=(f=e.schema[Me]).createNode)==null?void 0:g.call(f,e.schema,null,e);return _.items.push(s),_}(s instanceof String||s instanceof Number||s instanceof Boolean||typeof BigInt<"u"&&s instanceof BigInt)&&(s=s.valueOf());const{aliasDuplicateObjects:n,onAnchor:o,onTagObj:i,schema:l,sourceObjects:a}=e;let c;if(n&&s&&typeof s=="object"){if(c=a.get(s),c)return c.anchor??(c.anchor=o(s)),new Os(c.anchor);c={anchor:null,node:null},a.set(s,c)}t!=null&&t.startsWith("!!")&&(t=_u+t.slice(2));let d=wu(s,t,l.tags);if(!d){if(s&&typeof s.toJSON=="function"&&(s=s.toJSON()),!s||typeof s!="object"){const _=new W(s);return c&&(c.node=_),_}d=s instanceof Map?l[Me]:Symbol.iterator in Object(s)?l[wt]:l[Me]}i&&(i(d),delete e.onTagObj);const h=d!=null&&d.createNode?d.createNode(e.schema,s,e):typeof((b=d==null?void 0:d.nodeClass)==null?void 0:b.from)=="function"?d.nodeClass.from(e.schema,s,e):new W(s);return t?h.tag=t:d.default||(h.tag=d.tag),c&&(c.node=h),h}function hs(s,t,e){let n=e;for(let o=t.length-1;o>=0;--o){const i=t[o];if(typeof i=="number"&&Number.isInteger(i)&&i>=0){const l=[];l[i]=n,n=l}else n=new Map([[i,n]])}return Dt(n,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw new Error("This should not happen, please report a bug.")},schema:s,sourceObjects:new Map})}const Et=s=>s==null||typeof s=="object"&&!!s[Symbol.iterator]().next().done;class go extends un{constructor(t,e){super(t),Object.defineProperty(this,"schema",{value:e,configurable:!0,enumerable:!1,writable:!0})}clone(t){const e=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return t&&(e.schema=t),e.items=e.items.map(n=>ee(n)||z(n)?n.clone(t):n),this.range&&(e.range=this.range.slice()),e}addIn(t,e){if(Et(t))this.add(e);else{const[n,...o]=t,i=this.get(n,!0);if(Z(i))i.addIn(o,e);else if(i===void 0&&this.schema)this.set(n,hs(this.schema,o,e));else throw new Error(`Expected YAML collection at ${n}. Remaining path: ${o}`)}}deleteIn(t){const[e,...n]=t;if(n.length===0)return this.delete(e);const o=this.get(e,!0);if(Z(o))return o.deleteIn(n);throw new Error(`Expected YAML collection at ${e}. Remaining path: ${n}`)}getIn(t,e){const[n,...o]=t,i=this.get(n,!0);return o.length===0?!e&&Y(i)?i.value:i:Z(i)?i.getIn(o,e):void 0}hasAllNullValues(t){return this.items.every(e=>{if(!z(e))return!1;const n=e.value;return n==null||t&&Y(n)&&n.value==null&&!n.commentBefore&&!n.comment&&!n.tag})}hasIn(t){const[e,...n]=t;if(n.length===0)return this.has(e);const o=this.get(e,!0);return Z(o)?o.hasIn(n):!1}setIn(t,e){const[n,...o]=t;if(o.length===0)this.set(n,e);else{const i=this.get(n,!0);if(Z(i))i.setIn(o,e);else if(i===void 0&&this.schema)this.set(n,hs(this.schema,o,e));else throw new Error(`Expected YAML collection at ${n}. Remaining path: ${o}`)}}}const ku=s=>s.replace(/^(?!$)(?: $)?/gm,"#");function Le(s,t){return/^\n+$/.test(s)?s.substring(1):t?s.replace(/^(?! *$)/gm,t):s}const Fe=(s,t,e)=>s.endsWith(`
`)?Le(e,t):e.includes(`
`)?`
`+Le(e,t):(s.endsWith(" ")?"":" ")+e,bo="flow",zs="block",us="quoted";function Ts(s,t,e="flow",{indentAtStart:n,lineWidth:o=80,minContentWidth:i=20,onFold:l,onOverflow:a}={}){if(!o||o<0)return s;o<i&&(i=0);const c=Math.max(1+i,1+o-t.length);if(s.length<=c)return s;const d=[],h={};let f=o-t.length;typeof n=="number"&&(n>o-Math.max(2,i)?d.push(0):f=o-n);let g,b,_=!1,m=-1,y=-1,N=-1;e===zs&&(m=Ln(s,m,t.length),m!==-1&&(f=m+c));for(let S;S=s[m+=1];){if(e===us&&S==="\\"){switch(y=m,s[m+1]){case"x":m+=3;break;case"u":m+=5;break;case"U":m+=9;break;default:m+=1}N=m}if(S===`
`)e===zs&&(m=Ln(s,m,t.length)),f=m+t.length+c,g=void 0;else{if(S===" "&&b&&b!==" "&&b!==`
`&&b!=="	"){const O=s[m+1];O&&O!==" "&&O!==`
`&&O!=="	"&&(g=m)}if(m>=f)if(g)d.push(g),f=g+c,g=void 0;else if(e===us){for(;b===" "||b==="	";)b=S,S=s[m+=1],_=!0;const O=m>N+1?m-2:y-1;if(h[O])return s;d.push(O),h[O]=!0,f=O+c,g=void 0}else _=!0}b=S}if(_&&a&&a(),d.length===0)return s;l&&l();let $=s.slice(0,d[0]);for(let S=0;S<d.length;++S){const O=d[S],k=d[S+1]||s.length;O===0?$=`
${t}${s.slice(0,k)}`:(e===us&&h[O]&&($+=`${s[O]}\\`),$+=`
${t}${s.slice(O+1,k)}`)}return $}function Ln(s,t,e){let n=t,o=t+1,i=s[o];for(;i===" "||i==="	";)if(t<o+e)i=s[++t];else{do i=s[++t];while(i&&i!==`
`);n=t,o=t+1,i=s[o]}return n}const Ls=(s,t)=>({indentAtStart:t?s.indent.length:s.indentAtStart,lineWidth:s.options.lineWidth,minContentWidth:s.options.minContentWidth}),Is=s=>/^(%|---|\.\.\.)/m.test(s);function $u(s,t,e){if(!t||t<0)return!1;const n=t-e,o=s.length;if(o<=n)return!1;for(let i=0,l=0;i<o;++i)if(s[i]===`
`){if(i-l>n)return!0;if(l=i+1,o-l<=n)return!1}return!0}function Vt(s,t){const e=JSON.stringify(s);if(t.options.doubleQuotedAsJSON)return e;const{implicitKey:n}=t,o=t.options.doubleQuotedMinMultiLineLength,i=t.indent||(Is(s)?"  ":"");let l="",a=0;for(let c=0,d=e[c];d;d=e[++c])if(d===" "&&e[c+1]==="\\"&&e[c+2]==="n"&&(l+=e.slice(a,c)+"\\ ",c+=1,a=c,d="\\"),d==="\\")switch(e[c+1]){case"u":{l+=e.slice(a,c);const h=e.substr(c+2,4);switch(h){case"0000":l+="\\0";break;case"0007":l+="\\a";break;case"000b":l+="\\v";break;case"001b":l+="\\e";break;case"0085":l+="\\N";break;case"00a0":l+="\\_";break;case"2028":l+="\\L";break;case"2029":l+="\\P";break;default:h.substr(0,2)==="00"?l+="\\x"+h.substr(2):l+=e.substr(c,6)}c+=5,a=c+1}break;case"n":if(n||e[c+2]==='"'||e.length<o)c+=1;else{for(l+=e.slice(a,c)+`

`;e[c+2]==="\\"&&e[c+3]==="n"&&e[c+4]!=='"';)l+=`
`,c+=2;l+=i,e[c+2]===" "&&(l+="\\"),c+=1,a=c+1}break;default:c+=1}return l=a?l+e.slice(a):e,n?l:Ts(l,i,us,Ls(t,!1))}function Xs(s,t){if(t.options.singleQuote===!1||t.implicitKey&&s.includes(`
`)||/[ \t]\n|\n[ \t]/.test(s))return Vt(s,t);const e=t.indent||(Is(s)?"  ":""),n="'"+s.replace(/'/g,"''").replace(/\n+/g,`$&
${e}`)+"'";return t.implicitKey?n:Ts(n,e,bo,Ls(t,!1))}function rt(s,t){const{singleQuote:e}=t.options;let n;if(e===!1)n=Vt;else{const o=s.includes('"'),i=s.includes("'");o&&!i?n=Xs:i&&!o?n=Vt:n=e?Xs:Vt}return n(s,t)}let Zs;try{Zs=new RegExp(`(^|(?<!
))
+(?!
|$)`,"g")}catch{Zs=/\n+(?!\n|$)/g}function ds({comment:s,type:t,value:e},n,o,i){const{blockQuote:l,commentString:a,lineWidth:c}=n.options;if(!l||/\n[\t ]+$/.test(e))return rt(e,n);const d=n.indent||(n.forceBlockIndent||Is(e)?"  ":""),h=l==="literal"?!0:l==="folded"||t===W.BLOCK_FOLDED?!1:t===W.BLOCK_LITERAL?!0:!$u(e,c,d.length);if(!e)return h?`|
`:`>
`;let f,g;for(g=e.length;g>0;--g){const k=e[g-1];if(k!==`
`&&k!=="	"&&k!==" ")break}let b=e.substring(g);const _=b.indexOf(`
`);_===-1?f="-":e===b||_!==b.length-1?(f="+",i&&i()):f="",b&&(e=e.slice(0,-b.length),b[b.length-1]===`
`&&(b=b.slice(0,-1)),b=b.replace(Zs,`$&${d}`));let m=!1,y,N=-1;for(y=0;y<e.length;++y){const k=e[y];if(k===" ")m=!0;else if(k===`
`)N=y;else break}let $=e.substring(0,N<y?N+1:y);$&&(e=e.substring($.length),$=$.replace(/\n+/g,`$&${d}`));let O=(m?d?"2":"1":"")+f;if(s&&(O+=" "+a(s.replace(/ ?[\r\n]+/g," ")),o&&o()),!h){const k=e.replace(/\n+/g,`
$&`).replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${d}`);let A=!1;const D=Ls(n,!0);l!=="folded"&&t!==W.BLOCK_FOLDED&&(D.onOverflow=()=>{A=!0});const I=Ts(`${$}${k}${b}`,d,zs,D);if(!A)return`>${O}
${d}${I}`}return e=e.replace(/\n+/g,`$&${d}`),`|${O}
${d}${$}${e}${b}`}function Su(s,t,e,n){const{type:o,value:i}=s,{actualString:l,implicitKey:a,indent:c,indentStep:d,inFlow:h}=t;if(a&&i.includes(`
`)||h&&/[[\]{},]/.test(i))return rt(i,t);if(/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(i))return a||h||!i.includes(`
`)?rt(i,t):ds(s,t,e,n);if(!a&&!h&&o!==W.PLAIN&&i.includes(`
`))return ds(s,t,e,n);if(Is(i)){if(c==="")return t.forceBlockIndent=!0,ds(s,t,e,n);if(a&&c===d)return rt(i,t)}const f=i.replace(/\n+/g,`$&
${c}`);if(l){const g=m=>{var y;return m.default&&m.tag!=="tag:yaml.org,2002:str"&&((y=m.test)==null?void 0:y.test(f))},{compat:b,tags:_}=t.doc.schema;if(_.some(g)||b!=null&&b.some(g))return rt(i,t)}return a?f:Ts(f,c,bo,Ls(t,!1))}function qt(s,t,e,n){const{implicitKey:o,inFlow:i}=t,l=typeof s.value=="string"?s:Object.assign({},s,{value:String(s.value)});let{type:a}=s;a!==W.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(l.value)&&(a=W.QUOTE_DOUBLE);const c=h=>{switch(h){case W.BLOCK_FOLDED:case W.BLOCK_LITERAL:return o||i?rt(l.value,t):ds(l,t,e,n);case W.QUOTE_DOUBLE:return Vt(l.value,t);case W.QUOTE_SINGLE:return Xs(l.value,t);case W.PLAIN:return Su(l,t,e,n);default:return null}};let d=c(a);if(d===null){const{defaultKeyType:h,defaultStringType:f}=t.options,g=o&&h||f;if(d=c(g),d===null)throw new Error(`Unsupported default string type ${g}`)}return d}function yo(s,t){const e=Object.assign({blockQuote:!0,commentString:ku,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},s.schema.toStringOptions,t);let n;switch(e.collectionStyle){case"block":n=!1;break;case"flow":n=!0;break;default:n=null}return{anchors:new Set,doc:s,flowCollectionPadding:e.flowCollectionPadding?" ":"",indent:"",indentStep:typeof e.indent=="number"?" ".repeat(e.indent):"  ",inFlow:n,options:e}}function Cu(s,t){var o;if(t.tag){const i=s.filter(l=>l.tag===t.tag);if(i.length>0)return i.find(l=>l.format===t.format)??i[0]}let e,n;if(Y(t)){n=t.value;let i=s.filter(l=>{var a;return(a=l.identify)==null?void 0:a.call(l,n)});if(i.length>1){const l=i.filter(a=>a.test);l.length>0&&(i=l)}e=i.find(l=>l.format===t.format)??i.find(l=>!l.format)}else n=t,e=s.find(i=>i.nodeClass&&n instanceof i.nodeClass);if(!e){const i=((o=n==null?void 0:n.constructor)==null?void 0:o.name)??(n===null?"null":typeof n);throw new Error(`Tag not resolved for ${i} value`)}return e}function Nu(s,t,{anchors:e,doc:n}){if(!n.directives)return"";const o=[],i=(Y(s)||Z(s))&&s.anchor;i&&fo(i)&&(e.add(i),o.push(`&${i}`));const l=s.tag??(t.default?null:t.tag);return l&&o.push(n.directives.tagString(l)),o.join(" ")}function pt(s,t,e,n){var c;if(z(s))return s.toString(t,e,n);if(Pe(s)){if(t.doc.directives)return s.toString(t);if((c=t.resolvedAliases)!=null&&c.has(s))throw new TypeError("Cannot stringify circular structure without alias nodes");t.resolvedAliases?t.resolvedAliases.add(s):t.resolvedAliases=new Set([s]),s=s.resolve(t.doc)}let o;const i=ee(s)?s:t.doc.createNode(s,{onTagObj:d=>o=d});o??(o=Cu(t.doc.schema.tags,i));const l=Nu(i,o,t);l.length>0&&(t.indentAtStart=(t.indentAtStart??0)+l.length+1);const a=typeof o.stringify=="function"?o.stringify(i,t,e,n):Y(i)?qt(i,t,e,n):i.toString(t,e,n);return l?Y(i)||a[0]==="{"||a[0]==="["?`${l} ${a}`:`${l}
${t.indent}${a}`:a}function Ou({key:s,value:t},e,n,o){const{allNullValues:i,doc:l,indent:a,indentStep:c,options:{commentString:d,indentSeq:h,simpleKeys:f}}=e;let g=ee(s)&&s.comment||null;if(f){if(g)throw new Error("With simple keys, key nodes cannot have comments");if(Z(s)||!ee(s)&&typeof s=="object"){const D="With simple keys, collection cannot be used as a key value";throw new Error(D)}}let b=!f&&(!s||g&&t==null&&!e.inFlow||Z(s)||(Y(s)?s.type===W.BLOCK_FOLDED||s.type===W.BLOCK_LITERAL:typeof s=="object"));e=Object.assign({},e,{allNullValues:!1,implicitKey:!b&&(f||!i),indent:a+c});let _=!1,m=!1,y=pt(s,e,()=>_=!0,()=>m=!0);if(!b&&!e.inFlow&&y.length>1024){if(f)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");b=!0}if(e.inFlow){if(i||t==null)return _&&n&&n(),y===""?"?":b?`? ${y}`:y}else if(i&&!f||t==null&&b)return y=`? ${y}`,g&&!_?y+=Fe(y,e.indent,d(g)):m&&o&&o(),y;_&&(g=null),b?(g&&(y+=Fe(y,e.indent,d(g))),y=`? ${y}
${a}:`):(y=`${y}:`,g&&(y+=Fe(y,e.indent,d(g))));let N,$,S;ee(t)?(N=!!t.spaceBefore,$=t.commentBefore,S=t.comment):(N=!1,$=null,S=null,t&&typeof t=="object"&&(t=l.createNode(t))),e.implicitKey=!1,!b&&!g&&Y(t)&&(e.indentAtStart=y.length+1),m=!1,!h&&c.length>=2&&!e.inFlow&&!b&&St(t)&&!t.flow&&!t.tag&&!t.anchor&&(e.indent=e.indent.substring(2));let O=!1;const k=pt(t,e,()=>O=!0,()=>m=!0);let A=" ";if(g||N||$){if(A=N?`
`:"",$){const D=d($);A+=`
${Le(D,e.indent)}`}k===""&&!e.inFlow?A===`
`&&(A=`

`):A+=`
${e.indent}`}else if(!b&&Z(t)){const D=k[0],I=k.indexOf(`
`),F=I!==-1,V=e.inFlow??t.flow??t.items.length===0;if(F||!V){let H=!1;if(F&&(D==="&"||D==="!")){let q=k.indexOf(" ");D==="&"&&q!==-1&&q<I&&k[q+1]==="!"&&(q=k.indexOf(" ",q+1)),(q===-1||I<q)&&(H=!0)}H||(A=`
${e.indent}`)}}else(k===""||k[0]===`
`)&&(A="");return y+=A+k,e.inFlow?O&&n&&n():S&&!O?y+=Fe(y,e.indent,d(S)):m&&o&&o(),y}function vo(s,t){(s==="debug"||s==="warn")&&console.warn(t)}const os="<<",Ie={identify:s=>s===os||typeof s=="symbol"&&s.description===os,default:"key",tag:"tag:yaml.org,2002:merge",test:/^<<$/,resolve:()=>Object.assign(new W(Symbol(os)),{addToJSMap:_o}),stringify:()=>os},Tu=(s,t)=>(Ie.identify(t)||Y(t)&&(!t.type||t.type===W.PLAIN)&&Ie.identify(t.value))&&(s==null?void 0:s.doc.schema.tags.some(e=>e.tag===Ie.tag&&e.default));function _o(s,t,e){if(e=s&&Pe(e)?e.resolve(s.doc):e,St(e))for(const n of e.items)Ks(s,t,n);else if(Array.isArray(e))for(const n of e)Ks(s,t,n);else Ks(s,t,e)}function Ks(s,t,e){const n=s&&Pe(e)?e.resolve(s.doc):e;if(!kt(n))throw new Error("Merge sources must be maps or map aliases");const o=n.toJSON(null,s,Map);for(const[i,l]of o)t instanceof Map?t.has(i)||t.set(i,l):t instanceof Set?t.add(i):Object.prototype.hasOwnProperty.call(t,i)||Object.defineProperty(t,i,{value:l,writable:!0,enumerable:!0,configurable:!0});return t}function wo(s,t,{key:e,value:n}){if(ee(e)&&e.addToJSMap)e.addToJSMap(s,t,n);else if(Tu(s,e))_o(s,t,n);else{const o=ve(e,"",s);if(t instanceof Map)t.set(o,ve(n,o,s));else if(t instanceof Set)t.add(o);else{const i=Lu(e,o,s),l=ve(n,i,s);i in t?Object.defineProperty(t,i,{value:l,writable:!0,enumerable:!0,configurable:!0}):t[i]=l}}return t}function Lu(s,t,e){if(t===null)return"";if(typeof t!="object")return String(t);if(ee(s)&&(e!=null&&e.doc)){const n=yo(e.doc,{});n.anchors=new Set;for(const i of e.anchors.keys())n.anchors.add(i.anchor);n.inFlow=!0,n.inStringifyKey=!0;const o=s.toString(n);if(!e.mapKeyWarned){let i=JSON.stringify(o);i.length>40&&(i=i.substring(0,36)+'..."'),vo(e.doc.options.logLevel,`Keys with collection values will be stringified due to JS Object restrictions: ${i}. Set mapAsMap: true to use object keys.`),e.mapKeyWarned=!0}return o}return JSON.stringify(t)}function dn(s,t,e){const n=Dt(s,void 0,e),o=Dt(t,void 0,e);return new re(n,o)}class re{constructor(t,e=null){Object.defineProperty(this,_e,{value:io}),this.key=t,this.value=e}clone(t){let{key:e,value:n}=this;return ee(e)&&(e=e.clone(t)),ee(n)&&(n=n.clone(t)),new re(e,n)}toJSON(t,e){const n=e!=null&&e.mapAsMap?new Map:{};return wo(e,n,this)}toString(t,e,n){return t!=null&&t.doc?Ou(this,t,e,n):JSON.stringify(this)}}function ko(s,t,e){return(t.inFlow??s.flow?Au:Iu)(s,t,e)}function Iu({comment:s,items:t},e,{blockItemPrefix:n,flowChars:o,itemIndent:i,onChompKeep:l,onComment:a}){const{indent:c,options:{commentString:d}}=e,h=Object.assign({},e,{indent:i,type:null});let f=!1;const g=[];for(let _=0;_<t.length;++_){const m=t[_];let y=null;if(ee(m))!f&&m.spaceBefore&&g.push(""),ms(e,g,m.commentBefore,f),m.comment&&(y=m.comment);else if(z(m)){const $=ee(m.key)?m.key:null;$&&(!f&&$.spaceBefore&&g.push(""),ms(e,g,$.commentBefore,f))}f=!1;let N=pt(m,h,()=>y=null,()=>f=!0);y&&(N+=Fe(N,i,d(y))),f&&y&&(f=!1),g.push(n+N)}let b;if(g.length===0)b=o.start+o.end;else{b=g[0];for(let _=1;_<g.length;++_){const m=g[_];b+=m?`
${c}${m}`:`
`}}return s?(b+=`
`+Le(d(s),c),a&&a()):f&&l&&l(),b}function Au({items:s},t,{flowChars:e,itemIndent:n}){const{indent:o,indentStep:i,flowCollectionPadding:l,options:{commentString:a}}=t;n+=i;const c=Object.assign({},t,{indent:n,inFlow:!0,type:null});let d=!1,h=0;const f=[];for(let _=0;_<s.length;++_){const m=s[_];let y=null;if(ee(m))m.spaceBefore&&f.push(""),ms(t,f,m.commentBefore,!1),m.comment&&(y=m.comment);else if(z(m)){const $=ee(m.key)?m.key:null;$&&($.spaceBefore&&f.push(""),ms(t,f,$.commentBefore,!1),$.comment&&(d=!0));const S=ee(m.value)?m.value:null;S?(S.comment&&(y=S.comment),S.commentBefore&&(d=!0)):m.value==null&&($!=null&&$.comment)&&(y=$.comment)}y&&(d=!0);let N=pt(m,c,()=>y=null);_<s.length-1&&(N+=","),y&&(N+=Fe(N,n,a(y))),!d&&(f.length>h||N.includes(`
`))&&(d=!0),f.push(N),h=f.length}const{start:g,end:b}=e;if(f.length===0)return g+b;if(!d){const _=f.reduce((m,y)=>m+y.length+2,2);d=t.options.lineWidth>0&&_>t.options.lineWidth}if(d){let _=g;for(const m of f)_+=m?`
${i}${o}${m}`:`
`;return`${_}
${o}${b}`}else return`${g}${l}${f.join(" ")}${l}${b}`}function ms({indent:s,options:{commentString:t}},e,n,o){if(n&&o&&(n=n.replace(/^\n+/,"")),n){const i=Le(t(n),s);e.push(i.trimStart())}}function We(s,t){const e=Y(t)?t.value:t;for(const n of s)if(z(n)&&(n.key===t||n.key===e||Y(n.key)&&n.key.value===e))return n}class ge extends go{static get tagName(){return"tag:yaml.org,2002:map"}constructor(t){super(Me,t),this.items=[]}static from(t,e,n){const{keepUndefined:o,replacer:i}=n,l=new this(t),a=(c,d)=>{if(typeof i=="function")d=i.call(e,c,d);else if(Array.isArray(i)&&!i.includes(c))return;(d!==void 0||o)&&l.items.push(dn(c,d,n))};if(e instanceof Map)for(const[c,d]of e)a(c,d);else if(e&&typeof e=="object")for(const c of Object.keys(e))a(c,e[c]);return typeof t.sortMapEntries=="function"&&l.items.sort(t.sortMapEntries),l}add(t,e){var l;let n;z(t)?n=t:!t||typeof t!="object"||!("key"in t)?n=new re(t,t==null?void 0:t.value):n=new re(t.key,t.value);const o=We(this.items,n.key),i=(l=this.schema)==null?void 0:l.sortMapEntries;if(o){if(!e)throw new Error(`Key ${n.key} already set`);Y(o.value)&&mo(n.value)?o.value.value=n.value:o.value=n.value}else if(i){const a=this.items.findIndex(c=>i(n,c)<0);a===-1?this.items.push(n):this.items.splice(a,0,n)}else this.items.push(n)}delete(t){const e=We(this.items,t);return e?this.items.splice(this.items.indexOf(e),1).length>0:!1}get(t,e){const n=We(this.items,t),o=n==null?void 0:n.value;return(!e&&Y(o)?o.value:o)??void 0}has(t){return!!We(this.items,t)}set(t,e){this.add(new re(t,e),!0)}toJSON(t,e,n){const o=n?new n:e!=null&&e.mapAsMap?new Map:{};e!=null&&e.onCreate&&e.onCreate(o);for(const i of this.items)wo(e,o,i);return o}toString(t,e,n){if(!t)return JSON.stringify(this);for(const o of this.items)if(!z(o))throw new Error(`Map items must all be pairs; found ${JSON.stringify(o)} instead`);return!t.allNullValues&&this.hasAllNullValues(!1)&&(t=Object.assign({},t,{allNullValues:!0})),ko(this,t,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:t.indent||"",onChompKeep:n,onComment:e})}}const Ct={collection:"map",default:!0,nodeClass:ge,tag:"tag:yaml.org,2002:map",resolve(s,t){return kt(s)||t("Expected a mapping for this tag"),s},createNode:(s,t,e)=>ge.from(s,t,e)};class Ue extends go{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(t){super(wt,t),this.items=[]}add(t){this.items.push(t)}delete(t){const e=is(t);return typeof e!="number"?!1:this.items.splice(e,1).length>0}get(t,e){const n=is(t);if(typeof n!="number")return;const o=this.items[n];return!e&&Y(o)?o.value:o}has(t){const e=is(t);return typeof e=="number"&&e<this.items.length}set(t,e){const n=is(t);if(typeof n!="number")throw new Error(`Expected a valid index, not ${t}.`);const o=this.items[n];Y(o)&&mo(e)?o.value=e:this.items[n]=e}toJSON(t,e){const n=[];e!=null&&e.onCreate&&e.onCreate(n);let o=0;for(const i of this.items)n.push(ve(i,String(o++),e));return n}toString(t,e,n){return t?ko(this,t,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(t.indent||"")+"  ",onChompKeep:n,onComment:e}):JSON.stringify(this)}static from(t,e,n){const{replacer:o}=n,i=new this(t);if(e&&Symbol.iterator in Object(e)){let l=0;for(let a of e){if(typeof o=="function"){const c=e instanceof Set?a:String(l++);a=o.call(e,c,a)}i.items.push(Dt(a,void 0,n))}}return i}}function is(s){let t=Y(s)?s.value:s;return t&&typeof t=="string"&&(t=Number(t)),typeof t=="number"&&Number.isInteger(t)&&t>=0?t:null}const Nt={collection:"seq",default:!0,nodeClass:Ue,tag:"tag:yaml.org,2002:seq",resolve(s,t){return St(s)||t("Expected a sequence for this tag"),s},createNode:(s,t,e)=>Ue.from(s,t,e)},As={identify:s=>typeof s=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:s=>s,stringify(s,t,e,n){return t=Object.assign({actualString:!0},t),qt(s,t,e,n)}},Es={identify:s=>s==null,createNode:()=>new W(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new W(null),stringify:({source:s},t)=>typeof s=="string"&&Es.test.test(s)?s:t.options.nullStr},fn={identify:s=>typeof s=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:s=>new W(s[0]==="t"||s[0]==="T"),stringify({source:s,value:t},e){if(s&&fn.test.test(s)){const n=s[0]==="t"||s[0]==="T";if(t===n)return s}return t?e.options.trueStr:e.options.falseStr}};function Ce({format:s,minFractionDigits:t,tag:e,value:n}){if(typeof n=="bigint")return String(n);const o=typeof n=="number"?n:Number(n);if(!isFinite(o))return isNaN(o)?".nan":o<0?"-.inf":".inf";let i=JSON.stringify(n);if(!s&&t&&(!e||e==="tag:yaml.org,2002:float")&&/^\d/.test(i)){let l=i.indexOf(".");l<0&&(l=i.length,i+=".");let a=t-(i.length-l-1);for(;a-- >0;)i+="0"}return i}const $o={identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:s=>s.slice(-3).toLowerCase()==="nan"?NaN:s[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:Ce},So={identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:s=>parseFloat(s),stringify(s){const t=Number(s.value);return isFinite(t)?t.toExponential():Ce(s)}},Co={identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(s){const t=new W(parseFloat(s)),e=s.indexOf(".");return e!==-1&&s[s.length-1]==="0"&&(t.minFractionDigits=s.length-e-1),t},stringify:Ce},Vs=s=>typeof s=="bigint"||Number.isInteger(s),pn=(s,t,e,{intAsBigInt:n})=>n?BigInt(s):parseInt(s.substring(t),e);function No(s,t,e){const{value:n}=s;return Vs(n)&&n>=0?e+n.toString(t):Ce(s)}const Oo={identify:s=>Vs(s)&&s>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(s,t,e)=>pn(s,2,8,e),stringify:s=>No(s,8,"0o")},To={identify:Vs,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(s,t,e)=>pn(s,0,10,e),stringify:Ce},Lo={identify:s=>Vs(s)&&s>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(s,t,e)=>pn(s,2,16,e),stringify:s=>No(s,16,"0x")},Eu=[Ct,Nt,As,Es,fn,Oo,To,Lo,$o,So,Co];function In(s){return typeof s=="bigint"||Number.isInteger(s)}const ls=({value:s})=>JSON.stringify(s),Vu=[{identify:s=>typeof s=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:s=>s,stringify:ls},{identify:s=>s==null,createNode:()=>new W(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:ls},{identify:s=>typeof s=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^true$|^false$/,resolve:s=>s==="true",stringify:ls},{identify:In,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(s,t,{intAsBigInt:e})=>e?BigInt(s):parseInt(s,10),stringify:({value:s})=>In(s)?s.toString():JSON.stringify(s)},{identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:s=>parseFloat(s),stringify:ls}],xu={default:!0,tag:"",test:/^/,resolve(s,t){return t(`Unresolved plain scalar ${JSON.stringify(s)}`),s}},Du=[Ct,Nt].concat(Vu,xu),hn={identify:s=>s instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(s,t){if(typeof atob=="function"){const e=atob(s.replace(/[\n\r]/g,"")),n=new Uint8Array(e.length);for(let o=0;o<e.length;++o)n[o]=e.charCodeAt(o);return n}else return t("This environment does not support reading binary tags; either Buffer or atob is required"),s},stringify({comment:s,type:t,value:e},n,o,i){if(!e)return"";const l=e;let a;if(typeof btoa=="function"){let c="";for(let d=0;d<l.length;++d)c+=String.fromCharCode(l[d]);a=btoa(c)}else throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");if(t??(t=W.BLOCK_LITERAL),t!==W.QUOTE_DOUBLE){const c=Math.max(n.options.lineWidth-n.indent.length,n.options.minContentWidth),d=Math.ceil(a.length/c),h=new Array(d);for(let f=0,g=0;f<d;++f,g+=c)h[f]=a.substr(g,c);a=h.join(t===W.BLOCK_LITERAL?`
`:" ")}return qt({comment:s,type:t,value:a},n,o,i)}};function Io(s,t){if(St(s))for(let e=0;e<s.items.length;++e){let n=s.items[e];if(!z(n)){if(kt(n)){n.items.length>1&&t("Each pair must have its own sequence indicator");const o=n.items[0]||new re(new W(null));if(n.commentBefore&&(o.key.commentBefore=o.key.commentBefore?`${n.commentBefore}
${o.key.commentBefore}`:n.commentBefore),n.comment){const i=o.value??o.key;i.comment=i.comment?`${n.comment}
${i.comment}`:n.comment}n=o}s.items[e]=z(n)?n:new re(n)}}else t("Expected a sequence for this tag");return s}function Ao(s,t,e){const{replacer:n}=e,o=new Ue(s);o.tag="tag:yaml.org,2002:pairs";let i=0;if(t&&Symbol.iterator in Object(t))for(let l of t){typeof n=="function"&&(l=n.call(t,String(i++),l));let a,c;if(Array.isArray(l))if(l.length===2)a=l[0],c=l[1];else throw new TypeError(`Expected [key, value] tuple: ${l}`);else if(l&&l instanceof Object){const d=Object.keys(l);if(d.length===1)a=d[0],c=l[a];else throw new TypeError(`Expected tuple with one key, not ${d.length} keys`)}else a=l;o.items.push(dn(a,c,e))}return o}const mn={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:Io,createNode:Ao};class ct extends Ue{constructor(){super(),this.add=ge.prototype.add.bind(this),this.delete=ge.prototype.delete.bind(this),this.get=ge.prototype.get.bind(this),this.has=ge.prototype.has.bind(this),this.set=ge.prototype.set.bind(this),this.tag=ct.tag}toJSON(t,e){if(!e)return super.toJSON(t);const n=new Map;e!=null&&e.onCreate&&e.onCreate(n);for(const o of this.items){let i,l;if(z(o)?(i=ve(o.key,"",e),l=ve(o.value,i,e)):i=ve(o,"",e),n.has(i))throw new Error("Ordered maps must not include duplicate keys");n.set(i,l)}return n}static from(t,e,n){const o=Ao(t,e,n),i=new this;return i.items=o.items,i}}ct.tag="tag:yaml.org,2002:omap";const gn={collection:"seq",identify:s=>s instanceof Map,nodeClass:ct,default:!1,tag:"tag:yaml.org,2002:omap",resolve(s,t){const e=Io(s,t),n=[];for(const{key:o}of e.items)Y(o)&&(n.includes(o.value)?t(`Ordered maps must not include duplicate keys: ${o.value}`):n.push(o.value));return Object.assign(new ct,e)},createNode:(s,t,e)=>ct.from(s,t,e)};function Eo({value:s,source:t},e){return t&&(s?Vo:xo).test.test(t)?t:s?e.options.trueStr:e.options.falseStr}const Vo={identify:s=>s===!0,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new W(!0),stringify:Eo},xo={identify:s=>s===!1,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/,resolve:()=>new W(!1),stringify:Eo},Bu={identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:s=>s.slice(-3).toLowerCase()==="nan"?NaN:s[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:Ce},ju={identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:s=>parseFloat(s.replace(/_/g,"")),stringify(s){const t=Number(s.value);return isFinite(t)?t.toExponential():Ce(s)}},Mu={identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(s){const t=new W(parseFloat(s.replace(/_/g,""))),e=s.indexOf(".");if(e!==-1){const n=s.substring(e+1).replace(/_/g,"");n[n.length-1]==="0"&&(t.minFractionDigits=n.length)}return t},stringify:Ce},Kt=s=>typeof s=="bigint"||Number.isInteger(s);function xs(s,t,e,{intAsBigInt:n}){const o=s[0];if((o==="-"||o==="+")&&(t+=1),s=s.substring(t).replace(/_/g,""),n){switch(e){case 2:s=`0b${s}`;break;case 8:s=`0o${s}`;break;case 16:s=`0x${s}`;break}const l=BigInt(s);return o==="-"?BigInt(-1)*l:l}const i=parseInt(s,e);return o==="-"?-1*i:i}function bn(s,t,e){const{value:n}=s;if(Kt(n)){const o=n.toString(t);return n<0?"-"+e+o.substr(1):e+o}return Ce(s)}const Uu={identify:Kt,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(s,t,e)=>xs(s,2,2,e),stringify:s=>bn(s,2,"0b")},Pu={identify:Kt,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(s,t,e)=>xs(s,1,8,e),stringify:s=>bn(s,8,"0")},Ru={identify:Kt,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(s,t,e)=>xs(s,0,10,e),stringify:Ce},qu={identify:Kt,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(s,t,e)=>xs(s,2,16,e),stringify:s=>bn(s,16,"0x")};class ut extends ge{constructor(t){super(t),this.tag=ut.tag}add(t){let e;z(t)?e=t:t&&typeof t=="object"&&"key"in t&&"value"in t&&t.value===null?e=new re(t.key,null):e=new re(t,null),We(this.items,e.key)||this.items.push(e)}get(t,e){const n=We(this.items,t);return!e&&z(n)?Y(n.key)?n.key.value:n.key:n}set(t,e){if(typeof e!="boolean")throw new Error(`Expected boolean value for set(key, value) in a YAML set, not ${typeof e}`);const n=We(this.items,t);n&&!e?this.items.splice(this.items.indexOf(n),1):!n&&e&&this.items.push(new re(t))}toJSON(t,e){return super.toJSON(t,e,Set)}toString(t,e,n){if(!t)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},t,{allNullValues:!0}),e,n);throw new Error("Set items must all have null values")}static from(t,e,n){const{replacer:o}=n,i=new this(t);if(e&&Symbol.iterator in Object(e))for(let l of e)typeof o=="function"&&(l=o.call(e,l,l)),i.items.push(dn(l,null,n));return i}}ut.tag="tag:yaml.org,2002:set";const yn={collection:"map",identify:s=>s instanceof Set,nodeClass:ut,default:!1,tag:"tag:yaml.org,2002:set",createNode:(s,t,e)=>ut.from(s,t,e),resolve(s,t){if(kt(s)){if(s.hasAllNullValues(!0))return Object.assign(new ut,s);t("Set items must all have null values")}else t("Expected a mapping for this tag");return s}};function vn(s,t){const e=s[0],n=e==="-"||e==="+"?s.substring(1):s,o=l=>t?BigInt(l):Number(l),i=n.replace(/_/g,"").split(":").reduce((l,a)=>l*o(60)+o(a),o(0));return e==="-"?o(-1)*i:i}function Do(s){let{value:t}=s,e=l=>l;if(typeof t=="bigint")e=l=>BigInt(l);else if(isNaN(t)||!isFinite(t))return Ce(s);let n="";t<0&&(n="-",t*=e(-1));const o=e(60),i=[t%o];return t<60?i.unshift(0):(t=(t-i[0])/o,i.unshift(t%o),t>=60&&(t=(t-i[0])/o,i.unshift(t))),n+i.map(l=>String(l).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}const Bo={identify:s=>typeof s=="bigint"||Number.isInteger(s),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(s,t,{intAsBigInt:e})=>vn(s,e),stringify:Do},jo={identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:s=>vn(s,!1),stringify:Do},Ds={identify:s=>s instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(s){const t=s.match(Ds.test);if(!t)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");const[,e,n,o,i,l,a]=t.map(Number),c=t[7]?Number((t[7]+"00").substr(1,3)):0;let d=Date.UTC(e,n-1,o,i||0,l||0,a||0,c);const h=t[8];if(h&&h!=="Z"){let f=vn(h,!1);Math.abs(f)<30&&(f*=60),d-=6e4*f}return new Date(d)},stringify:({value:s})=>(s==null?void 0:s.toISOString().replace(/(T00:00:00)?\.000Z$/,""))??""},An=[Ct,Nt,As,Es,Vo,xo,Uu,Pu,Ru,qu,Bu,ju,Mu,hn,Ie,gn,mn,yn,Bo,jo,Ds],En=new Map([["core",Eu],["failsafe",[Ct,Nt,As]],["json",Du],["yaml11",An],["yaml-1.1",An]]),Vn={binary:hn,bool:fn,float:Co,floatExp:So,floatNaN:$o,floatTime:jo,int:To,intHex:Lo,intOct:Oo,intTime:Bo,map:Ct,merge:Ie,null:Es,omap:gn,pairs:mn,seq:Nt,set:yn,timestamp:Ds},Ku={"tag:yaml.org,2002:binary":hn,"tag:yaml.org,2002:merge":Ie,"tag:yaml.org,2002:omap":gn,"tag:yaml.org,2002:pairs":mn,"tag:yaml.org,2002:set":yn,"tag:yaml.org,2002:timestamp":Ds};function Fs(s,t,e){const n=En.get(t);if(n&&!s)return e&&!n.includes(Ie)?n.concat(Ie):n.slice();let o=n;if(!o)if(Array.isArray(s))o=[];else{const i=Array.from(En.keys()).filter(l=>l!=="yaml11").map(l=>JSON.stringify(l)).join(", ");throw new Error(`Unknown schema "${t}"; use one of ${i} or define customTags array`)}if(Array.isArray(s))for(const i of s)o=o.concat(i);else typeof s=="function"&&(o=s(o.slice()));return e&&(o=o.concat(Ie)),o.reduce((i,l)=>{const a=typeof l=="string"?Vn[l]:l;if(!a){const c=JSON.stringify(l),d=Object.keys(Vn).map(h=>JSON.stringify(h)).join(", ");throw new Error(`Unknown custom tag ${c}; use one of ${d}`)}return i.includes(a)||i.push(a),i},[])}const Fu=(s,t)=>s.key<t.key?-1:s.key>t.key?1:0;class Bs{constructor({compat:t,customTags:e,merge:n,resolveKnownTags:o,schema:i,sortMapEntries:l,toStringDefaults:a}){this.compat=Array.isArray(t)?Fs(t,"compat"):t?Fs(null,t):null,this.name=typeof i=="string"&&i||"core",this.knownTags=o?Ku:{},this.tags=Fs(e,this.name,n),this.toStringOptions=a??null,Object.defineProperty(this,Me,{value:Ct}),Object.defineProperty(this,Oe,{value:As}),Object.defineProperty(this,wt,{value:Nt}),this.sortMapEntries=typeof l=="function"?l:l===!0?Fu:null}clone(){const t=Object.create(Bs.prototype,Object.getOwnPropertyDescriptors(this));return t.tags=this.tags.slice(),t}}function Wu(s,t){var c;const e=[];let n=t.directives===!0;if(t.directives!==!1&&s.directives){const d=s.directives.toString(s);d?(e.push(d),n=!0):s.directives.docStart&&(n=!0)}n&&e.push("---");const o=yo(s,t),{commentString:i}=o.options;if(s.commentBefore){e.length!==1&&e.unshift("");const d=i(s.commentBefore);e.unshift(Le(d,""))}let l=!1,a=null;if(s.contents){if(ee(s.contents)){if(s.contents.spaceBefore&&n&&e.push(""),s.contents.commentBefore){const f=i(s.contents.commentBefore);e.push(Le(f,""))}o.forceBlockIndent=!!s.comment,a=s.contents.comment}const d=a?void 0:()=>l=!0;let h=pt(s.contents,o,()=>a=null,d);a&&(h+=Fe(h,"",i(a))),(h[0]==="|"||h[0]===">")&&e[e.length-1]==="---"?e[e.length-1]=`--- ${h}`:e.push(h)}else e.push(pt(s.contents,o));if((c=s.directives)!=null&&c.docEnd)if(s.comment){const d=i(s.comment);d.includes(`
`)?(e.push("..."),e.push(Le(d,""))):e.push(`... ${d}`)}else e.push("...");else{let d=s.comment;d&&l&&(d=d.replace(/^\n+/,"")),d&&((!l||a)&&e[e.length-1]!==""&&e.push(""),e.push(Le(i(d),"")))}return e.join(`
`)+`
`}class Ot{constructor(t,e,n){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,_e,{value:Ys});let o=null;typeof e=="function"||Array.isArray(e)?o=e:n===void 0&&e&&(n=e,e=void 0);const i=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,stringKeys:!1,uniqueKeys:!0,version:"1.2"},n);this.options=i;let{version:l}=i;n!=null&&n._directives?(this.directives=n._directives.atDocument(),this.directives.yaml.explicit&&(l=this.directives.yaml.version)):this.directives=new ue({version:l}),this.setSchema(l,n),this.contents=t===void 0?null:this.createNode(t,o,n)}clone(){const t=Object.create(Ot.prototype,{[_e]:{value:Ys}});return t.commentBefore=this.commentBefore,t.comment=this.comment,t.errors=this.errors.slice(),t.warnings=this.warnings.slice(),t.options=Object.assign({},this.options),this.directives&&(t.directives=this.directives.clone()),t.schema=this.schema.clone(),t.contents=ee(this.contents)?this.contents.clone(t.schema):this.contents,this.range&&(t.range=this.range.slice()),t}add(t){nt(this.contents)&&this.contents.add(t)}addIn(t,e){nt(this.contents)&&this.contents.addIn(t,e)}createAlias(t,e){if(!t.anchor){const n=po(this);t.anchor=!e||n.has(e)?ho(e||"a",n):e}return new Os(t.anchor)}createNode(t,e,n){let o;if(typeof e=="function")t=e.call({"":t},"",t),o=e;else if(Array.isArray(e)){const y=$=>typeof $=="number"||$ instanceof String||$ instanceof Number,N=e.filter(y).map(String);N.length>0&&(e=e.concat(N)),o=e}else n===void 0&&e&&(n=e,e=void 0);const{aliasDuplicateObjects:i,anchorPrefix:l,flow:a,keepUndefined:c,onTagObj:d,tag:h}=n??{},{onAnchor:f,setAnchors:g,sourceObjects:b}=vu(this,l||"a"),_={aliasDuplicateObjects:i??!0,keepUndefined:c??!1,onAnchor:f,onTagObj:d,replacer:o,schema:this.schema,sourceObjects:b},m=Dt(t,h,_);return a&&Z(m)&&(m.flow=!0),g(),m}createPair(t,e,n={}){const o=this.createNode(t,null,n),i=this.createNode(e,null,n);return new re(o,i)}delete(t){return nt(this.contents)?this.contents.delete(t):!1}deleteIn(t){return Et(t)?this.contents==null?!1:(this.contents=null,!0):nt(this.contents)?this.contents.deleteIn(t):!1}get(t,e){return Z(this.contents)?this.contents.get(t,e):void 0}getIn(t,e){return Et(t)?!e&&Y(this.contents)?this.contents.value:this.contents:Z(this.contents)?this.contents.getIn(t,e):void 0}has(t){return Z(this.contents)?this.contents.has(t):!1}hasIn(t){return Et(t)?this.contents!==void 0:Z(this.contents)?this.contents.hasIn(t):!1}set(t,e){this.contents==null?this.contents=hs(this.schema,[t],e):nt(this.contents)&&this.contents.set(t,e)}setIn(t,e){Et(t)?this.contents=e:this.contents==null?this.contents=hs(this.schema,Array.from(t),e):nt(this.contents)&&this.contents.setIn(t,e)}setSchema(t,e={}){typeof t=="number"&&(t=String(t));let n;switch(t){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new ue({version:"1.1"}),n={resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=t:this.directives=new ue({version:t}),n={resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,n=null;break;default:{const o=JSON.stringify(t);throw new Error(`Expected '1.1', '1.2' or null as first argument, but found: ${o}`)}}if(e.schema instanceof Object)this.schema=e.schema;else if(n)this.schema=new Bs(Object.assign(n,e));else throw new Error("With a null YAML version, the { schema: Schema } option is required")}toJS({json:t,jsonArg:e,mapAsMap:n,maxAliasCount:o,onAnchor:i,reviver:l}={}){const a={anchors:new Map,doc:this,keep:!t,mapAsMap:n===!0,mapKeyWarned:!1,maxAliasCount:typeof o=="number"?o:100},c=ve(this.contents,e??"",a);if(typeof i=="function")for(const{count:d,res:h}of a.anchors.values())i(h,d);return typeof l=="function"?at(l,{"":c},"",c):c}toJSON(t,e){return this.toJS({json:!0,jsonArg:t,mapAsMap:!1,onAnchor:e})}toString(t={}){if(this.errors.length>0)throw new Error("Document with errors cannot be stringified");if("indent"in t&&(!Number.isInteger(t.indent)||Number(t.indent)<=0)){const e=JSON.stringify(t.indent);throw new Error(`"indent" option must be a positive integer, not ${e}`)}return Wu(this,t)}}function nt(s){if(Z(s))return!0;throw new Error("Expected a YAML collection as document contents")}class _n extends Error{constructor(t,e,n,o){super(),this.name=t,this.code=n,this.message=o,this.pos=e}}class He extends _n{constructor(t,e,n){super("YAMLParseError",t,e,n)}}class Mo extends _n{constructor(t,e,n){super("YAMLWarning",t,e,n)}}const gs=(s,t)=>e=>{if(e.pos[0]===-1)return;e.linePos=e.pos.map(a=>t.linePos(a));const{line:n,col:o}=e.linePos[0];e.message+=` at line ${n}, column ${o}`;let i=o-1,l=s.substring(t.lineStarts[n-1],t.lineStarts[n]).replace(/[\n\r]+$/,"");if(i>=60&&l.length>80){const a=Math.min(i-39,l.length-79);l="â€¦"+l.substring(a),i-=a-1}if(l.length>80&&(l=l.substring(0,79)+"â€¦"),n>1&&/^ *$/.test(l.substring(0,i))){let a=s.substring(t.lineStarts[n-2],t.lineStarts[n-1]);a.length>80&&(a=a.substring(0,79)+`â€¦
`),l=a+l}if(/[^ ]/.test(l)){let a=1;const c=e.linePos[1];c&&c.line===n&&c.col>o&&(a=Math.max(1,Math.min(c.col-o,80-i)));const d=" ".repeat(i)+"^".repeat(a);e.message+=`:

${l}
${d}
`}};function ht(s,{flow:t,indicator:e,next:n,offset:o,onError:i,parentIndent:l,startOnNewline:a}){let c=!1,d=a,h=a,f="",g="",b=!1,_=!1,m=null,y=null,N=null,$=null,S=null,O=null,k=null;for(const I of s)switch(_&&(I.type!=="space"&&I.type!=="newline"&&I.type!=="comma"&&i(I.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),_=!1),m&&(d&&I.type!=="comment"&&I.type!=="newline"&&i(m,"TAB_AS_INDENT","Tabs are not allowed as indentation"),m=null),I.type){case"space":!t&&(e!=="doc-start"||(n==null?void 0:n.type)!=="flow-collection")&&I.source.includes("	")&&(m=I),h=!0;break;case"comment":{h||i(I,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const F=I.source.substring(1)||" ";f?f+=g+F:f=F,g="",d=!1;break}case"newline":d?f?f+=I.source:(!O||e!=="seq-item-ind")&&(c=!0):g+=I.source,d=!0,b=!0,(y||N)&&($=I),h=!0;break;case"anchor":y&&i(I,"MULTIPLE_ANCHORS","A node can have at most one anchor"),I.source.endsWith(":")&&i(I.offset+I.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),y=I,k??(k=I.offset),d=!1,h=!1,_=!0;break;case"tag":{N&&i(I,"MULTIPLE_TAGS","A node can have at most one tag"),N=I,k??(k=I.offset),d=!1,h=!1,_=!0;break}case e:(y||N)&&i(I,"BAD_PROP_ORDER",`Anchors and tags must be after the ${I.source} indicator`),O&&i(I,"UNEXPECTED_TOKEN",`Unexpected ${I.source} in ${t??"collection"}`),O=I,d=e==="seq-item-ind"||e==="explicit-key-ind",h=!1;break;case"comma":if(t){S&&i(I,"UNEXPECTED_TOKEN",`Unexpected , in ${t}`),S=I,d=!1,h=!1;break}default:i(I,"UNEXPECTED_TOKEN",`Unexpected ${I.type} token`),d=!1,h=!1}const A=s[s.length-1],D=A?A.offset+A.source.length:o;return _&&n&&n.type!=="space"&&n.type!=="newline"&&n.type!=="comma"&&(n.type!=="scalar"||n.source!=="")&&i(n.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),m&&(d&&m.indent<=l||(n==null?void 0:n.type)==="block-map"||(n==null?void 0:n.type)==="block-seq")&&i(m,"TAB_AS_INDENT","Tabs are not allowed as indentation"),{comma:S,found:O,spaceBefore:c,comment:f,hasNewline:b,anchor:y,tag:N,newlineAfterProp:$,end:D,start:k??D}}function Bt(s){if(!s)return null;switch(s.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(s.source.includes(`
`))return!0;if(s.end){for(const t of s.end)if(t.type==="newline")return!0}return!1;case"flow-collection":for(const t of s.items){for(const e of t.start)if(e.type==="newline")return!0;if(t.sep){for(const e of t.sep)if(e.type==="newline")return!0}if(Bt(t.key)||Bt(t.value))return!0}return!1;default:return!0}}function en(s,t,e){if((t==null?void 0:t.type)==="flow-collection"){const n=t.end[0];n.indent===s&&(n.source==="]"||n.source==="}")&&Bt(t)&&e(n,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}function Uo(s,t,e){const{uniqueKeys:n}=s.options;if(n===!1)return!1;const o=typeof n=="function"?n:(i,l)=>i===l||Y(i)&&Y(l)&&i.value===l.value;return t.some(i=>o(i.key,e))}const xn="All mapping items must start at the same column";function Hu({composeNode:s,composeEmptyNode:t},e,n,o,i){var h;const l=(i==null?void 0:i.nodeClass)??ge,a=new l(e.schema);e.atRoot&&(e.atRoot=!1);let c=n.offset,d=null;for(const f of n.items){const{start:g,key:b,sep:_,value:m}=f,y=ht(g,{indicator:"explicit-key-ind",next:b??(_==null?void 0:_[0]),offset:c,onError:o,parentIndent:n.indent,startOnNewline:!0}),N=!y.found;if(N){if(b&&(b.type==="block-seq"?o(c,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in b&&b.indent!==n.indent&&o(c,"BAD_INDENT",xn)),!y.anchor&&!y.tag&&!_){d=y.end,y.comment&&(a.comment?a.comment+=`
`+y.comment:a.comment=y.comment);continue}(y.newlineAfterProp||Bt(b))&&o(b??g[g.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else((h=y.found)==null?void 0:h.indent)!==n.indent&&o(c,"BAD_INDENT",xn);e.atKey=!0;const $=y.end,S=b?s(e,b,y,o):t(e,$,g,null,y,o);e.schema.compat&&en(n.indent,b,o),e.atKey=!1,Uo(e,a.items,S)&&o($,"DUPLICATE_KEY","Map keys must be unique");const O=ht(_??[],{indicator:"map-value-ind",next:m,offset:S.range[2],onError:o,parentIndent:n.indent,startOnNewline:!b||b.type==="block-scalar"});if(c=O.end,O.found){N&&((m==null?void 0:m.type)==="block-map"&&!O.hasNewline&&o(c,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),e.options.strict&&y.start<O.found.offset-1024&&o(S.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));const k=m?s(e,m,O,o):t(e,c,_,null,O,o);e.schema.compat&&en(n.indent,m,o),c=k.range[2];const A=new re(S,k);e.options.keepSourceTokens&&(A.srcToken=f),a.items.push(A)}else{N&&o(S.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),O.comment&&(S.comment?S.comment+=`
`+O.comment:S.comment=O.comment);const k=new re(S);e.options.keepSourceTokens&&(k.srcToken=f),a.items.push(k)}}return d&&d<c&&o(d,"IMPOSSIBLE","Map comment with trailing content"),a.range=[n.offset,c,d??c],a}function Gu({composeNode:s,composeEmptyNode:t},e,n,o,i){const l=(i==null?void 0:i.nodeClass)??Ue,a=new l(e.schema);e.atRoot&&(e.atRoot=!1),e.atKey&&(e.atKey=!1);let c=n.offset,d=null;for(const{start:h,value:f}of n.items){const g=ht(h,{indicator:"seq-item-ind",next:f,offset:c,onError:o,parentIndent:n.indent,startOnNewline:!0});if(!g.found)if(g.anchor||g.tag||f)f&&f.type==="block-seq"?o(g.end,"BAD_INDENT","All sequence items must start at the same column"):o(c,"MISSING_CHAR","Sequence item without - indicator");else{d=g.end,g.comment&&(a.comment=g.comment);continue}const b=f?s(e,f,g,o):t(e,g.end,h,null,g,o);e.schema.compat&&en(n.indent,f,o),c=b.range[2],a.items.push(b)}return a.range=[n.offset,c,d??c],a}function Ft(s,t,e,n){let o="";if(s){let i=!1,l="";for(const a of s){const{source:c,type:d}=a;switch(d){case"space":i=!0;break;case"comment":{e&&!i&&n(a,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const h=c.substring(1)||" ";o?o+=l+h:o=h,l="";break}case"newline":o&&(l+=c),i=!0;break;default:n(a,"UNEXPECTED_TOKEN",`Unexpected ${d} at node end`)}t+=c.length}}return{comment:o,offset:t}}const Ws="Block collections are not allowed within flow collections",Hs=s=>s&&(s.type==="block-map"||s.type==="block-seq");function Ju({composeNode:s,composeEmptyNode:t},e,n,o,i){const l=n.start.source==="{",a=l?"flow map":"flow sequence",c=(i==null?void 0:i.nodeClass)??(l?ge:Ue),d=new c(e.schema);d.flow=!0;const h=e.atRoot;h&&(e.atRoot=!1),e.atKey&&(e.atKey=!1);let f=n.offset+n.start.source.length;for(let y=0;y<n.items.length;++y){const N=n.items[y],{start:$,key:S,sep:O,value:k}=N,A=ht($,{flow:a,indicator:"explicit-key-ind",next:S??(O==null?void 0:O[0]),offset:f,onError:o,parentIndent:n.indent,startOnNewline:!1});if(!A.found){if(!A.anchor&&!A.tag&&!O&&!k){y===0&&A.comma?o(A.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${a}`):y<n.items.length-1&&o(A.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${a}`),A.comment&&(d.comment?d.comment+=`
`+A.comment:d.comment=A.comment),f=A.end;continue}!l&&e.options.strict&&Bt(S)&&o(S,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(y===0)A.comma&&o(A.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${a}`);else if(A.comma||o(A.start,"MISSING_CHAR",`Missing , between ${a} items`),A.comment){let D="";e:for(const I of $)switch(I.type){case"comma":case"space":break;case"comment":D=I.source.substring(1);break e;default:break e}if(D){let I=d.items[d.items.length-1];z(I)&&(I=I.value??I.key),I.comment?I.comment+=`
`+D:I.comment=D,A.comment=A.comment.substring(D.length+1)}}if(!l&&!O&&!A.found){const D=k?s(e,k,A,o):t(e,A.end,O,null,A,o);d.items.push(D),f=D.range[2],Hs(k)&&o(D.range,"BLOCK_IN_FLOW",Ws)}else{e.atKey=!0;const D=A.end,I=S?s(e,S,A,o):t(e,D,$,null,A,o);Hs(S)&&o(I.range,"BLOCK_IN_FLOW",Ws),e.atKey=!1;const F=ht(O??[],{flow:a,indicator:"map-value-ind",next:k,offset:I.range[2],onError:o,parentIndent:n.indent,startOnNewline:!1});if(F.found){if(!l&&!A.found&&e.options.strict){if(O)for(const q of O){if(q===F.found)break;if(q.type==="newline"){o(q,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}A.start<F.found.offset-1024&&o(F.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else k&&("source"in k&&k.source&&k.source[0]===":"?o(k,"MISSING_CHAR",`Missing space after : in ${a}`):o(F.start,"MISSING_CHAR",`Missing , or : between ${a} items`));const V=k?s(e,k,F,o):F.found?t(e,F.end,O,null,F,o):null;V?Hs(k)&&o(V.range,"BLOCK_IN_FLOW",Ws):F.comment&&(I.comment?I.comment+=`
`+F.comment:I.comment=F.comment);const H=new re(I,V);if(e.options.keepSourceTokens&&(H.srcToken=N),l){const q=d;Uo(e,q.items,I)&&o(D,"DUPLICATE_KEY","Map keys must be unique"),q.items.push(H)}else{const q=new ge(e.schema);q.flow=!0,q.items.push(H);const J=(V??I).range;q.range=[I.range[0],J[1],J[2]],d.items.push(q)}f=V?V.range[2]:F.end}}const g=l?"}":"]",[b,..._]=n.end;let m=f;if(b&&b.source===g)m=b.offset+b.source.length;else{const y=a[0].toUpperCase()+a.substring(1),N=h?`${y} must end with a ${g}`:`${y} in block collection must be sufficiently indented and end with a ${g}`;o(f,h?"MISSING_CHAR":"BAD_INDENT",N),b&&b.source.length!==1&&_.unshift(b)}if(_.length>0){const y=Ft(_,m,e.options.strict,o);y.comment&&(d.comment?d.comment+=`
`+y.comment:d.comment=y.comment),d.range=[n.offset,m,y.offset]}else d.range=[n.offset,m,m];return d}function Gs(s,t,e,n,o,i){const l=e.type==="block-map"?Hu(s,t,e,n,i):e.type==="block-seq"?Gu(s,t,e,n,i):Ju(s,t,e,n,i),a=l.constructor;return o==="!"||o===a.tagName?(l.tag=a.tagName,l):(o&&(l.tag=o),l)}function Qu(s,t,e,n,o){var g;const i=n.tag,l=i?t.directives.tagName(i.source,b=>o(i,"TAG_RESOLVE_FAILED",b)):null;if(e.type==="block-seq"){const{anchor:b,newlineAfterProp:_}=n,m=b&&i?b.offset>i.offset?b:i:b??i;m&&(!_||_.offset<m.offset)&&o(m,"MISSING_CHAR","Missing newline after block sequence props")}const a=e.type==="block-map"?"map":e.type==="block-seq"?"seq":e.start.source==="{"?"map":"seq";if(!i||!l||l==="!"||l===ge.tagName&&a==="map"||l===Ue.tagName&&a==="seq")return Gs(s,t,e,o,l);let c=t.schema.tags.find(b=>b.tag===l&&b.collection===a);if(!c){const b=t.schema.knownTags[l];if(b&&b.collection===a)t.schema.tags.push(Object.assign({},b,{default:!1})),c=b;else return b?o(i,"BAD_COLLECTION_TYPE",`${b.tag} used for ${a} collection, but expects ${b.collection??"scalar"}`,!0):o(i,"TAG_RESOLVE_FAILED",`Unresolved tag: ${l}`,!0),Gs(s,t,e,o,l)}const d=Gs(s,t,e,o,l,c),h=((g=c.resolve)==null?void 0:g.call(c,d,b=>o(i,"TAG_RESOLVE_FAILED",b),t.options))??d,f=ee(h)?h:new W(h);return f.range=d.range,f.tag=l,c!=null&&c.format&&(f.format=c.format),f}function Po(s,t,e){const n=t.offset,o=Yu(t,s.options.strict,e);if(!o)return{value:"",type:null,comment:"",range:[n,n,n]};const i=o.mode===">"?W.BLOCK_FOLDED:W.BLOCK_LITERAL,l=t.source?zu(t.source):[];let a=l.length;for(let m=l.length-1;m>=0;--m){const y=l[m][1];if(y===""||y==="\r")a=m;else break}if(a===0){const m=o.chomp==="+"&&l.length>0?`
`.repeat(Math.max(1,l.length-1)):"";let y=n+o.length;return t.source&&(y+=t.source.length),{value:m,type:i,comment:o.comment,range:[n,y,y]}}let c=t.indent+o.indent,d=t.offset+o.length,h=0;for(let m=0;m<a;++m){const[y,N]=l[m];if(N===""||N==="\r")o.indent===0&&y.length>c&&(c=y.length);else{y.length<c&&e(d+y.length,"MISSING_CHAR","Block scalars with more-indented leading empty lines must use an explicit indentation indicator"),o.indent===0&&(c=y.length),h=m,c===0&&!s.atRoot&&e(d,"BAD_INDENT","Block scalar values in collections must be indented");break}d+=y.length+N.length+1}for(let m=l.length-1;m>=a;--m)l[m][0].length>c&&(a=m+1);let f="",g="",b=!1;for(let m=0;m<h;++m)f+=l[m][0].slice(c)+`
`;for(let m=h;m<a;++m){let[y,N]=l[m];d+=y.length+N.length+1;const $=N[N.length-1]==="\r";if($&&(N=N.slice(0,-1)),N&&y.length<c){const O=`Block scalar lines must not be less indented than their ${o.indent?"explicit indentation indicator":"first line"}`;e(d-N.length-($?2:1),"BAD_INDENT",O),y=""}i===W.BLOCK_LITERAL?(f+=g+y.slice(c)+N,g=`
`):y.length>c||N[0]==="	"?(g===" "?g=`
`:!b&&g===`
`&&(g=`

`),f+=g+y.slice(c)+N,g=`
`,b=!0):N===""?g===`
`?f+=`
`:g=`
`:(f+=g+N,g=" ",b=!1)}switch(o.chomp){case"-":break;case"+":for(let m=a;m<l.length;++m)f+=`
`+l[m][0].slice(c);f[f.length-1]!==`
`&&(f+=`
`);break;default:f+=`
`}const _=n+o.length+t.source.length;return{value:f,type:i,comment:o.comment,range:[n,_,_]}}function Yu({offset:s,props:t},e,n){if(t[0].type!=="block-scalar-header")return n(t[0],"IMPOSSIBLE","Block scalar header not found"),null;const{source:o}=t[0],i=o[0];let l=0,a="",c=-1;for(let g=1;g<o.length;++g){const b=o[g];if(!a&&(b==="-"||b==="+"))a=b;else{const _=Number(b);!l&&_?l=_:c===-1&&(c=s+g)}}c!==-1&&n(c,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${o}`);let d=!1,h="",f=o.length;for(let g=1;g<t.length;++g){const b=t[g];switch(b.type){case"space":d=!0;case"newline":f+=b.source.length;break;case"comment":e&&!d&&n(b,"MISSING_CHAR","Comments must be separated from other tokens by white space characters"),f+=b.source.length,h=b.source.substring(1);break;case"error":n(b,"UNEXPECTED_TOKEN",b.message),f+=b.source.length;break;default:{const _=`Unexpected token in block scalar header: ${b.type}`;n(b,"UNEXPECTED_TOKEN",_);const m=b.source;m&&typeof m=="string"&&(f+=m.length)}}}return{mode:i,indent:l,chomp:a,comment:h,length:f}}function zu(s){const t=s.split(/\n( *)/),e=t[0],n=e.match(/^( *)/),i=[n!=null&&n[1]?[n[1],e.slice(n[1].length)]:["",e]];for(let l=1;l<t.length;l+=2)i.push([t[l],t[l+1]]);return i}function Ro(s,t,e){const{offset:n,type:o,source:i,end:l}=s;let a,c;const d=(g,b,_)=>e(n+g,b,_);switch(o){case"scalar":a=W.PLAIN,c=Xu(i,d);break;case"single-quoted-scalar":a=W.QUOTE_SINGLE,c=Zu(i,d);break;case"double-quoted-scalar":a=W.QUOTE_DOUBLE,c=ed(i,d);break;default:return e(s,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${o}`),{value:"",type:null,comment:"",range:[n,n+i.length,n+i.length]}}const h=n+i.length,f=Ft(l,h,t,e);return{value:c,type:a,comment:f.comment,range:[n,h,f.offset]}}function Xu(s,t){let e="";switch(s[0]){case"	":e="a tab character";break;case",":e="flow indicator character ,";break;case"%":e="directive indicator character %";break;case"|":case">":{e=`block scalar indicator ${s[0]}`;break}case"@":case"`":{e=`reserved character ${s[0]}`;break}}return e&&t(0,"BAD_SCALAR_START",`Plain value cannot start with ${e}`),qo(s)}function Zu(s,t){return(s[s.length-1]!=="'"||s.length===1)&&t(s.length,"MISSING_CHAR","Missing closing 'quote"),qo(s.slice(1,-1)).replace(/''/g,"'")}function qo(s){let t,e;try{t=new RegExp(`(.*?)(?<![ 	])[ 	]*\r?
`,"sy"),e=new RegExp(`[ 	]*(.*?)(?:(?<![ 	])[ 	]*)?\r?
`,"sy")}catch{t=/(.*?)[ \t]*\r?\n/sy,e=/[ \t]*(.*?)[ \t]*\r?\n/sy}let n=t.exec(s);if(!n)return s;let o=n[1],i=" ",l=t.lastIndex;for(e.lastIndex=l;n=e.exec(s);)n[1]===""?i===`
`?o+=i:i=`
`:(o+=i+n[1],i=" "),l=e.lastIndex;const a=/[ \t]*(.*)/sy;return a.lastIndex=l,n=a.exec(s),o+i+((n==null?void 0:n[1])??"")}function ed(s,t){let e="";for(let n=1;n<s.length-1;++n){const o=s[n];if(!(o==="\r"&&s[n+1]===`
`))if(o===`
`){const{fold:i,offset:l}=td(s,n);e+=i,n=l}else if(o==="\\"){let i=s[++n];const l=sd[i];if(l)e+=l;else if(i===`
`)for(i=s[n+1];i===" "||i==="	";)i=s[++n+1];else if(i==="\r"&&s[n+1]===`
`)for(i=s[++n+1];i===" "||i==="	";)i=s[++n+1];else if(i==="x"||i==="u"||i==="U"){const a={x:2,u:4,U:8}[i];e+=nd(s,n+1,a,t),n+=a}else{const a=s.substr(n-1,2);t(n-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${a}`),e+=a}}else if(o===" "||o==="	"){const i=n;let l=s[n+1];for(;l===" "||l==="	";)l=s[++n+1];l!==`
`&&!(l==="\r"&&s[n+2]===`
`)&&(e+=n>i?s.slice(i,n+1):o)}else e+=o}return(s[s.length-1]!=='"'||s.length===1)&&t(s.length,"MISSING_CHAR",'Missing closing "quote'),e}function td(s,t){let e="",n=s[t+1];for(;(n===" "||n==="	"||n===`
`||n==="\r")&&!(n==="\r"&&s[t+2]!==`
`);)n===`
`&&(e+=`
`),t+=1,n=s[t+1];return e||(e=" "),{fold:e,offset:t}}const sd={0:"\0",a:"\x07",b:"\b",e:"\x1B",f:"\f",n:`
`,r:"\r",t:"	",v:"\v",N:"Â…",_:"Â ",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","	":"	"};function nd(s,t,e,n){const o=s.substr(t,e),l=o.length===e&&/^[0-9a-fA-F]+$/.test(o)?parseInt(o,16):NaN;if(isNaN(l)){const a=s.substr(t-2,e+2);return n(t-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${a}`),a}return String.fromCodePoint(l)}function Ko(s,t,e,n){const{value:o,type:i,comment:l,range:a}=t.type==="block-scalar"?Po(s,t,n):Ro(t,s.options.strict,n),c=e?s.directives.tagName(e.source,f=>n(e,"TAG_RESOLVE_FAILED",f)):null;let d;s.options.stringKeys&&s.atKey?d=s.schema[Oe]:c?d=od(s.schema,o,c,e,n):t.type==="scalar"?d=id(s,o,t,n):d=s.schema[Oe];let h;try{const f=d.resolve(o,g=>n(e??t,"TAG_RESOLVE_FAILED",g),s.options);h=Y(f)?f:new W(f)}catch(f){const g=f instanceof Error?f.message:String(f);n(e??t,"TAG_RESOLVE_FAILED",g),h=new W(o)}return h.range=a,h.source=o,i&&(h.type=i),c&&(h.tag=c),d.format&&(h.format=d.format),l&&(h.comment=l),h}function od(s,t,e,n,o){var a;if(e==="!")return s[Oe];const i=[];for(const c of s.tags)if(!c.collection&&c.tag===e)if(c.default&&c.test)i.push(c);else return c;for(const c of i)if((a=c.test)!=null&&a.test(t))return c;const l=s.knownTags[e];return l&&!l.collection?(s.tags.push(Object.assign({},l,{default:!1,test:void 0})),l):(o(n,"TAG_RESOLVE_FAILED",`Unresolved tag: ${e}`,e!=="tag:yaml.org,2002:str"),s[Oe])}function id({atKey:s,directives:t,schema:e},n,o,i){const l=e.tags.find(a=>{var c;return(a.default===!0||s&&a.default==="key")&&((c=a.test)==null?void 0:c.test(n))})||e[Oe];if(e.compat){const a=e.compat.find(c=>{var d;return c.default&&((d=c.test)==null?void 0:d.test(n))})??e[Oe];if(l.tag!==a.tag){const c=t.tagString(l.tag),d=t.tagString(a.tag),h=`Value may be parsed as either ${c} or ${d}`;i(o,"TAG_RESOLVE_FAILED",h,!0)}}return l}function ld(s,t,e){if(t){e??(e=t.length);for(let n=e-1;n>=0;--n){let o=t[n];switch(o.type){case"space":case"comment":case"newline":s-=o.source.length;continue}for(o=t[++n];(o==null?void 0:o.type)==="space";)s+=o.source.length,o=t[++n];break}}return s}const ad={composeNode:Fo,composeEmptyNode:wn};function Fo(s,t,e,n){const o=s.atKey,{spaceBefore:i,comment:l,anchor:a,tag:c}=e;let d,h=!0;switch(t.type){case"alias":d=rd(s,t,n),(a||c)&&n(t,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":d=Ko(s,t,c,n),a&&(d.anchor=a.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":d=Qu(ad,s,t,e,n),a&&(d.anchor=a.source.substring(1));break;default:{const f=t.type==="error"?t.message:`Unsupported token (type: ${t.type})`;n(t,"UNEXPECTED_TOKEN",f),d=wn(s,t.offset,void 0,null,e,n),h=!1}}return a&&d.anchor===""&&n(a,"BAD_ALIAS","Anchor cannot be an empty string"),o&&s.options.stringKeys&&(!Y(d)||typeof d.value!="string"||d.tag&&d.tag!=="tag:yaml.org,2002:str")&&n(c??t,"NON_STRING_KEY","With stringKeys, all keys must be strings"),i&&(d.spaceBefore=!0),l&&(t.type==="scalar"&&t.source===""?d.comment=l:d.commentBefore=l),s.options.keepSourceTokens&&h&&(d.srcToken=t),d}function wn(s,t,e,n,{spaceBefore:o,comment:i,anchor:l,tag:a,end:c},d){const h={type:"scalar",offset:ld(t,e,n),indent:-1,source:""},f=Ko(s,h,a,d);return l&&(f.anchor=l.source.substring(1),f.anchor===""&&d(l,"BAD_ALIAS","Anchor cannot be an empty string")),o&&(f.spaceBefore=!0),i&&(f.comment=i,f.range[2]=c),f}function rd({options:s},{offset:t,source:e,end:n},o){const i=new Os(e.substring(1));i.source===""&&o(t,"BAD_ALIAS","Alias cannot be an empty string"),i.source.endsWith(":")&&o(t+e.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);const l=t+e.length,a=Ft(n,l,s.strict,o);return i.range=[t,l,a.offset],a.comment&&(i.comment=a.comment),i}function cd(s,t,{offset:e,start:n,value:o,end:i},l){const a=Object.assign({_directives:t},s),c=new Ot(void 0,a),d={atKey:!1,atRoot:!0,directives:c.directives,options:c.options,schema:c.schema},h=ht(n,{indicator:"doc-start",next:o??(i==null?void 0:i[0]),offset:e,onError:l,parentIndent:0,startOnNewline:!0});h.found&&(c.directives.docStart=!0,o&&(o.type==="block-map"||o.type==="block-seq")&&!h.hasNewline&&l(h.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),c.contents=o?Fo(d,o,h,l):wn(d,h.end,n,null,h,l);const f=c.contents.range[2],g=Ft(i,f,!1,l);return g.comment&&(c.comment=g.comment),c.range=[e,f,g.offset],c}function It(s){if(typeof s=="number")return[s,s+1];if(Array.isArray(s))return s.length===2?s:[s[0],s[1]];const{offset:t,source:e}=s;return[t,t+(typeof e=="string"?e.length:1)]}function Dn(s){var o;let t="",e=!1,n=!1;for(let i=0;i<s.length;++i){const l=s[i];switch(l[0]){case"#":t+=(t===""?"":n?`

`:`
`)+(l.substring(1)||" "),e=!0,n=!1;break;case"%":((o=s[i+1])==null?void 0:o[0])!=="#"&&(i+=1),e=!1;break;default:e||(n=!0),e=!1}}return{comment:t,afterEmptyLine:n}}class kn{constructor(t={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(e,n,o,i)=>{const l=It(e);i?this.warnings.push(new Mo(l,n,o)):this.errors.push(new He(l,n,o))},this.directives=new ue({version:t.version||"1.2"}),this.options=t}decorate(t,e){const{comment:n,afterEmptyLine:o}=Dn(this.prelude);if(n){const i=t.contents;if(e)t.comment=t.comment?`${t.comment}
${n}`:n;else if(o||t.directives.docStart||!i)t.commentBefore=n;else if(Z(i)&&!i.flow&&i.items.length>0){let l=i.items[0];z(l)&&(l=l.key);const a=l.commentBefore;l.commentBefore=a?`${n}
${a}`:n}else{const l=i.commentBefore;i.commentBefore=l?`${n}
${l}`:n}}e?(Array.prototype.push.apply(t.errors,this.errors),Array.prototype.push.apply(t.warnings,this.warnings)):(t.errors=this.errors,t.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:Dn(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(t,e=!1,n=-1){for(const o of t)yield*this.next(o);yield*this.end(e,n)}*next(t){switch(t.type){case"directive":this.directives.add(t.source,(e,n,o)=>{const i=It(t);i[0]+=e,this.onError(i,"BAD_DIRECTIVE",n,o)}),this.prelude.push(t.source),this.atDirectives=!0;break;case"document":{const e=cd(this.options,this.directives,t,this.onError);this.atDirectives&&!e.directives.docStart&&this.onError(t,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(e,!1),this.doc&&(yield this.doc),this.doc=e,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(t.source);break;case"error":{const e=t.source?`${t.message}: ${JSON.stringify(t.source)}`:t.message,n=new He(It(t),"UNEXPECTED_TOKEN",e);this.atDirectives||!this.doc?this.errors.push(n):this.doc.errors.push(n);break}case"doc-end":{if(!this.doc){const n="Unexpected doc-end without preceding document";this.errors.push(new He(It(t),"UNEXPECTED_TOKEN",n));break}this.doc.directives.docEnd=!0;const e=Ft(t.end,t.offset+t.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),e.comment){const n=this.doc.comment;this.doc.comment=n?`${n}
${e.comment}`:e.comment}this.doc.range[2]=e.offset;break}default:this.errors.push(new He(It(t),"UNEXPECTED_TOKEN",`Unsupported token ${t.type}`))}}*end(t=!1,e=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(t){const n=Object.assign({_directives:this.directives},this.options),o=new Ot(void 0,n);this.atDirectives&&this.onError(e,"MISSING_CHAR","Missing directives-end indicator line"),o.range=[0,e,e],this.decorate(o,!1),yield o}}}function ud(s,t=!0,e){if(s){const n=(o,i,l)=>{const a=typeof o=="number"?o:Array.isArray(o)?o[0]:o.offset;if(e)e(a,i,l);else throw new He([a,a+1],i,l)};switch(s.type){case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return Ro(s,t,n);case"block-scalar":return Po({options:{strict:t}},s,n)}}return null}function dd(s,t){const{implicitKey:e=!1,indent:n,inFlow:o=!1,offset:i=-1,type:l="PLAIN"}=t,a=qt({type:l,value:s},{implicitKey:e,indent:n>0?" ".repeat(n):"",inFlow:o,options:{blockQuote:!0,lineWidth:-1}}),c=t.end??[{type:"newline",offset:-1,indent:n,source:`
`}];switch(a[0]){case"|":case">":{const d=a.indexOf(`
`),h=a.substring(0,d),f=a.substring(d+1)+`
`,g=[{type:"block-scalar-header",offset:i,indent:n,source:h}];return Wo(g,c)||g.push({type:"newline",offset:-1,indent:n,source:`
`}),{type:"block-scalar",offset:i,indent:n,props:g,source:f}}case'"':return{type:"double-quoted-scalar",offset:i,indent:n,source:a,end:c};case"'":return{type:"single-quoted-scalar",offset:i,indent:n,source:a,end:c};default:return{type:"scalar",offset:i,indent:n,source:a,end:c}}}function fd(s,t,e={}){let{afterKey:n=!1,implicitKey:o=!1,inFlow:i=!1,type:l}=e,a="indent"in s?s.indent:null;if(n&&typeof a=="number"&&(a+=2),!l)switch(s.type){case"single-quoted-scalar":l="QUOTE_SINGLE";break;case"double-quoted-scalar":l="QUOTE_DOUBLE";break;case"block-scalar":{const d=s.props[0];if(d.type!=="block-scalar-header")throw new Error("Invalid block scalar header");l=d.source[0]===">"?"BLOCK_FOLDED":"BLOCK_LITERAL";break}default:l="PLAIN"}const c=qt({type:l,value:t},{implicitKey:o||a===null,indent:a!==null&&a>0?" ".repeat(a):"",inFlow:i,options:{blockQuote:!0,lineWidth:-1}});switch(c[0]){case"|":case">":pd(s,c);break;case'"':Js(s,c,"double-quoted-scalar");break;case"'":Js(s,c,"single-quoted-scalar");break;default:Js(s,c,"scalar")}}function pd(s,t){const e=t.indexOf(`
`),n=t.substring(0,e),o=t.substring(e+1)+`
`;if(s.type==="block-scalar"){const i=s.props[0];if(i.type!=="block-scalar-header")throw new Error("Invalid block scalar header");i.source=n,s.source=o}else{const{offset:i}=s,l="indent"in s?s.indent:-1,a=[{type:"block-scalar-header",offset:i,indent:l,source:n}];Wo(a,"end"in s?s.end:void 0)||a.push({type:"newline",offset:-1,indent:l,source:`
`});for(const c of Object.keys(s))c!=="type"&&c!=="offset"&&delete s[c];Object.assign(s,{type:"block-scalar",indent:l,props:a,source:o})}}function Wo(s,t){if(t)for(const e of t)switch(e.type){case"space":case"comment":s.push(e);break;case"newline":return s.push(e),!0}return!1}function Js(s,t,e){switch(s.type){case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":s.type=e,s.source=t;break;case"block-scalar":{const n=s.props.slice(1);let o=t.length;s.props[0].type==="block-scalar-header"&&(o-=s.props[0].source.length);for(const i of n)i.offset+=o;delete s.props,Object.assign(s,{type:e,source:t,end:n});break}case"block-map":case"block-seq":{const o={type:"newline",offset:s.offset+t.length,indent:s.indent,source:`
`};delete s.items,Object.assign(s,{type:e,source:t,end:[o]});break}default:{const n="indent"in s?s.indent:-1,o="end"in s&&Array.isArray(s.end)?s.end.filter(i=>i.type==="space"||i.type==="comment"||i.type==="newline"):[];for(const i of Object.keys(s))i!=="type"&&i!=="offset"&&delete s[i];Object.assign(s,{type:e,indent:n,source:t,end:o})}}}const hd=s=>"type"in s?bs(s):fs(s);function bs(s){switch(s.type){case"block-scalar":{let t="";for(const e of s.props)t+=bs(e);return t+s.source}case"block-map":case"block-seq":{let t="";for(const e of s.items)t+=fs(e);return t}case"flow-collection":{let t=s.start.source;for(const e of s.items)t+=fs(e);for(const e of s.end)t+=e.source;return t}case"document":{let t=fs(s);if(s.end)for(const e of s.end)t+=e.source;return t}default:{let t=s.source;if("end"in s&&s.end)for(const e of s.end)t+=e.source;return t}}}function fs({start:s,key:t,sep:e,value:n}){let o="";for(const i of s)o+=i.source;if(t&&(o+=bs(t)),e)for(const i of e)o+=i.source;return n&&(o+=bs(n)),o}const tn=Symbol("break visit"),md=Symbol("skip children"),Ho=Symbol("remove item");function Ge(s,t){"type"in s&&s.type==="document"&&(s={start:s.start,value:s.value}),Go(Object.freeze([]),s,t)}Ge.BREAK=tn;Ge.SKIP=md;Ge.REMOVE=Ho;Ge.itemAtPath=(s,t)=>{let e=s;for(const[n,o]of t){const i=e==null?void 0:e[n];if(i&&"items"in i)e=i.items[o];else return}return e};Ge.parentCollection=(s,t)=>{const e=Ge.itemAtPath(s,t.slice(0,-1)),n=t[t.length-1][0],o=e==null?void 0:e[n];if(o&&"items"in o)return o;throw new Error("Parent collection not found")};function Go(s,t,e){let n=e(t,s);if(typeof n=="symbol")return n;for(const o of["key","value"]){const i=t[o];if(i&&"items"in i){for(let l=0;l<i.items.length;++l){const a=Go(Object.freeze(s.concat([[o,l]])),i.items[l],e);if(typeof a=="number")l=a-1;else{if(a===tn)return tn;a===Ho&&(i.items.splice(l,1),l-=1)}}typeof n=="function"&&o==="key"&&(n=n(t,s))}}return typeof n=="function"?n(t,s):n}const js="\uFEFF",Ms="",Us="",jt="",gd=s=>!!s&&"items"in s,bd=s=>!!s&&(s.type==="scalar"||s.type==="single-quoted-scalar"||s.type==="double-quoted-scalar"||s.type==="block-scalar");function yd(s){switch(s){case js:return"<BOM>";case Ms:return"<DOC>";case Us:return"<FLOW_END>";case jt:return"<SCALAR>";default:return JSON.stringify(s)}}function Jo(s){switch(s){case js:return"byte-order-mark";case Ms:return"doc-mode";case Us:return"flow-error-end";case jt:return"scalar";case"---":return"doc-start";case"...":return"doc-end";case"":case`
`:case`\r
`:return"newline";case"-":return"seq-item-ind";case"?":return"explicit-key-ind";case":":return"map-value-ind";case"{":return"flow-map-start";case"}":return"flow-map-end";case"[":return"flow-seq-start";case"]":return"flow-seq-end";case",":return"comma"}switch(s[0]){case" ":case"	":return"space";case"#":return"comment";case"%":return"directive-line";case"*":return"alias";case"&":return"anchor";case"!":return"tag";case"'":return"single-quoted-scalar";case'"':return"double-quoted-scalar";case"|":case">":return"block-scalar-header"}return null}const vd=Object.freeze(Object.defineProperty({__proto__:null,BOM:js,DOCUMENT:Ms,FLOW_END:Us,SCALAR:jt,createScalarToken:dd,isCollection:gd,isScalar:bd,prettyToken:yd,resolveAsScalar:ud,setScalarValue:fd,stringify:hd,tokenType:Jo,visit:Ge},Symbol.toStringTag,{value:"Module"}));function Se(s){switch(s){case void 0:case" ":case`
`:case"\r":case"	":return!0;default:return!1}}const Bn=new Set("0123456789ABCDEFabcdef"),_d=new Set("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()"),as=new Set(",[]{}"),wd=new Set(` ,[]{}
\r	`),Qs=s=>!s||wd.has(s);class Qo{constructor(){this.atEnd=!1,this.blockScalarIndent=-1,this.blockScalarKeep=!1,this.buffer="",this.flowKey=!1,this.flowLevel=0,this.indentNext=0,this.indentValue=0,this.lineEndPos=null,this.next=null,this.pos=0}*lex(t,e=!1){if(t){if(typeof t!="string")throw TypeError("source is not a string");this.buffer=this.buffer?this.buffer+t:t,this.lineEndPos=null}this.atEnd=!e;let n=this.next??"stream";for(;n&&(e||this.hasChars(1));)n=yield*this.parseNext(n)}atLineEnd(){let t=this.pos,e=this.buffer[t];for(;e===" "||e==="	";)e=this.buffer[++t];return!e||e==="#"||e===`
`?!0:e==="\r"?this.buffer[t+1]===`
`:!1}charAt(t){return this.buffer[this.pos+t]}continueScalar(t){let e=this.buffer[t];if(this.indentNext>0){let n=0;for(;e===" ";)e=this.buffer[++n+t];if(e==="\r"){const o=this.buffer[n+t+1];if(o===`
`||!o&&!this.atEnd)return t+n+1}return e===`
`||n>=this.indentNext||!e&&!this.atEnd?t+n:-1}if(e==="-"||e==="."){const n=this.buffer.substr(t,3);if((n==="---"||n==="...")&&Se(this.buffer[t+3]))return-1}return t}getLine(){let t=this.lineEndPos;return(typeof t!="number"||t!==-1&&t<this.pos)&&(t=this.buffer.indexOf(`
`,this.pos),this.lineEndPos=t),t===-1?this.atEnd?this.buffer.substring(this.pos):null:(this.buffer[t-1]==="\r"&&(t-=1),this.buffer.substring(this.pos,t))}hasChars(t){return this.pos+t<=this.buffer.length}setNext(t){return this.buffer=this.buffer.substring(this.pos),this.pos=0,this.lineEndPos=null,this.next=t,null}peek(t){return this.buffer.substr(this.pos,t)}*parseNext(t){switch(t){case"stream":return yield*this.parseStream();case"line-start":return yield*this.parseLineStart();case"block-start":return yield*this.parseBlockStart();case"doc":return yield*this.parseDocument();case"flow":return yield*this.parseFlowCollection();case"quoted-scalar":return yield*this.parseQuotedScalar();case"block-scalar":return yield*this.parseBlockScalar();case"plain-scalar":return yield*this.parsePlainScalar()}}*parseStream(){let t=this.getLine();if(t===null)return this.setNext("stream");if(t[0]===js&&(yield*this.pushCount(1),t=t.substring(1)),t[0]==="%"){let e=t.length,n=t.indexOf("#");for(;n!==-1;){const i=t[n-1];if(i===" "||i==="	"){e=n-1;break}else n=t.indexOf("#",n+1)}for(;;){const i=t[e-1];if(i===" "||i==="	")e-=1;else break}const o=(yield*this.pushCount(e))+(yield*this.pushSpaces(!0));return yield*this.pushCount(t.length-o),this.pushNewline(),"stream"}if(this.atLineEnd()){const e=yield*this.pushSpaces(!0);return yield*this.pushCount(t.length-e),yield*this.pushNewline(),"stream"}return yield Ms,yield*this.parseLineStart()}*parseLineStart(){const t=this.charAt(0);if(!t&&!this.atEnd)return this.setNext("line-start");if(t==="-"||t==="."){if(!this.atEnd&&!this.hasChars(4))return this.setNext("line-start");const e=this.peek(3);if((e==="---"||e==="...")&&Se(this.charAt(3)))return yield*this.pushCount(3),this.indentValue=0,this.indentNext=0,e==="---"?"doc":"stream"}return this.indentValue=yield*this.pushSpaces(!1),this.indentNext>this.indentValue&&!Se(this.charAt(1))&&(this.indentNext=this.indentValue),yield*this.parseBlockStart()}*parseBlockStart(){const[t,e]=this.peek(2);if(!e&&!this.atEnd)return this.setNext("block-start");if((t==="-"||t==="?"||t===":")&&Se(e)){const n=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0));return this.indentNext=this.indentValue+1,this.indentValue+=n,yield*this.parseBlockStart()}return"doc"}*parseDocument(){yield*this.pushSpaces(!0);const t=this.getLine();if(t===null)return this.setNext("doc");let e=yield*this.pushIndicators();switch(t[e]){case"#":yield*this.pushCount(t.length-e);case void 0:return yield*this.pushNewline(),yield*this.parseLineStart();case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel=1,"flow";case"}":case"]":return yield*this.pushCount(1),"doc";case"*":return yield*this.pushUntil(Qs),"doc";case'"':case"'":return yield*this.parseQuotedScalar();case"|":case">":return e+=yield*this.parseBlockScalarHeader(),e+=yield*this.pushSpaces(!0),yield*this.pushCount(t.length-e),yield*this.pushNewline(),yield*this.parseBlockScalar();default:return yield*this.parsePlainScalar()}}*parseFlowCollection(){let t,e,n=-1;do t=yield*this.pushNewline(),t>0?(e=yield*this.pushSpaces(!1),this.indentValue=n=e):e=0,e+=yield*this.pushSpaces(!0);while(t+e>0);const o=this.getLine();if(o===null)return this.setNext("flow");if((n!==-1&&n<this.indentNext&&o[0]!=="#"||n===0&&(o.startsWith("---")||o.startsWith("..."))&&Se(o[3]))&&!(n===this.indentNext-1&&this.flowLevel===1&&(o[0]==="]"||o[0]==="}")))return this.flowLevel=0,yield Us,yield*this.parseLineStart();let i=0;for(;o[i]===",";)i+=yield*this.pushCount(1),i+=yield*this.pushSpaces(!0),this.flowKey=!1;switch(i+=yield*this.pushIndicators(),o[i]){case void 0:return"flow";case"#":return yield*this.pushCount(o.length-i),"flow";case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel+=1,"flow";case"}":case"]":return yield*this.pushCount(1),this.flowKey=!0,this.flowLevel-=1,this.flowLevel?"flow":"doc";case"*":return yield*this.pushUntil(Qs),"flow";case'"':case"'":return this.flowKey=!0,yield*this.parseQuotedScalar();case":":{const l=this.charAt(1);if(this.flowKey||Se(l)||l===",")return this.flowKey=!1,yield*this.pushCount(1),yield*this.pushSpaces(!0),"flow"}default:return this.flowKey=!1,yield*this.parsePlainScalar()}}*parseQuotedScalar(){const t=this.charAt(0);let e=this.buffer.indexOf(t,this.pos+1);if(t==="'")for(;e!==-1&&this.buffer[e+1]==="'";)e=this.buffer.indexOf("'",e+2);else for(;e!==-1;){let i=0;for(;this.buffer[e-1-i]==="\\";)i+=1;if(i%2===0)break;e=this.buffer.indexOf('"',e+1)}const n=this.buffer.substring(0,e);let o=n.indexOf(`
`,this.pos);if(o!==-1){for(;o!==-1;){const i=this.continueScalar(o+1);if(i===-1)break;o=n.indexOf(`
`,i)}o!==-1&&(e=o-(n[o-1]==="\r"?2:1))}if(e===-1){if(!this.atEnd)return this.setNext("quoted-scalar");e=this.buffer.length}return yield*this.pushToIndex(e+1,!1),this.flowLevel?"flow":"doc"}*parseBlockScalarHeader(){this.blockScalarIndent=-1,this.blockScalarKeep=!1;let t=this.pos;for(;;){const e=this.buffer[++t];if(e==="+")this.blockScalarKeep=!0;else if(e>"0"&&e<="9")this.blockScalarIndent=Number(e)-1;else if(e!=="-")break}return yield*this.pushUntil(e=>Se(e)||e==="#")}*parseBlockScalar(){let t=this.pos-1,e=0,n;e:for(let i=this.pos;n=this.buffer[i];++i)switch(n){case" ":e+=1;break;case`
`:t=i,e=0;break;case"\r":{const l=this.buffer[i+1];if(!l&&!this.atEnd)return this.setNext("block-scalar");if(l===`
`)break}default:break e}if(!n&&!this.atEnd)return this.setNext("block-scalar");if(e>=this.indentNext){this.blockScalarIndent===-1?this.indentNext=e:this.indentNext=this.blockScalarIndent+(this.indentNext===0?1:this.indentNext);do{const i=this.continueScalar(t+1);if(i===-1)break;t=this.buffer.indexOf(`
`,i)}while(t!==-1);if(t===-1){if(!this.atEnd)return this.setNext("block-scalar");t=this.buffer.length}}let o=t+1;for(n=this.buffer[o];n===" ";)n=this.buffer[++o];if(n==="	"){for(;n==="	"||n===" "||n==="\r"||n===`
`;)n=this.buffer[++o];t=o-1}else if(!this.blockScalarKeep)do{let i=t-1,l=this.buffer[i];l==="\r"&&(l=this.buffer[--i]);const a=i;for(;l===" ";)l=this.buffer[--i];if(l===`
`&&i>=this.pos&&i+1+e>a)t=i;else break}while(!0);return yield jt,yield*this.pushToIndex(t+1,!0),yield*this.parseLineStart()}*parsePlainScalar(){const t=this.flowLevel>0;let e=this.pos-1,n=this.pos-1,o;for(;o=this.buffer[++n];)if(o===":"){const i=this.buffer[n+1];if(Se(i)||t&&as.has(i))break;e=n}else if(Se(o)){let i=this.buffer[n+1];if(o==="\r"&&(i===`
`?(n+=1,o=`
`,i=this.buffer[n+1]):e=n),i==="#"||t&&as.has(i))break;if(o===`
`){const l=this.continueScalar(n+1);if(l===-1)break;n=Math.max(n,l-2)}}else{if(t&&as.has(o))break;e=n}return!o&&!this.atEnd?this.setNext("plain-scalar"):(yield jt,yield*this.pushToIndex(e+1,!0),t?"flow":"doc")}*pushCount(t){return t>0?(yield this.buffer.substr(this.pos,t),this.pos+=t,t):0}*pushToIndex(t,e){const n=this.buffer.slice(this.pos,t);return n?(yield n,this.pos+=n.length,n.length):(e&&(yield""),0)}*pushIndicators(){switch(this.charAt(0)){case"!":return(yield*this.pushTag())+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"&":return(yield*this.pushUntil(Qs))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"-":case"?":case":":{const t=this.flowLevel>0,e=this.charAt(1);if(Se(e)||t&&as.has(e))return t?this.flowKey&&(this.flowKey=!1):this.indentNext=this.indentValue+1,(yield*this.pushCount(1))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators())}}return 0}*pushTag(){if(this.charAt(1)==="<"){let t=this.pos+2,e=this.buffer[t];for(;!Se(e)&&e!==">";)e=this.buffer[++t];return yield*this.pushToIndex(e===">"?t+1:t,!1)}else{let t=this.pos+1,e=this.buffer[t];for(;e;)if(_d.has(e))e=this.buffer[++t];else if(e==="%"&&Bn.has(this.buffer[t+1])&&Bn.has(this.buffer[t+2]))e=this.buffer[t+=3];else break;return yield*this.pushToIndex(t,!1)}}*pushNewline(){const t=this.buffer[this.pos];return t===`
`?yield*this.pushCount(1):t==="\r"&&this.charAt(1)===`
`?yield*this.pushCount(2):0}*pushSpaces(t){let e=this.pos-1,n;do n=this.buffer[++e];while(n===" "||t&&n==="	");const o=e-this.pos;return o>0&&(yield this.buffer.substr(this.pos,o),this.pos=e),o}*pushUntil(t){let e=this.pos,n=this.buffer[e];for(;!t(n);)n=this.buffer[++e];return yield*this.pushToIndex(e,!1)}}class Yo{constructor(){this.lineStarts=[],this.addNewLine=t=>this.lineStarts.push(t),this.linePos=t=>{let e=0,n=this.lineStarts.length;for(;e<n;){const i=e+n>>1;this.lineStarts[i]<t?e=i+1:n=i}if(this.lineStarts[e]===t)return{line:e+1,col:1};if(e===0)return{line:0,col:t};const o=this.lineStarts[e-1];return{line:e,col:t-o+1}}}}function je(s,t){for(let e=0;e<s.length;++e)if(s[e].type===t)return!0;return!1}function jn(s){for(let t=0;t<s.length;++t)switch(s[t].type){case"space":case"comment":case"newline":break;default:return t}return-1}function zo(s){switch(s==null?void 0:s.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function rs(s){switch(s.type){case"document":return s.start;case"block-map":{const t=s.items[s.items.length-1];return t.sep??t.start}case"block-seq":return s.items[s.items.length-1].start;default:return[]}}function ot(s){var e;if(s.length===0)return[];let t=s.length;e:for(;--t>=0;)switch(s[t].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break e}for(;((e=s[++t])==null?void 0:e.type)==="space";);return s.splice(t,s.length)}function Mn(s){if(s.start.type==="flow-seq-start")for(const t of s.items)t.sep&&!t.value&&!je(t.start,"explicit-key-ind")&&!je(t.sep,"map-value-ind")&&(t.key&&(t.value=t.key),delete t.key,zo(t.value)?t.value.end?Array.prototype.push.apply(t.value.end,t.sep):t.value.end=t.sep:Array.prototype.push.apply(t.start,t.sep),delete t.sep)}class $n{constructor(t){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new Qo,this.onNewLine=t}*parse(t,e=!1){this.onNewLine&&this.offset===0&&this.onNewLine(0);for(const n of this.lexer.lex(t,e))yield*this.next(n);e||(yield*this.end())}*next(t){if(this.source=t,this.atScalar){this.atScalar=!1,yield*this.step(),this.offset+=t.length;return}const e=Jo(t);if(e)if(e==="scalar")this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=e,yield*this.step(),e){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+t.length);break;case"space":this.atNewLine&&t[0]===" "&&(this.indent+=t.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=t.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=t.length}else{const n=`Not a YAML token: ${t}`;yield*this.pop({type:"error",offset:this.offset,message:n,source:t}),this.offset+=t.length}}*end(){for(;this.stack.length>0;)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){const t=this.peek(1);if(this.type==="doc-end"&&(!t||t.type!=="doc-end")){for(;this.stack.length>0;)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source});return}if(!t)return yield*this.stream();switch(t.type){case"document":return yield*this.document(t);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(t);case"block-scalar":return yield*this.blockScalar(t);case"block-map":return yield*this.blockMap(t);case"block-seq":return yield*this.blockSequence(t);case"flow-collection":return yield*this.flowCollection(t);case"doc-end":return yield*this.documentEnd(t)}yield*this.pop()}peek(t){return this.stack[this.stack.length-t]}*pop(t){const e=t??this.stack.pop();if(!e)yield{type:"error",offset:this.offset,source:"",message:"Tried to pop an empty stack"};else if(this.stack.length===0)yield e;else{const n=this.peek(1);switch(e.type==="block-scalar"?e.indent="indent"in n?n.indent:0:e.type==="flow-collection"&&n.type==="document"&&(e.indent=0),e.type==="flow-collection"&&Mn(e),n.type){case"document":n.value=e;break;case"block-scalar":n.props.push(e);break;case"block-map":{const o=n.items[n.items.length-1];if(o.value){n.items.push({start:[],key:e,sep:[]}),this.onKeyLine=!0;return}else if(o.sep)o.value=e;else{Object.assign(o,{key:e,sep:[]}),this.onKeyLine=!o.explicitKey;return}break}case"block-seq":{const o=n.items[n.items.length-1];o.value?n.items.push({start:[],value:e}):o.value=e;break}case"flow-collection":{const o=n.items[n.items.length-1];!o||o.value?n.items.push({start:[],key:e,sep:[]}):o.sep?o.value=e:Object.assign(o,{key:e,sep:[]});return}default:yield*this.pop(),yield*this.pop(e)}if((n.type==="document"||n.type==="block-map"||n.type==="block-seq")&&(e.type==="block-map"||e.type==="block-seq")){const o=e.items[e.items.length-1];o&&!o.sep&&!o.value&&o.start.length>0&&jn(o.start)===-1&&(e.indent===0||o.start.every(i=>i.type!=="comment"||i.indent<e.indent))&&(n.type==="document"?n.end=o.start:n.items.push({start:o.start}),e.items.splice(-1,1))}}}*stream(){switch(this.type){case"directive-line":yield{type:"directive",offset:this.offset,source:this.source};return;case"byte-order-mark":case"space":case"comment":case"newline":yield this.sourceToken;return;case"doc-mode":case"doc-start":{const t={type:"document",offset:this.offset,start:[]};this.type==="doc-start"&&t.start.push(this.sourceToken),this.stack.push(t);return}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(t){if(t.value)return yield*this.lineEnd(t);switch(this.type){case"doc-start":{jn(t.start)!==-1?(yield*this.pop(),yield*this.step()):t.start.push(this.sourceToken);return}case"anchor":case"tag":case"space":case"comment":case"newline":t.start.push(this.sourceToken);return}const e=this.startBlockValue(t);e?this.stack.push(e):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(t){if(this.type==="map-value-ind"){const e=rs(this.peek(2)),n=ot(e);let o;t.end?(o=t.end,o.push(this.sourceToken),delete t.end):o=[this.sourceToken];const i={type:"block-map",offset:t.offset,indent:t.indent,items:[{start:n,key:t,sep:o}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=i}else yield*this.lineEnd(t)}*blockScalar(t){switch(this.type){case"space":case"comment":case"newline":t.props.push(this.sourceToken);return;case"scalar":if(t.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let e=this.source.indexOf(`
`)+1;for(;e!==0;)this.onNewLine(this.offset+e),e=this.source.indexOf(`
`,e)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(t){var n;const e=t.items[t.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,e.value){const o="end"in e.value?e.value.end:void 0,i=Array.isArray(o)?o[o.length-1]:void 0;(i==null?void 0:i.type)==="comment"?o==null||o.push(this.sourceToken):t.items.push({start:[this.sourceToken]})}else e.sep?e.sep.push(this.sourceToken):e.start.push(this.sourceToken);return;case"space":case"comment":if(e.value)t.items.push({start:[this.sourceToken]});else if(e.sep)e.sep.push(this.sourceToken);else{if(this.atIndentedComment(e.start,t.indent)){const o=t.items[t.items.length-2],i=(n=o==null?void 0:o.value)==null?void 0:n.end;if(Array.isArray(i)){Array.prototype.push.apply(i,e.start),i.push(this.sourceToken),t.items.pop();return}}e.start.push(this.sourceToken)}return}if(this.indent>=t.indent){const o=!this.onKeyLine&&this.indent===t.indent,i=o&&(e.sep||e.explicitKey)&&this.type!=="seq-item-ind";let l=[];if(i&&e.sep&&!e.value){const a=[];for(let c=0;c<e.sep.length;++c){const d=e.sep[c];switch(d.type){case"newline":a.push(c);break;case"space":break;case"comment":d.indent>t.indent&&(a.length=0);break;default:a.length=0}}a.length>=2&&(l=e.sep.splice(a[1]))}switch(this.type){case"anchor":case"tag":i||e.value?(l.push(this.sourceToken),t.items.push({start:l}),this.onKeyLine=!0):e.sep?e.sep.push(this.sourceToken):e.start.push(this.sourceToken);return;case"explicit-key-ind":!e.sep&&!e.explicitKey?(e.start.push(this.sourceToken),e.explicitKey=!0):i||e.value?(l.push(this.sourceToken),t.items.push({start:l,explicitKey:!0})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken],explicitKey:!0}]}),this.onKeyLine=!0;return;case"map-value-ind":if(e.explicitKey)if(e.sep)if(e.value)t.items.push({start:[],key:null,sep:[this.sourceToken]});else if(je(e.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:l,key:null,sep:[this.sourceToken]}]});else if(zo(e.key)&&!je(e.sep,"newline")){const a=ot(e.start),c=e.key,d=e.sep;d.push(this.sourceToken),delete e.key,delete e.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:a,key:c,sep:d}]})}else l.length>0?e.sep=e.sep.concat(l,this.sourceToken):e.sep.push(this.sourceToken);else if(je(e.start,"newline"))Object.assign(e,{key:null,sep:[this.sourceToken]});else{const a=ot(e.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:a,key:null,sep:[this.sourceToken]}]})}else e.sep?e.value||i?t.items.push({start:l,key:null,sep:[this.sourceToken]}):je(e.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):e.sep.push(this.sourceToken):Object.assign(e,{key:null,sep:[this.sourceToken]});this.onKeyLine=!0;return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const a=this.flowScalar(this.type);i||e.value?(t.items.push({start:l,key:a,sep:[]}),this.onKeyLine=!0):e.sep?this.stack.push(a):(Object.assign(e,{key:a,sep:[]}),this.onKeyLine=!0);return}default:{const a=this.startBlockValue(t);if(a){if(a.type==="block-seq"){if(!e.explicitKey&&e.sep&&!je(e.sep,"newline")){yield*this.pop({type:"error",offset:this.offset,message:"Unexpected block-seq-ind on same line with key",source:this.source});return}}else o&&t.items.push({start:l});this.stack.push(a);return}}}}yield*this.pop(),yield*this.step()}*blockSequence(t){var n;const e=t.items[t.items.length-1];switch(this.type){case"newline":if(e.value){const o="end"in e.value?e.value.end:void 0,i=Array.isArray(o)?o[o.length-1]:void 0;(i==null?void 0:i.type)==="comment"?o==null||o.push(this.sourceToken):t.items.push({start:[this.sourceToken]})}else e.start.push(this.sourceToken);return;case"space":case"comment":if(e.value)t.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(e.start,t.indent)){const o=t.items[t.items.length-2],i=(n=o==null?void 0:o.value)==null?void 0:n.end;if(Array.isArray(i)){Array.prototype.push.apply(i,e.start),i.push(this.sourceToken),t.items.pop();return}}e.start.push(this.sourceToken)}return;case"anchor":case"tag":if(e.value||this.indent<=t.indent)break;e.start.push(this.sourceToken);return;case"seq-item-ind":if(this.indent!==t.indent)break;e.value||je(e.start,"seq-item-ind")?t.items.push({start:[this.sourceToken]}):e.start.push(this.sourceToken);return}if(this.indent>t.indent){const o=this.startBlockValue(t);if(o){this.stack.push(o);return}}yield*this.pop(),yield*this.step()}*flowCollection(t){const e=t.items[t.items.length-1];if(this.type==="flow-error-end"){let n;do yield*this.pop(),n=this.peek(1);while(n&&n.type==="flow-collection")}else if(t.end.length===0){switch(this.type){case"comma":case"explicit-key-ind":!e||e.sep?t.items.push({start:[this.sourceToken]}):e.start.push(this.sourceToken);return;case"map-value-ind":!e||e.value?t.items.push({start:[],key:null,sep:[this.sourceToken]}):e.sep?e.sep.push(this.sourceToken):Object.assign(e,{key:null,sep:[this.sourceToken]});return;case"space":case"comment":case"newline":case"anchor":case"tag":!e||e.value?t.items.push({start:[this.sourceToken]}):e.sep?e.sep.push(this.sourceToken):e.start.push(this.sourceToken);return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const o=this.flowScalar(this.type);!e||e.value?t.items.push({start:[],key:o,sep:[]}):e.sep?this.stack.push(o):Object.assign(e,{key:o,sep:[]});return}case"flow-map-end":case"flow-seq-end":t.end.push(this.sourceToken);return}const n=this.startBlockValue(t);n?this.stack.push(n):(yield*this.pop(),yield*this.step())}else{const n=this.peek(2);if(n.type==="block-map"&&(this.type==="map-value-ind"&&n.indent===t.indent||this.type==="newline"&&!n.items[n.items.length-1].sep))yield*this.pop(),yield*this.step();else if(this.type==="map-value-ind"&&n.type!=="flow-collection"){const o=rs(n),i=ot(o);Mn(t);const l=t.end.splice(1,t.end.length);l.push(this.sourceToken);const a={type:"block-map",offset:t.offset,indent:t.indent,items:[{start:i,key:t,sep:l}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=a}else yield*this.lineEnd(t)}}flowScalar(t){if(this.onNewLine){let e=this.source.indexOf(`
`)+1;for(;e!==0;)this.onNewLine(this.offset+e),e=this.source.indexOf(`
`,e)+1}return{type:t,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(t){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;const e=rs(t),n=ot(e);return n.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:n,explicitKey:!0}]}}case"map-value-ind":{this.onKeyLine=!0;const e=rs(t),n=ot(e);return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:n,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(t,e){return this.type!=="comment"||this.indent<=e?!1:t.every(n=>n.type==="newline"||n.type==="space")}*documentEnd(t){this.type!=="doc-mode"&&(t.end?t.end.push(this.sourceToken):t.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop()))}*lineEnd(t){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;case"space":case"comment":default:t.end?t.end.push(this.sourceToken):t.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop())}}}function Xo(s){const t=s.prettyErrors!==!1;return{lineCounter:s.lineCounter||t&&new Yo||null,prettyErrors:t}}function kd(s,t={}){const{lineCounter:e,prettyErrors:n}=Xo(t),o=new $n(e==null?void 0:e.addNewLine),i=new kn(t),l=Array.from(i.compose(o.parse(s)));if(n&&e)for(const a of l)a.errors.forEach(gs(s,e)),a.warnings.forEach(gs(s,e));return l.length>0?l:Object.assign([],{empty:!0},i.streamInfo())}function Zo(s,t={}){const{lineCounter:e,prettyErrors:n}=Xo(t),o=new $n(e==null?void 0:e.addNewLine),i=new kn(t);let l=null;for(const a of i.compose(o.parse(s),!0,s.length))if(!l)l=a;else if(l.options.logLevel!=="silent"){l.errors.push(new He(a.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}return n&&e&&(l.errors.forEach(gs(s,e)),l.warnings.forEach(gs(s,e))),l}function $d(s,t,e){let n;typeof t=="function"?n=t:e===void 0&&t&&typeof t=="object"&&(e=t);const o=Zo(s,e);if(!o)return null;if(o.warnings.forEach(i=>vo(o.options.logLevel,i)),o.errors.length>0){if(o.options.logLevel!=="silent")throw o.errors[0];o.errors=[]}return o.toJS(Object.assign({reviver:n},e))}function Sd(s,t,e){let n=null;if(typeof t=="function"||Array.isArray(t)?n=t:e===void 0&&t&&(e=t),typeof e=="string"&&(e=e.length),typeof e=="number"){const o=Math.round(e);e=o<1?void 0:o>8?{indent:8}:{indent:o}}if(s===void 0){const{keepUndefined:o}=e??t??{};if(!o)return}return ze(s)&&!n?s.toString(e):new Ot(s,n,e).toString(e)}const Un=Object.freeze(Object.defineProperty({__proto__:null,Alias:Os,CST:vd,Composer:kn,Document:Ot,Lexer:Qo,LineCounter:Yo,Pair:re,Parser:$n,Scalar:W,Schema:Bs,YAMLError:_n,YAMLMap:ge,YAMLParseError:He,YAMLSeq:Ue,YAMLWarning:Mo,isAlias:Pe,isCollection:Z,isDocument:ze,isMap:kt,isNode:ee,isPair:z,isScalar:Y,isSeq:St,parse:$d,parseAllDocuments:kd,parseDocument:Zo,stringify:Sd,visit:Xe,visitAsync:Ns},Symbol.toStringTag,{value:"Module"})),Ps=s=>(Je("data-v-c1c8d161"),s=s(),Qe(),s),Cd={class:"templates-editor"},Nd={class:"agent-toggle"},Od={class:"image-wrapper"},Td=["src","alt"],Ld={class:"pi pi-info-circle"},Id={key:0,class:"p-error"},Ad={class:"toolbar"},Ed=Ps(()=>r("i",{class:"pi pi-copy"},null,-1)),Vd=Ps(()=>r("i",{class:"pi pi-pencil"},null,-1)),xd=Ps(()=>r("i",{class:"pi pi-times mr-2"},null,-1)),Dd=Ps(()=>r("i",{class:"pi pi-check mr-2"},null,-1)),Bd=Ye({__name:"AppConfigChatWootTemplates",props:{modelValue:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(s,{emit:t}){const{t:e}=Q(),n=s,o=t,i={"chatwoot.to.whatsapp.message.text":`*{{{chatwoot.sender.name}}}*:
{{{ content }}}`,"chatwoot.to.whatsapp.message.media.caption":["{{#singleAttachment}}","{{#content}}","*{{{chatwoot.sender.name}}}*:","{{{ content }}}","{{/content}}","{{/singleAttachment}}"].join(`
`)},l=Object.keys(i),a=new URL(""+new URL("chatwoot-templates-agent-name.BoWby9TR.jpg",import.meta.url).href,import.meta.url).href,c=new URL(""+new URL("chatwoot-templates-no-agent-name.BjTBJy2e.jpg",import.meta.url).href,import.meta.url).href,d=E(!1),h=E(""),f=E(null);function g(A){return!A||Object.keys(A).length===0?"":Object.entries(A).map(([I,F])=>{const V=new Un.Document,H=new W(F);return H.type=W.BLOCK_LITERAL,V.set(I,H),String(V).replace(/^---\s*\n/,"").trimEnd()}).join(`

`)}const b=R(()=>{const A=n.modelValue||{};return l.every(D=>Object.prototype.hasOwnProperty.call(A,D))}),_=R({get:()=>b.value,set:A=>{if(d.value||A===b.value)return;const D={...n.modelValue||{}};if(A)for(const[I,F]of Object.entries(i))D[I]=F;else for(const I of l)Object.prototype.hasOwnProperty.call(D,I)&&delete D[I];h.value=g(D),f.value=null,o("update:modelValue",D)}}),m=R(()=>b.value?a:c),y=R(()=>b.value?"Templates with agent name":"Templates without agent name");se(()=>n.modelValue,A=>{d.value||(h.value=g(A||{}),f.value=null)},{deep:!0,immediate:!0});function N(){d.value=!0,f.value=null}function $(){h.value=g(n.modelValue||{}),f.value=null,d.value=!1}function S(){try{const A=Un.parse(h.value||"")??{};if(A&&typeof A=="object"&&!Array.isArray(A)){const D={};for(const[I,F]of Object.entries(A)){if(typeof I!="string")throw new Error("All keys must be strings");if(typeof F!="string")throw new Error(`Value for key "${I}" must be a string`);D[I]=F}o("update:modelValue",D),f.value=null,d.value=!1}else throw new Error("YAML must be a mapping of string keys to string values")}catch(A){f.value=(A==null?void 0:A.message)||String(A)}}const O=R(()=>!!f.value);async function k(){try{await navigator.clipboard.writeText(h.value||"")}catch{}}return(A,D)=>{const I=_t,F=$s,V=ne,H=ae("tooltip");return v(),L("div",Cd,[r("div",Nd,[p(I,{inputId:"templates-add-agent-name",modelValue:_.value,"onUpdate:modelValue":D[0]||(D[0]=q=>_.value=q),disabled:d.value,onLabel:u(e)("apps.chatwoot.templates.toggle.addAgentName"),offLabel:u(e)("apps.chatwoot.templates.toggle.noAgentName"),"aria-label":u(e)("apps.chatwoot.templates.addAgentName")},null,8,["modelValue","disabled","onLabel","offLabel","aria-label"]),r("div",Od,[r("img",{src:m.value,alt:y.value},null,8,Td)])]),r("label",null,[G(w(u(e)("apps.chatwoot.templates.title"))+" ",1),K(r("i",Ld,null,512),[[H,u(e)("apps.chatwoot.templates.tooltip")]])]),p(F,{modelValue:h.value,"onUpdate:modelValue":D[1]||(D[1]=q=>h.value=q),spellcheck:"false",autoResize:"",rows:"2",cols:"30",disabled:!d.value,class:le([{"p-invalid":O.value},"w-full mt-1"]),placeholder:"Put your templates here in YAML format..."},null,8,["modelValue","disabled","class"]),O.value?(v(),L("small",Id,w(f.value),1)):B("",!0),r("div",Ad,[d.value?(v(),L(te,{key:1},[p(V,{size:"small",class:"mr-2",severity:"secondary",onClick:$},{default:C(()=>[xd,r("span",null,w(u(e)("common.cancel")),1)]),_:1}),p(V,{size:"small",class:"ml-2",severity:"success",onClick:S},{default:C(()=>[Dd,r("span",null,w(u(e)("common.save")),1)]),_:1})],64)):(v(),L(te,{key:0},[K((v(),L("a",{href:"#",class:"toolbar-action mr-3",tabindex:0,onClick:xt(k,["prevent"])},[Ed,r("span",null,w(u(e)("apps.chatwoot.copy")),1)])),[[H,{value:u(e)("apps.chatwoot.copiedToClipboard")},void 0,{focus:!0,bottom:!0}]]),r("a",{href:"#",class:"toolbar-action",onClick:xt(N,["prevent"])},[Vd,r("span",null,w(u(e)("common.edit")),1)])],64))])])}}}),jd=me(Bd,[["__scopeId","data-v-c1c8d161"]]),Wt=s=>(Je("data-v-9f4c0dcd"),s=s(),Qe(),s),Md={class:"chatwoot-config"},Ud={class:"mb-3"},Pd=Wt(()=>r("br",null,null,-1)),Rd={href:"http://waha.devlike.pro/docs/apps/chatwoot/",target:"_blank",rel:"noopener noreferrer"},qd=Wt(()=>r("br",null,null,-1)),Kd={href:"https://waha.devlike.pro/blog/apps-chatwoot-config/",target:"_blank",rel:"noopener noreferrer"},Fd={class:"text-center"},Wd={class:"field"},Hd={for:"url"},Gd={key:0,class:"p-error"},Jd={class:"grid"},Qd={class:"col-6"},Yd={class:"field"},zd={for:"accountId"},Xd={key:0,class:"p-error"},Zd={class:"col-6"},ef={class:"field"},tf={for:"accountToken"},sf={key:0,class:"p-error"},nf={class:"grid"},of={class:"col-6"},lf={class:"field"},af={for:"inboxId"},rf={class:"pi pi-info-circle"},cf={key:0,class:"p-error"},uf={class:"col-6"},df={class:"field"},ff={for:"inboxIdentifier"},pf={key:0,class:"p-error"},hf=Wt(()=>r("hr",null,null,-1)),mf={class:"text-center"},gf={class:"field"},bf={for:"conversations-sort"},yf={class:"pi pi-info-circle"},vf={key:0,class:"p-error"},_f={class:"field"},wf={class:"block mb-2"},kf={class:"pi pi-info-circle"},$f={class:"flex align-items-center gap-2"},Sf={class:"field"},Cf={class:"block mb-2"},Nf={class:"pi pi-info-circle"},Of=Wt(()=>r("hr",null,null,-1)),Tf={class:"text-center"},Lf={class:"pi pi-info-circle"},If={class:"field"},Af={class:"flex flex-wrap align-items-center gap-2"},Ef=Wt(()=>r("hr",null,null,-1)),Vf={class:"text-center"},xf={class:"field"},Df={for:"locale"},Bf={class:"pi pi-info-circle"},jf={key:0,class:"p-error"},Mf={class:"field"},Uf={for:"linkPreview"},Pf={class:"pi pi-info-circle"},Rf={class:"field"},qf=Ye({__name:"AppConfigChatWoot",props:{modelValue:{type:Object,required:!0},server:{type:Object,required:!0},submitted:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(s,{emit:t}){var N;const{t:e}=Q(),n=s,o=t,i=he(),l=bt(),a={url:"",accountId:null,accountToken:"",inboxId:null,inboxIdentifier:"",locale:"en-US",linkPreview:At.OFF,templates:{},commands:{server:!0,queue:!0},conversations:{sort:"created_newest",status:null,markAsRead:!0}},c=Kn(pe.defaultsDeep({},pe.cloneDeep(n.modelValue??{}),a));se(c,$=>{const S=pe.cloneDeep($);o("update:modelValue",S)},{deep:!0});const d=E([]),h=E(!1),f=[{label:e("apps.chatwoot.linkPreview.off"),value:At.OFF},{label:e("apps.chatwoot.linkPreview.lq"),value:At.LQ},{label:e("apps.chatwoot.linkPreview.hq"),value:At.HQ}],g=[{label:e("apps.chatwoot.conversations.sort.createdNewest"),value:"created_newest"},{label:e("apps.chatwoot.conversations.sort.activityNewest"),value:"activity_newest"},{label:e("apps.chatwoot.conversations.sort.activityOldest"),value:"activity_oldest"},{label:e("apps.chatwoot.conversations.sort.createdOldest"),value:"created_oldest"}],b=[{label:e("apps.chatwoot.conversations.status.open"),value:"open"},{label:e("apps.chatwoot.conversations.status.pending"),value:"pending"},{label:e("apps.chatwoot.conversations.status.snoozed"),value:"snoozed"},{label:e("apps.chatwoot.conversations.status.resolved"),value:"resolved"}],_=E(!!((N=c.conversations)!=null&&N.status)),m=R({get:()=>!_.value,set:$=>{_.value=!$}});se(_,$=>{$?c.conversations.status=b.filter(S=>S.value!=="resolved").map(S=>S.value):c.conversations.status=null}),_s(async()=>{await y()});async function y(){if(!(!n.server||!n.server.id))try{h.value=!0,d.value=await l(i.getAppChatWootLocales(n.server.id),void 0,e("apps.chatwoot.failedToLoadLocales"))}catch($){console.error("Error loading locales:",$)}finally{h.value=!1}}return($,S)=>{var H,q;const O=Ae,k=Yn,A=zn,D=yt,I=_t,F=ln,V=ae("tooltip");return v(),L("div",Md,[r("div",Ud,[p(u(ft),{severity:"info"},{default:C(()=>[r("span",null,w(u(e)("apps.chatwoot.help.header")),1),Pd,r("a",Rd,w(u(e)("apps.chatwoot.help.ChatWootAppPage")),1),qd,r("a",Kd,w(u(e)("apps.chatwoot.help.ChatWootConfigArticle")),1)]),_:1})]),r("h4",Fd,w(u(e)("apps.chatwoot.section.connection.title")),1),r("div",Wd,[r("label",Hd,w(u(e)("apps.chatwoot.url")),1),p(O,{id:"url",modelValue:c.url,"onUpdate:modelValue":S[0]||(S[0]=J=>c.url=J),placeholder:"https://app.chatwoot.com",class:le({"p-invalid":s.submitted&&!c.url})},null,8,["modelValue","class"]),s.submitted&&!c.url?(v(),L("small",Gd,w(u(e)("apps.chatwoot.urlRequired")),1)):B("",!0)]),r("div",Jd,[r("div",Qd,[r("div",Yd,[r("label",zd,w(u(e)("apps.chatwoot.accountId")),1),p(k,{id:"accountId",modelValue:c.accountId,"onUpdate:modelValue":S[1]||(S[1]=J=>c.accountId=J),placeholder:u(e)("apps.chatwoot.accountIdPlaceholder"),class:le({"p-invalid":s.submitted&&!c.accountId})},null,8,["modelValue","placeholder","class"]),s.submitted&&!c.accountId?(v(),L("small",Xd,w(u(e)("apps.chatwoot.accountIdRequired")),1)):B("",!0)])]),r("div",Zd,[r("div",ef,[r("label",tf,w(u(e)("apps.chatwoot.accountToken")),1),p(A,{id:"accountToken",modelValue:c.accountToken,"onUpdate:modelValue":S[2]||(S[2]=J=>c.accountToken=J),placeholder:u(e)("apps.chatwoot.accountTokenPlaceholder"),feedback:!1,toggleMask:"",class:le({"p-invalid":s.submitted&&!c.accountToken})},null,8,["modelValue","placeholder","class"]),s.submitted&&!c.accountToken?(v(),L("small",sf,w(u(e)("apps.chatwoot.accountTokenRequired")),1)):B("",!0)])])]),r("div",nf,[r("div",of,[r("div",lf,[r("label",af,[G(w(u(e)("apps.chatwoot.inboxId"))+" ",1),K(r("i",rf,null,512),[[V,u(e)("apps.chatwoot.inboxIdTooltip")]])]),p(k,{id:"inboxId",modelValue:c.inboxId,"onUpdate:modelValue":S[3]||(S[3]=J=>c.inboxId=J),placeholder:u(e)("apps.chatwoot.inboxIdPlaceholder"),class:le({"p-invalid":s.submitted&&!c.inboxId})},null,8,["modelValue","placeholder","class"]),s.submitted&&!c.inboxId?(v(),L("small",cf,w(u(e)("apps.chatwoot.inboxIdRequired")),1)):B("",!0)])]),r("div",uf,[r("div",df,[r("label",ff,w(u(e)("apps.chatwoot.inboxIdentifier")),1),p(A,{id:"inboxIdentifier",modelValue:c.inboxIdentifier,"onUpdate:modelValue":S[4]||(S[4]=J=>c.inboxIdentifier=J),placeholder:u(e)("apps.chatwoot.inboxIdentifierPlaceholder"),feedback:!1,toggleMask:"",class:le({"p-invalid":s.submitted&&!c.inboxIdentifier})},null,8,["modelValue","placeholder","class"]),s.submitted&&!c.inboxIdentifier?(v(),L("small",pf,w(u(e)("apps.chatwoot.inboxIdentifierRequired")),1)):B("",!0)])])]),hf,r("h4",mf,w(u(e)("apps.chatwoot.section.conversations.title")),1),r("div",gf,[r("label",bf,[G(w(u(e)("apps.chatwoot.conversations.sort.label"))+" ",1),K(r("i",yf,null,512),[[V,u(e)("apps.chatwoot.conversations.sort.tooltip")]])]),p(D,{id:"conversations-sort",modelValue:c.conversations.sort,"onUpdate:modelValue":S[5]||(S[5]=J=>c.conversations.sort=J),options:g,optionLabel:"label",optionValue:"value",class:le({"p-invalid":s.submitted&&!((H=c.conversations)!=null&&H.sort)})},null,8,["modelValue","class"]),s.submitted&&!((q=c.conversations)!=null&&q.sort)?(v(),L("small",vf,w(u(e)("apps.chatwoot.conversations.sortRequired")),1)):B("",!0)]),r("div",_f,[r("label",wf,[G(w(u(e)("apps.chatwoot.conversations.statusFilter.label"))+" ",1),K(r("i",kf,null,512),[[V,u(e)("apps.chatwoot.conversations.statusFilter.tooltip")]])]),r("div",$f,[p(I,{modelValue:m.value,"onUpdate:modelValue":S[6]||(S[6]=J=>m.value=J),onIcon:"pi pi-check",offIcon:"pi pi-times",onLabel:u(e)("apps.chatwoot.conversations.statusFilter.on"),offLabel:u(e)("apps.chatwoot.conversations.statusFilter.off")},null,8,["modelValue","onLabel","offLabel"]),m.value?B("",!0):(v(),P(F,{key:0,modelValue:c.conversations.status,"onUpdate:modelValue":S[7]||(S[7]=J=>c.conversations.status=J),options:b,optionLabel:"label",optionValue:"value",placeholder:u(e)("apps.chatwoot.conversations.status.selectPlaceholder"),"max-selected-labels":4,class:"flex-1 w-full",style:{minWidth:"12rem"}},null,8,["modelValue","placeholder"]))])]),r("div",Sf,[r("label",Cf,[G(w(u(e)("apps.chatwoot.conversations.markAsRead.label"))+" ",1),K(r("i",Nf,null,512),[[V,u(e)("apps.chatwoot.conversations.markAsRead.tooltip")]])]),p(I,{modelValue:c.conversations.markAsRead,"onUpdate:modelValue":S[8]||(S[8]=J=>c.conversations.markAsRead=J),onIcon:"pi pi-check",offIcon:"pi pi-times",onLabel:u(e)("apps.chatwoot.conversations.markAsRead.on"),offLabel:u(e)("apps.chatwoot.conversations.markAsRead.off")},null,8,["modelValue","onLabel","offLabel"])]),Of,r("h4",Tf,[G(w(u(e)("apps.chatwoot.section.commands.title"))+" ",1),K(r("i",Lf,null,512),[[V,u(e)("apps.chatwoot.commands.tooltip")]])]),r("div",If,[r("div",Af,[p(I,{modelValue:c.commands.server,"onUpdate:modelValue":S[9]||(S[9]=J=>c.commands.server=J),onIcon:"pi pi-check",offIcon:"pi pi-times",onLabel:u(e)("apps.chatwoot.commands.server.on"),offLabel:u(e)("apps.chatwoot.commands.server.off")},null,8,["modelValue","onLabel","offLabel"]),p(I,{modelValue:c.commands.queue,"onUpdate:modelValue":S[10]||(S[10]=J=>c.commands.queue=J),onIcon:"pi pi-check",offIcon:"pi pi-times",onLabel:u(e)("apps.chatwoot.commands.queue.on"),offLabel:u(e)("apps.chatwoot.commands.queue.off")},null,8,["modelValue","onLabel","offLabel"])])]),Ef,r("h4",Vf,w(u(e)("apps.chatwoot.section.messages.title")),1),r("div",xf,[r("label",Df,[G(w(u(e)("apps.chatwoot.language"))+" ",1),K(r("i",Bf,null,512),[[V,u(e)("apps.chatwoot.languageTooltip")]])]),p(D,{id:"locale",modelValue:c.locale,"onUpdate:modelValue":S[11]||(S[11]=J=>c.locale=J),options:d.value,optionLabel:"name",optionValue:"locale",placeholder:u(e)("apps.chatwoot.selectLocale"),loading:h.value,class:le({"p-invalid":s.submitted&&!c.locale}),scrollHeight:"400px"},null,8,["modelValue","options","placeholder","loading","class"]),s.submitted&&!c.locale?(v(),L("small",jf,w(u(e)("apps.chatwoot.languageRequired")),1)):B("",!0)]),r("div",Mf,[r("label",Uf,[G(w(u(e)("apps.chatwoot.linkPreview.label"))+" ",1),K(r("i",Pf,null,512),[[V,u(e)("apps.chatwoot.linkPreview.tooltip")]])]),p(D,{id:"linkPreview",modelValue:c.linkPreview,"onUpdate:modelValue":S[12]||(S[12]=J=>c.linkPreview=J),options:f,optionLabel:"label",optionValue:"value"},null,8,["modelValue"])]),r("div",Rf,[r("div",null,[p(jd,{modelValue:c.templates,"onUpdate:modelValue":S[13]||(S[13]=J=>c.templates=J)},null,8,["modelValue"])])])])}}}),Kf=me(qf,[["__scopeId","data-v-9f4c0dcd"]]),Ff=s=>(Je("data-v-54b2cb78"),s=s(),Qe(),s),Wf={class:"calls-config"},Hf={class:"text-center"},Gf={class:"field"},Jf={class:"field"},Qf={class:"block mb-2",for:"dm-message"},Yf={class:"p-message-secondary"},zf=Ff(()=>r("hr",null,null,-1)),Xf={class:"text-center"},Zf={class:"field"},ep={class:"field"},tp={class:"block mb-2",for:"group-message"},sp={class:"p-message-secondary"},np=Ye({__name:"AppConfigCalls",props:{modelValue:{type:Object,required:!0},submitted:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(s,{emit:t}){const{t:e}=Q(),n=s,o=t,i=R(()=>e("apps.calls.message.default")),l=()=>({dm:{reject:!0,message:i.value},group:{reject:!0,message:i.value}}),a=Kn(pe.defaultsDeep({},pe.cloneDeep(n.modelValue??{}),l()));return se(a,c=>{const d=pe.cloneDeep(c);(d.dm.message===void 0||d.dm.message===null)&&(d.dm.message=""),(d.group.message===void 0||d.group.message===null)&&(d.group.message=""),o("update:modelValue",d)},{deep:!0,immediate:!0}),se(()=>i.value,(c,d)=>{a.dm.message===d&&(a.dm.message=c),a.group.message===d&&(a.group.message=c)}),(c,d)=>{const h=_t,f=$s,g=ft;return v(),L("div",Wf,[r("h4",Hf,w(u(e)("apps.calls.dm.title")),1),r("div",Gf,[p(h,{modelValue:a.dm.reject,"onUpdate:modelValue":d[0]||(d[0]=b=>a.dm.reject=b),onIcon:"pi pi-ban",offIcon:"pi pi-phone",onLabel:u(e)("apps.calls.reject.on"),offLabel:u(e)("apps.calls.reject.off")},null,8,["modelValue","onLabel","offLabel"])]),r("div",Jf,[r("label",Qf,w(u(e)("apps.calls.message.label")),1),p(f,{id:"dm-message",modelValue:a.dm.message,"onUpdate:modelValue":d[1]||(d[1]=b=>a.dm.message=b),autoResize:!0,rows:2,placeholder:u(e)("apps.calls.message.placeholder")},null,8,["modelValue","placeholder"]),r("small",Yf,w(u(e)("apps.calls.message.help")),1)]),zf,r("h4",Xf,w(u(e)("apps.calls.group.title")),1),r("div",Zf,[p(h,{modelValue:a.group.reject,"onUpdate:modelValue":d[2]||(d[2]=b=>a.group.reject=b),onIcon:"pi pi-ban",offIcon:"pi pi-phone",onLabel:u(e)("apps.calls.reject.on"),offLabel:u(e)("apps.calls.reject.off")},null,8,["modelValue","onLabel","offLabel"])]),r("div",ep,[r("label",tp,w(u(e)("apps.calls.message.label")),1),p(g,{severity:"warn",class:"mb-2"},{default:C(()=>[G(w(u(e)("apps.calls.group.note")),1)]),_:1}),p(f,{id:"group-message",modelValue:a.group.message,"onUpdate:modelValue":d[3]||(d[3]=b=>a.group.message=b),autoResize:!0,rows:2,placeholder:u(e)("apps.calls.message.placeholder")},null,8,["modelValue","placeholder"]),r("small",sp,w(u(e)("apps.calls.message.help")),1)])])}}}),op=me(np,[["__scopeId","data-v-54b2cb78"]]),ip={class:"chatwoot-faq"},lp={class:"mb-3"},ap={href:"https://waha.devlike.pro/docs/apps/chatwoot",target:"_blank"},rp={class:"mb-4"},cp={class:"mb-1"},up={class:"p-inputgroup mb-1"},dp={class:"p-message-secondary"},fp={class:"mt-4"},pp={class:"p-inputgroup"},hp=Ye({__name:"AppFAQChatWoot",props:{app:{type:Object,required:!0},session:{type:String,required:!0}},setup(s){const{t}=Q(),e=s,n=R(()=>`/webhooks/chatwoot/${e.session}/${e.app.id}`),o=R(()=>`http://waha:3000${n.value}`),i=R(()=>`{WAHA_BASE_URL}${n.value}`);async function l(){await navigator.clipboard.writeText(i.value)}async function a(){await navigator.clipboard.writeText(o.value)}return(c,d)=>{const h=Ss,f=Ae,g=ne,b=Cs,_=ae("tooltip");return v(),L("div",ip,[p(b,{multiple:!0,activeIndex:[1]},{default:C(()=>[p(h,{header:u(t)("apps.chatwoot.aboutApp")},{default:C(()=>[r("div",lp,[r("a",ap,w(u(t)("apps.chatwoot.learnMore")),1)])]),_:1},8,["header"]),p(h,{header:u(t)("apps.chatwoot.webhookUrl")},{default:C(()=>[r("div",rp,[r("p",cp,w(u(t)("apps.chatwoot.useWebhookUrl")),1),r("div",up,[p(f,{value:i.value,disabled:"",placeholder:u(t)("apps.chatwoot.webhookUrlPlaceholder")},null,8,["value","placeholder"]),K(p(g,{label:u(t)("apps.chatwoot.copy"),icon:"pi pi-copy",onClick:l},null,8,["label"]),[[_,{value:u(t)("apps.chatwoot.copiedToClipboard")},void 0,{focus:!0,bottom:!0}]])]),r("small",dp,w(u(t)("apps.chatwoot.replaceBaseUrl")),1)]),r("div",fp,[r("p",null,w(u(t)("apps.chatwoot.exampleSetup")),1),r("div",pp,[p(f,{value:o.value,disabled:"",placeholder:u(t)("apps.chatwoot.exampleUrlPlaceholder")},null,8,["value","placeholder"]),K(p(g,{label:u(t)("apps.chatwoot.copy"),icon:"pi pi-copy",onClick:a},null,8,["label"]),[[_,{value:u(t)("apps.chatwoot.copiedToClipboard")},void 0,{focus:!0,bottom:!0}]])])])]),_:1},8,["header"])]),_:1})])}}}),mp=me(hp,[["__scopeId","data-v-68901460"]]),gp={class:"calls-faq"},bp={class:"mb-3"},yp={href:"https://waha.devlike.pro/docs/apps/calls",target:"_blank",rel:"noopener noreferrer"},vp=Ye({__name:"AppFAQCalls",setup(s){const{t}=Q();return(e,n)=>{const o=Ss,i=Cs;return v(),L("div",gp,[p(i,{multiple:!0,activeIndex:[0]},{default:C(()=>[p(o,{header:u(t)("apps.calls.aboutApp")},{default:C(()=>[r("p",bp,[r("b",null,w(u(t)("apps.calls.description")),1)]),r("a",yp,w(u(t)("apps.calls.learnMore")),1)]),_:1},8,["header"])]),_:1})])}}}),_p=me(vp,[["__scopeId","data-v-fae640c6"]]),wp="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_378_9639)'%3e%3cpath%20d='M12%2024C18.6274%2024%2024%2018.6274%2024%2012C24%205.37258%2018.6274%200%2012%200C5.37258%200%200%205.37258%200%2012C0%2018.6274%205.37258%2024%2012%2024Z'%20fill='%232781F6'%3e%3c/path%3e%3cpath%20d='M17.1256%2017.1258H11.5622C8.4955%2017.1258%205.99976%2014.6299%205.99976%2011.5624C5.99976%208.49591%208.4955%206%2011.5623%206C14.6298%206%2017.1256%208.49591%2017.1256%2011.5624V17.1258Z'%20fill='white'%20stroke='white'%20stroke-width='0.28125'%3e%3c/path%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_378_9639'%3e%3crect%20width='24'%20height='24'%20fill='white'%3e%3c/rect%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",ei=s=>(Je("data-v-50742726"),s=s(),Qe(),s),kp={class:"chatwoot-label"},$p=ei(()=>r("img",{src:wp,alt:"ChatWoot Icon",class:"chatwoot-icon"},null,-1)),Sp=ei(()=>r("span",null,"ChatWoot",-1)),Cp=[$p,Sp],Np={__name:"ChatWootLabel",setup(s){return(t,e)=>(v(),L("span",kp,Cp))}},sn=me(Np,[["__scopeId","data-v-50742726"]]),ti=s=>(Je("data-v-aa3bf9a9"),s=s(),Qe(),s),Op={class:"calls-label"},Tp=ti(()=>r("span",{class:"emoji"},"ðŸ“ž",-1)),Lp=ti(()=>r("span",null,"Calls",-1)),Ip=[Tp,Lp],Ap={__name:"CallsLabel",setup(s){return(t,e)=>(v(),L("span",Op,Ip))}},nn=me(Ap,[["__scopeId","data-v-aa3bf9a9"]]),Ep={class:"app-edit"},Vp={class:"field"},xp={for:"id"},Dp={key:0,class:"p-error"},Bp={class:"field"},jp={for:"app-type"},Mp={key:0},Up={key:2},Pp={key:1},Rp={key:2},qp={key:0,class:"p-error"},Kp={class:"field"},Fp={key:0,class:"field"},Wp={key:0},Hp={key:1},Gp={class:"card app-config"},Jp=Ye({__name:"AppEdit",props:{modelValue:{type:Object,required:!0},server:{type:Object,required:!0},visible:{type:Boolean,default:!1},isNewApp:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},emits:["update:modelValue","update:visible","save","cancel"],setup(s,{emit:t}){const{t:e}=Q(),n=s,o=R({get:()=>n.visible,set:_=>l("update:visible",_)}),i=R(()=>!n.modelValue.id),l=t;he(),bt();const a=R({get:()=>n.modelValue,set:_=>l("update:modelValue",_)}),c=R({get:()=>{var _;return((_=a.value)==null?void 0:_.enabled)===void 0?!0:!!a.value.enabled},set:_=>{a.value={...a.value,enabled:_}}}),d=E([{name:"ChatWoot",value:"chatwoot",label:"chatwoot"},{name:"ðŸ“ž Calls",value:"calls",label:"calls"}]);se(()=>{var _;return(_=a.value)==null?void 0:_.app},(_,m)=>{!_||_===m||(a.value={...a.value,config:{}})});const h=E(!1);se(()=>a.value,_=>{_.id||(a.value={..._,id:f()}),_.enabled===void 0&&(a.value={..._,enabled:!0})},{immediate:!0});function f(){return Xn()}function g(){if(h.value=!0,!(!a.value.id||!a.value.app||!a.value.session)){if(a.value.app==="chatwoot"){const _=a.value.config;if(!_||!_.url||!_.accountId||!_.accountToken||!_.inboxId||!_.inboxIdentifier||!_.locale)return}l("save",a.value)}}function b(){h.value=!1,l("update:visible",!1),l("cancel")}return(_,m)=>{const y=Ae,N=yt,$=_t,S=ne,O=vt;return v(),P(O,{visible:o.value,"onUpdate:visible":m[5]||(m[5]=k=>o.value=k),modal:!0,class:"p-fluid",header:n.isNewApp?u(e)("apps.addAppTitle"):u(e)("apps.editAppTitle")},{footer:C(()=>[p(S,{label:u(e)("apps.cancel"),icon:"pi pi-times",onClick:b,text:"",severity:"secondary"},null,8,["label"]),p(S,{label:i.value?u(e)("apps.add"):u(e)("apps.save"),icon:i.value?"pi pi-plus":"pi pi-check",onClick:g,loading:n.loading,text:""},null,8,["label","icon","loading"])]),default:C(()=>[r("div",Ep,[r("div",Vp,[r("label",xp,[r("b",null,w(u(e)("apps.appId")),1)]),p(y,{id:"id",modelValue:a.value.id,"onUpdate:modelValue":m[0]||(m[0]=k=>a.value.id=k),disabled:!n.isNewApp,placeholder:"Automatically generated"},null,8,["modelValue","disabled"]),h.value&&!a.value.id?(v(),L("small",Dp,w(u(e)("apps.appIdRequired")),1)):B("",!0)]),r("div",Bp,[r("label",jp,[r("b",null,w(u(e)("apps.appType")),1)]),p(N,{id:"app-type",modelValue:a.value.app,"onUpdate:modelValue":m[1]||(m[1]=k=>a.value.app=k),options:d.value,optionLabel:"name",optionValue:"value",placeholder:u(e)("apps.selectAppType"),class:le({"p-invalid":h.value&&!a.value.app}),disabled:!n.isNewApp},{value:C(k=>[k.value?(v(),L("div",Mp,[k.value==="chatwoot"?(v(),P(sn,{key:0})):k.value==="calls"?(v(),P(nn,{key:1})):(v(),L("span",Up,w(k.value),1))])):(v(),L("span",Pp,w(k.placeholder),1))]),option:C(k=>[k.option.value==="chatwoot"?(v(),P(sn,{key:0})):k.option.value==="calls"?(v(),P(nn,{key:1})):(v(),L("span",Rp,w(k.option.name),1))]),_:1},8,["modelValue","options","placeholder","class","disabled"]),h.value&&!a.value.app?(v(),L("small",qp,w(u(e)("apps.appTypeRequired")),1)):B("",!0)]),r("div",Kp,[r("label",null,[r("b",null,w(u(e)("apps.enabled.label.edit")),1)]),r("div",null,[p($,{modelValue:c.value,"onUpdate:modelValue":m[2]||(m[2]=k=>c.value=k),onIcon:"pi pi-check",offIcon:"pi pi-times",onLabel:u(e)("apps.enabled.on"),offLabel:u(e)("apps.enabled.off")},null,8,["modelValue","onLabel","offLabel"])])]),a.value.app?(v(),L("div",Fp,[a.value.app==="chatwoot"?(v(),L("div",Wp,[r("label",null,[r("b",null,w(u(e)("apps.appFAQ")),1)]),p(mp,{app:a.value,session:a.value.session||""},null,8,["app","session"])])):a.value.app==="calls"?(v(),L("div",Hp,[r("label",null,[r("b",null,w(u(e)("apps.appFAQ")),1)]),p(_p)])):B("",!0),r("label",null,[r("b",null,w(u(e)("apps.appConfiguration")),1)]),r("div",Gp,[a.value.app==="chatwoot"?(v(),P(Kf,{key:0,modelValue:a.value.config,"onUpdate:modelValue":m[3]||(m[3]=k=>a.value.config=k),server:s.server,submitted:h.value},null,8,["modelValue","server","submitted"])):a.value.app==="calls"?(v(),P(op,{key:1,modelValue:a.value.config,"onUpdate:modelValue":m[4]||(m[4]=k=>a.value.config=k),submitted:h.value},null,8,["modelValue","submitted"])):B("",!0)])])):B("",!0)])]),_:1},8,["visible","header"])}}}),Qp=me(Jp,[["__scopeId","data-v-ec86aebb"]]),Yp={class:"app-list"},zp={class:"flex justify-content-between align-items-center w-full mb-2"},Xp={class:"mb-0"},Zp={class:"pi pi-info-circle"},eh={class:"text-center p-4"},th={class:"flex gap-2 justify-content-end"},sh=Ye({__name:"AppList",props:{server:Object,session:Object,isNewSession:{type:Boolean,default:!1}},setup(s){const t=Mt(),e=qn(),n=he(),o=bt(),{t:i}=Q(),l=s,a=E([]),c=E(!1),d=E(!1),h=E(null),f=E(!1);_s(async()=>{await g()}),se(()=>[l.server,l.session],async()=>{await g()},{deep:!0});async function g(){if(!l.server||!l.session||!l.session.name){a.value=[];return}try{c.value=!0,a.value=await o(n.getApps(l.server.id,l.session.name),void 0,i("apps.failedToLoad"))}catch(O){console.error("Error loading apps:",O)}finally{c.value=!1}}function b(){if(l.isNewSession){t.add({severity:"info",summary:"Info",detail:i("apps.createSessionFirst"),life:3e3});return}h.value={id:N(),session:l.session.name,app:"",config:{},enabled:!0},f.value=!0,d.value=!0}function _(O){h.value={...O},f.value=!1,d.value=!0}function m(O,k){const A=S(O.app);e.require({target:k.currentTarget,message:i("apps.deleteConfirm",{appType:A,id:O.id}),icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-danger p-button-sm",rejectLabel:i("apps.no"),acceptLabel:i("apps.yesDelete"),accept:async()=>{await y(O)},reject:()=>{}})}async function y(O){try{await o(n.deleteApp(l.server.id,O.id),void 0,i("apps.failedToDelete"));const k=S(O.app);t.add({severity:"success",summary:i("apps.deleted"),detail:`${k} (${O.id})`,life:3e3}),await g()}catch(k){console.error("Error deleting app:",k)}}function N(){return Xn()}async function $(O){try{const k=S(O.app);return f.value?(await o(n.createApp(l.server.id,O),void 0,i("apps.failedToCreate")),t.add({severity:"success",summary:i("apps.created"),detail:`${k} (${O.id})`,life:3e3})):(await o(n.updateApp(l.server.id,O),void 0,i("apps.failedToUpdate")),t.add({severity:"success",summary:i("apps.updated"),detail:`${k} (${O.id})`,life:3e3})),await g(),d.value=!1,!0}catch(k){return console.error("Error saving app:",k),!1}}function S(O){switch(O){case"chatwoot":return"ChatWoot";case"calls":return"ðŸ“ž Calls";default:return O}}return(O,k)=>{const A=ne,D=ws,I=gu,F=ks,V=an,H=ae("tooltip");return v(),L("div",Yp,[r("div",zp,[r("div",null,[r("h5",Xp,[G(w(u(i)("apps.title"))+" ",1),K(r("i",Zp,null,512),[[H,u(i)("apps.builtInIntegrations")]])])]),r("div",null,[p(A,{label:u(i)("apps.addApp"),icon:"pi pi-plus",onClick:b,severity:"success",text:""},null,8,["label"])])]),p(F,{value:a.value,loading:c.value,dataKey:"id",paginator:a.value.length>10,rows:10,showGridlines:""},{empty:C(()=>[r("div",eh,w(u(i)("apps.noAppsFound")),1)]),default:C(()=>[p(D,{field:"app",header:u(i)("apps.appType")},{body:C(({data:q})=>[q.app==="chatwoot"?(v(),P(sn,{key:0})):q.app==="calls"?(v(),P(nn,{key:1})):(v(),L(te,{key:2},[G(w(S(q.app)),1)],64))]),_:1},8,["header"]),p(D,{field:"id",header:u(i)("apps.id")},null,8,["header"]),p(D,{header:u(i)("apps.enabled.label.list"),style:{width:"10rem"}},{body:C(({data:q})=>[p(I,{enabled:q.enabled!==!1},null,8,["enabled"])]),_:1},8,["header"]),p(D,{style:{width:"10rem","text-align":"right"}},{body:C(({data:q})=>[r("div",th,[K(p(A,{icon:"pi pi-pencil",onClick:J=>_(q),outlined:"",rounded:"",severity:"success"},null,8,["onClick"]),[[H,u(i)("apps.editApp"),void 0,{top:!0}]]),K(p(A,{icon:"pi pi-trash",onClick:J=>m(q,J),outlined:"",rounded:"",severity:"danger"},null,8,["onClick"]),[[H,u(i)("apps.deleteApp"),void 0,{top:!0}]])])]),_:1})]),_:1},8,["value","loading","paginator"]),p(V),h.value?(v(),P(Qp,{key:0,modelValue:h.value,"onUpdate:modelValue":k[0]||(k[0]=q=>h.value=q),server:s.server,visible:d.value,"onUpdate:visible":k[1]||(k[1]=q=>d.value=q),isNewApp:f.value,loading:c.value,onSave:$,onCancel:k[2]||(k[2]=q=>d.value=!1)},null,8,["modelValue","server","visible","isNewApp","loading"])):B("",!0)])}}}),nh=me(sh,[["__scopeId","data-v-f50de5be"]]),oh={class:"w-full flex flex-column gap-2"},ih={key:0},lh=["innerHTML"],ah={__name:"AppsDialog",props:{visible:{},visibleModifiers:{},session:{},sessionModifiers:{},server:{},serverModifiers:{}},emits:["update:visible","update:session","update:server"],setup(s){const{t}=Q(),e=be(s,"visible"),n=be(s,"session"),o=be(s,"server"),i=R(()=>n.value.status==="STOPPED");return(l,a)=>{const c=vt;return v(),P(c,{visible:e.value,"onUpdate:visible":a[0]||(a[0]=d=>e.value=d),modal:!0,class:"p-fluid",maximizable:"",style:{"min-width":"50%"}},{header:C(()=>[p(Rt,{session:n.value},null,8,["session"])]),footer:C(()=>[r("div",oh,[i.value?B("",!0):(v(),L("div",ih,[p(u(ft),{severity:"warn"},{default:C(()=>[r("span",{innerHTML:u(t)("apps.sessionStatusWarning",{status:n.value.status})},null,8,lh)]),_:1})]))])]),default:C(()=>[p(nh,{server:o.value,session:n.value,isNewSession:!1},null,8,["server","session"])]),_:1},8,["visible"])}}},rh={class:"flex justify-content-between"},ch={class:"flex align-items-center gap-1"},uh=r("i",{class:"pi pi-whatsapp"},null,-1),dh={class:"mr-1"},fh=["disabled"],ph=r("i",{class:"pi pi-refresh"},null,-1),hh=[ph],mh={class:"flex justify-content-between flex-column sm:flex-row gap-2 sm:gap-0"},gh={class:"flex flex-column"},bh={class:"flex justify-content-between flex-column sm:flex-row gap-2 sm:gap-2"},yh={style:{"text-align":"left"},class:"flex flex-column"},vh={class:"flex justify-content-center"},_h={class:"flex gap-2"},wh={class:"my-auto"},kh={key:0,class:"pi pi-info-circle text-orange-400"},$h={class:"flex flex-row gap-2 justify-content-end",style:{order:"2"}},lm={__name:"SessionTable",setup(s){const t=Mt(),{t:e}=Q(),n=he(),{visibleSessions:o,refreshing:i,servers:l}=on(n),a=E({config:{webhooks:[]}}),c=E(!1),d=E(void 0),h=E(!1),f=E(!1),g=E(!1),b=E(null),_=E(10);E(null);const m=E({}),y=E(null),N=E([]),$=R(()=>N.value.filter(T=>I.value[`session-action-${T.server.id}-${T.name}`])),S=E(!1),O=E(!1),k=E(!1),A=E(!1),D=E(!1),I=E({});function F(T,M){switch(T){case"startSession":S.value=M;break;case"restartSession":O.value=M;break;case"stopSession":k.value=M;break;case"logoutSession":A.value=M;break;case"deleteSession":D.value=M;break}}async function V(T){F(T,!0);try{for(const M of $.value)await I.value[`session-action-${M.server.id}-${M.name}`][T]()}finally{F(T,!1)}}pi(()=>{I.value=[]}),hi(()=>{Yt()});const H=E([{field:"name",header:e("sessions.name")},{field:"metadata",header:e("sessions.metadata")},{field:"me",header:e("sessions.me")},{field:"status",header:e("sessions.status")},{field:"server",header:e("sessions.server")}]);function q(){return JSON.parse(localStorage.getItem("sessions.table.columns.hidden"))||[]}const J=q(),we=E(pe.differenceBy(H.value,J,"field")),Ee=T=>{we.value=H.value.filter(M=>T.includes(M))};function Te(T){return!we.value||we.value.length===0?!0:pe.find(we.value,{field:T})}const Tt=R(()=>Te("name")),Ve=R(()=>Te("metadata")),Ht=R(()=>Te("me")),Gt=R(()=>Te("status")),Jt=R(()=>Te("server")),Qt=R(()=>pe.differenceBy(H.value,we.value,"field"));se(()=>Qt.value,T=>{localStorage.setItem("sessions.table.columns.hidden",JSON.stringify(T))},{deep:!0});const Yt=()=>{m.value={global:{value:null,matchMode:Lt.CONTAINS},status:{value:null,matchMode:Lt.EQUALS},"server.id":{value:null,matchMode:Lt.EQUALS},name:{value:null,matchMode:Lt.CONTAINS},"me.id":{value:null,matchMode:Lt.CONTAINS}}};function zt(){const T=l.value.find(M=>M.connected);if(!T){t.add({severity:"error",summary:e("sessions.noConnectedServer"),detail:e("sessions.pleaseConnectToServerFirst"),life:3e3});return}a.value={server:T.id,name:"",config:{metadata:{},webhooks:[],noweb:{markOnline:!0,store:{enabled:!0,fullSync:!0}},webjs:{tagsEventsOn:!1},gows:{storage:{messages:!0,groups:!0,chats:!0,labels:!0}},ignore:null,proxy:{}}},d.value="new",c.value=!0}function Xt(T){a.value=pe.cloneDeep({name:T.name,status:T.status,server:T.server.id,config:T.config}),d.value="update",c.value=!0}function Zt(){ys("store",async()=>await n.refresh())}function es(T){h.value=!0,a.value=T}function ts(T){a.value=T,f.value=!0}function ss(T){a.value=T,b.value=T.server,g.value=!0}se(f,T=>{T||(a.value={config:{webhooks:[]}})});const x=R(()=>["name","me.id","me.pushName","_metadata"]);return(T,M)=>{const ke=Pn,xe=ne,De=Ri,oe=mi,X=Ae,Re=gi,Ze=ln,de=ws,Be=Fi,et=rn,tt=ll,qe=Gn,Ke=yt,Rs=Jn,ce=to,U=cl,si=ks,ni=an,oi=ya,ii=Ja,li=Pc,ns=ae("tooltip");return v(),L(te,null,[r("div",rh,[r("div",null,[r("h5",ch,[uh,r("span",dh,w(u(e)("sessions.title")),1),p(ke,{refreshing:u(i)},null,8,["refreshing"])])]),r("div",null,[K((v(),L("button",{onClick:Zt,class:"p-link layout-topbar-button",disabled:u(i)},hh,8,fh)),[[ns,u(e)("sessions.refresh"),void 0,{top:!0}]])])]),p(si,{selection:N.value,"onUpdate:selection":M[8]||(M[8]=j=>N.value=j),value:u(o).length>0?u(o):[],paginator:!0,rows:_.value,rowsPerPageOptions:[5,10,20,50,100,500],dataKey:j=>`${j.server.id}-${j.name}`,rowHover:!0,filters:m.value,"onUpdate:filters":M[9]||(M[9]=j=>m.value=j),filterDisplay:"row",loading:y.value,globalFilterFields:u(x),showGridlines:"",style:{"white-space":"nowrap"},sortField:"name",sortOrder:1,resizableColumns:""},{header:C(()=>[r("div",mh,[r("div",gh,[p(xe,{label:u(e)("sessions.startNew"),icon:"pi pi-play",severity:"success",onClick:zt},null,8,["label"])]),r("div",bh,[p(De),r("div",null,[p(Re,{iconPosition:"left"},{default:C(()=>[p(oe,{class:"pi pi-search"}),p(X,{modelValue:m.value.global.value,"onUpdate:modelValue":M[0]||(M[0]=j=>m.value.global.value=j),placeholder:u(e)("sessions.searchByNamePhoneMetadata"),style:{width:"100%"}},null,8,["modelValue","placeholder"])]),_:1})]),r("div",yh,[p(Ze,{placeholder:u(e)("sessions.columns"),modelValue:we.value,options:H.value,optionLabel:"header",selectedItemsLabel:u(e)("sessions.columns"),maxSelectedLabels:0,"onUpdate:modelValue":Ee},null,8,["placeholder","modelValue","options","selectedItemsLabel"])])])])]),empty:C(()=>[G(w(u(e)("sessions.noSessionsFound")),1)]),loading:C(()=>[G(w(u(e)("sessions.loadingSessions")),1)]),default:C(()=>[p(de,{selectionMode:"multiple",headerStyle:"width: 3rem"}),u(Tt)?(v(),P(de,{key:0,field:"name",header:u(e)("sessions.name"),"show-filter-menu":!1,sortable:""},{filter:C(({filterModel:j,filterCallback:ye})=>[p(X,{modelValue:m.value.name.value,"onUpdate:modelValue":M[1]||(M[1]=$e=>m.value.name.value=$e),type:"text",placeholder:u(e)("sessions.session")},null,8,["modelValue","placeholder"])]),_:1},8,["header"])):B("",!0),u(Ve)?(v(),P(de,{key:1,header:u(e)("sessions.metadata")},{body:C(({data:j})=>{var ye;return[p(Be,{metadata:(ye=j.config)==null?void 0:ye.metadata},null,8,["metadata"])]}),_:1},8,["header"])):B("",!0),u(Ht)?(v(),P(de,{key:2,header:u(e)("sessions.me")},{body:C(({data:j})=>[r("div",vh,[p(et,{session:j},null,8,["session"])])]),filter:C(({filterModel:j,filterCallback:ye})=>[p(X,{modelValue:m.value["me.id"].value,"onUpdate:modelValue":M[2]||(M[2]=$e=>m.value["me.id"].value=$e),type:"text",placeholder:u(e)("sessions.mePhoneNumber")},null,8,["modelValue","placeholder"])]),_:1},8,["header"])):B("",!0),u(Gt)?(v(),P(de,{key:3,field:"status",header:u(e)("sessions.status"),showFilterMenu:!1,style:{width:"9rem"}},{body:C(({data:j})=>[r("div",_h,[r("div",null,[p(mu,{session:j},null,8,["session"])]),r("div",null,[p(tt,{session:j},null,8,["session"])]),r("div",null,[K(p(xe,{icon:"pi pi-whatsapp",severity:"",rounded:"",outlined:"",disabled:j.status!=="WORKING",onClick:ye=>ts(j)},null,8,["disabled","onClick"]),[[ns,u(e)("sessions.chatUI"),void 0,{top:!0}]])]),r("div",null,[K(p(xe,{icon:"pi pi-code",severity:"secondary",rounded:"",outlined:"",onClick:ye=>es(j)},null,8,["onClick"]),[[ns,u(e)("sessions.sendRequest"),void 0,{top:!0}]])]),r("div",wh,[p(qe,{status:j.status},null,8,["status"])])])]),filter:C(({filterModel:j,filterCallback:ye})=>[p(Ke,{modelValue:j.value,"onUpdate:modelValue":$e=>j.value=$e,options:u(Rc),onChange:$e=>ye(),placeholder:u(e)("sessions.any"),class:"p-column-filter",showClear:!0},{option:C(({option:$e})=>[p(qe,{status:$e},null,8,["status"])]),_:2},1032,["modelValue","onUpdate:modelValue","options","onChange","placeholder"])]),_:1},8,["header"])):B("",!0),u(Jt)?(v(),P(de,{key:4,field:"server.name",filterField:"server.id",header:u(e)("sessions.server"),showFilterMenu:!1},{filter:C(({filterModel:j,filterCallback:ye})=>[p(Rs,{placeholder:u(e)("sessions.any"),onChange:$e=>ye(),modelValue:j.value,"onUpdate:modelValue":$e=>j.value=$e,showClear:!0,required:!1},null,8,["placeholder","onChange","modelValue","onUpdate:modelValue"])]),body:C(({data:j})=>[G(w(j.server.name)+" ",1),j.assignedWorker&&j.server.name!==j.assignedWorker?K((v(),L("i",kh,null,512)),[[ns,`${u(e)("sessions.assignedWorkerIdDoesNotMatch")}

ðŸ‘‰ ${u(e)("sessions.assignedWorkerId")}: ${j.assignedWorker}`]]):B("",!0)]),_:1},8,["header"])):B("",!0),p(de,{showFilterMenu:!1},{filter:C(()=>[r("div",$h,[p(ce,{group:"dialog",name:`'${u($).length}' sessions`,"all-disabled":u($).length===0,"hide-actions":["view","apps"],"is-starting":S.value,"is-restarting":O.value,"is-stopping":k.value,"is-logging-out":A.value,"is-removing":D.value,onStart:M[3]||(M[3]=j=>V("startSession")),onRestart:M[4]||(M[4]=j=>V("restartSession")),onStop:M[5]||(M[5]=j=>V("stopSession")),onLogout:M[6]||(M[6]=j=>V("logoutSession")),onDelete:M[7]||(M[7]=j=>V("deleteSession"))},null,8,["name","all-disabled","is-starting","is-restarting","is-stopping","is-logging-out","is-removing"])])]),body:C(({data:j})=>[p(U,{ref:ye=>{I.value[`session-action-${j.server.id}-${j.name}`]=ye},session:j,disabled:u($).length!==0,onView:Xt,onApps:ss},null,8,["session","disabled"])]),_:1})]),_:1},8,["selection","value","rows","dataKey","filters","loading","globalFilterFields"]),p(ni),p(oi,{visible:f.value,"onUpdate:visible":M[10]||(M[10]=j=>f.value=j),session:a.value,"onUpdate:session":M[11]||(M[11]=j=>a.value=j)},null,8,["visible","session"]),p(ii,{visible:h.value,"onUpdate:visible":M[12]||(M[12]=j=>h.value=j),session:a.value,"onUpdate:session":M[13]||(M[13]=j=>a.value=j)},null,8,["visible","session"]),p(li,{visible:c.value,"onUpdate:visible":M[14]||(M[14]=j=>c.value=j),session:a.value,"onUpdate:session":M[15]||(M[15]=j=>a.value=j),mode:d.value},null,8,["visible","session","mode"]),p(ah,{visible:g.value,"onUpdate:visible":M[16]||(M[16]=j=>g.value=j),session:a.value,"onUpdate:session":M[17]||(M[17]=j=>a.value=j),server:b.value,"onUpdate:server":M[18]||(M[18]=j=>b.value=j)},null,8,["visible","session","server"])],64)}}};export{Ri as _,lm as a};
