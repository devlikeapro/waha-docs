import{u as is,_ as Cn}from"./Dv-CHjTy.js";import te from"./BUl0Pv7r.js";import Qi from"./CYQsh3YH.js";import{u as ae,a as Yi,s as it,C as Qe,W as zi,l as ve}from"./f2okiP2T.js";import{O as X,S as Us,P as oe,N as d,t as w,v as A,x as u,y as S,Q as K,z as g,X as os,_ as Pe,U as ee,Y as St,V as D,L as M,A as O,r as I,o as ls,c as q,Z as On,B as H,$ as fe,M as fn,H as ce,a0 as Xi,a1 as Xt,a2 as ue,R as $t,a3 as Zi,a4 as Ct,i as Ot,a5 as eo,d as Tt,C as Rs,D as qs,a6 as to,a7 as so,W as no,T as mt}from"./ChQFhIew.js";import io from"./Dr1hxoo_.js";import Ne from"./D-JyQb6l.js";import oo from"./CI0A0Wkx.js";import Tn from"./a3nVFgIp.js";import as from"./DM46f_xp.js";import Nn from"./DHiQJAxB.js";import An from"./DJ33xA9l.js";import In from"./D_9SwNzo.js";import lo from"./DMC5MHo4.js";import{u as at,_ as Ln}from"./1A5yDvMn.js";import Nt from"./CFn3xlQC.js";import{_ as ao,a as ro,b as En}from"./Bcr4vldM.js";import Ks from"./6qBdumMh.js";import co from"./CGZjogD2.js";import rs from"./DrZqx2yV.js";import{_ as uo}from"./DdCIPMan.js";import fo from"./CRtDgbms.js";import po from"./Dmy-Yr0W.js";import ho from"./n8wLO7nh.js";import rt from"./BiOIhbiW.js";import Fs from"./wRfqSfCK.js";import Vn from"./D3HNWd3F.js";import Ws from"./Cow5aY05.js";import cs from"./Ce92w4tZ.js";import Hs from"./8wQF9na5.js";import Js from"./CQ3xhMJz.js";import Dn from"./Dgdj8HhA.js";import Bn from"./DYcxFNde.js";import mo from"./TgVeNTEw.js";import go from"./BDSudhPM.js";import yo from"./DsKXBuDT.js";function xn(s="app"){const t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let e="";for(let n=0;n<8;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return`${s}_${e}`}function bo(s){return s?Object.keys(s).map(t=>({key:t,value:s[t]})):[]}function vo(s){return s.reduce((t,e)=>(t[e.key]=e.value,t),{})}const _o={key:0},wo={key:1,class:"ml-auto flex align-items-center gap-2 mr-2"},ko={for:"show-duplicates"},So={class:"pi pi-info-circle"},$o={__name:"HideDuplicates",setup(s){const{t}=X(),e=ae(),{hideDuplicatedSessions:n,servers:i}=Us(e);return e.$subscribe((o,l)=>{Yi(l.hideDuplicatedSessions)}),(o,l)=>{const a=Qi,r=oe("tooltip");return d(i)&&d(i).length<2?(w(),A("div",_o)):(w(),A("div",wo,[u("label",ko,S(d(t)("sessions.hideDuplicates")),1),K(u("i",So,null,512),[[r,d(t)("sessions.hideDuplicatesTooltip")]]),g(a,{id:"show-duplicates",modelValue:d(n),"onUpdate:modelValue":l[0]||(l[0]=c=>os(n)?n.value=c:null)},null,8,["modelValue"])]))}}},Co={class:"metadata"},Oo={__name:"Metadata",props:["metadata"],setup(s){return(t,e)=>(w(),A("div",Co,[(w(!0),A(ee,null,St(s.metadata,(n,i)=>(w(),A("pre",{key:i},S(i)+"="+S(n),1))),128))]))}},To=Pe(Oo,[["__scopeId","data-v-cb7cbf08"]]),No={key:0,class:"text-center p-1"},Ao={class:"text-center"},Io=u("i",{class:"mr-3 pi pi-user",style:{color:"#34d399"}},null,-1),Zt={__name:"ContactChip",props:{id:String,name:String,image:String},setup(s){return(t,e)=>{const n=Nn;return w(),A("div",null,[s.name?(w(),A("div",No,[u("b",Ao,S(s.name),1)])):D("",!0),s.id?(w(),M(n,{key:1,label:s.id,image:s.image,icon:"pi pi-user"},{icon:O(()=>[Io]),_:1},8,["label","image"])):D("",!0)])}}},Gs={__name:"SessionChip",props:{session:Object},setup(s){const t=s,e=ae(),n=I(null);return ls(()=>{var i,o,l;(o=(i=t.session)==null?void 0:i.me)!=null&&o.id&&((l=t.session)==null?void 0:l.status)==="WORKING"&&e.getProfilePicture(t.session.server.id,t.session.name,t.session.me.id).then(a=>{n.value=a.profilePictureURL})}),(i,o)=>{var l,a,r,c;return w(),M(Zt,{id:(a=(l=t.session)==null?void 0:l.me)==null?void 0:a.id,name:(c=(r=t.session)==null?void 0:r.me)==null?void 0:c.pushName,image:d(n)},null,8,["id","name","image"])}}},At={__name:"RefreshButton",props:["refreshing"],setup(s){const t=s,e=q(()=>t.refreshing?"pi pi-refresh pi-spin":"pi pi-refresh");return(n,i)=>{const o=te;return w(),M(o,{icon:d(e),rounded:"",text:"",disabled:s.refreshing},null,8,["icon","disabled"])}}},Lo=["src"],Mn={__name:"Base64Img",props:{data:String,mimetype:String},setup(s){const t=s,e=q(()=>`data:${t.mimetype};base64, ${t.data}`);return(n,i)=>(w(),A("img",{src:e.value,style:{"max-width":"100%"}},null,8,Lo))}},Eo={key:2,style:{"background-color":"#f8f9fa",padding:"1rem",color:"red","white-space":"pre-wrap"}},Pn={__name:"SessionScreenshot",props:{session:Object},setup(s,{expose:t}){const e=ae(),n=s,{data:i,pending:o,error:l,refresh:a}=is(`session-screenshot-${n.session.server.id}-${n.session.name}`,async()=>(await it(1e3),await e.getScreenshot(n.session.server.id,n.session.name)));return t({refresh:a}),(r,c)=>{const h=An,p=In,y=Mn;return w(),A(ee,null,[d(o)?(w(),A(ee,{key:0},[g(h,{mode:"indeterminate",style:{height:"3px"}}),!d(i)&&!d(l)?(w(),M(p,{key:0,width:"100%",height:"20rem"})):D("",!0)],64)):D("",!0),d(i)?(w(),M(y,{key:1,data:d(i).data,mimetype:d(i).mimetype},null,8,["data","mimetype"])):D("",!0),d(l)?(w(),A("pre",Eo,""+S(d(l).cause.response.data.message||d(l).cause.response.data||d(l))+`
  `,1)):D("",!0)],64)}}},Vo={class:"",style:{"min-width":"20rem"}},Do={class:"flex justify-content-center align-items-center"},Bo={class:"m-0"},xo={class:"m-auto w-full"},Mo={__name:"ScreenshotButton",props:["session"],setup(s){const{t}=X(),e=s,n=I(null),i=I(null),o=r=>{n.value.toggle(r)},l=()=>{i.value.refresh()},a=q(()=>e.session.status==="STOPPED");return(r,c)=>{const h=te,p=At,y=Pn,v=lo,m=oe("tooltip");return w(),A(ee,null,[K(g(h,{disabled:d(a),type:"button",icon:"pi pi-camera",onClick:o,rounded:"",outlined:"",severity:"help"},null,8,["disabled"]),[[m,d(t)("screenshot.screenshotQR"),void 0,{top:!0}]]),g(v,{ref_key:"op",ref:n,appendTo:"body",showCloseIcon:!0},{default:O(()=>[u("div",Vo,[u("div",Do,[u("h5",Bo,S(d(t)("screenshot.screenshot")),1),g(p,{onClick:l})]),u("div",xo,[g(y,{ref_key:"screenshot",ref:i,session:s.session},null,8,["session"])])])]),_:1},512)],64)}}},Po={class:"flex flex-row gap-2 justify-content-end"},jn={__name:"SessionActionButtons",props:["name","isStarting","isRestarting","isStopping","isLoggingOut","isRemoving","allDisabled","hideActions","skipConfirmation","group"],emits:["view","start","restart","stop","logout","delete","apps"],setup(s,{emit:t}){const{t:e}=X(),n=On(),i=s,o=t;function l(m){return i.skipConfirmation?!i.skipConfirmation.includes(m):!0}async function a(){if(!l("start")){o("start");return}n.require({group:i.group,target:event.target,message:e("sessions.startConfirm",{name:i.name}),icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-success p-button-sm",rejectLabel:e("sessions.no"),acceptLabel:e("sessions.yesStart"),accept:()=>{o("start")},reject:()=>{}})}const r=q(()=>i.hideActions?!i.hideActions.includes("view"):!0),c=q(()=>i.hideActions?!i.hideActions.includes("apps"):!0);function h(m){n.require({group:i.group,target:m.target,message:e("sessions.restartConfirm",{name:i.name}),icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-info p-button-sm",rejectLabel:e("sessions.no"),acceptLabel:e("sessions.yesRestart"),accept:()=>{o("restart")},reject:()=>{}})}function p(m){n.require({group:i.group,target:m.target,message:e("sessions.stopConfirm",{name:i.name}),icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-warning p-button-sm",rejectLabel:e("sessions.no"),acceptLabel:e("sessions.yesStop"),accept:async()=>{o("stop")},reject:()=>{}})}function y(m){n.require({group:i.group,target:m.target,message:e("sessions.logoutConfirm",{name:i.name}),icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-warning p-button-sm",rejectLabel:e("sessions.no"),acceptLabel:e("sessions.yesLogout"),accept:async()=>{o("logout")},reject:()=>{}})}function v(m){n.require({group:i.group,target:m.target,message:e("sessions.deleteConfirm",{name:i.name}),icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-danger p-button-sm",rejectLabel:e("sessions.no"),acceptLabel:e("sessions.yesDelete"),accept:async()=>{o("delete")},reject:()=>{}})}return(m,f)=>{const b=te,$=Ks,k=co,T=oe("tooltip");return w(),A(ee,null,[u("div",Po,[d(r)?K((w(),M(b,{key:0,icon:"pi pi-cog",severity:"help",rounded:"",outlined:"",onClick:f[0]||(f[0]=C=>m.$emit("view")),disabled:s.allDisabled},null,8,["disabled"])),[[T,d(e)("sessions.configuration"),void 0,{top:!0}]]):D("",!0),d(c)?K((w(),M(b,{key:1,icon:"pi pi-th-large",severity:"info",rounded:"",outlined:"",onClick:f[1]||(f[1]=C=>m.$emit("apps")),disabled:s.allDisabled},null,8,["disabled"])),[[T,d(e)("sessions.apps"),void 0,{top:!0}]]):D("",!0),K(g(b,{icon:"pi pi-play",severity:"success",rounded:"",outlined:"",onClick:a,loading:s.isStarting,disabled:s.allDisabled},null,8,["loading","disabled"]),[[T,d(e)("sessions.start"),void 0,{top:!0}]]),K(g(b,{icon:"pi pi-replay",severity:"info",rounded:"",outlined:"",onClick:f[2]||(f[2]=C=>h(C)),loading:s.isRestarting,disabled:s.allDisabled},null,8,["loading","disabled"]),[[T,d(e)("sessions.restart"),void 0,{top:!0}]]),K(g(b,{icon:"pi pi-stop",severity:"secondary",rounded:"",outlined:"",onClick:f[3]||(f[3]=C=>p(C)),loading:s.isStopping,disabled:s.allDisabled},null,8,["loading","disabled"]),[[T,d(e)("sessions.stop"),void 0,{top:!0}]]),K(g(b,{icon:"pi pi-sign-out",severity:"warning",rounded:"",outlined:"",onClick:f[4]||(f[4]=C=>y(C)),loading:s.isLoggingOut,disabled:s.allDisabled},null,8,["loading","disabled"]),[[T,d(e)("sessions.logout"),void 0,{top:!0}]]),K(g(b,{icon:"pi pi-trash",severity:"danger",rounded:"",outlined:"",onClick:f[5]||(f[5]=C=>v(C)),loading:s.isRemoving,disabled:s.allDisabled},null,8,["loading","disabled"]),[[T,d(e)("sessions.delete"),void 0,{top:!0}]])]),s.group==="popup"?(w(),M($,{key:0,group:"popup"})):D("",!0),s.group==="dialog"?(w(),M(k,{key:1,group:"dialog"})):D("",!0)],64)}}},jo={class:"flex flex-row gap-2 justify-content-end"},Uo={__name:"SessionActions",props:["session","disabled"],emits:["view","apps"],setup(s,{expose:t,emit:e}){const{t:n}=X(),i=s,o=ae(),l=at(),a=I(!1),r=I(!1),c=I(!1),h=I(!1),p=I(!1),y=q(()=>i.disabled||a.value||r.value||c.value||h.value||p.value);async function v(){const k=i.session;h.value=!0,await l(o.startSession(k.server.id,k.name),n("sessions.started"),n("sessions.failedToStartSession"),k.name,k.name).finally(()=>h.value=!1)}async function m(){const k=i.session;p.value=!0,await l(o.restartSession(k.server.id,k.name),n("sessions.restarted"),n("sessions.failedToRestartSession"),k.name,k.name).finally(()=>p.value=!1)}async function f(){const k=i.session;a.value=!0,await l(o.stopSession(k.server.id,k.name),n("sessions.stopped"),n("sessions.failedToStopSession"),k.name,k.name).finally(()=>a.value=!1)}async function b(){const k=i.session;r.value=!0,await l(o.logoutSession(k.server.id,k.name),n("sessions.loggedOut"),n("sessions.failedToLogoutSession"),k.name,k.name).finally(()=>r.value=!1)}async function $(){const k=i.session;c.value=!0,await l(o.deleteSession(k.server.id,k.name),n("sessions.deleted"),n("sessions.failedToDeleteSession"),k.name,k.name).finally(()=>c.value=!1)}return t({startSession:v,restartSession:m,stopSession:f,logoutSession:b,deleteSession:$}),(k,T)=>{const C=jn;return w(),A("div",jo,[g(C,{group:"popup",name:`'${s.session.name}' ${d(n)("sessions.session")}`,onView:T[0]||(T[0]=_=>k.$emit("view",s.session)),onApps:T[1]||(T[1]=_=>k.$emit("apps",s.session)),onStart:v,onRestart:m,onStop:f,onLogout:b,onDelete:$,"is-starting":d(h),"is-restarting":d(p),"is-stopping":d(a),"is-logging-out":d(r),"is-removing":d(c),"all-disabled":d(y),"hide-actions":[],"skip-confirmation":["start"]},null,8,["name","is-starting","is-restarting","is-stopping","is-logging-out","is-removing","all-disabled"])])}}},Ro={class:"p-dialog-title flex gap-2 align-items-center"},qo=u("i",{class:"pi pi-whatsapp"},null,-1),Ko=u("span",null,"(",-1),Fo={class:"ml-1"},Wo=u("span",null,")",-1),Ho=["disabled"],Jo=u("i",{class:"pi pi-refresh"},null,-1),Go=[Jo],It={__name:"SessionHeader",props:{session:Object,refresh:Boolean},setup(s){const{t}=X(),e=s,n=ae(),{refreshing:i}=Us(n),o=q(()=>e.session.server.id?e.session.server:n.getServer(e.session.server));async function l(){await n.refresh()}async function a(r){var c;await navigator.clipboard.writeText(((c=e.session)==null?void 0:c.name)||""),r&&r.preventDefault&&r.preventDefault()}return(r,c)=>{var f;const h=te,p=Ln,y=uo,v=Cn,m=oe("tooltip");return w(),A("div",Ro,[qo,u("span",null,S((f=s.session)==null?void 0:f.name),1),K(g(h,{text:"",tabindex:0,icon:"pi pi-copy",severity:"secondary",onClick:c[0]||(c[0]=b=>a(b))},null,512),[[m,{value:d(t)("sessions.copiedToClipboard")},void 0,{focus:!0,bottom:!0}]]),g(p,{status:s.session.status},null,8,["status"]),u("div",null,[Ko,g(y,{connected:o.value.connected},null,8,["connected"]),u("span",Fo,S(o.value.name),1),Wo]),s.refresh?K((w(),A("button",{key:0,onClick:c[1]||(c[1]=b=>l()),class:"p-link layout-topbar-button",disabled:d(i)},Go,8,Ho)),[[m,d(t)("sessions.refresh"),void 0,{top:!0}]]):D("",!0),g(v,{refreshing:d(i)},null,8,["refreshing"])])}}},Qo=u("br",null,null,-1),Yo={href:"https://waha.devlike.pro/",target:"_blank"},zo=u("br",null,null,-1),Xo={href:"https://waha.devlike.pro/docs/how-to/chats/",target:"_blank"},Zo={href:"https://waha.devlike.pro/docs/how-to/send-messages/",target:"_blank"},el={href:"https://waha.devlike.pro/docs/how-to/webhooks/#messageack",target:"_blank"},tl={href:"https://waha.devlike.pro/docs/how-to/webhooks/#websockets",target:"_blank"},sl={href:"https://github.com/devlikeapro/waha-hub/tree/main/ui/components/chat",target:"_blank"},nl={href:"https://waha.devlike.pro/pricing/#tier-pro",target:"_blank"},il={__name:"ChatPromo",emits:["close"],setup(s,{emit:t}){const e=t;return(n,i)=>{const o=fo;return w(),M(o,{onClose:i[0]||(i[0]=l=>e("close"))},{default:O(()=>[H(S(n.$t("chat.promo.exampleChatsUI")),1),Qo,H(" "+S(n.$t("chat.promo.implementFeatures"))+" ",1),u("a",Yo,[u("b",null,S(n.$t("chat.promo.wahaAPI")),1)]),H(" :"),zo,u("ul",null,[u("li",null,[u("a",Xo,[u("b",null,S(n.$t("chat.promo.chatsAPI")),1)]),H(" "+S(n.$t("chat.promo.getChatsOverview")),1)]),u("li",null,[u("a",Zo,[u("b",null,S(n.$t("chat.promo.sendAPI")),1)]),H(" "+S(n.$t("chat.promo.sendMessages")),1)]),u("li",null,[u("a",el,[u("b",null,S(n.$t("chat.promo.messageACK")),1)]),H(" "+S(n.$t("chat.promo.getMessageStatus")),1)]),u("li",null,[u("a",tl,[u("b",null,S(n.$t("chat.promo.websockets")),1)]),H(" "+S(n.$t("chat.promo.getRealTimeMessages")),1)])]),H(" 👉 "),u("a",sl,[u("b",null,S(n.$t("chat.promo.sourceCodeOnGithub")),1)]),H(" "+S(n.$t("chat.promo.availableFor"))+" ",1),u("a",nl,S(n.$t("chat.promo.wahaPro")),1),H(" "+S(n.$t("chat.promo.supporters")),1)]),_:1})}}},ol={class:"flex"},Un={__name:"MessageAck",props:{ack:Number},setup(s){const t=s,e={ERROR:-1,PENDING:0,SERVER:1,DEVICE:2,READ:3,PLAYED:4},n=q(()=>{switch(t.ack){case e.ERROR:return"pi-exclamation-circle";case e.PENDING:return"pi-clock";case e.SERVER:return"pi-check";case e.DEVICE:return"pi-check";case e.READ:return"pi-check";case e.PLAYED:return"pi-microphone"}}),i=q(()=>{switch(t.ack){case e.ERROR:return"color: red";case e.PENDING:return"color: blue";case e.SERVER:return"";case e.DEVICE:return"";case e.READ:return"color: blue";case e.PLAYED:return"color: blue"}});return(o,l)=>(w(),A("div",ol,[u("i",{class:fe(["pi",d(n)]),style:fn(d(i))},null,6),s.ack===e.READ||s.ack===e.DEVICE?(w(),A("i",{key:0,class:fe(["pi",d(n)]),style:fn([d(i),{"margin-left":"-0.7rem"}])},null,6)):D("",!0)]))}},ll={class:"p-2"},al=["innerHTML"],rl={class:"flex flex-column justify-content-end",style:{height:"100%"}},cl={__name:"ChatMessage",props:{message:Object},setup(s){return(t,e)=>{const n=Nn;return w(),M(n,null,{default:O(()=>[u("div",ll,[u("p",{innerHTML:s.message.body.replace(/\n/g,"<br>")},null,8,al)]),u("div",rl,[g(Un,{ack:s.message.ack,class:"pb-2"},null,8,["ack"])])]),_:1})}}},ul={class:"flex flex-column gap-2"},dl={__name:"ChatMessages",props:{messages:Array},setup(s){const t=s,e=I(null);async function n(){await it(10),e.value&&(e.value.scrollTop=e.value.scrollHeight)}return ce(()=>t.messages,n),(i,o)=>{const l=cl;return w(),A("div",{class:"my-2 pb-3",style:{width:"100%",height:"100%",overflow:"auto"},ref_key:"scroll",ref:e},[u("div",ul,[(w(!0),A(ee,null,St(s.messages,a=>(w(),A(ee,null,[a.body?(w(),A("div",{key:0,class:fe({"flex justify-content-end":a.fromMe})},[(w(),M(l,{key:a.key,message:a},null,8,["message"]))],2)):D("",!0)],64))),256))])],512)}}},fl={class:"flex justify-content-between gap-2 my-2"},pl={class:"flex gap-2 align-items-center"},hl={__name:"ChatHeader",props:{chat:Object,me:Object,mePicture:Object,fetching:Boolean,fetch:Function},setup(s){return(t,e)=>{var i;const n=At;return w(),A("div",fl,[u("div",pl,[g(Zt,{id:s.chat.name||s.chat.id,image:s.chat.picture},null,8,["id","image"])]),g(n,{onClick:s.fetch,refreshing:s.fetching},null,8,["onClick","refreshing"]),g(Zt,{id:(i=s.me)==null?void 0:i.pushName,image:s.mePicture},null,8,["id","image"])])}}},ml={class:"flex gap-1 mt-1"},pn=60,gl={__name:"ChatPreview",props:{id:String,name:String,picture:String,message:Object},setup(s){const t=s,e=q(()=>{var i,o,l;return((i=t.message)==null?void 0:i.body)?((l=(o=t.message)==null?void 0:o.body)==null?void 0:l.length)>pn?t.message.body.slice(0,pn)+"...":t.message.body:""});return(n,i)=>(w(),A(ee,null,[g(Zt,{id:t.name||t.id,image:t.picture},null,8,["id","image"]),u("div",ml,[d(e)?(w(),M(Un,{key:0,ack:s.message.ack,class:"pb-2"},null,8,["ack"])):D("",!0),H(" "+S(d(e)),1)])],64))}},yl={class:"flex justify-content-center align-items-center gap-1"},bl={__name:"ChatList",props:{chats:Array,pending:Boolean},emits:["clickOnChat","refreshChats"],setup(s,{emit:t}){const e=t;return(n,i)=>{const o=At,l=gl,a=as,r=rs;return w(),M(r,{value:s.chats,loading:s.pending,class:"p-datatable--clickable",onRowClick:i[1]||(i[1]=c=>e("clickOnChat",c.data)),scrollable:"",scrollHeight:"100%",rowHover:!0},{default:O(()=>[g(a,null,{header:O(()=>[u("div",yl,[u("div",null,S(n.$t("chat.last20Chats")),1),g(o,{onClick:i[0]||(i[0]=c=>e("refreshChats")),refreshing:s.pending},null,8,["refreshing"])])]),body:O(({data:c})=>[g(l,{id:c.id,name:c.name,picture:c.picture,message:c.lastMessage},null,8,["id","name","picture","message"])]),_:1})]),_:1},8,["value","loading"])}}},vl={class:"flex justify-content-end",style:{width:"100%"}},_l={style:{width:"100%"}},wl={class:"my-auto pl-2"},kl={__name:"ChatInputFooter",props:{disabled:Boolean,sendText:Function},setup(s){const t=s,e=I(!1),n=I("");function i(){e.value=!0,t.sendText(n.value).then(()=>{n.value=""}).finally(()=>{e.value=!1})}return(o,l)=>{const a=Fs,r=te;return w(),A("div",vl,[u("div",_l,[g(a,{modelValue:d(n),"onUpdate:modelValue":l[0]||(l[0]=c=>os(n)?n.value=c:null),rows:"2",cols:"50",onKeydown:Xi(Xt(i,["ctrl"]),["enter"]),style:{width:"100%"}},null,8,["modelValue","onKeydown"])]),u("div",wl,[g(r,{onClick:i,disabled:s.disabled||!d(n),loading:d(e),label:"",icon:"pi pi-send",class:"p-button-success"},null,8,["disabled","loading"])])])}}},Sl={class:"pb-3 flex"},$l={class:"flex align-items-center gap-1"},Cl={class:"m-auto pb-2"},Ol={class:"text-center"},Tl={class:"flex flex-column justify-content-between",style:{height:"100%"}},Nl=u("hr",null,null,-1),Al={__name:"SessionChatDialog",props:{visible:{},visibleModifiers:{},session:{},sessionModifiers:{}},emits:["update:visible","update:session"],setup(s){const t=ue(s,"visible"),e=ue(s,"session");ce(t,()=>{t.value||(r.value=null,c.value=[],k())}),$t();const n=ae(),{data:i,pending:o,error:l,refresh:a}=is(`session-${e.value.name}-chats`,async()=>await n.getChatsOverview(e.value.server.id,e.value.name,20)),r=I(null),c=I([]),h=I(null);ce(r,()=>{r.value&&T()});const p=I(!1),y=I(20),v=I(0);let m=null;const f=I(Qe.DISCONNECTED);function b(){const x=n.getServer(e.value.server.id),N=["message.any"];m=new zi(x,N,e.value.name),m.connect(),f.value=Qe.CONNECTING,m.on("open",()=>{f.value=Qe.CONNECTED}),m.on("close",()=>{f.value=Qe.DISCONNECTED}),m.on("error",()=>{f.value=Qe.ERROR}),m.on("event",$)}async function $(x){var W;await it(100);const N=(W=r.value)==null?void 0:W.id;N&&((x.payload.from===N||x.payload.to===N)&&T(),a())}function k(){m==null||m.stop(),m=null,f.value=Qe.DISCONNECTED}function T(){p.value=!0,n.getChatsMessages(e.value.server.id,e.value.name,r.value.id,y.value,v.value,!1).then(x=>{c.value=x.reverse()}).finally(()=>{p.value=!1})}ce(e,()=>{var x,N;(N=(x=e.value)==null?void 0:x.me)!=null&&N.id&&(k(),b(),a(),n.getProfilePicture(e.value.server.id,e.value.name,e.value.me.id).then(W=>{h.value=W.profilePictureURL}))});function C(x){r.value=x}function _(x){return n.sendText(e.value.server.id,e.value.name,r.value.id,x).then(()=>{it(100)})}const L=I(!1);return(x,N)=>{const W=It,J=Gs,Z=il,F=po,me=ho,ge=rt;return w(),M(ge,{visible:t.value,"onUpdate:visible":N[2]||(N[2]=Ae=>t.value=Ae),modal:!0,maximizable:"",style:{width:"90%",height:"90%"}},{header:O(()=>[u("div",null,[g(W,{session:e.value},null,8,["session"])])]),default:O(()=>[u("div",Sl,[u("div",$l,[e.value.me?(w(),M(J,{key:0,session:e.value,image:h.value},null,8,["session","image"])):D("",!0),g(ao,{status:f.value},null,8,["status"])]),u("div",Cl,[u("div",Ol,[u("a",{href:"#",onClick:N[0]||(N[0]=Ae=>L.value=!0)},[u("b",null,S(x.$t("chat.aboutChatUI")),1)])]),L.value?(w(),M(Z,{key:0,style:{"max-width":"50em"},onClose:N[1]||(N[1]=Ae=>L.value=!1)})):D("",!0)])]),g(me,{style:{"max-height":"90%"}},{default:O(()=>[g(F,{size:30,class:"flex items-center justify-center"},{default:O(()=>[g(bl,{chats:d(i),loading:d(o),onClickOnChat:C,onRefreshChats:d(a)},null,8,["chats","loading","onRefreshChats"])]),_:1}),g(F,{size:70,class:"flex flex-column gap-2 justify-content-between p-2"},{default:O(()=>[u("div",Tl,[r.value?(w(),A(ee,{key:0},[g(hl,{chat:r.value,me:e.value.me,mePicture:h.value,fetch:T,fetching:p.value},null,8,["chat","me","mePicture","fetching"]),Nl,g(dl,{messages:c.value},null,8,["messages"]),g(kl,{disabled:!r.value||p.value,sendText:_},null,8,["disabled"])],64)):D("",!0)])]),_:1})]),_:1})]),_:1},8,["visible"])}}},Il={class:"-mt-4 p-0 line-height-3 block",style:{"font-family":"monaco, Consolas, 'Lucida Console', monospace"}},Ll={__name:"CodeHighlight",props:["invalid"],setup(s){const t=s,e=q(()=>t.invalid?"p-invalid p-component p-inputtext":"");return(n,i)=>(w(),A("pre",{class:fe(["border-round surface-ground text-900 p-5 overflow-auto",e.value])},[H("        "),u("code",Il,[Zi(n.$slots,"default")])],2))}},El={class:"h-full flex flex-column"},Vl={class:"flex justify-content-center align-items-center"},Dl={class:"m-0"},Bl={class:"flex flex-column justify-content-between h-full"},xl={class:"flex flex-column gap-2"},Ml={class:"flex gap-2"},Pl={class:"text-center"},jl={class:"mb-2"},Ul={class:"text-center mt-2"},Rl={class:"flex flex-column h-full"},ql={class:"flex justify-content-center align-items-center"},Kl={class:"m-0"},Fl={__name:"SessionRequestResponse",props:["session"],setup(s){const{t}=X(),e=ae(),n=s,i=I(null),o=I("POST"),l=I("/api/sendText"),a=I(""),r=I(!1),c=I(!1);function h($){return JSON.stringify($,null,2)}function p($){try{return JSON.parse($)}catch{return $}}const y=q(()=>({method:o.value,uri:l.value,params:void 0,body:p(a.value)})),v=["GET","POST","PUT","DELETE","PATCH"];async function m($){await navigator.clipboard.writeText(i.value),$.preventDefault()}async function f($){await navigator.clipboard.writeText(h(y.value)),$.preventDefault()}async function b(){try{c.value=!1,r.value=!0;const $=await e.callServerAPI(n.session.server.id,y.value);i.value=h($)}catch($){c.value=!0,$.response?i.value=h($.response.data):i.value=h($)}finally{r.value=!1}}return ls(()=>{const $={chatId:"11111111111@c.us",text:"Hi there!",session:n.session.name};a.value=h($),i.value="..."}),($,k)=>{const T=te,C=Nt,_=Ne,L=Fs,x=Vn,N=Ll,W=oe("tooltip");return w(),A(ee,null,[u("div",null,[u("div",El,[u("div",Vl,[u("h5",Dl,S(d(t)("sessions.request")),1),K(g(T,{rounded:"",text:"",tabindex:0,icon:"pi pi-copy",onClick:k[0]||(k[0]=J=>f(J))},null,512),[[W,{value:d(t)("sessions.copiedToClipboard")},void 0,{focus:!0,bottom:!0}]])]),u("div",Bl,[u("div",xl,[u("div",Ml,[g(C,{modelValue:o.value,"onUpdate:modelValue":k[1]||(k[1]=J=>o.value=J),options:v},null,8,["modelValue"]),g(_,{type:"text",class:"w-full",modelValue:l.value,"onUpdate:modelValue":k[2]||(k[2]=J=>l.value=J),placeholder:d(t)("sessions.apiEndpoint")},null,8,["modelValue","placeholder"])]),u("div",Pl,[u("div",jl,S(d(t)("sessions.body")),1),g(L,{modelValue:a.value,"onUpdate:modelValue":k[3]||(k[3]=J=>a.value=J),rows:"8",class:"w-full",placeholder:d(t)("sessions.request")},null,8,["modelValue","placeholder"])])]),u("div",Ul,[g(T,{onClick:b,loading:r.value,label:d(t)("sessions.send"),icon:"pi pi-send","icon-pos":"right"},null,8,["loading","label"])])])])]),g(x),u("div",null,[u("div",Rl,[u("div",ql,[u("h5",Kl,S(d(t)("sessions.response")),1),K(g(T,{rounded:"",text:"",tabindex:0,icon:"pi pi-copy",onClick:k[4]||(k[4]=J=>m(J))},null,512),[[W,{value:d(t)("sessions.copiedToClipboard")},void 0,{focus:!0,bottom:!0}]])]),g(N,{class:"m-0 p-4 pretty",invalid:c.value},{default:O(()=>[H(S(i.value),1)]),_:1},8,["invalid"])])])],64)}}},Wl=Pe(Fl,[["__scopeId","data-v-1e461245"]]),Hl={class:"grid pt-4"},Jl={class:"col-12 sm:col-6 h-full"},Gl={class:"grid"},Ql={class:"col-12"},Yl={class:""},zl={class:"flex justify-content-center align-items-center"},Xl={class:"col-12"},Zl={class:""},ea={class:"flex justify-content-center align-items-center"},ta=u("h5",{class:"m-0"},"Screenshot",-1),sa={class:"m-auto w-full"},na={class:"col-12 sm:col-6 h-full card"},ia={__name:"SessionControl",props:["session"],setup(s){const t=I(null),e=()=>{t.value.refresh()};return(n,i)=>{const o=Gs,l=At,a=Pn,r=Wl;return w(),A("div",Hl,[u("div",Jl,[u("div",Gl,[u("div",Ql,[u("div",Yl,[u("div",zl,[s.session.me?(w(),M(o,{key:0,session:s.session},null,8,["session"])):D("",!0)])])]),u("div",Xl,[u("div",Zl,[u("div",ea,[ta,g(l,{onClick:e})]),u("div",sa,[g(a,{ref_key:"screenshot",ref:t,session:s.session},null,8,["session"])])])])])]),u("div",na,[g(r,{session:s.session},null,8,["session"])])])}}},oa={__name:"SessionControlDialog",props:{visible:{},visibleModifiers:{},session:{},sessionModifiers:{}},emits:["update:visible","update:session"],setup(s){const t=ue(s,"visible"),e=ue(s,"session");return $t(),(n,i)=>{const o=It,l=ia,a=rt;return w(),M(a,{visible:t.value,"onUpdate:visible":i[0]||(i[0]=r=>t.value=r),modal:!0,maximizable:"",style:{"max-width":"100%"}},{header:O(()=>[g(o,{session:e.value},null,8,["session"])]),default:O(()=>[g(l,{session:e.value},null,8,["session"])]),_:1},8,["visible"])}}},la={class:"card p-fluid"},aa={class:"flex flex-grow-1 justify-content-center"},ra={class:"flex flex-grow-1 justify-content-center"},Rn={__name:"KeyValueTable",props:Ct(["keyColumn","keyColumnName","prefix","entityName"],{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(s){const{t}=X(),e=ue(s,"modelValue"),n=s,i=I([]),o=c=>{let{newData:h,index:p}=c;e.value[p]=h},l=c=>{let{data:h,newValue:p,field:y}=c;h[y]=p};function a(){const c=e.value.length+1,h=`${n.prefix}${c}`;e.value.unshift({[n.keyColumn]:h,value:"123"})}function r(c){e.value.splice(c,1)}return(c,h)=>{const p=Ne,y=as,v=te,m=rs,f=oe("tooltip");return w(),A("div",la,[g(m,{editingRows:i.value,"onUpdate:editingRows":h[0]||(h[0]=b=>i.value=b),value:e.value,editMode:"cell",dataKey:n.keyColumn,onRowEditSave:o,onCellEditComplete:l,pt:{table:{style:"min-width: 50rem"},column:{bodycell:({state:b})=>({style:b.d_editing&&"padding-top: 0.6rem; padding-bottom: 0.6rem"})}},resizableColumns:""},{default:O(()=>[g(y,{field:n.keyColumn,header:n.keyColumnName,style:{width:"40%"}},{editor:O(({data:b,field:$})=>[g(p,{modelValue:b[$],"onUpdate:modelValue":k=>b[$]=k},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["field","header"]),g(y,{style:{width:"40%"},field:"value",header:d(t)("common.value")},{editor:O(({data:b,field:$})=>[g(p,{modelValue:b[$],"onUpdate:modelValue":k=>b[$]=k},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["header"]),g(y,{style:{"min-width":"1rem"}},{header:O(()=>[u("div",aa,[K(g(v,{label:s.entityName,text:"",icon:"pi pi-plus",severity:"success",onClick:a},null,8,["label"]),[[f,`${d(t)("common.add")} ${s.entityName}`,void 0,{top:!0}]])])]),body:O(({index:b})=>[u("div",ra,[K(g(v,{label:"",rounded:"",text:"",style:{height:"2rem",width:"2rem"},icon:"pi pi-trash",severity:"warning",onClick:$=>r(b)},null,8,["onClick"]),[[f,d(t)("common.delete"),void 0,{top:!0}]])])]),_:1})]),_:1},8,["editingRows","value","dataKey","pt"])])}}},ca={class:"flex justify-content-between align-items-center w-full"},ua={class:"field"},da={for:"url"},fa={class:"field mb-4"},pa={for:"events"},ha={class:"font-bold mb-2"},ma={class:"flex gap-3"},ga={class:"field",style:{width:"10em"}},ya={for:"retries-attempts"},ba=u("span",{class:"pi pi-plus"},null,-1),va=u("span",{class:"pi pi-minus"},null,-1),_a={class:"field",style:{width:"10em"}},wa={for:"retries-delay-seconds"},ka=u("span",{class:"pi pi-plus"},null,-1),Sa=u("span",{class:"pi pi-minus"},null,-1),$a={class:"field"},Ca={for:"retries-delay-policy"},Oa={class:"pi pi-info-circle"},Ta={style:{"text-transform":"capitalize"}},Na={style:{"text-transform":"capitalize"}},Aa={class:"field"},Ia={for:"hmac"},La={class:"field"},Ea={class:"field flex justify-content-between align-items-center"},Va={for:"hmac"},Da={__name:"SessionWebhook",props:Ct({disabled:Boolean,index:Number},{webhook:{},webhookModifiers:{}}),emits:["update:webhook"],setup(s){const{t}=X(),e=ue(s,"webhook"),n=s,i=["constant","linear","exponential"],o=q(()=>{var v;const r=((v=e.value.retries)==null?void 0:v.delaySeconds)??2,c=4,h=Array.from({length:c},(m,f)=>r),p=Array.from({length:c},(m,f)=>r*(f+1)),y=Array.from({length:c},(m,f)=>r*2**f);return[t("sessions.webhooks.constant",{values:h.join(", ")}),t("sessions.webhooks.linear",{values:p.join(", ")}),t("sessions.webhooks.exponential",{values:y.join(", ")})].join(`
`)}),l=ro,a=I(e.value.customHeaders&&e.value.customHeaders.length>0);return ce(a,(r,c)=>{if(c&&!r){e.value.customHeaders=null;return}!c&&r&&(e.value.customHeaders=[{name:"X-Header-1",value:"123"}])}),(r,c)=>{const h=te,p=Ne,y=Tn,v=Dn,m=Nt,f=Ot("font-awesome-icon"),b=cs,$=Rn,k=Hs,T=Js,C=oe("tooltip");return w(),M(T,{activeIndex:0},{default:O(()=>[g(k,null,{header:O(()=>[u("div",ca,[u("div",null,S(d(t)("sessions.webhooks.webhookNumber",{number:n.index+1})),1),u("div",null,[K(g(h,{label:"",text:"",rounded:"",style:{height:"2rem",width:"2rem"},icon:"pi pi-trash",severity:"warning",onClick:c[0]||(c[0]=_=>r.$emit("remove"))},null,512),[[C,d(t)("sessions.webhooks.deleteWebhook"),void 0,{top:!0}]])])])]),default:O(()=>[u("div",ua,[u("label",da,S(d(t)("sessions.webhooks.url")),1),g(p,{id:"url",modelValue:e.value.url,"onUpdate:modelValue":c[1]||(c[1]=_=>e.value.url=_),modelModifiers:{trim:!0},required:"true",disabled:s.disabled},null,8,["modelValue","disabled"])]),u("div",fa,[u("label",pa,S(d(t)("sessions.webhooks.events")),1),g(y,{id:"events",modelValue:e.value.events,"onUpdate:modelValue":c[2]||(c[2]=_=>e.value.events=_),options:d(l),placeholder:d(t)("sessions.webhooks.selectEvents"),"max-selected-labels":1,selectedItemsLabel:d(t)("sessions.webhooks.eventsSelected"),disabled:s.disabled},null,8,["modelValue","options","placeholder","selectedItemsLabel","disabled"]),u("ul",null,[(w(!0),A(ee,null,St(e.value.events,_=>(w(),A("li",{key:_},S(_),1))),128))])]),u("div",null,[u("div",ha,S(d(t)("sessions.webhooks.retries")),1),u("div",ma,[u("div",ga,[u("label",ya,S(d(t)("sessions.webhooks.attempts")),1),g(v,{modelValue:e.value.retries.attempts,"onUpdate:modelValue":c[3]||(c[3]=_=>e.value.retries.attempts=_),inputId:"retries-delay-attempts",showButtons:"",buttonLayout:"horizontal",min:1,step:1,disabled:s.disabled},{incrementbuttonicon:O(()=>[ba]),decrementbuttonicon:O(()=>[va]),_:1},8,["modelValue","disabled"])]),u("div",_a,[u("label",wa,S(d(t)("sessions.webhooks.delaySeconds")),1),g(v,{modelValue:e.value.retries.delaySeconds,"onUpdate:modelValue":c[4]||(c[4]=_=>e.value.retries.delaySeconds=_),inputId:"retries-delay-seconds",showButtons:"",buttonLayout:"horizontal",min:1,step:1,disabled:s.disabled},{incrementbuttonicon:O(()=>[ka]),decrementbuttonicon:O(()=>[Sa]),_:1},8,["modelValue","disabled"])]),u("div",$a,[u("label",Ca,[H(S(d(t)("sessions.webhooks.retryPolicy"))+"   ",1),K(u("i",Oa,null,512),[[C,d(o)]])]),g(m,{id:"retries-delay-policy",modelValue:e.value.retries.policy,"onUpdate:modelValue":c[5]||(c[5]=_=>e.value.retries.policy=_),options:i,placeholder:d(t)("sessions.webhooks.selectRetryPolicy"),"max-selected-labels":1,disabled:s.disabled},{option:O(_=>[u("span",Ta,S(_.option),1)]),value:O(_=>[u("span",Na,S(_.value),1)]),_:1},8,["modelValue","placeholder","disabled"])])])]),u("div",Aa,[u("label",Ia,S(d(t)("sessions.webhooks.hmacKey")),1),g(p,{id:"hmac",modelValue:e.value.hmac.key,"onUpdate:modelValue":c[6]||(c[6]=_=>e.value.hmac.key=_),modelModifiers:{trim:!0},disabled:s.disabled},null,8,["modelValue","disabled"])]),u("div",La,[u("div",Ea,[u("div",null,[u("label",Va,S(d(t)("sessions.webhooks.customHeaders")),1)]),g(b,{modelValue:a.value,"onUpdate:modelValue":c[7]||(c[7]=_=>a.value=_),id:"customHeaders",onLabel:d(t)("sessions.webhooks.headersOn"),offLabel:d(t)("sessions.webhooks.headersOff")},{icon:O(()=>[g(f,{icon:"fa-solid fa-fingerprint",class:"mr-2"})]),_:1},8,["modelValue","onLabel","offLabel"])]),a.value?(w(),M($,{key:0,modelValue:e.value.customHeaders,"onUpdate:modelValue":c[8]||(c[8]=_=>e.value.customHeaders=_),"entity-name":"Header","key-column":"name","key-column-name":"Header",prefix:"X-Header-"},null,8,["modelValue"])):D("",!0)])]),_:1})]),_:1})}}},Ba={class:"flex flex-column gap-2"},xa={class:"flex justify-content-between align-items-center w-full"},Ma={class:"pr-2"},Pa={key:0,class:"text-300 text-center"},ja={__name:"SessionWebhooksField",props:Ct({disabled:Boolean},{webhooks:{},webhooksModifiers:{}}),emits:["update:webhooks"],setup(s){const{t}=X(),e=ue(s,"webhooks");function n(){const o={url:"https://httpbin.org/post",events:["session.status","message"],hmac:{key:null},retries:{delaySeconds:2,attempts:15,policy:"exponential"},customHeaders:null};e.value.push(o)}function i(o){e.value.splice(o,1)}return(o,l)=>{const a=te,r=Da,c=oe("tooltip");return w(),A("div",Ba,[u("div",xa,[u("h5",null,S(d(t)("sessions.webhooks.title")),1),u("div",Ma,[K(g(a,{label:d(t)("sessions.webhooks.webhook"),text:"",icon:"pi pi-plus",severity:"success",onClick:n},null,8,["label"]),[[c,d(t)("sessions.webhooks.addWebhook"),void 0,{top:!0}]])])]),e.value.length===0?(w(),A("div",Pa,S(d(t)("sessions.webhooks.noWebhooksConfigured")),1)):(w(!0),A(ee,{key:1},St(e.value,(h,p)=>(w(),M(r,{webhook:e.value[p],"onUpdate:webhook":y=>e.value[p]=y,index:p,total:e.value.length,onRemove:y=>i(p),disabled:s.disabled},null,8,["webhook","onUpdate:webhook","index","total","onRemove","disabled"]))),256))])}}},Ua=u("i",{class:"pi pi-whatsapp"},null,-1),Ra={class:"mb-2"},qa={class:"field"},Ka={for:"server"},Fa={key:0,class:"p-invalid"},Wa={class:"field"},Ha={for:"name"},Ja={key:0,class:"mb-4"},Ga={class:"mb-3"},Qa={class:"flex flex-column gap-2"},Ya={href:"https://waha.devlike.pro/docs/engines/noweb",target:"_blank"},za={class:"flex gap-2"},Xa={key:1,class:"mb-4"},Za={class:"mb-3"},er={class:"flex flex-column gap-2"},tr={class:"pi pi-info-circle"},sr={class:"field mt-4"},nr={class:"field flex justify-content-between align-items-center"},ir={for:"chats-filter"},or={class:"pi pi-info-circle"},lr={key:0,class:"card mb-4"},ar={class:"flex gap-2"},rr={class:"field flex justify-content-between align-items-center"},cr={for:"proxy"},ur={key:0,class:"card mb-4"},dr={class:"field"},fr={for:"proxy-server"},pr={key:0,class:"p-invalid"},hr={class:"flex gap-3"},mr={class:"field w-full"},gr={for:"proxy-username"},yr={class:"field w-full"},br={for:"proxy-password"},vr={class:"field flex justify-content-between align-items-center"},_r={for:"debug"},wr={class:"w-full flex flex-column gap-2"},kr={class:"flex justify-content-end"},Sr={__name:"SessionDialog",props:Ct({mode:String},{visible:{},visibleModifiers:{},session:{},sessionModifiers:{}}),emits:["update:visible","update:session"],setup(s){var ge,Ae,Ie,Dt,Bt,xt,Mt,Pt,jt,Ut,Rt;const t=$t(),{t:e}=X(),n=ue(s,"visible"),i=ue(s,"session"),o=s,l=q(()=>o.mode==="new"),a=q(()=>o.mode==="update"),r=q(()=>a.value),c=at(),h=ae(),p=q(()=>h.getServer(i.value.server)),y=q(()=>{var j,B;return((B=(j=p.value)==null?void 0:j.version)==null?void 0:B.engine)==="NOWEB"}),v=q(()=>{var j,B;return((B=(j=p.value)==null?void 0:j.version)==null?void 0:B.engine)==="WEBJS"}),m=I([]),f=I(!!((Ae=(ge=i.value.config)==null?void 0:ge.proxy)!=null&&Ae.server)),b=I(((Ie=i.value.config)==null?void 0:Ie.ignore)!=null),$=I(!((Bt=(Dt=i.value.config)==null?void 0:Dt.ignore)!=null&&Bt.status)),k=I(!((Mt=(xt=i.value.config)==null?void 0:xt.ignore)!=null&&Mt.groups)),T=I(!((jt=(Pt=i.value.config)==null?void 0:Pt.ignore)!=null&&jt.channels)),C=I(!((Rt=(Ut=i.value.config)==null?void 0:Ut.ignore)!=null&&Rt.broadcast));ce(i,async(j,B)=>{var Le,$e,He,Ee,U,E,Ve,Ce,Je,Ge,De,we;f.value=($e=(Le=j==null?void 0:j.config)==null?void 0:Le.proxy)==null?void 0:$e.server,m.value=bo((He=j.config)==null?void 0:He.metadata),b.value=((Ee=j==null?void 0:j.config)==null?void 0:Ee.ignore)!=null,$.value=!((E=(U=j==null?void 0:j.config)==null?void 0:U.ignore)!=null&&E.status),k.value=!((Ce=(Ve=j==null?void 0:j.config)==null?void 0:Ve.ignore)!=null&&Ce.groups),T.value=!((Ge=(Je=j==null?void 0:j.config)==null?void 0:Je.ignore)!=null&&Ge.channels),C.value=!((we=(De=j==null?void 0:j.config)==null?void 0:De.ignore)!=null&&we.broadcast)});const _=I(!1),L=I(!1),x=q(()=>{const j=ve.cloneDeep(i.value.config);return f.value||(j.proxy=void 0),b.value?j.ignore={status:!$.value,groups:!k.value,channels:!T.value,broadcast:!C.value}:j.ignore=void 0,j.metadata=vo(m.value),j}),N=q(()=>{const j={...x.value};return y.value||delete j.noweb,v.value||delete j.webjs,{name:i.value.name,config:j}});async function W(){_.value=!0;try{L.value=!0;const j=ve.cloneDeep(N.value);await c(h.updateSession(i.value.server,i.value.name,j.config),void 0,e("sessions.failedToUpdateSession")),t.add({severity:"success",summary:e("sessions.updated"),detail:i.value.name,life:3e3})}finally{L.value=!1}i.value=void 0,Z()}async function J(j){_.value=!0;try{L.value=!0;const B=ve.cloneDeep(N.value);B.start=j;const Le=await c(h.createSession(i.value.server,B),void 0,e("sessions.failedToStartSession")),$e=e(j?"sessions.started":"sessions.created");t.add({severity:"success",summary:$e,detail:Le.name,life:3e3})}finally{L.value=!1}i.value=void 0,Z()}function Z(){_.value=!1,n.value=!1}const F=q(()=>i.value.status==="STOPPED");async function me(j){await navigator.clipboard.writeText(JSON.stringify(N.value,null,2)),j.preventDefault()}return(j,B)=>{const Le=It,$e=Ws,He=En,Ee=Ne,U=Ot("font-awesome-icon"),E=cs,Ve=Hs,Ce=Js,Je=Rn,Ge=ja,De=Bn,we=te,Cs=rt,ne=oe("tooltip");return w(),M(Cs,{visible:n.value,"onUpdate:visible":B[21]||(B[21]=R=>n.value=R),modal:!0,class:"p-fluid",maximizable:""},eo({footer:O(()=>[u("div",wr,[u("div",null,[a.value&&!F.value?(w(),M($e,{key:0,severity:"warn"},{default:O(()=>[H(S(d(e)("sessions.sessionRestartWarning",{status:i.value.status})),1)]),_:1})):D("",!0)]),u("div",kr,[g(we,{label:d(e)("common.cancel"),icon:"pi pi-times",text:"",onClick:Z,severity:"secondary"},null,8,["label"]),K(g(we,{label:d(e)("sessions.copy"),text:"",tabindex:0,icon:"pi pi-copy",severity:"secondary",onClick:B[18]||(B[18]=R=>me(R))},null,8,["label"]),[[ne,{value:d(e)("sessions.copiedToClipboard")},void 0,{focus:!0,bottom:!0}]]),a.value?D("",!0):(w(),M(we,{key:0,label:d(e)("sessions.create"),icon:"pi pi-plus",text:"",onClick:B[19]||(B[19]=R=>J(!1)),loading:L.value},null,8,["label","loading"])),a.value?D("",!0):(w(),M(we,{key:1,label:d(e)("sessions.createAndStart"),icon:"pi pi-play",text:"",onClick:B[20]||(B[20]=R=>J(!0)),loading:L.value},null,8,["label","loading"])),a.value?(w(),M(we,{key:2,label:d(e)("sessions.update"),icon:"pi pi-save",text:"",onClick:W,loading:L.value},null,8,["label","loading"])):D("",!0)])])]),default:O(()=>[u("div",Ra,[a.value?(w(),M($e,{key:0,severity:"info"},{default:O(()=>[H(S(d(e)("sessions.changeServerOrNameInfo")),1)]),_:1})):D("",!0)]),u("div",qa,[u("label",Ka,S(d(e)("sessions.server")),1),g(He,{placeholder:d(e)("sessions.selectServer"),modelValue:i.value.server,"onUpdate:modelValue":B[0]||(B[0]=R=>i.value.server=R),showClear:!1,required:!0,invalid:_.value&&!i.value.server,disabled:r.value},null,8,["placeholder","modelValue","invalid","disabled"]),_.value&&!i.value.server?(w(),A("small",Fa,S(d(e)("sessions.serverRequired")),1)):D("",!0)]),u("div",Wa,[u("label",Ha,S(d(e)("sessions.nameOptional")),1),g(Ee,{id:"name",modelValue:i.value.name,"onUpdate:modelValue":B[1]||(B[1]=R=>i.value.name=R),modelModifiers:{trim:!0},required:"false",autofocus:"",placeholder:d(e)("sessions.sessionIdPlaceholder"),disabled:!l.value},null,8,["modelValue","placeholder","disabled"])]),y.value?(w(),A("div",Ja,[u("div",Ga,[u("h5",null,"🏭 "+S(d(e)("sessions.engineSettings")),1)]),g(Ce,{activeIndex:0},{default:O(()=>[g(Ve,{header:"NOWEB"},{default:O(()=>[u("div",Qa,[u("div",null,[u("a",Ya,S(d(e)("sessions.readMoreAboutNOWEB")),1)]),u("div",null,[K((w(),M(E,{modelValue:i.value.config.noweb.markOnline,"onUpdate:modelValue":B[2]||(B[2]=R=>i.value.config.noweb.markOnline=R),onLabel:d(e)("sessions.presenceOnline"),offLabel:d(e)("sessions.presenceOffline")},{icon:O(()=>[g(U,{icon:"fa-solid fa-sync",class:"mr-2"})]),_:1},8,["modelValue","onLabel","offLabel"])),[[ne,d(e)("sessions.presenceTooltip")]])]),u("div",za,[u("div",null,[K((w(),M(E,{modelValue:i.value.config.noweb.store.enabled,"onUpdate:modelValue":B[3]||(B[3]=R=>i.value.config.noweb.store.enabled=R),onLabel:d(e)("sessions.storeEnabled"),offLabel:d(e)("sessions.storeDisabled")},{icon:O(()=>[g(U,{icon:"fa-solid fa-folder",class:"mr-2"})]),_:1},8,["modelValue","onLabel","offLabel"])),[[ne,d(e)("sessions.storeTooltip")]])]),u("div",null,[K((w(),M(E,{modelValue:i.value.config.noweb.store.fullSync,"onUpdate:modelValue":B[4]||(B[4]=R=>i.value.config.noweb.store.fullSync=R),onLabel:d(e)("sessions.storeFullSyncOn"),offLabel:d(e)("sessions.storeFullSyncOff")},{icon:O(()=>[g(U,{icon:"fa-solid fa-sync",class:"mr-2"})]),_:1},8,["modelValue","onLabel","offLabel"])),[[ne,d(e)("sessions.storeFullSyncTooltip")]])])])])]),_:1})]),_:1})])):D("",!0),v.value?(w(),A("div",Xa,[u("div",Za,[u("h5",null,"🏭 "+S(d(e)("sessions.engineSettings")),1)]),g(Ce,{activeIndex:0},{default:O(()=>[g(Ve,{header:"WEBJS"},{default:O(()=>[u("div",er,[u("div",null,[K((w(),M(E,{modelValue:i.value.config.webjs.tagsEventsOn,"onUpdate:modelValue":B[5]||(B[5]=R=>i.value.config.webjs.tagsEventsOn=R),onLabel:d(e)("sessions.webjs.tagsEventsOnOn"),offLabel:d(e)("sessions.webjs.tagsEventsOnOff")},{icon:O(()=>[g(U,{icon:"fa-solid fa-tag",class:"mr-2"})]),_:1},8,["modelValue","onLabel","offLabel"])),[[ne,d(e)("sessions.webjs.tagsEventsOnTooltip")]])])])]),_:1})]),_:1})])):D("",!0),u("div",null,[u("div",null,[u("h5",null,[H("📝 "+S(d(e)("sessions.metadata"))+"  ",1),K(u("i",tr,null,512),[[ne,d(e)("sessions.metadataTooltip")]])])]),g(Je,{modelValue:m.value,"onUpdate:modelValue":B[6]||(B[6]=R=>m.value=R),"entity-name":d(e)("sessions.metadata"),"key-column":"key","key-column-name":d(e)("sessions.key"),prefix:"user.id."},null,8,["modelValue","entity-name","key-column-name"])]),u("div",sr,[g(Ge,{ref:"webhooks",webhooks:i.value.config.webhooks,"onUpdate:webhooks":B[7]||(B[7]=R=>i.value.config.webhooks=R)},null,8,["webhooks"])]),u("div",null,[u("div",nr,[u("div",null,[u("h5",null,[u("label",ir,S(d(e)("sessions.config.ignore.title")),1),H("  "),K(u("i",or,null,512),[[ne,d(e)("sessions.config.ignore.tooltip")]])])]),g(E,{modelValue:b.value,"onUpdate:modelValue":B[8]||(B[8]=R=>b.value=R),id:"ignore",onLabel:d(e)("sessions.config.ignore.filterOn"),offLabel:d(e)("sessions.config.ignore.filterOff")},{icon:O(()=>[g(U,{icon:"fa-solid fa-filter",class:"mr-2"})]),_:1},8,["modelValue","onLabel","offLabel"])]),b.value?(w(),A("div",lr,[u("div",ar,[g(E,{modelValue:$.value,"onUpdate:modelValue":B[9]||(B[9]=R=>$.value=R),id:"include-status",onLabel:""+d(e)("sessions.config.ignore.status.title")+": "+d(e)("sessions.config.ignore.on"),offLabel:""+d(e)("sessions.config.ignore.status.title")+": "+d(e)("sessions.config.ignore.off")},null,8,["modelValue","onLabel","offLabel"]),g(E,{modelValue:k.value,"onUpdate:modelValue":B[10]||(B[10]=R=>k.value=R),id:"include-groups",onLabel:""+d(e)("sessions.config.ignore.groups.title")+": "+d(e)("sessions.config.ignore.on"),offLabel:""+d(e)("sessions.config.ignore.groups.title")+": "+d(e)("sessions.config.ignore.off")},null,8,["modelValue","onLabel","offLabel"]),g(E,{modelValue:T.value,"onUpdate:modelValue":B[11]||(B[11]=R=>T.value=R),id:"include-channels",onLabel:""+d(e)("sessions.config.ignore.channels.title")+": "+d(e)("sessions.config.ignore.on"),offLabel:""+d(e)("sessions.config.ignore.channels.title")+": "+d(e)("sessions.config.ignore.off")},null,8,["modelValue","onLabel","offLabel"]),g(E,{modelValue:C.value,"onUpdate:modelValue":B[12]||(B[12]=R=>C.value=R),id:"include-broadcast",onLabel:""+d(e)("sessions.config.ignore.broadcast.title")+": "+d(e)("sessions.config.ignore.on"),offLabel:""+d(e)("sessions.config.ignore.broadcast.title")+": "+d(e)("sessions.config.ignore.off")},null,8,["modelValue","onLabel","offLabel"])])])):D("",!0)]),u("div",null,[u("div",rr,[u("div",null,[u("h5",null,[u("label",cr,"🌐 "+S(d(e)("sessions.proxy")),1)])]),g(E,{modelValue:f.value,"onUpdate:modelValue":B[13]||(B[13]=R=>f.value=R),id:"proxy",onLabel:d(e)("sessions.proxyOn"),offLabel:d(e)("sessions.proxyOff")},{icon:O(()=>[g(U,{icon:"fa-solid fa-server",class:"mr-2"})]),_:1},8,["modelValue","onLabel","offLabel"])]),f.value?(w(),A("div",ur,[u("div",dr,[u("label",fr,S(d(e)("sessions.server")),1),g(Ee,{id:"proxy-server",modelValue:i.value.config.proxy.server,"onUpdate:modelValue":B[14]||(B[14]=R=>i.value.config.proxy.server=R),modelModifiers:{trim:!0},required:"true",invalid:_.value&&!i.value.config.proxy.server,placeholder:d(e)("sessions.hostPort")},null,8,["modelValue","invalid","placeholder"]),_.value&&!i.value.config.proxy.server?(w(),A("small",pr,S(d(e)("sessions.serverRequired")),1)):D("",!0)]),u("div",hr,[u("div",mr,[u("label",gr,S(d(e)("sessions.usernameOptional")),1),g(Ee,{id:"proxy-username",modelValue:i.value.config.proxy.username,"onUpdate:modelValue":B[15]||(B[15]=R=>i.value.config.proxy.username=R),modelModifiers:{trim:!0}},null,8,["modelValue"])]),u("div",yr,[u("label",br,S(d(e)("sessions.passwordOptional")),1),g(De,{id:"proxy-password",modelValue:i.value.config.proxy.password,"onUpdate:modelValue":B[16]||(B[16]=R=>i.value.config.proxy.password=R),modelModifiers:{trim:!0},feedback:!1,toggleMask:""},null,8,["modelValue"])])])])):D("",!0)]),u("div",vr,[u("div",null,[u("h5",null,[u("label",_r,"🛠️ "+S(d(e)("sessions.debug")),1)])]),g(E,{modelValue:i.value.config.debug,"onUpdate:modelValue":B[17]||(B[17]=R=>i.value.config.debug=R),onLabel:d(e)("sessions.debugEnabled"),offLabel:d(e)("sessions.debugDisabled"),onIcon:"fa fa-bug"},{icon:O(()=>[g(U,{icon:"fa-solid fa-bug",class:"mr-2"})]),_:1},8,["modelValue","onLabel","offLabel"])])]),_:2},[l.value?{name:"header",fn:O(()=>[u("div",null,[u("h5",null,[Ua,H(" "+S(d(e)("sessions.createSession")),1)])])]),key:"0"}:void 0,l.value?void 0:{name:"header",fn:O(()=>[u("div",null,[g(Le,{session:i.value},null,8,["session"])])]),key:"1"}]),1032,["visible"])}}},$r=["WORKING","FAILED","STARTING","SCAN_QR_CODE","STOPPED"];var yt=(s=>(s.OFF="OFF",s.LQ="LG",s.HQ="HG",s))(yt||{});const Cr={class:"",style:{"min-width":"20rem"}},Or={class:"flex justify-content-center align-items-center"},Tr=u("h5",{class:"m-0"},"QR",-1),Nr={class:"m-auto w-full"},Ar={class:"flex justify-content-center"},Ir={key:1,style:{"background-color":"#f8f9fa",padding:"1rem",color:"red","white-space":"pre-wrap"}},Lr={__name:"QRImage",props:{session:Object},setup(s){const t=ae(),e=s,{data:n,pending:i,error:o,refresh:l}=is(`session-qr-${e.session.server.id}-${e.session.name}`,async()=>(await it(1e3),await t.getQR(e.session.server.id,e.session.name)));return(a,r)=>{const c=At,h=An,p=In,y=Mn;return w(),A("div",Cr,[u("div",Or,[Tr,g(c,{onClick:d(l)},null,8,["onClick"])]),u("div",Nr,[d(i)?(w(),A(ee,{key:0},[g(h,{mode:"indeterminate",style:{height:"3px"}}),!d(n)&&!d(o)?(w(),M(p,{key:0,width:"100%",height:"20rem"})):D("",!0)],64)):D("",!0),u("div",Ar,[d(n)?(w(),M(y,{key:0,data:d(n).data,mimetype:d(n).mimetype},null,8,["data","mimetype"])):D("",!0),d(o)?(w(),A("pre",Ir,""+S(d(o).cause.response.data.message||d(o).cause.response.data||d(o))+`
  `,1)):D("",!0)])])])}}},Er={class:"pl-4"},Vr=u("b",null,"WhatsApp",-1),Dr=u("i",{class:"pi pi-ellipsis-v"},null,-1),Br=u("i",{class:"pi pi-cog"},null,-1),xr={__name:"EnterCodeGuide",setup(s){const{t}=X();return(e,n)=>{const i=Ot("i18n-t");return w(),A("ul",Er,[u("li",null,[g(i,{keypath:"sessions.guide.code.openWhatsApp"},{app:O(()=>[Vr]),_:1})]),u("li",null,[g(i,{keypath:"sessions.guide.code.tapMoreOptions"},{options:O(()=>[u("b",null,S(d(t)("whatsapp.MoreOptions")),1),H(),Dr]),settings:O(()=>[u("b",null,S(d(t)("whatsapp.Settings")),1),H(),Br]),_:1})]),u("li",null,[g(i,{keypath:"sessions.guide.code.tapLinkedDevices"},{linkedDevices:O(()=>[u("b",null,S(d(t)("whatsapp.LinkedDevices")),1)]),linkDevice:O(()=>[u("b",null,S(d(t)("whatsapp.LinkADevice")),1)]),_:1})]),u("li",null,[g(i,{keypath:"sessions.guide.code.linkWithPhone"},{linkWithPhone:O(()=>[u("b",null,S(d(t)("sessions.guide.code.linkWithPhoneText")),1)]),_:1})])])}}},Mr={class:"flex flex-column gap-2 mt-4"},Pr={class:"flex justify-content-between gap-2"},jr={class:"field"},Ur={class:"card flex justify-content-center align-items-center"},Rr={class:"mx-1",style:{"font-size":"2rem"}},qr={__name:"PairingCodeSteps",props:["session"],setup(s){const t=s,e=I(null),n=I(!1),i=I("XXXX-XXXX"),o=at(),l=ae(),{t:a}=X();function r(h){return h.replace(/\D/g,"")}async function c(){e.value=r(e.value),n.value=!0;try{await it(1e3);const h=await o(l.getPairingCode(t.session.server.id,t.session.name,e.value),a("sessions.guide.code.requestSent"),a("sessions.guide.code.failedToRequestCode"),t.session.name,t.session.name);i.value=h.code}finally{n.value=!1}}return ce(e,ve.debounce(h=>{e.value=r(h)},1e3)),(h,p)=>{const y=Ne,v=te,m=Vn;return w(),A(ee,null,[u("div",Mr,[u("form",{onSubmit:Xt(c,["prevent"])},[u("div",Pr,[u("div",jr,[g(y,{id:"phone","input-id":"phone",name:"phone",modelValue:d(e),"onUpdate:modelValue":p[0]||(p[0]=f=>os(e)?e.value=f:null),modelModifiers:{trim:!0},useGrouping:!1,required:"true",autofocus:"",placeholder:d(a)("sessions.guide.code.phonePlaceholder")},null,8,["modelValue","placeholder"])]),u("div",null,[g(v,{type:"submit",label:d(a)("sessions.guide.code.showCode"),icon:"pi pi-send",loading:d(n)},null,8,["label","loading"])])])],32)]),d(i)?(w(),A(ee,{key:0},[g(m),u("div",null,[g(xr)]),u("div",Ur,[u("div",null,[d(i)?(w(!0),A(ee,{key:0},St(d(i),f=>(w(),A("span",Rr,S(f),1))),256)):D("",!0)])])],64)):D("",!0)],64)}}},Kr={class:"pl-4"},Fr=u("b",null,"WhatsApp",-1),Wr=u("i",{class:"pi pi-ellipsis-v"},null,-1),Hr=u("i",{class:"pi pi-cog"},null,-1),Jr={__name:"ScanQRCodeGuide",setup(s){const{t}=X();return(e,n)=>{const i=Ot("i18n-t");return w(),A("ul",Kr,[u("li",null,[g(i,{keypath:"sessions.guide.qr.openWhatsApp"},{app:O(()=>[Fr]),_:1})]),u("li",null,[g(i,{keypath:"sessions.guide.qr.tapMoreOptions"},{options:O(()=>[u("b",null,S(d(t)("whatsapp.MoreOptions")),1),H(),Wr]),settings:O(()=>[u("b",null,S(d(t)("whatsapp.Settings")),1),H(),Hr]),_:1})]),u("li",null,[g(i,{keypath:"sessions.guide.qr.tapLinkedDevices"},{linkedDevices:O(()=>[u("b",null,S(d(t)("whatsapp.LinkedDevices")),1)]),linkDevice:O(()=>[u("b",null,S(d(t)("whatsapp.LinkADevice")),1)]),_:1})]),u("li",null,[g(i,{keypath:"sessions.guide.qr.pointPhone"},{qrCode:O(()=>[u("b",null,S(d(t)("sessions.qr")),1)]),_:1})])])}}},Gr=u("i",{class:"pi pi-qrcode mr-2"},null,-1),Qr=u("i",{class:"pi pi-send mr-2"},null,-1),Yr=["innerHTML"],zr={__name:"SessionLoginDialog",props:Ct(["session"],{visible:{},visibleModifiers:{}}),emits:["update:visible"],setup(s){const t=ue(s,"visible"),{t:e}=X();return(n,i)=>{const o=Ot("i18n-t"),l=mo,a=go,r=rt;return w(),M(r,{visible:t.value,"onUpdate:visible":i[0]||(i[0]=c=>t.value=c),modal:!0,class:"p-fluid",maximizable:""},{header:O(()=>[g(It,{session:s.session},null,8,["session"])]),default:O(()=>[g(a,null,{default:O(()=>[g(l,null,{header:O(()=>[Gr,H(" "+S(d(e)("sessions.scanQRTab")),1)]),default:O(()=>[g(o,{keypath:"sessions.scanQRCode",tag:"p"},{qr:O(()=>[u("b",null,S(d(e)("sessions.qr")),1)]),_:1}),g(Jr),u("div",null,[g(Lr,{session:s.session},null,8,["session"])])]),_:1}),g(l,null,{header:O(()=>[Qr,H(" "+S(d(e)("sessions.enterCodeTab")),1)]),default:O(()=>[u("p",{innerHTML:d(e)("sessions.enterPhoneNumber"),class:"m-0"},null,8,Yr),u("div",null,[g(qr,{session:s.session},null,8,["session"])])]),_:1})]),_:1})]),_:1},8,["visible"])}}},Xr={__name:"SessionLogin",props:["session"],setup(s){const{t}=X(),e=I(!1);return(n,i)=>{const o=te,l=oe("tooltip");return w(),A(ee,null,[K(g(o,{icon:"pi pi-sign-in",severity:"",rounded:"",outlined:"",onClick:i[0]||(i[0]=a=>e.value=!0),disabled:s.session.status!=="SCAN_QR_CODE"},null,8,["disabled"]),[[l,d(t)("sessions.login"),void 0,{top:!0}]]),g(zr,{visible:d(e),"onUpdate:visible":i[1]||(i[1]=a=>os(e)?e.value=a:null),session:s.session},null,8,["visible","session"])],64)}}},Zr={__name:"AppStatusTag",props:{enabled:{type:Boolean,required:!1,default:!0}},setup(s){const{t}=X(),e=s,n=q(()=>e.enabled?"success":"secondary"),i=q(()=>e.enabled?t("apps.enabled.on").toUpperCase():t("apps.enabled.off").toUpperCase());return(o,l)=>{const a=yo;return w(),M(a,{value:i.value,severity:n.value},null,8,["value","severity"])}}},Qs=Symbol.for("yaml.alias"),Vs=Symbol.for("yaml.document"),xe=Symbol.for("yaml.map"),qn=Symbol.for("yaml.pair"),Se=Symbol.for("yaml.scalar"),ct=Symbol.for("yaml.seq"),he=Symbol.for("yaml.node.type"),je=s=>!!s&&typeof s=="object"&&s[he]===Qs,Fe=s=>!!s&&typeof s=="object"&&s[he]===Vs,ut=s=>!!s&&typeof s=="object"&&s[he]===xe,Q=s=>!!s&&typeof s=="object"&&s[he]===qn,G=s=>!!s&&typeof s=="object"&&s[he]===Se,dt=s=>!!s&&typeof s=="object"&&s[he]===ct;function Y(s){if(s&&typeof s=="object")switch(s[he]){case xe:case ct:return!0}return!1}function z(s){if(s&&typeof s=="object")switch(s[he]){case Qs:case xe:case Se:case ct:return!0}return!1}const Kn=s=>(G(s)||Y(s))&&!!s.anchor,le=Symbol("break visit"),Fn=Symbol("skip children"),ke=Symbol("remove node");function We(s,t){const e=Wn(t);Fe(s)?Xe(null,s.contents,e,Object.freeze([s]))===ke&&(s.contents=null):Xe(null,s,e,Object.freeze([]))}We.BREAK=le;We.SKIP=Fn;We.REMOVE=ke;function Xe(s,t,e,n){const i=Hn(s,t,e,n);if(z(i)||Q(i))return Jn(s,n,i),Xe(s,i,e,n);if(typeof i!="symbol"){if(Y(t)){n=Object.freeze(n.concat(t));for(let o=0;o<t.items.length;++o){const l=Xe(o,t.items[o],e,n);if(typeof l=="number")o=l-1;else{if(l===le)return le;l===ke&&(t.items.splice(o,1),o-=1)}}}else if(Q(t)){n=Object.freeze(n.concat(t));const o=Xe("key",t.key,e,n);if(o===le)return le;o===ke&&(t.key=null);const l=Xe("value",t.value,e,n);if(l===le)return le;l===ke&&(t.value=null)}}return i}async function us(s,t){const e=Wn(t);Fe(s)?await Ze(null,s.contents,e,Object.freeze([s]))===ke&&(s.contents=null):await Ze(null,s,e,Object.freeze([]))}us.BREAK=le;us.SKIP=Fn;us.REMOVE=ke;async function Ze(s,t,e,n){const i=await Hn(s,t,e,n);if(z(i)||Q(i))return Jn(s,n,i),Ze(s,i,e,n);if(typeof i!="symbol"){if(Y(t)){n=Object.freeze(n.concat(t));for(let o=0;o<t.items.length;++o){const l=await Ze(o,t.items[o],e,n);if(typeof l=="number")o=l-1;else{if(l===le)return le;l===ke&&(t.items.splice(o,1),o-=1)}}}else if(Q(t)){n=Object.freeze(n.concat(t));const o=await Ze("key",t.key,e,n);if(o===le)return le;o===ke&&(t.key=null);const l=await Ze("value",t.value,e,n);if(l===le)return le;l===ke&&(t.value=null)}}return i}function Wn(s){return typeof s=="object"&&(s.Collection||s.Node||s.Value)?Object.assign({Alias:s.Node,Map:s.Node,Scalar:s.Node,Seq:s.Node},s.Value&&{Map:s.Value,Scalar:s.Value,Seq:s.Value},s.Collection&&{Map:s.Collection,Seq:s.Collection},s):s}function Hn(s,t,e,n){var i,o,l,a,r;if(typeof e=="function")return e(s,t,n);if(ut(t))return(i=e.Map)==null?void 0:i.call(e,s,t,n);if(dt(t))return(o=e.Seq)==null?void 0:o.call(e,s,t,n);if(Q(t))return(l=e.Pair)==null?void 0:l.call(e,s,t,n);if(G(t))return(a=e.Scalar)==null?void 0:a.call(e,s,t,n);if(je(t))return(r=e.Alias)==null?void 0:r.call(e,s,t,n)}function Jn(s,t,e){const n=t[t.length-1];if(Y(n))n.items[s]=e;else if(Q(n))s==="key"?n.key=e:n.value=e;else if(Fe(n))n.contents=e;else{const i=je(n)?"alias":"scalar";throw new Error(`Cannot replace node with ${i} parent`)}}const ec={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"},tc=s=>s.replace(/[!,[\]{}]/g,t=>ec[t]);class ie{constructor(t,e){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},ie.defaultYaml,t),this.tags=Object.assign({},ie.defaultTags,e)}clone(){const t=new ie(this.yaml,this.tags);return t.docStart=this.docStart,t}atDocument(){const t=new ie(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:ie.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},ie.defaultTags);break}return t}add(t,e){this.atNextDocument&&(this.yaml={explicit:ie.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},ie.defaultTags),this.atNextDocument=!1);const n=t.trim().split(/[ \t]+/),i=n.shift();switch(i){case"%TAG":{if(n.length!==2&&(e(0,"%TAG directive should contain exactly two parts"),n.length<2))return!1;const[o,l]=n;return this.tags[o]=l,!0}case"%YAML":{if(this.yaml.explicit=!0,n.length!==1)return e(0,"%YAML directive should contain exactly one part"),!1;const[o]=n;if(o==="1.1"||o==="1.2")return this.yaml.version=o,!0;{const l=/^\d+\.\d+$/.test(o);return e(6,`Unsupported YAML version ${o}`,l),!1}}default:return e(0,`Unknown directive ${i}`,!0),!1}}tagName(t,e){if(t==="!")return"!";if(t[0]!=="!")return e(`Not a valid tag: ${t}`),null;if(t[1]==="<"){const l=t.slice(2,-1);return l==="!"||l==="!!"?(e(`Verbatim tags aren't resolved, so ${t} is invalid.`),null):(t[t.length-1]!==">"&&e("Verbatim tags must end with a >"),l)}const[,n,i]=t.match(/^(.*!)([^!]*)$/s);i||e(`The ${t} tag has no suffix`);const o=this.tags[n];if(o)try{return o+decodeURIComponent(i)}catch(l){return e(String(l)),null}return n==="!"?t:(e(`Could not resolve tag: ${t}`),null)}tagString(t){for(const[e,n]of Object.entries(this.tags))if(t.startsWith(n))return e+tc(t.substring(n.length));return t[0]==="!"?t:`!<${t}>`}toString(t){const e=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],n=Object.entries(this.tags);let i;if(t&&n.length>0&&z(t.contents)){const o={};We(t.contents,(l,a)=>{z(a)&&a.tag&&(o[a.tag]=!0)}),i=Object.keys(o)}else i=[];for(const[o,l]of n)o==="!!"&&l==="tag:yaml.org,2002:"||(!t||i.some(a=>a.startsWith(l)))&&e.push(`%TAG ${o} ${l}`);return e.join(`
`)}}ie.defaultYaml={explicit:!1,version:"1.2"};ie.defaultTags={"!!":"tag:yaml.org,2002:"};function Gn(s){if(/[\x00-\x19\s,[\]{}]/.test(s)){const e=`Anchor must not contain whitespace or control characters: ${JSON.stringify(s)}`;throw new Error(e)}return!0}function Qn(s){const t=new Set;return We(s,{Value(e,n){n.anchor&&t.add(n.anchor)}}),t}function Yn(s,t){for(let e=1;;++e){const n=`${s}${e}`;if(!t.has(n))return n}}function sc(s,t){const e=[],n=new Map;let i=null;return{onAnchor:o=>{e.push(o),i??(i=Qn(s));const l=Yn(t,i);return i.add(l),l},setAnchors:()=>{for(const o of e){const l=n.get(o);if(typeof l=="object"&&l.anchor&&(G(l.node)||Y(l.node)))l.node.anchor=l.anchor;else{const a=new Error("Failed to resolve repeated object (this should not happen)");throw a.source=o,a}}},sourceObjects:n}}function et(s,t,e,n){if(n&&typeof n=="object")if(Array.isArray(n))for(let i=0,o=n.length;i<o;++i){const l=n[i],a=et(s,n,String(i),l);a===void 0?delete n[i]:a!==l&&(n[i]=a)}else if(n instanceof Map)for(const i of Array.from(n.keys())){const o=n.get(i),l=et(s,n,i,o);l===void 0?n.delete(i):l!==o&&n.set(i,l)}else if(n instanceof Set)for(const i of Array.from(n)){const o=et(s,n,i,i);o===void 0?n.delete(i):o!==i&&(n.delete(i),n.add(o))}else for(const[i,o]of Object.entries(n)){const l=et(s,n,i,o);l===void 0?delete n[i]:l!==o&&(n[i]=l)}return s.call(t,e,n)}function pe(s,t,e){if(Array.isArray(s))return s.map((n,i)=>pe(n,String(i),e));if(s&&typeof s.toJSON=="function"){if(!e||!Kn(s))return s.toJSON(t,e);const n={aliasCount:0,count:1,res:void 0};e.anchors.set(s,n),e.onCreate=o=>{n.res=o,delete e.onCreate};const i=s.toJSON(t,e);return e.onCreate&&e.onCreate(i),i}return typeof s=="bigint"&&!(e!=null&&e.keep)?Number(s):s}class Ys{constructor(t){Object.defineProperty(this,he,{value:t})}clone(){const t=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(t.range=this.range.slice()),t}toJS(t,{mapAsMap:e,maxAliasCount:n,onAnchor:i,reviver:o}={}){if(!Fe(t))throw new TypeError("A document argument is required");const l={anchors:new Map,doc:t,keep:!0,mapAsMap:e===!0,mapKeyWarned:!1,maxAliasCount:typeof n=="number"?n:100},a=pe(this,"",l);if(typeof i=="function")for(const{count:r,res:c}of l.anchors.values())i(c,r);return typeof o=="function"?et(o,{"":a},"",a):a}}class ds extends Ys{constructor(t){super(Qs),this.source=t,Object.defineProperty(this,"tag",{set(){throw new Error("Alias nodes cannot have tags")}})}resolve(t,e){let n;e!=null&&e.aliasResolveCache?n=e.aliasResolveCache:(n=[],We(t,{Node:(o,l)=>{(je(l)||Kn(l))&&n.push(l)}}),e&&(e.aliasResolveCache=n));let i;for(const o of n){if(o===this)break;o.anchor===this.source&&(i=o)}return i}toJSON(t,e){if(!e)return{source:this.source};const{anchors:n,doc:i,maxAliasCount:o}=e,l=this.resolve(i,e);if(!l){const r=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new ReferenceError(r)}let a=n.get(l);if(a||(pe(l,null,e),a=n.get(l)),!a||a.res===void 0){const r="This should not happen: Alias anchor was not resolved?";throw new ReferenceError(r)}if(o>=0&&(a.count+=1,a.aliasCount===0&&(a.aliasCount=Gt(i,l,n)),a.count*a.aliasCount>o)){const r="Excessive alias count indicates a resource exhaustion attack";throw new ReferenceError(r)}return a.res}toString(t,e,n){const i=`*${this.source}`;if(t){if(Gn(this.source),t.options.verifyAliasOrder&&!t.anchors.has(this.source)){const o=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new Error(o)}if(t.implicitKey)return`${i} `}return i}}function Gt(s,t,e){if(je(t)){const n=t.resolve(s),i=e&&n&&e.get(n);return i?i.count*i.aliasCount:0}else if(Y(t)){let n=0;for(const i of t.items){const o=Gt(s,i,e);o>n&&(n=o)}return n}else if(Q(t)){const n=Gt(s,t.key,e),i=Gt(s,t.value,e);return Math.max(n,i)}return 1}const zn=s=>!s||typeof s!="function"&&typeof s!="object";class P extends Ys{constructor(t){super(Se),this.value=t}toJSON(t,e){return e!=null&&e.keep?this.value:pe(this.value,t,e)}toString(){return String(this.value)}}P.BLOCK_FOLDED="BLOCK_FOLDED";P.BLOCK_LITERAL="BLOCK_LITERAL";P.PLAIN="PLAIN";P.QUOTE_DOUBLE="QUOTE_DOUBLE";P.QUOTE_SINGLE="QUOTE_SINGLE";const nc="tag:yaml.org,2002:";function ic(s,t,e){if(t){const n=e.filter(o=>o.tag===t),i=n.find(o=>!o.format)??n[0];if(!i)throw new Error(`Tag ${t} not found`);return i}return e.find(n=>{var i;return((i=n.identify)==null?void 0:i.call(n,s))&&!n.format})}function _t(s,t,e){var p,y,v;if(Fe(s)&&(s=s.contents),z(s))return s;if(Q(s)){const m=(y=(p=e.schema[xe]).createNode)==null?void 0:y.call(p,e.schema,null,e);return m.items.push(s),m}(s instanceof String||s instanceof Number||s instanceof Boolean||typeof BigInt<"u"&&s instanceof BigInt)&&(s=s.valueOf());const{aliasDuplicateObjects:n,onAnchor:i,onTagObj:o,schema:l,sourceObjects:a}=e;let r;if(n&&s&&typeof s=="object"){if(r=a.get(s),r)return r.anchor??(r.anchor=i(s)),new ds(r.anchor);r={anchor:null,node:null},a.set(s,r)}t!=null&&t.startsWith("!!")&&(t=nc+t.slice(2));let c=ic(s,t,l.tags);if(!c){if(s&&typeof s.toJSON=="function"&&(s=s.toJSON()),!s||typeof s!="object"){const m=new P(s);return r&&(r.node=m),m}c=s instanceof Map?l[xe]:Symbol.iterator in Object(s)?l[ct]:l[xe]}o&&(o(c),delete e.onTagObj);const h=c!=null&&c.createNode?c.createNode(e.schema,s,e):typeof((v=c==null?void 0:c.nodeClass)==null?void 0:v.from)=="function"?c.nodeClass.from(e.schema,s,e):new P(s);return t?h.tag=t:c.default||(h.tag=c.tag),r&&(r.node=h),h}function es(s,t,e){let n=e;for(let i=t.length-1;i>=0;--i){const o=t[i];if(typeof o=="number"&&Number.isInteger(o)&&o>=0){const l=[];l[o]=n,n=l}else n=new Map([[o,n]])}return _t(n,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw new Error("This should not happen, please report a bug.")},schema:s,sourceObjects:new Map})}const bt=s=>s==null||typeof s=="object"&&!!s[Symbol.iterator]().next().done;class Xn extends Ys{constructor(t,e){super(t),Object.defineProperty(this,"schema",{value:e,configurable:!0,enumerable:!1,writable:!0})}clone(t){const e=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return t&&(e.schema=t),e.items=e.items.map(n=>z(n)||Q(n)?n.clone(t):n),this.range&&(e.range=this.range.slice()),e}addIn(t,e){if(bt(t))this.add(e);else{const[n,...i]=t,o=this.get(n,!0);if(Y(o))o.addIn(i,e);else if(o===void 0&&this.schema)this.set(n,es(this.schema,i,e));else throw new Error(`Expected YAML collection at ${n}. Remaining path: ${i}`)}}deleteIn(t){const[e,...n]=t;if(n.length===0)return this.delete(e);const i=this.get(e,!0);if(Y(i))return i.deleteIn(n);throw new Error(`Expected YAML collection at ${e}. Remaining path: ${n}`)}getIn(t,e){const[n,...i]=t,o=this.get(n,!0);return i.length===0?!e&&G(o)?o.value:o:Y(o)?o.getIn(i,e):void 0}hasAllNullValues(t){return this.items.every(e=>{if(!Q(e))return!1;const n=e.value;return n==null||t&&G(n)&&n.value==null&&!n.commentBefore&&!n.comment&&!n.tag})}hasIn(t){const[e,...n]=t;if(n.length===0)return this.has(e);const i=this.get(e,!0);return Y(i)?i.hasIn(n):!1}setIn(t,e){const[n,...i]=t;if(i.length===0)this.set(n,e);else{const o=this.get(n,!0);if(Y(o))o.setIn(i,e);else if(o===void 0&&this.schema)this.set(n,es(this.schema,i,e));else throw new Error(`Expected YAML collection at ${n}. Remaining path: ${i}`)}}}const oc=s=>s.replace(/^(?!$)(?: $)?/gm,"#");function Oe(s,t){return/^\n+$/.test(s)?s.substring(1):t?s.replace(/^(?! *$)/gm,t):s}const Ue=(s,t,e)=>s.endsWith(`
`)?Oe(e,t):e.includes(`
`)?`
`+Oe(e,t):(s.endsWith(" ")?"":" ")+e,Zn="flow",Ds="block",Qt="quoted";function fs(s,t,e="flow",{indentAtStart:n,lineWidth:i=80,minContentWidth:o=20,onFold:l,onOverflow:a}={}){if(!i||i<0)return s;i<o&&(o=0);const r=Math.max(1+o,1+i-t.length);if(s.length<=r)return s;const c=[],h={};let p=i-t.length;typeof n=="number"&&(n>i-Math.max(2,o)?c.push(0):p=i-n);let y,v,m=!1,f=-1,b=-1,$=-1;e===Ds&&(f=hn(s,f,t.length),f!==-1&&(p=f+r));for(let T;T=s[f+=1];){if(e===Qt&&T==="\\"){switch(b=f,s[f+1]){case"x":f+=3;break;case"u":f+=5;break;case"U":f+=9;break;default:f+=1}$=f}if(T===`
`)e===Ds&&(f=hn(s,f,t.length)),p=f+t.length+r,y=void 0;else{if(T===" "&&v&&v!==" "&&v!==`
`&&v!=="	"){const C=s[f+1];C&&C!==" "&&C!==`
`&&C!=="	"&&(y=f)}if(f>=p)if(y)c.push(y),p=y+r,y=void 0;else if(e===Qt){for(;v===" "||v==="	";)v=T,T=s[f+=1],m=!0;const C=f>$+1?f-2:b-1;if(h[C])return s;c.push(C),h[C]=!0,p=C+r,y=void 0}else m=!0}v=T}if(m&&a&&a(),c.length===0)return s;l&&l();let k=s.slice(0,c[0]);for(let T=0;T<c.length;++T){const C=c[T],_=c[T+1]||s.length;C===0?k=`
${t}${s.slice(0,_)}`:(e===Qt&&h[C]&&(k+=`${s[C]}\\`),k+=`
${t}${s.slice(C+1,_)}`)}return k}function hn(s,t,e){let n=t,i=t+1,o=s[i];for(;o===" "||o==="	";)if(t<i+e)o=s[++t];else{do o=s[++t];while(o&&o!==`
`);n=t,i=t+1,o=s[i]}return n}const ps=(s,t)=>({indentAtStart:t?s.indent.length:s.indentAtStart,lineWidth:s.options.lineWidth,minContentWidth:s.options.minContentWidth}),hs=s=>/^(%|---|\.\.\.)/m.test(s);function lc(s,t,e){if(!t||t<0)return!1;const n=t-e,i=s.length;if(i<=n)return!1;for(let o=0,l=0;o<i;++o)if(s[o]===`
`){if(o-l>n)return!0;if(l=o+1,i-l<=n)return!1}return!0}function vt(s,t){const e=JSON.stringify(s);if(t.options.doubleQuotedAsJSON)return e;const{implicitKey:n}=t,i=t.options.doubleQuotedMinMultiLineLength,o=t.indent||(hs(s)?"  ":"");let l="",a=0;for(let r=0,c=e[r];c;c=e[++r])if(c===" "&&e[r+1]==="\\"&&e[r+2]==="n"&&(l+=e.slice(a,r)+"\\ ",r+=1,a=r,c="\\"),c==="\\")switch(e[r+1]){case"u":{l+=e.slice(a,r);const h=e.substr(r+2,4);switch(h){case"0000":l+="\\0";break;case"0007":l+="\\a";break;case"000b":l+="\\v";break;case"001b":l+="\\e";break;case"0085":l+="\\N";break;case"00a0":l+="\\_";break;case"2028":l+="\\L";break;case"2029":l+="\\P";break;default:h.substr(0,2)==="00"?l+="\\x"+h.substr(2):l+=e.substr(r,6)}r+=5,a=r+1}break;case"n":if(n||e[r+2]==='"'||e.length<i)r+=1;else{for(l+=e.slice(a,r)+`

`;e[r+2]==="\\"&&e[r+3]==="n"&&e[r+4]!=='"';)l+=`
`,r+=2;l+=o,e[r+2]===" "&&(l+="\\"),r+=1,a=r+1}break;default:r+=1}return l=a?l+e.slice(a):e,n?l:fs(l,o,Qt,ps(t,!1))}function Bs(s,t){if(t.options.singleQuote===!1||t.implicitKey&&s.includes(`
`)||/[ \t]\n|\n[ \t]/.test(s))return vt(s,t);const e=t.indent||(hs(s)?"  ":""),n="'"+s.replace(/'/g,"''").replace(/\n+/g,`$&
${e}`)+"'";return t.implicitKey?n:fs(n,e,Zn,ps(t,!1))}function tt(s,t){const{singleQuote:e}=t.options;let n;if(e===!1)n=vt;else{const i=s.includes('"'),o=s.includes("'");i&&!o?n=Bs:o&&!i?n=vt:n=e?Bs:vt}return n(s,t)}let xs;try{xs=new RegExp(`(^|(?<!
))
+(?!
|$)`,"g")}catch{xs=/\n+(?!\n|$)/g}function Yt({comment:s,type:t,value:e},n,i,o){const{blockQuote:l,commentString:a,lineWidth:r}=n.options;if(!l||/\n[\t ]+$/.test(e))return tt(e,n);const c=n.indent||(n.forceBlockIndent||hs(e)?"  ":""),h=l==="literal"?!0:l==="folded"||t===P.BLOCK_FOLDED?!1:t===P.BLOCK_LITERAL?!0:!lc(e,r,c.length);if(!e)return h?`|
`:`>
`;let p,y;for(y=e.length;y>0;--y){const _=e[y-1];if(_!==`
`&&_!=="	"&&_!==" ")break}let v=e.substring(y);const m=v.indexOf(`
`);m===-1?p="-":e===v||m!==v.length-1?(p="+",o&&o()):p="",v&&(e=e.slice(0,-v.length),v[v.length-1]===`
`&&(v=v.slice(0,-1)),v=v.replace(xs,`$&${c}`));let f=!1,b,$=-1;for(b=0;b<e.length;++b){const _=e[b];if(_===" ")f=!0;else if(_===`
`)$=b;else break}let k=e.substring(0,$<b?$+1:b);k&&(e=e.substring(k.length),k=k.replace(/\n+/g,`$&${c}`));let C=(f?c?"2":"1":"")+p;if(s&&(C+=" "+a(s.replace(/ ?[\r\n]+/g," ")),i&&i()),!h){const _=e.replace(/\n+/g,`
$&`).replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${c}`);let L=!1;const x=ps(n,!0);l!=="folded"&&t!==P.BLOCK_FOLDED&&(x.onOverflow=()=>{L=!0});const N=fs(`${k}${_}${v}`,c,Ds,x);if(!L)return`>${C}
${c}${N}`}return e=e.replace(/\n+/g,`$&${c}`),`|${C}
${c}${k}${e}${v}`}function ac(s,t,e,n){const{type:i,value:o}=s,{actualString:l,implicitKey:a,indent:r,indentStep:c,inFlow:h}=t;if(a&&o.includes(`
`)||h&&/[[\]{},]/.test(o))return tt(o,t);if(/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(o))return a||h||!o.includes(`
`)?tt(o,t):Yt(s,t,e,n);if(!a&&!h&&i!==P.PLAIN&&o.includes(`
`))return Yt(s,t,e,n);if(hs(o)){if(r==="")return t.forceBlockIndent=!0,Yt(s,t,e,n);if(a&&r===c)return tt(o,t)}const p=o.replace(/\n+/g,`$&
${r}`);if(l){const y=f=>{var b;return f.default&&f.tag!=="tag:yaml.org,2002:str"&&((b=f.test)==null?void 0:b.test(p))},{compat:v,tags:m}=t.doc.schema;if(m.some(y)||v!=null&&v.some(y))return tt(o,t)}return a?p:fs(p,r,Zn,ps(t,!1))}function Lt(s,t,e,n){const{implicitKey:i,inFlow:o}=t,l=typeof s.value=="string"?s:Object.assign({},s,{value:String(s.value)});let{type:a}=s;a!==P.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(l.value)&&(a=P.QUOTE_DOUBLE);const r=h=>{switch(h){case P.BLOCK_FOLDED:case P.BLOCK_LITERAL:return i||o?tt(l.value,t):Yt(l,t,e,n);case P.QUOTE_DOUBLE:return vt(l.value,t);case P.QUOTE_SINGLE:return Bs(l.value,t);case P.PLAIN:return ac(l,t,e,n);default:return null}};let c=r(a);if(c===null){const{defaultKeyType:h,defaultStringType:p}=t.options,y=i&&h||p;if(c=r(y),c===null)throw new Error(`Unsupported default string type ${y}`)}return c}function ei(s,t){const e=Object.assign({blockQuote:!0,commentString:oc,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},s.schema.toStringOptions,t);let n;switch(e.collectionStyle){case"block":n=!1;break;case"flow":n=!0;break;default:n=null}return{anchors:new Set,doc:s,flowCollectionPadding:e.flowCollectionPadding?" ":"",indent:"",indentStep:typeof e.indent=="number"?" ".repeat(e.indent):"  ",inFlow:n,options:e}}function rc(s,t){var i;if(t.tag){const o=s.filter(l=>l.tag===t.tag);if(o.length>0)return o.find(l=>l.format===t.format)??o[0]}let e,n;if(G(t)){n=t.value;let o=s.filter(l=>{var a;return(a=l.identify)==null?void 0:a.call(l,n)});if(o.length>1){const l=o.filter(a=>a.test);l.length>0&&(o=l)}e=o.find(l=>l.format===t.format)??o.find(l=>!l.format)}else n=t,e=s.find(o=>o.nodeClass&&n instanceof o.nodeClass);if(!e){const o=((i=n==null?void 0:n.constructor)==null?void 0:i.name)??(n===null?"null":typeof n);throw new Error(`Tag not resolved for ${o} value`)}return e}function cc(s,t,{anchors:e,doc:n}){if(!n.directives)return"";const i=[],o=(G(s)||Y(s))&&s.anchor;o&&Gn(o)&&(e.add(o),i.push(`&${o}`));const l=s.tag??(t.default?null:t.tag);return l&&i.push(n.directives.tagString(l)),i.join(" ")}function ot(s,t,e,n){var r;if(Q(s))return s.toString(t,e,n);if(je(s)){if(t.doc.directives)return s.toString(t);if((r=t.resolvedAliases)!=null&&r.has(s))throw new TypeError("Cannot stringify circular structure without alias nodes");t.resolvedAliases?t.resolvedAliases.add(s):t.resolvedAliases=new Set([s]),s=s.resolve(t.doc)}let i;const o=z(s)?s:t.doc.createNode(s,{onTagObj:c=>i=c});i??(i=rc(t.doc.schema.tags,o));const l=cc(o,i,t);l.length>0&&(t.indentAtStart=(t.indentAtStart??0)+l.length+1);const a=typeof i.stringify=="function"?i.stringify(o,t,e,n):G(o)?Lt(o,t,e,n):o.toString(t,e,n);return l?G(o)||a[0]==="{"||a[0]==="["?`${l} ${a}`:`${l}
${t.indent}${a}`:a}function uc({key:s,value:t},e,n,i){const{allNullValues:o,doc:l,indent:a,indentStep:r,options:{commentString:c,indentSeq:h,simpleKeys:p}}=e;let y=z(s)&&s.comment||null;if(p){if(y)throw new Error("With simple keys, key nodes cannot have comments");if(Y(s)||!z(s)&&typeof s=="object"){const x="With simple keys, collection cannot be used as a key value";throw new Error(x)}}let v=!p&&(!s||y&&t==null&&!e.inFlow||Y(s)||(G(s)?s.type===P.BLOCK_FOLDED||s.type===P.BLOCK_LITERAL:typeof s=="object"));e=Object.assign({},e,{allNullValues:!1,implicitKey:!v&&(p||!o),indent:a+r});let m=!1,f=!1,b=ot(s,e,()=>m=!0,()=>f=!0);if(!v&&!e.inFlow&&b.length>1024){if(p)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");v=!0}if(e.inFlow){if(o||t==null)return m&&n&&n(),b===""?"?":v?`? ${b}`:b}else if(o&&!p||t==null&&v)return b=`? ${b}`,y&&!m?b+=Ue(b,e.indent,c(y)):f&&i&&i(),b;m&&(y=null),v?(y&&(b+=Ue(b,e.indent,c(y))),b=`? ${b}
${a}:`):(b=`${b}:`,y&&(b+=Ue(b,e.indent,c(y))));let $,k,T;z(t)?($=!!t.spaceBefore,k=t.commentBefore,T=t.comment):($=!1,k=null,T=null,t&&typeof t=="object"&&(t=l.createNode(t))),e.implicitKey=!1,!v&&!y&&G(t)&&(e.indentAtStart=b.length+1),f=!1,!h&&r.length>=2&&!e.inFlow&&!v&&dt(t)&&!t.flow&&!t.tag&&!t.anchor&&(e.indent=e.indent.substring(2));let C=!1;const _=ot(t,e,()=>C=!0,()=>f=!0);let L=" ";if(y||$||k){if(L=$?`
`:"",k){const x=c(k);L+=`
${Oe(x,e.indent)}`}_===""&&!e.inFlow?L===`
`&&(L=`

`):L+=`
${e.indent}`}else if(!v&&Y(t)){const x=_[0],N=_.indexOf(`
`),W=N!==-1,J=e.inFlow??t.flow??t.items.length===0;if(W||!J){let Z=!1;if(W&&(x==="&"||x==="!")){let F=_.indexOf(" ");x==="&"&&F!==-1&&F<N&&_[F+1]==="!"&&(F=_.indexOf(" ",F+1)),(F===-1||N<F)&&(Z=!0)}Z||(L=`
${e.indent}`)}}else(_===""||_[0]===`
`)&&(L="");return b+=L+_,e.inFlow?C&&n&&n():T&&!C?b+=Ue(b,e.indent,c(T)):f&&i&&i(),b}function ti(s,t){(s==="debug"||s==="warn")&&console.warn(t)}const Kt="<<",Te={identify:s=>s===Kt||typeof s=="symbol"&&s.description===Kt,default:"key",tag:"tag:yaml.org,2002:merge",test:/^<<$/,resolve:()=>Object.assign(new P(Symbol(Kt)),{addToJSMap:si}),stringify:()=>Kt},dc=(s,t)=>(Te.identify(t)||G(t)&&(!t.type||t.type===P.PLAIN)&&Te.identify(t.value))&&(s==null?void 0:s.doc.schema.tags.some(e=>e.tag===Te.tag&&e.default));function si(s,t,e){if(e=s&&je(e)?e.resolve(s.doc):e,dt(e))for(const n of e.items)Os(s,t,n);else if(Array.isArray(e))for(const n of e)Os(s,t,n);else Os(s,t,e)}function Os(s,t,e){const n=s&&je(e)?e.resolve(s.doc):e;if(!ut(n))throw new Error("Merge sources must be maps or map aliases");const i=n.toJSON(null,s,Map);for(const[o,l]of i)t instanceof Map?t.has(o)||t.set(o,l):t instanceof Set?t.add(o):Object.prototype.hasOwnProperty.call(t,o)||Object.defineProperty(t,o,{value:l,writable:!0,enumerable:!0,configurable:!0});return t}function ni(s,t,{key:e,value:n}){if(z(e)&&e.addToJSMap)e.addToJSMap(s,t,n);else if(dc(s,e))si(s,t,n);else{const i=pe(e,"",s);if(t instanceof Map)t.set(i,pe(n,i,s));else if(t instanceof Set)t.add(i);else{const o=fc(e,i,s),l=pe(n,o,s);o in t?Object.defineProperty(t,o,{value:l,writable:!0,enumerable:!0,configurable:!0}):t[o]=l}}return t}function fc(s,t,e){if(t===null)return"";if(typeof t!="object")return String(t);if(z(s)&&(e!=null&&e.doc)){const n=ei(e.doc,{});n.anchors=new Set;for(const o of e.anchors.keys())n.anchors.add(o.anchor);n.inFlow=!0,n.inStringifyKey=!0;const i=s.toString(n);if(!e.mapKeyWarned){let o=JSON.stringify(i);o.length>40&&(o=o.substring(0,36)+'..."'),ti(e.doc.options.logLevel,`Keys with collection values will be stringified due to JS Object restrictions: ${o}. Set mapAsMap: true to use object keys.`),e.mapKeyWarned=!0}return i}return JSON.stringify(t)}function zs(s,t,e){const n=_t(s,void 0,e),i=_t(t,void 0,e);return new se(n,i)}class se{constructor(t,e=null){Object.defineProperty(this,he,{value:qn}),this.key=t,this.value=e}clone(t){let{key:e,value:n}=this;return z(e)&&(e=e.clone(t)),z(n)&&(n=n.clone(t)),new se(e,n)}toJSON(t,e){const n=e!=null&&e.mapAsMap?new Map:{};return ni(e,n,this)}toString(t,e,n){return t!=null&&t.doc?uc(this,t,e,n):JSON.stringify(this)}}function ii(s,t,e){return(t.inFlow??s.flow?hc:pc)(s,t,e)}function pc({comment:s,items:t},e,{blockItemPrefix:n,flowChars:i,itemIndent:o,onChompKeep:l,onComment:a}){const{indent:r,options:{commentString:c}}=e,h=Object.assign({},e,{indent:o,type:null});let p=!1;const y=[];for(let m=0;m<t.length;++m){const f=t[m];let b=null;if(z(f))!p&&f.spaceBefore&&y.push(""),ts(e,y,f.commentBefore,p),f.comment&&(b=f.comment);else if(Q(f)){const k=z(f.key)?f.key:null;k&&(!p&&k.spaceBefore&&y.push(""),ts(e,y,k.commentBefore,p))}p=!1;let $=ot(f,h,()=>b=null,()=>p=!0);b&&($+=Ue($,o,c(b))),p&&b&&(p=!1),y.push(n+$)}let v;if(y.length===0)v=i.start+i.end;else{v=y[0];for(let m=1;m<y.length;++m){const f=y[m];v+=f?`
${r}${f}`:`
`}}return s?(v+=`
`+Oe(c(s),r),a&&a()):p&&l&&l(),v}function hc({items:s},t,{flowChars:e,itemIndent:n}){const{indent:i,indentStep:o,flowCollectionPadding:l,options:{commentString:a}}=t;n+=o;const r=Object.assign({},t,{indent:n,inFlow:!0,type:null});let c=!1,h=0;const p=[];for(let m=0;m<s.length;++m){const f=s[m];let b=null;if(z(f))f.spaceBefore&&p.push(""),ts(t,p,f.commentBefore,!1),f.comment&&(b=f.comment);else if(Q(f)){const k=z(f.key)?f.key:null;k&&(k.spaceBefore&&p.push(""),ts(t,p,k.commentBefore,!1),k.comment&&(c=!0));const T=z(f.value)?f.value:null;T?(T.comment&&(b=T.comment),T.commentBefore&&(c=!0)):f.value==null&&(k!=null&&k.comment)&&(b=k.comment)}b&&(c=!0);let $=ot(f,r,()=>b=null);m<s.length-1&&($+=","),b&&($+=Ue($,n,a(b))),!c&&(p.length>h||$.includes(`
`))&&(c=!0),p.push($),h=p.length}const{start:y,end:v}=e;if(p.length===0)return y+v;if(!c){const m=p.reduce((f,b)=>f+b.length+2,2);c=t.options.lineWidth>0&&m>t.options.lineWidth}if(c){let m=y;for(const f of p)m+=f?`
${o}${i}${f}`:`
`;return`${m}
${i}${v}`}else return`${y}${l}${p.join(" ")}${l}${v}`}function ts({indent:s,options:{commentString:t}},e,n,i){if(n&&i&&(n=n.replace(/^\n+/,"")),n){const o=Oe(t(n),s);e.push(o.trimStart())}}function Re(s,t){const e=G(t)?t.value:t;for(const n of s)if(Q(n)&&(n.key===t||n.key===e||G(n.key)&&n.key.value===e))return n}class re extends Xn{static get tagName(){return"tag:yaml.org,2002:map"}constructor(t){super(xe,t),this.items=[]}static from(t,e,n){const{keepUndefined:i,replacer:o}=n,l=new this(t),a=(r,c)=>{if(typeof o=="function")c=o.call(e,r,c);else if(Array.isArray(o)&&!o.includes(r))return;(c!==void 0||i)&&l.items.push(zs(r,c,n))};if(e instanceof Map)for(const[r,c]of e)a(r,c);else if(e&&typeof e=="object")for(const r of Object.keys(e))a(r,e[r]);return typeof t.sortMapEntries=="function"&&l.items.sort(t.sortMapEntries),l}add(t,e){var l;let n;Q(t)?n=t:!t||typeof t!="object"||!("key"in t)?n=new se(t,t==null?void 0:t.value):n=new se(t.key,t.value);const i=Re(this.items,n.key),o=(l=this.schema)==null?void 0:l.sortMapEntries;if(i){if(!e)throw new Error(`Key ${n.key} already set`);G(i.value)&&zn(n.value)?i.value.value=n.value:i.value=n.value}else if(o){const a=this.items.findIndex(r=>o(n,r)<0);a===-1?this.items.push(n):this.items.splice(a,0,n)}else this.items.push(n)}delete(t){const e=Re(this.items,t);return e?this.items.splice(this.items.indexOf(e),1).length>0:!1}get(t,e){const n=Re(this.items,t),i=n==null?void 0:n.value;return(!e&&G(i)?i.value:i)??void 0}has(t){return!!Re(this.items,t)}set(t,e){this.add(new se(t,e),!0)}toJSON(t,e,n){const i=n?new n:e!=null&&e.mapAsMap?new Map:{};e!=null&&e.onCreate&&e.onCreate(i);for(const o of this.items)ni(e,i,o);return i}toString(t,e,n){if(!t)return JSON.stringify(this);for(const i of this.items)if(!Q(i))throw new Error(`Map items must all be pairs; found ${JSON.stringify(i)} instead`);return!t.allNullValues&&this.hasAllNullValues(!1)&&(t=Object.assign({},t,{allNullValues:!0})),ii(this,t,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:t.indent||"",onChompKeep:n,onComment:e})}}const ft={collection:"map",default:!0,nodeClass:re,tag:"tag:yaml.org,2002:map",resolve(s,t){return ut(s)||t("Expected a mapping for this tag"),s},createNode:(s,t,e)=>re.from(s,t,e)};class Me extends Xn{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(t){super(ct,t),this.items=[]}add(t){this.items.push(t)}delete(t){const e=Ft(t);return typeof e!="number"?!1:this.items.splice(e,1).length>0}get(t,e){const n=Ft(t);if(typeof n!="number")return;const i=this.items[n];return!e&&G(i)?i.value:i}has(t){const e=Ft(t);return typeof e=="number"&&e<this.items.length}set(t,e){const n=Ft(t);if(typeof n!="number")throw new Error(`Expected a valid index, not ${t}.`);const i=this.items[n];G(i)&&zn(e)?i.value=e:this.items[n]=e}toJSON(t,e){const n=[];e!=null&&e.onCreate&&e.onCreate(n);let i=0;for(const o of this.items)n.push(pe(o,String(i++),e));return n}toString(t,e,n){return t?ii(this,t,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(t.indent||"")+"  ",onChompKeep:n,onComment:e}):JSON.stringify(this)}static from(t,e,n){const{replacer:i}=n,o=new this(t);if(e&&Symbol.iterator in Object(e)){let l=0;for(let a of e){if(typeof i=="function"){const r=e instanceof Set?a:String(l++);a=i.call(e,r,a)}o.items.push(_t(a,void 0,n))}}return o}}function Ft(s){let t=G(s)?s.value:s;return t&&typeof t=="string"&&(t=Number(t)),typeof t=="number"&&Number.isInteger(t)&&t>=0?t:null}const pt={collection:"seq",default:!0,nodeClass:Me,tag:"tag:yaml.org,2002:seq",resolve(s,t){return dt(s)||t("Expected a sequence for this tag"),s},createNode:(s,t,e)=>Me.from(s,t,e)},ms={identify:s=>typeof s=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:s=>s,stringify(s,t,e,n){return t=Object.assign({actualString:!0},t),Lt(s,t,e,n)}},gs={identify:s=>s==null,createNode:()=>new P(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new P(null),stringify:({source:s},t)=>typeof s=="string"&&gs.test.test(s)?s:t.options.nullStr},Xs={identify:s=>typeof s=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:s=>new P(s[0]==="t"||s[0]==="T"),stringify({source:s,value:t},e){if(s&&Xs.test.test(s)){const n=s[0]==="t"||s[0]==="T";if(t===n)return s}return t?e.options.trueStr:e.options.falseStr}};function _e({format:s,minFractionDigits:t,tag:e,value:n}){if(typeof n=="bigint")return String(n);const i=typeof n=="number"?n:Number(n);if(!isFinite(i))return isNaN(i)?".nan":i<0?"-.inf":".inf";let o=JSON.stringify(n);if(!s&&t&&(!e||e==="tag:yaml.org,2002:float")&&/^\d/.test(o)){let l=o.indexOf(".");l<0&&(l=o.length,o+=".");let a=t-(o.length-l-1);for(;a-- >0;)o+="0"}return o}const oi={identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:s=>s.slice(-3).toLowerCase()==="nan"?NaN:s[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:_e},li={identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:s=>parseFloat(s),stringify(s){const t=Number(s.value);return isFinite(t)?t.toExponential():_e(s)}},ai={identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(s){const t=new P(parseFloat(s)),e=s.indexOf(".");return e!==-1&&s[s.length-1]==="0"&&(t.minFractionDigits=s.length-e-1),t},stringify:_e},ys=s=>typeof s=="bigint"||Number.isInteger(s),Zs=(s,t,e,{intAsBigInt:n})=>n?BigInt(s):parseInt(s.substring(t),e);function ri(s,t,e){const{value:n}=s;return ys(n)&&n>=0?e+n.toString(t):_e(s)}const ci={identify:s=>ys(s)&&s>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(s,t,e)=>Zs(s,2,8,e),stringify:s=>ri(s,8,"0o")},ui={identify:ys,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(s,t,e)=>Zs(s,0,10,e),stringify:_e},di={identify:s=>ys(s)&&s>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(s,t,e)=>Zs(s,2,16,e),stringify:s=>ri(s,16,"0x")},mc=[ft,pt,ms,gs,Xs,ci,ui,di,oi,li,ai];function mn(s){return typeof s=="bigint"||Number.isInteger(s)}const Wt=({value:s})=>JSON.stringify(s),gc=[{identify:s=>typeof s=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:s=>s,stringify:Wt},{identify:s=>s==null,createNode:()=>new P(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:Wt},{identify:s=>typeof s=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^true$|^false$/,resolve:s=>s==="true",stringify:Wt},{identify:mn,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(s,t,{intAsBigInt:e})=>e?BigInt(s):parseInt(s,10),stringify:({value:s})=>mn(s)?s.toString():JSON.stringify(s)},{identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:s=>parseFloat(s),stringify:Wt}],yc={default:!0,tag:"",test:/^/,resolve(s,t){return t(`Unresolved plain scalar ${JSON.stringify(s)}`),s}},bc=[ft,pt].concat(gc,yc),en={identify:s=>s instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(s,t){if(typeof atob=="function"){const e=atob(s.replace(/[\n\r]/g,"")),n=new Uint8Array(e.length);for(let i=0;i<e.length;++i)n[i]=e.charCodeAt(i);return n}else return t("This environment does not support reading binary tags; either Buffer or atob is required"),s},stringify({comment:s,type:t,value:e},n,i,o){if(!e)return"";const l=e;let a;if(typeof btoa=="function"){let r="";for(let c=0;c<l.length;++c)r+=String.fromCharCode(l[c]);a=btoa(r)}else throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");if(t??(t=P.BLOCK_LITERAL),t!==P.QUOTE_DOUBLE){const r=Math.max(n.options.lineWidth-n.indent.length,n.options.minContentWidth),c=Math.ceil(a.length/r),h=new Array(c);for(let p=0,y=0;p<c;++p,y+=r)h[p]=a.substr(y,r);a=h.join(t===P.BLOCK_LITERAL?`
`:" ")}return Lt({comment:s,type:t,value:a},n,i,o)}};function fi(s,t){if(dt(s))for(let e=0;e<s.items.length;++e){let n=s.items[e];if(!Q(n)){if(ut(n)){n.items.length>1&&t("Each pair must have its own sequence indicator");const i=n.items[0]||new se(new P(null));if(n.commentBefore&&(i.key.commentBefore=i.key.commentBefore?`${n.commentBefore}
${i.key.commentBefore}`:n.commentBefore),n.comment){const o=i.value??i.key;o.comment=o.comment?`${n.comment}
${o.comment}`:n.comment}n=i}s.items[e]=Q(n)?n:new se(n)}}else t("Expected a sequence for this tag");return s}function pi(s,t,e){const{replacer:n}=e,i=new Me(s);i.tag="tag:yaml.org,2002:pairs";let o=0;if(t&&Symbol.iterator in Object(t))for(let l of t){typeof n=="function"&&(l=n.call(t,String(o++),l));let a,r;if(Array.isArray(l))if(l.length===2)a=l[0],r=l[1];else throw new TypeError(`Expected [key, value] tuple: ${l}`);else if(l&&l instanceof Object){const c=Object.keys(l);if(c.length===1)a=c[0],r=l[a];else throw new TypeError(`Expected tuple with one key, not ${c.length} keys`)}else a=l;i.items.push(zs(a,r,e))}return i}const tn={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:fi,createNode:pi};class st extends Me{constructor(){super(),this.add=re.prototype.add.bind(this),this.delete=re.prototype.delete.bind(this),this.get=re.prototype.get.bind(this),this.has=re.prototype.has.bind(this),this.set=re.prototype.set.bind(this),this.tag=st.tag}toJSON(t,e){if(!e)return super.toJSON(t);const n=new Map;e!=null&&e.onCreate&&e.onCreate(n);for(const i of this.items){let o,l;if(Q(i)?(o=pe(i.key,"",e),l=pe(i.value,o,e)):o=pe(i,"",e),n.has(o))throw new Error("Ordered maps must not include duplicate keys");n.set(o,l)}return n}static from(t,e,n){const i=pi(t,e,n),o=new this;return o.items=i.items,o}}st.tag="tag:yaml.org,2002:omap";const sn={collection:"seq",identify:s=>s instanceof Map,nodeClass:st,default:!1,tag:"tag:yaml.org,2002:omap",resolve(s,t){const e=fi(s,t),n=[];for(const{key:i}of e.items)G(i)&&(n.includes(i.value)?t(`Ordered maps must not include duplicate keys: ${i.value}`):n.push(i.value));return Object.assign(new st,e)},createNode:(s,t,e)=>st.from(s,t,e)};function hi({value:s,source:t},e){return t&&(s?mi:gi).test.test(t)?t:s?e.options.trueStr:e.options.falseStr}const mi={identify:s=>s===!0,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new P(!0),stringify:hi},gi={identify:s=>s===!1,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/,resolve:()=>new P(!1),stringify:hi},vc={identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:s=>s.slice(-3).toLowerCase()==="nan"?NaN:s[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:_e},_c={identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:s=>parseFloat(s.replace(/_/g,"")),stringify(s){const t=Number(s.value);return isFinite(t)?t.toExponential():_e(s)}},wc={identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(s){const t=new P(parseFloat(s.replace(/_/g,""))),e=s.indexOf(".");if(e!==-1){const n=s.substring(e+1).replace(/_/g,"");n[n.length-1]==="0"&&(t.minFractionDigits=n.length)}return t},stringify:_e},Et=s=>typeof s=="bigint"||Number.isInteger(s);function bs(s,t,e,{intAsBigInt:n}){const i=s[0];if((i==="-"||i==="+")&&(t+=1),s=s.substring(t).replace(/_/g,""),n){switch(e){case 2:s=`0b${s}`;break;case 8:s=`0o${s}`;break;case 16:s=`0x${s}`;break}const l=BigInt(s);return i==="-"?BigInt(-1)*l:l}const o=parseInt(s,e);return i==="-"?-1*o:o}function nn(s,t,e){const{value:n}=s;if(Et(n)){const i=n.toString(t);return n<0?"-"+e+i.substr(1):e+i}return _e(s)}const kc={identify:Et,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(s,t,e)=>bs(s,2,2,e),stringify:s=>nn(s,2,"0b")},Sc={identify:Et,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(s,t,e)=>bs(s,1,8,e),stringify:s=>nn(s,8,"0")},$c={identify:Et,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(s,t,e)=>bs(s,0,10,e),stringify:_e},Cc={identify:Et,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(s,t,e)=>bs(s,2,16,e),stringify:s=>nn(s,16,"0x")};class nt extends re{constructor(t){super(t),this.tag=nt.tag}add(t){let e;Q(t)?e=t:t&&typeof t=="object"&&"key"in t&&"value"in t&&t.value===null?e=new se(t.key,null):e=new se(t,null),Re(this.items,e.key)||this.items.push(e)}get(t,e){const n=Re(this.items,t);return!e&&Q(n)?G(n.key)?n.key.value:n.key:n}set(t,e){if(typeof e!="boolean")throw new Error(`Expected boolean value for set(key, value) in a YAML set, not ${typeof e}`);const n=Re(this.items,t);n&&!e?this.items.splice(this.items.indexOf(n),1):!n&&e&&this.items.push(new se(t))}toJSON(t,e){return super.toJSON(t,e,Set)}toString(t,e,n){if(!t)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},t,{allNullValues:!0}),e,n);throw new Error("Set items must all have null values")}static from(t,e,n){const{replacer:i}=n,o=new this(t);if(e&&Symbol.iterator in Object(e))for(let l of e)typeof i=="function"&&(l=i.call(e,l,l)),o.items.push(zs(l,null,n));return o}}nt.tag="tag:yaml.org,2002:set";const on={collection:"map",identify:s=>s instanceof Set,nodeClass:nt,default:!1,tag:"tag:yaml.org,2002:set",createNode:(s,t,e)=>nt.from(s,t,e),resolve(s,t){if(ut(s)){if(s.hasAllNullValues(!0))return Object.assign(new nt,s);t("Set items must all have null values")}else t("Expected a mapping for this tag");return s}};function ln(s,t){const e=s[0],n=e==="-"||e==="+"?s.substring(1):s,i=l=>t?BigInt(l):Number(l),o=n.replace(/_/g,"").split(":").reduce((l,a)=>l*i(60)+i(a),i(0));return e==="-"?i(-1)*o:o}function yi(s){let{value:t}=s,e=l=>l;if(typeof t=="bigint")e=l=>BigInt(l);else if(isNaN(t)||!isFinite(t))return _e(s);let n="";t<0&&(n="-",t*=e(-1));const i=e(60),o=[t%i];return t<60?o.unshift(0):(t=(t-o[0])/i,o.unshift(t%i),t>=60&&(t=(t-o[0])/i,o.unshift(t))),n+o.map(l=>String(l).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}const bi={identify:s=>typeof s=="bigint"||Number.isInteger(s),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(s,t,{intAsBigInt:e})=>ln(s,e),stringify:yi},vi={identify:s=>typeof s=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:s=>ln(s,!1),stringify:yi},vs={identify:s=>s instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(s){const t=s.match(vs.test);if(!t)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");const[,e,n,i,o,l,a]=t.map(Number),r=t[7]?Number((t[7]+"00").substr(1,3)):0;let c=Date.UTC(e,n-1,i,o||0,l||0,a||0,r);const h=t[8];if(h&&h!=="Z"){let p=ln(h,!1);Math.abs(p)<30&&(p*=60),c-=6e4*p}return new Date(c)},stringify:({value:s})=>(s==null?void 0:s.toISOString().replace(/(T00:00:00)?\.000Z$/,""))??""},gn=[ft,pt,ms,gs,mi,gi,kc,Sc,$c,Cc,vc,_c,wc,en,Te,sn,tn,on,bi,vi,vs],yn=new Map([["core",mc],["failsafe",[ft,pt,ms]],["json",bc],["yaml11",gn],["yaml-1.1",gn]]),bn={binary:en,bool:Xs,float:ai,floatExp:li,floatNaN:oi,floatTime:vi,int:ui,intHex:di,intOct:ci,intTime:bi,map:ft,merge:Te,null:gs,omap:sn,pairs:tn,seq:pt,set:on,timestamp:vs},Oc={"tag:yaml.org,2002:binary":en,"tag:yaml.org,2002:merge":Te,"tag:yaml.org,2002:omap":sn,"tag:yaml.org,2002:pairs":tn,"tag:yaml.org,2002:set":on,"tag:yaml.org,2002:timestamp":vs};function Ts(s,t,e){const n=yn.get(t);if(n&&!s)return e&&!n.includes(Te)?n.concat(Te):n.slice();let i=n;if(!i)if(Array.isArray(s))i=[];else{const o=Array.from(yn.keys()).filter(l=>l!=="yaml11").map(l=>JSON.stringify(l)).join(", ");throw new Error(`Unknown schema "${t}"; use one of ${o} or define customTags array`)}if(Array.isArray(s))for(const o of s)i=i.concat(o);else typeof s=="function"&&(i=s(i.slice()));return e&&(i=i.concat(Te)),i.reduce((o,l)=>{const a=typeof l=="string"?bn[l]:l;if(!a){const r=JSON.stringify(l),c=Object.keys(bn).map(h=>JSON.stringify(h)).join(", ");throw new Error(`Unknown custom tag ${r}; use one of ${c}`)}return o.includes(a)||o.push(a),o},[])}const Tc=(s,t)=>s.key<t.key?-1:s.key>t.key?1:0;class _s{constructor({compat:t,customTags:e,merge:n,resolveKnownTags:i,schema:o,sortMapEntries:l,toStringDefaults:a}){this.compat=Array.isArray(t)?Ts(t,"compat"):t?Ts(null,t):null,this.name=typeof o=="string"&&o||"core",this.knownTags=i?Oc:{},this.tags=Ts(e,this.name,n),this.toStringOptions=a??null,Object.defineProperty(this,xe,{value:ft}),Object.defineProperty(this,Se,{value:ms}),Object.defineProperty(this,ct,{value:pt}),this.sortMapEntries=typeof l=="function"?l:l===!0?Tc:null}clone(){const t=Object.create(_s.prototype,Object.getOwnPropertyDescriptors(this));return t.tags=this.tags.slice(),t}}function Nc(s,t){var r;const e=[];let n=t.directives===!0;if(t.directives!==!1&&s.directives){const c=s.directives.toString(s);c?(e.push(c),n=!0):s.directives.docStart&&(n=!0)}n&&e.push("---");const i=ei(s,t),{commentString:o}=i.options;if(s.commentBefore){e.length!==1&&e.unshift("");const c=o(s.commentBefore);e.unshift(Oe(c,""))}let l=!1,a=null;if(s.contents){if(z(s.contents)){if(s.contents.spaceBefore&&n&&e.push(""),s.contents.commentBefore){const p=o(s.contents.commentBefore);e.push(Oe(p,""))}i.forceBlockIndent=!!s.comment,a=s.contents.comment}const c=a?void 0:()=>l=!0;let h=ot(s.contents,i,()=>a=null,c);a&&(h+=Ue(h,"",o(a))),(h[0]==="|"||h[0]===">")&&e[e.length-1]==="---"?e[e.length-1]=`--- ${h}`:e.push(h)}else e.push(ot(s.contents,i));if((r=s.directives)!=null&&r.docEnd)if(s.comment){const c=o(s.comment);c.includes(`
`)?(e.push("..."),e.push(Oe(c,""))):e.push(`... ${c}`)}else e.push("...");else{let c=s.comment;c&&l&&(c=c.replace(/^\n+/,"")),c&&((!l||a)&&e[e.length-1]!==""&&e.push(""),e.push(Oe(o(c),"")))}return e.join(`
`)+`
`}class ht{constructor(t,e,n){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,he,{value:Vs});let i=null;typeof e=="function"||Array.isArray(e)?i=e:n===void 0&&e&&(n=e,e=void 0);const o=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,stringKeys:!1,uniqueKeys:!0,version:"1.2"},n);this.options=o;let{version:l}=o;n!=null&&n._directives?(this.directives=n._directives.atDocument(),this.directives.yaml.explicit&&(l=this.directives.yaml.version)):this.directives=new ie({version:l}),this.setSchema(l,n),this.contents=t===void 0?null:this.createNode(t,i,n)}clone(){const t=Object.create(ht.prototype,{[he]:{value:Vs}});return t.commentBefore=this.commentBefore,t.comment=this.comment,t.errors=this.errors.slice(),t.warnings=this.warnings.slice(),t.options=Object.assign({},this.options),this.directives&&(t.directives=this.directives.clone()),t.schema=this.schema.clone(),t.contents=z(this.contents)?this.contents.clone(t.schema):this.contents,this.range&&(t.range=this.range.slice()),t}add(t){Ye(this.contents)&&this.contents.add(t)}addIn(t,e){Ye(this.contents)&&this.contents.addIn(t,e)}createAlias(t,e){if(!t.anchor){const n=Qn(this);t.anchor=!e||n.has(e)?Yn(e||"a",n):e}return new ds(t.anchor)}createNode(t,e,n){let i;if(typeof e=="function")t=e.call({"":t},"",t),i=e;else if(Array.isArray(e)){const b=k=>typeof k=="number"||k instanceof String||k instanceof Number,$=e.filter(b).map(String);$.length>0&&(e=e.concat($)),i=e}else n===void 0&&e&&(n=e,e=void 0);const{aliasDuplicateObjects:o,anchorPrefix:l,flow:a,keepUndefined:r,onTagObj:c,tag:h}=n??{},{onAnchor:p,setAnchors:y,sourceObjects:v}=sc(this,l||"a"),m={aliasDuplicateObjects:o??!0,keepUndefined:r??!1,onAnchor:p,onTagObj:c,replacer:i,schema:this.schema,sourceObjects:v},f=_t(t,h,m);return a&&Y(f)&&(f.flow=!0),y(),f}createPair(t,e,n={}){const i=this.createNode(t,null,n),o=this.createNode(e,null,n);return new se(i,o)}delete(t){return Ye(this.contents)?this.contents.delete(t):!1}deleteIn(t){return bt(t)?this.contents==null?!1:(this.contents=null,!0):Ye(this.contents)?this.contents.deleteIn(t):!1}get(t,e){return Y(this.contents)?this.contents.get(t,e):void 0}getIn(t,e){return bt(t)?!e&&G(this.contents)?this.contents.value:this.contents:Y(this.contents)?this.contents.getIn(t,e):void 0}has(t){return Y(this.contents)?this.contents.has(t):!1}hasIn(t){return bt(t)?this.contents!==void 0:Y(this.contents)?this.contents.hasIn(t):!1}set(t,e){this.contents==null?this.contents=es(this.schema,[t],e):Ye(this.contents)&&this.contents.set(t,e)}setIn(t,e){bt(t)?this.contents=e:this.contents==null?this.contents=es(this.schema,Array.from(t),e):Ye(this.contents)&&this.contents.setIn(t,e)}setSchema(t,e={}){typeof t=="number"&&(t=String(t));let n;switch(t){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new ie({version:"1.1"}),n={resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=t:this.directives=new ie({version:t}),n={resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,n=null;break;default:{const i=JSON.stringify(t);throw new Error(`Expected '1.1', '1.2' or null as first argument, but found: ${i}`)}}if(e.schema instanceof Object)this.schema=e.schema;else if(n)this.schema=new _s(Object.assign(n,e));else throw new Error("With a null YAML version, the { schema: Schema } option is required")}toJS({json:t,jsonArg:e,mapAsMap:n,maxAliasCount:i,onAnchor:o,reviver:l}={}){const a={anchors:new Map,doc:this,keep:!t,mapAsMap:n===!0,mapKeyWarned:!1,maxAliasCount:typeof i=="number"?i:100},r=pe(this.contents,e??"",a);if(typeof o=="function")for(const{count:c,res:h}of a.anchors.values())o(h,c);return typeof l=="function"?et(l,{"":r},"",r):r}toJSON(t,e){return this.toJS({json:!0,jsonArg:t,mapAsMap:!1,onAnchor:e})}toString(t={}){if(this.errors.length>0)throw new Error("Document with errors cannot be stringified");if("indent"in t&&(!Number.isInteger(t.indent)||Number(t.indent)<=0)){const e=JSON.stringify(t.indent);throw new Error(`"indent" option must be a positive integer, not ${e}`)}return Nc(this,t)}}function Ye(s){if(Y(s))return!0;throw new Error("Expected a YAML collection as document contents")}class an extends Error{constructor(t,e,n,i){super(),this.name=t,this.code=n,this.message=i,this.pos=e}}class qe extends an{constructor(t,e,n){super("YAMLParseError",t,e,n)}}class _i extends an{constructor(t,e,n){super("YAMLWarning",t,e,n)}}const ss=(s,t)=>e=>{if(e.pos[0]===-1)return;e.linePos=e.pos.map(a=>t.linePos(a));const{line:n,col:i}=e.linePos[0];e.message+=` at line ${n}, column ${i}`;let o=i-1,l=s.substring(t.lineStarts[n-1],t.lineStarts[n]).replace(/[\n\r]+$/,"");if(o>=60&&l.length>80){const a=Math.min(o-39,l.length-79);l="…"+l.substring(a),o-=a-1}if(l.length>80&&(l=l.substring(0,79)+"…"),n>1&&/^ *$/.test(l.substring(0,o))){let a=s.substring(t.lineStarts[n-2],t.lineStarts[n-1]);a.length>80&&(a=a.substring(0,79)+`…
`),l=a+l}if(/[^ ]/.test(l)){let a=1;const r=e.linePos[1];r&&r.line===n&&r.col>i&&(a=Math.max(1,Math.min(r.col-i,80-o)));const c=" ".repeat(o)+"^".repeat(a);e.message+=`:

${l}
${c}
`}};function lt(s,{flow:t,indicator:e,next:n,offset:i,onError:o,parentIndent:l,startOnNewline:a}){let r=!1,c=a,h=a,p="",y="",v=!1,m=!1,f=null,b=null,$=null,k=null,T=null,C=null,_=null;for(const N of s)switch(m&&(N.type!=="space"&&N.type!=="newline"&&N.type!=="comma"&&o(N.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),m=!1),f&&(c&&N.type!=="comment"&&N.type!=="newline"&&o(f,"TAB_AS_INDENT","Tabs are not allowed as indentation"),f=null),N.type){case"space":!t&&(e!=="doc-start"||(n==null?void 0:n.type)!=="flow-collection")&&N.source.includes("	")&&(f=N),h=!0;break;case"comment":{h||o(N,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const W=N.source.substring(1)||" ";p?p+=y+W:p=W,y="",c=!1;break}case"newline":c?p?p+=N.source:(!C||e!=="seq-item-ind")&&(r=!0):y+=N.source,c=!0,v=!0,(b||$)&&(k=N),h=!0;break;case"anchor":b&&o(N,"MULTIPLE_ANCHORS","A node can have at most one anchor"),N.source.endsWith(":")&&o(N.offset+N.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),b=N,_??(_=N.offset),c=!1,h=!1,m=!0;break;case"tag":{$&&o(N,"MULTIPLE_TAGS","A node can have at most one tag"),$=N,_??(_=N.offset),c=!1,h=!1,m=!0;break}case e:(b||$)&&o(N,"BAD_PROP_ORDER",`Anchors and tags must be after the ${N.source} indicator`),C&&o(N,"UNEXPECTED_TOKEN",`Unexpected ${N.source} in ${t??"collection"}`),C=N,c=e==="seq-item-ind"||e==="explicit-key-ind",h=!1;break;case"comma":if(t){T&&o(N,"UNEXPECTED_TOKEN",`Unexpected , in ${t}`),T=N,c=!1,h=!1;break}default:o(N,"UNEXPECTED_TOKEN",`Unexpected ${N.type} token`),c=!1,h=!1}const L=s[s.length-1],x=L?L.offset+L.source.length:i;return m&&n&&n.type!=="space"&&n.type!=="newline"&&n.type!=="comma"&&(n.type!=="scalar"||n.source!=="")&&o(n.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),f&&(c&&f.indent<=l||(n==null?void 0:n.type)==="block-map"||(n==null?void 0:n.type)==="block-seq")&&o(f,"TAB_AS_INDENT","Tabs are not allowed as indentation"),{comma:T,found:C,spaceBefore:r,comment:p,hasNewline:v,anchor:b,tag:$,newlineAfterProp:k,end:x,start:_??x}}function wt(s){if(!s)return null;switch(s.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(s.source.includes(`
`))return!0;if(s.end){for(const t of s.end)if(t.type==="newline")return!0}return!1;case"flow-collection":for(const t of s.items){for(const e of t.start)if(e.type==="newline")return!0;if(t.sep){for(const e of t.sep)if(e.type==="newline")return!0}if(wt(t.key)||wt(t.value))return!0}return!1;default:return!0}}function Ms(s,t,e){if((t==null?void 0:t.type)==="flow-collection"){const n=t.end[0];n.indent===s&&(n.source==="]"||n.source==="}")&&wt(t)&&e(n,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}function wi(s,t,e){const{uniqueKeys:n}=s.options;if(n===!1)return!1;const i=typeof n=="function"?n:(o,l)=>o===l||G(o)&&G(l)&&o.value===l.value;return t.some(o=>i(o.key,e))}const vn="All mapping items must start at the same column";function Ac({composeNode:s,composeEmptyNode:t},e,n,i,o){var h;const l=(o==null?void 0:o.nodeClass)??re,a=new l(e.schema);e.atRoot&&(e.atRoot=!1);let r=n.offset,c=null;for(const p of n.items){const{start:y,key:v,sep:m,value:f}=p,b=lt(y,{indicator:"explicit-key-ind",next:v??(m==null?void 0:m[0]),offset:r,onError:i,parentIndent:n.indent,startOnNewline:!0}),$=!b.found;if($){if(v&&(v.type==="block-seq"?i(r,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in v&&v.indent!==n.indent&&i(r,"BAD_INDENT",vn)),!b.anchor&&!b.tag&&!m){c=b.end,b.comment&&(a.comment?a.comment+=`
`+b.comment:a.comment=b.comment);continue}(b.newlineAfterProp||wt(v))&&i(v??y[y.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else((h=b.found)==null?void 0:h.indent)!==n.indent&&i(r,"BAD_INDENT",vn);e.atKey=!0;const k=b.end,T=v?s(e,v,b,i):t(e,k,y,null,b,i);e.schema.compat&&Ms(n.indent,v,i),e.atKey=!1,wi(e,a.items,T)&&i(k,"DUPLICATE_KEY","Map keys must be unique");const C=lt(m??[],{indicator:"map-value-ind",next:f,offset:T.range[2],onError:i,parentIndent:n.indent,startOnNewline:!v||v.type==="block-scalar"});if(r=C.end,C.found){$&&((f==null?void 0:f.type)==="block-map"&&!C.hasNewline&&i(r,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),e.options.strict&&b.start<C.found.offset-1024&&i(T.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));const _=f?s(e,f,C,i):t(e,r,m,null,C,i);e.schema.compat&&Ms(n.indent,f,i),r=_.range[2];const L=new se(T,_);e.options.keepSourceTokens&&(L.srcToken=p),a.items.push(L)}else{$&&i(T.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),C.comment&&(T.comment?T.comment+=`
`+C.comment:T.comment=C.comment);const _=new se(T);e.options.keepSourceTokens&&(_.srcToken=p),a.items.push(_)}}return c&&c<r&&i(c,"IMPOSSIBLE","Map comment with trailing content"),a.range=[n.offset,r,c??r],a}function Ic({composeNode:s,composeEmptyNode:t},e,n,i,o){const l=(o==null?void 0:o.nodeClass)??Me,a=new l(e.schema);e.atRoot&&(e.atRoot=!1),e.atKey&&(e.atKey=!1);let r=n.offset,c=null;for(const{start:h,value:p}of n.items){const y=lt(h,{indicator:"seq-item-ind",next:p,offset:r,onError:i,parentIndent:n.indent,startOnNewline:!0});if(!y.found)if(y.anchor||y.tag||p)p&&p.type==="block-seq"?i(y.end,"BAD_INDENT","All sequence items must start at the same column"):i(r,"MISSING_CHAR","Sequence item without - indicator");else{c=y.end,y.comment&&(a.comment=y.comment);continue}const v=p?s(e,p,y,i):t(e,y.end,h,null,y,i);e.schema.compat&&Ms(n.indent,p,i),r=v.range[2],a.items.push(v)}return a.range=[n.offset,r,c??r],a}function Vt(s,t,e,n){let i="";if(s){let o=!1,l="";for(const a of s){const{source:r,type:c}=a;switch(c){case"space":o=!0;break;case"comment":{e&&!o&&n(a,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const h=r.substring(1)||" ";i?i+=l+h:i=h,l="";break}case"newline":i&&(l+=r),o=!0;break;default:n(a,"UNEXPECTED_TOKEN",`Unexpected ${c} at node end`)}t+=r.length}}return{comment:i,offset:t}}const Ns="Block collections are not allowed within flow collections",As=s=>s&&(s.type==="block-map"||s.type==="block-seq");function Lc({composeNode:s,composeEmptyNode:t},e,n,i,o){const l=n.start.source==="{",a=l?"flow map":"flow sequence",r=(o==null?void 0:o.nodeClass)??(l?re:Me),c=new r(e.schema);c.flow=!0;const h=e.atRoot;h&&(e.atRoot=!1),e.atKey&&(e.atKey=!1);let p=n.offset+n.start.source.length;for(let b=0;b<n.items.length;++b){const $=n.items[b],{start:k,key:T,sep:C,value:_}=$,L=lt(k,{flow:a,indicator:"explicit-key-ind",next:T??(C==null?void 0:C[0]),offset:p,onError:i,parentIndent:n.indent,startOnNewline:!1});if(!L.found){if(!L.anchor&&!L.tag&&!C&&!_){b===0&&L.comma?i(L.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${a}`):b<n.items.length-1&&i(L.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${a}`),L.comment&&(c.comment?c.comment+=`
`+L.comment:c.comment=L.comment),p=L.end;continue}!l&&e.options.strict&&wt(T)&&i(T,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(b===0)L.comma&&i(L.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${a}`);else if(L.comma||i(L.start,"MISSING_CHAR",`Missing , between ${a} items`),L.comment){let x="";e:for(const N of k)switch(N.type){case"comma":case"space":break;case"comment":x=N.source.substring(1);break e;default:break e}if(x){let N=c.items[c.items.length-1];Q(N)&&(N=N.value??N.key),N.comment?N.comment+=`
`+x:N.comment=x,L.comment=L.comment.substring(x.length+1)}}if(!l&&!C&&!L.found){const x=_?s(e,_,L,i):t(e,L.end,C,null,L,i);c.items.push(x),p=x.range[2],As(_)&&i(x.range,"BLOCK_IN_FLOW",Ns)}else{e.atKey=!0;const x=L.end,N=T?s(e,T,L,i):t(e,x,k,null,L,i);As(T)&&i(N.range,"BLOCK_IN_FLOW",Ns),e.atKey=!1;const W=lt(C??[],{flow:a,indicator:"map-value-ind",next:_,offset:N.range[2],onError:i,parentIndent:n.indent,startOnNewline:!1});if(W.found){if(!l&&!L.found&&e.options.strict){if(C)for(const F of C){if(F===W.found)break;if(F.type==="newline"){i(F,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}L.start<W.found.offset-1024&&i(W.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else _&&("source"in _&&_.source&&_.source[0]===":"?i(_,"MISSING_CHAR",`Missing space after : in ${a}`):i(W.start,"MISSING_CHAR",`Missing , or : between ${a} items`));const J=_?s(e,_,W,i):W.found?t(e,W.end,C,null,W,i):null;J?As(_)&&i(J.range,"BLOCK_IN_FLOW",Ns):W.comment&&(N.comment?N.comment+=`
`+W.comment:N.comment=W.comment);const Z=new se(N,J);if(e.options.keepSourceTokens&&(Z.srcToken=$),l){const F=c;wi(e,F.items,N)&&i(x,"DUPLICATE_KEY","Map keys must be unique"),F.items.push(Z)}else{const F=new re(e.schema);F.flow=!0,F.items.push(Z);const me=(J??N).range;F.range=[N.range[0],me[1],me[2]],c.items.push(F)}p=J?J.range[2]:W.end}}const y=l?"}":"]",[v,...m]=n.end;let f=p;if(v&&v.source===y)f=v.offset+v.source.length;else{const b=a[0].toUpperCase()+a.substring(1),$=h?`${b} must end with a ${y}`:`${b} in block collection must be sufficiently indented and end with a ${y}`;i(p,h?"MISSING_CHAR":"BAD_INDENT",$),v&&v.source.length!==1&&m.unshift(v)}if(m.length>0){const b=Vt(m,f,e.options.strict,i);b.comment&&(c.comment?c.comment+=`
`+b.comment:c.comment=b.comment),c.range=[n.offset,f,b.offset]}else c.range=[n.offset,f,f];return c}function Is(s,t,e,n,i,o){const l=e.type==="block-map"?Ac(s,t,e,n,o):e.type==="block-seq"?Ic(s,t,e,n,o):Lc(s,t,e,n,o),a=l.constructor;return i==="!"||i===a.tagName?(l.tag=a.tagName,l):(i&&(l.tag=i),l)}function Ec(s,t,e,n,i){var y;const o=n.tag,l=o?t.directives.tagName(o.source,v=>i(o,"TAG_RESOLVE_FAILED",v)):null;if(e.type==="block-seq"){const{anchor:v,newlineAfterProp:m}=n,f=v&&o?v.offset>o.offset?v:o:v??o;f&&(!m||m.offset<f.offset)&&i(f,"MISSING_CHAR","Missing newline after block sequence props")}const a=e.type==="block-map"?"map":e.type==="block-seq"?"seq":e.start.source==="{"?"map":"seq";if(!o||!l||l==="!"||l===re.tagName&&a==="map"||l===Me.tagName&&a==="seq")return Is(s,t,e,i,l);let r=t.schema.tags.find(v=>v.tag===l&&v.collection===a);if(!r){const v=t.schema.knownTags[l];if(v&&v.collection===a)t.schema.tags.push(Object.assign({},v,{default:!1})),r=v;else return v?i(o,"BAD_COLLECTION_TYPE",`${v.tag} used for ${a} collection, but expects ${v.collection??"scalar"}`,!0):i(o,"TAG_RESOLVE_FAILED",`Unresolved tag: ${l}`,!0),Is(s,t,e,i,l)}const c=Is(s,t,e,i,l,r),h=((y=r.resolve)==null?void 0:y.call(r,c,v=>i(o,"TAG_RESOLVE_FAILED",v),t.options))??c,p=z(h)?h:new P(h);return p.range=c.range,p.tag=l,r!=null&&r.format&&(p.format=r.format),p}function ki(s,t,e){const n=t.offset,i=Vc(t,s.options.strict,e);if(!i)return{value:"",type:null,comment:"",range:[n,n,n]};const o=i.mode===">"?P.BLOCK_FOLDED:P.BLOCK_LITERAL,l=t.source?Dc(t.source):[];let a=l.length;for(let f=l.length-1;f>=0;--f){const b=l[f][1];if(b===""||b==="\r")a=f;else break}if(a===0){const f=i.chomp==="+"&&l.length>0?`
`.repeat(Math.max(1,l.length-1)):"";let b=n+i.length;return t.source&&(b+=t.source.length),{value:f,type:o,comment:i.comment,range:[n,b,b]}}let r=t.indent+i.indent,c=t.offset+i.length,h=0;for(let f=0;f<a;++f){const[b,$]=l[f];if($===""||$==="\r")i.indent===0&&b.length>r&&(r=b.length);else{b.length<r&&e(c+b.length,"MISSING_CHAR","Block scalars with more-indented leading empty lines must use an explicit indentation indicator"),i.indent===0&&(r=b.length),h=f,r===0&&!s.atRoot&&e(c,"BAD_INDENT","Block scalar values in collections must be indented");break}c+=b.length+$.length+1}for(let f=l.length-1;f>=a;--f)l[f][0].length>r&&(a=f+1);let p="",y="",v=!1;for(let f=0;f<h;++f)p+=l[f][0].slice(r)+`
`;for(let f=h;f<a;++f){let[b,$]=l[f];c+=b.length+$.length+1;const k=$[$.length-1]==="\r";if(k&&($=$.slice(0,-1)),$&&b.length<r){const C=`Block scalar lines must not be less indented than their ${i.indent?"explicit indentation indicator":"first line"}`;e(c-$.length-(k?2:1),"BAD_INDENT",C),b=""}o===P.BLOCK_LITERAL?(p+=y+b.slice(r)+$,y=`
`):b.length>r||$[0]==="	"?(y===" "?y=`
`:!v&&y===`
`&&(y=`

`),p+=y+b.slice(r)+$,y=`
`,v=!0):$===""?y===`
`?p+=`
`:y=`
`:(p+=y+$,y=" ",v=!1)}switch(i.chomp){case"-":break;case"+":for(let f=a;f<l.length;++f)p+=`
`+l[f][0].slice(r);p[p.length-1]!==`
`&&(p+=`
`);break;default:p+=`
`}const m=n+i.length+t.source.length;return{value:p,type:o,comment:i.comment,range:[n,m,m]}}function Vc({offset:s,props:t},e,n){if(t[0].type!=="block-scalar-header")return n(t[0],"IMPOSSIBLE","Block scalar header not found"),null;const{source:i}=t[0],o=i[0];let l=0,a="",r=-1;for(let y=1;y<i.length;++y){const v=i[y];if(!a&&(v==="-"||v==="+"))a=v;else{const m=Number(v);!l&&m?l=m:r===-1&&(r=s+y)}}r!==-1&&n(r,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${i}`);let c=!1,h="",p=i.length;for(let y=1;y<t.length;++y){const v=t[y];switch(v.type){case"space":c=!0;case"newline":p+=v.source.length;break;case"comment":e&&!c&&n(v,"MISSING_CHAR","Comments must be separated from other tokens by white space characters"),p+=v.source.length,h=v.source.substring(1);break;case"error":n(v,"UNEXPECTED_TOKEN",v.message),p+=v.source.length;break;default:{const m=`Unexpected token in block scalar header: ${v.type}`;n(v,"UNEXPECTED_TOKEN",m);const f=v.source;f&&typeof f=="string"&&(p+=f.length)}}}return{mode:o,indent:l,chomp:a,comment:h,length:p}}function Dc(s){const t=s.split(/\n( *)/),e=t[0],n=e.match(/^( *)/),o=[n!=null&&n[1]?[n[1],e.slice(n[1].length)]:["",e]];for(let l=1;l<t.length;l+=2)o.push([t[l],t[l+1]]);return o}function Si(s,t,e){const{offset:n,type:i,source:o,end:l}=s;let a,r;const c=(y,v,m)=>e(n+y,v,m);switch(i){case"scalar":a=P.PLAIN,r=Bc(o,c);break;case"single-quoted-scalar":a=P.QUOTE_SINGLE,r=xc(o,c);break;case"double-quoted-scalar":a=P.QUOTE_DOUBLE,r=Mc(o,c);break;default:return e(s,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${i}`),{value:"",type:null,comment:"",range:[n,n+o.length,n+o.length]}}const h=n+o.length,p=Vt(l,h,t,e);return{value:r,type:a,comment:p.comment,range:[n,h,p.offset]}}function Bc(s,t){let e="";switch(s[0]){case"	":e="a tab character";break;case",":e="flow indicator character ,";break;case"%":e="directive indicator character %";break;case"|":case">":{e=`block scalar indicator ${s[0]}`;break}case"@":case"`":{e=`reserved character ${s[0]}`;break}}return e&&t(0,"BAD_SCALAR_START",`Plain value cannot start with ${e}`),$i(s)}function xc(s,t){return(s[s.length-1]!=="'"||s.length===1)&&t(s.length,"MISSING_CHAR","Missing closing 'quote"),$i(s.slice(1,-1)).replace(/''/g,"'")}function $i(s){let t,e;try{t=new RegExp(`(.*?)(?<![ 	])[ 	]*\r?
`,"sy"),e=new RegExp(`[ 	]*(.*?)(?:(?<![ 	])[ 	]*)?\r?
`,"sy")}catch{t=/(.*?)[ \t]*\r?\n/sy,e=/[ \t]*(.*?)[ \t]*\r?\n/sy}let n=t.exec(s);if(!n)return s;let i=n[1],o=" ",l=t.lastIndex;for(e.lastIndex=l;n=e.exec(s);)n[1]===""?o===`
`?i+=o:o=`
`:(i+=o+n[1],o=" "),l=e.lastIndex;const a=/[ \t]*(.*)/sy;return a.lastIndex=l,n=a.exec(s),i+o+((n==null?void 0:n[1])??"")}function Mc(s,t){let e="";for(let n=1;n<s.length-1;++n){const i=s[n];if(!(i==="\r"&&s[n+1]===`
`))if(i===`
`){const{fold:o,offset:l}=Pc(s,n);e+=o,n=l}else if(i==="\\"){let o=s[++n];const l=jc[o];if(l)e+=l;else if(o===`
`)for(o=s[n+1];o===" "||o==="	";)o=s[++n+1];else if(o==="\r"&&s[n+1]===`
`)for(o=s[++n+1];o===" "||o==="	";)o=s[++n+1];else if(o==="x"||o==="u"||o==="U"){const a={x:2,u:4,U:8}[o];e+=Uc(s,n+1,a,t),n+=a}else{const a=s.substr(n-1,2);t(n-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${a}`),e+=a}}else if(i===" "||i==="	"){const o=n;let l=s[n+1];for(;l===" "||l==="	";)l=s[++n+1];l!==`
`&&!(l==="\r"&&s[n+2]===`
`)&&(e+=n>o?s.slice(o,n+1):i)}else e+=i}return(s[s.length-1]!=='"'||s.length===1)&&t(s.length,"MISSING_CHAR",'Missing closing "quote'),e}function Pc(s,t){let e="",n=s[t+1];for(;(n===" "||n==="	"||n===`
`||n==="\r")&&!(n==="\r"&&s[t+2]!==`
`);)n===`
`&&(e+=`
`),t+=1,n=s[t+1];return e||(e=" "),{fold:e,offset:t}}const jc={0:"\0",a:"\x07",b:"\b",e:"\x1B",f:"\f",n:`
`,r:"\r",t:"	",v:"\v",N:"",_:" ",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","	":"	"};function Uc(s,t,e,n){const i=s.substr(t,e),l=i.length===e&&/^[0-9a-fA-F]+$/.test(i)?parseInt(i,16):NaN;if(isNaN(l)){const a=s.substr(t-2,e+2);return n(t-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${a}`),a}return String.fromCodePoint(l)}function Ci(s,t,e,n){const{value:i,type:o,comment:l,range:a}=t.type==="block-scalar"?ki(s,t,n):Si(t,s.options.strict,n),r=e?s.directives.tagName(e.source,p=>n(e,"TAG_RESOLVE_FAILED",p)):null;let c;s.options.stringKeys&&s.atKey?c=s.schema[Se]:r?c=Rc(s.schema,i,r,e,n):t.type==="scalar"?c=qc(s,i,t,n):c=s.schema[Se];let h;try{const p=c.resolve(i,y=>n(e??t,"TAG_RESOLVE_FAILED",y),s.options);h=G(p)?p:new P(p)}catch(p){const y=p instanceof Error?p.message:String(p);n(e??t,"TAG_RESOLVE_FAILED",y),h=new P(i)}return h.range=a,h.source=i,o&&(h.type=o),r&&(h.tag=r),c.format&&(h.format=c.format),l&&(h.comment=l),h}function Rc(s,t,e,n,i){var a;if(e==="!")return s[Se];const o=[];for(const r of s.tags)if(!r.collection&&r.tag===e)if(r.default&&r.test)o.push(r);else return r;for(const r of o)if((a=r.test)!=null&&a.test(t))return r;const l=s.knownTags[e];return l&&!l.collection?(s.tags.push(Object.assign({},l,{default:!1,test:void 0})),l):(i(n,"TAG_RESOLVE_FAILED",`Unresolved tag: ${e}`,e!=="tag:yaml.org,2002:str"),s[Se])}function qc({atKey:s,directives:t,schema:e},n,i,o){const l=e.tags.find(a=>{var r;return(a.default===!0||s&&a.default==="key")&&((r=a.test)==null?void 0:r.test(n))})||e[Se];if(e.compat){const a=e.compat.find(r=>{var c;return r.default&&((c=r.test)==null?void 0:c.test(n))})??e[Se];if(l.tag!==a.tag){const r=t.tagString(l.tag),c=t.tagString(a.tag),h=`Value may be parsed as either ${r} or ${c}`;o(i,"TAG_RESOLVE_FAILED",h,!0)}}return l}function Kc(s,t,e){if(t){e??(e=t.length);for(let n=e-1;n>=0;--n){let i=t[n];switch(i.type){case"space":case"comment":case"newline":s-=i.source.length;continue}for(i=t[++n];(i==null?void 0:i.type)==="space";)s+=i.source.length,i=t[++n];break}}return s}const Fc={composeNode:Oi,composeEmptyNode:rn};function Oi(s,t,e,n){const i=s.atKey,{spaceBefore:o,comment:l,anchor:a,tag:r}=e;let c,h=!0;switch(t.type){case"alias":c=Wc(s,t,n),(a||r)&&n(t,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":c=Ci(s,t,r,n),a&&(c.anchor=a.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":c=Ec(Fc,s,t,e,n),a&&(c.anchor=a.source.substring(1));break;default:{const p=t.type==="error"?t.message:`Unsupported token (type: ${t.type})`;n(t,"UNEXPECTED_TOKEN",p),c=rn(s,t.offset,void 0,null,e,n),h=!1}}return a&&c.anchor===""&&n(a,"BAD_ALIAS","Anchor cannot be an empty string"),i&&s.options.stringKeys&&(!G(c)||typeof c.value!="string"||c.tag&&c.tag!=="tag:yaml.org,2002:str")&&n(r??t,"NON_STRING_KEY","With stringKeys, all keys must be strings"),o&&(c.spaceBefore=!0),l&&(t.type==="scalar"&&t.source===""?c.comment=l:c.commentBefore=l),s.options.keepSourceTokens&&h&&(c.srcToken=t),c}function rn(s,t,e,n,{spaceBefore:i,comment:o,anchor:l,tag:a,end:r},c){const h={type:"scalar",offset:Kc(t,e,n),indent:-1,source:""},p=Ci(s,h,a,c);return l&&(p.anchor=l.source.substring(1),p.anchor===""&&c(l,"BAD_ALIAS","Anchor cannot be an empty string")),i&&(p.spaceBefore=!0),o&&(p.comment=o,p.range[2]=r),p}function Wc({options:s},{offset:t,source:e,end:n},i){const o=new ds(e.substring(1));o.source===""&&i(t,"BAD_ALIAS","Alias cannot be an empty string"),o.source.endsWith(":")&&i(t+e.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);const l=t+e.length,a=Vt(n,l,s.strict,i);return o.range=[t,l,a.offset],a.comment&&(o.comment=a.comment),o}function Hc(s,t,{offset:e,start:n,value:i,end:o},l){const a=Object.assign({_directives:t},s),r=new ht(void 0,a),c={atKey:!1,atRoot:!0,directives:r.directives,options:r.options,schema:r.schema},h=lt(n,{indicator:"doc-start",next:i??(o==null?void 0:o[0]),offset:e,onError:l,parentIndent:0,startOnNewline:!0});h.found&&(r.directives.docStart=!0,i&&(i.type==="block-map"||i.type==="block-seq")&&!h.hasNewline&&l(h.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),r.contents=i?Oi(c,i,h,l):rn(c,h.end,n,null,h,l);const p=r.contents.range[2],y=Vt(o,p,!1,l);return y.comment&&(r.comment=y.comment),r.range=[e,p,y.offset],r}function gt(s){if(typeof s=="number")return[s,s+1];if(Array.isArray(s))return s.length===2?s:[s[0],s[1]];const{offset:t,source:e}=s;return[t,t+(typeof e=="string"?e.length:1)]}function _n(s){var i;let t="",e=!1,n=!1;for(let o=0;o<s.length;++o){const l=s[o];switch(l[0]){case"#":t+=(t===""?"":n?`

`:`
`)+(l.substring(1)||" "),e=!0,n=!1;break;case"%":((i=s[o+1])==null?void 0:i[0])!=="#"&&(o+=1),e=!1;break;default:e||(n=!0),e=!1}}return{comment:t,afterEmptyLine:n}}class cn{constructor(t={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(e,n,i,o)=>{const l=gt(e);o?this.warnings.push(new _i(l,n,i)):this.errors.push(new qe(l,n,i))},this.directives=new ie({version:t.version||"1.2"}),this.options=t}decorate(t,e){const{comment:n,afterEmptyLine:i}=_n(this.prelude);if(n){const o=t.contents;if(e)t.comment=t.comment?`${t.comment}
${n}`:n;else if(i||t.directives.docStart||!o)t.commentBefore=n;else if(Y(o)&&!o.flow&&o.items.length>0){let l=o.items[0];Q(l)&&(l=l.key);const a=l.commentBefore;l.commentBefore=a?`${n}
${a}`:n}else{const l=o.commentBefore;o.commentBefore=l?`${n}
${l}`:n}}e?(Array.prototype.push.apply(t.errors,this.errors),Array.prototype.push.apply(t.warnings,this.warnings)):(t.errors=this.errors,t.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:_n(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(t,e=!1,n=-1){for(const i of t)yield*this.next(i);yield*this.end(e,n)}*next(t){switch(t.type){case"directive":this.directives.add(t.source,(e,n,i)=>{const o=gt(t);o[0]+=e,this.onError(o,"BAD_DIRECTIVE",n,i)}),this.prelude.push(t.source),this.atDirectives=!0;break;case"document":{const e=Hc(this.options,this.directives,t,this.onError);this.atDirectives&&!e.directives.docStart&&this.onError(t,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(e,!1),this.doc&&(yield this.doc),this.doc=e,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(t.source);break;case"error":{const e=t.source?`${t.message}: ${JSON.stringify(t.source)}`:t.message,n=new qe(gt(t),"UNEXPECTED_TOKEN",e);this.atDirectives||!this.doc?this.errors.push(n):this.doc.errors.push(n);break}case"doc-end":{if(!this.doc){const n="Unexpected doc-end without preceding document";this.errors.push(new qe(gt(t),"UNEXPECTED_TOKEN",n));break}this.doc.directives.docEnd=!0;const e=Vt(t.end,t.offset+t.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),e.comment){const n=this.doc.comment;this.doc.comment=n?`${n}
${e.comment}`:e.comment}this.doc.range[2]=e.offset;break}default:this.errors.push(new qe(gt(t),"UNEXPECTED_TOKEN",`Unsupported token ${t.type}`))}}*end(t=!1,e=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(t){const n=Object.assign({_directives:this.directives},this.options),i=new ht(void 0,n);this.atDirectives&&this.onError(e,"MISSING_CHAR","Missing directives-end indicator line"),i.range=[0,e,e],this.decorate(i,!1),yield i}}}function Jc(s,t=!0,e){if(s){const n=(i,o,l)=>{const a=typeof i=="number"?i:Array.isArray(i)?i[0]:i.offset;if(e)e(a,o,l);else throw new qe([a,a+1],o,l)};switch(s.type){case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return Si(s,t,n);case"block-scalar":return ki({options:{strict:t}},s,n)}}return null}function Gc(s,t){const{implicitKey:e=!1,indent:n,inFlow:i=!1,offset:o=-1,type:l="PLAIN"}=t,a=Lt({type:l,value:s},{implicitKey:e,indent:n>0?" ".repeat(n):"",inFlow:i,options:{blockQuote:!0,lineWidth:-1}}),r=t.end??[{type:"newline",offset:-1,indent:n,source:`
`}];switch(a[0]){case"|":case">":{const c=a.indexOf(`
`),h=a.substring(0,c),p=a.substring(c+1)+`
`,y=[{type:"block-scalar-header",offset:o,indent:n,source:h}];return Ti(y,r)||y.push({type:"newline",offset:-1,indent:n,source:`
`}),{type:"block-scalar",offset:o,indent:n,props:y,source:p}}case'"':return{type:"double-quoted-scalar",offset:o,indent:n,source:a,end:r};case"'":return{type:"single-quoted-scalar",offset:o,indent:n,source:a,end:r};default:return{type:"scalar",offset:o,indent:n,source:a,end:r}}}function Qc(s,t,e={}){let{afterKey:n=!1,implicitKey:i=!1,inFlow:o=!1,type:l}=e,a="indent"in s?s.indent:null;if(n&&typeof a=="number"&&(a+=2),!l)switch(s.type){case"single-quoted-scalar":l="QUOTE_SINGLE";break;case"double-quoted-scalar":l="QUOTE_DOUBLE";break;case"block-scalar":{const c=s.props[0];if(c.type!=="block-scalar-header")throw new Error("Invalid block scalar header");l=c.source[0]===">"?"BLOCK_FOLDED":"BLOCK_LITERAL";break}default:l="PLAIN"}const r=Lt({type:l,value:t},{implicitKey:i||a===null,indent:a!==null&&a>0?" ".repeat(a):"",inFlow:o,options:{blockQuote:!0,lineWidth:-1}});switch(r[0]){case"|":case">":Yc(s,r);break;case'"':Ls(s,r,"double-quoted-scalar");break;case"'":Ls(s,r,"single-quoted-scalar");break;default:Ls(s,r,"scalar")}}function Yc(s,t){const e=t.indexOf(`
`),n=t.substring(0,e),i=t.substring(e+1)+`
`;if(s.type==="block-scalar"){const o=s.props[0];if(o.type!=="block-scalar-header")throw new Error("Invalid block scalar header");o.source=n,s.source=i}else{const{offset:o}=s,l="indent"in s?s.indent:-1,a=[{type:"block-scalar-header",offset:o,indent:l,source:n}];Ti(a,"end"in s?s.end:void 0)||a.push({type:"newline",offset:-1,indent:l,source:`
`});for(const r of Object.keys(s))r!=="type"&&r!=="offset"&&delete s[r];Object.assign(s,{type:"block-scalar",indent:l,props:a,source:i})}}function Ti(s,t){if(t)for(const e of t)switch(e.type){case"space":case"comment":s.push(e);break;case"newline":return s.push(e),!0}return!1}function Ls(s,t,e){switch(s.type){case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":s.type=e,s.source=t;break;case"block-scalar":{const n=s.props.slice(1);let i=t.length;s.props[0].type==="block-scalar-header"&&(i-=s.props[0].source.length);for(const o of n)o.offset+=i;delete s.props,Object.assign(s,{type:e,source:t,end:n});break}case"block-map":case"block-seq":{const i={type:"newline",offset:s.offset+t.length,indent:s.indent,source:`
`};delete s.items,Object.assign(s,{type:e,source:t,end:[i]});break}default:{const n="indent"in s?s.indent:-1,i="end"in s&&Array.isArray(s.end)?s.end.filter(o=>o.type==="space"||o.type==="comment"||o.type==="newline"):[];for(const o of Object.keys(s))o!=="type"&&o!=="offset"&&delete s[o];Object.assign(s,{type:e,indent:n,source:t,end:i})}}}const zc=s=>"type"in s?ns(s):zt(s);function ns(s){switch(s.type){case"block-scalar":{let t="";for(const e of s.props)t+=ns(e);return t+s.source}case"block-map":case"block-seq":{let t="";for(const e of s.items)t+=zt(e);return t}case"flow-collection":{let t=s.start.source;for(const e of s.items)t+=zt(e);for(const e of s.end)t+=e.source;return t}case"document":{let t=zt(s);if(s.end)for(const e of s.end)t+=e.source;return t}default:{let t=s.source;if("end"in s&&s.end)for(const e of s.end)t+=e.source;return t}}}function zt({start:s,key:t,sep:e,value:n}){let i="";for(const o of s)i+=o.source;if(t&&(i+=ns(t)),e)for(const o of e)i+=o.source;return n&&(i+=ns(n)),i}const Ps=Symbol("break visit"),Xc=Symbol("skip children"),Ni=Symbol("remove item");function Ke(s,t){"type"in s&&s.type==="document"&&(s={start:s.start,value:s.value}),Ai(Object.freeze([]),s,t)}Ke.BREAK=Ps;Ke.SKIP=Xc;Ke.REMOVE=Ni;Ke.itemAtPath=(s,t)=>{let e=s;for(const[n,i]of t){const o=e==null?void 0:e[n];if(o&&"items"in o)e=o.items[i];else return}return e};Ke.parentCollection=(s,t)=>{const e=Ke.itemAtPath(s,t.slice(0,-1)),n=t[t.length-1][0],i=e==null?void 0:e[n];if(i&&"items"in i)return i;throw new Error("Parent collection not found")};function Ai(s,t,e){let n=e(t,s);if(typeof n=="symbol")return n;for(const i of["key","value"]){const o=t[i];if(o&&"items"in o){for(let l=0;l<o.items.length;++l){const a=Ai(Object.freeze(s.concat([[i,l]])),o.items[l],e);if(typeof a=="number")l=a-1;else{if(a===Ps)return Ps;a===Ni&&(o.items.splice(l,1),l-=1)}}typeof n=="function"&&i==="key"&&(n=n(t,s))}}return typeof n=="function"?n(t,s):n}const ws="\uFEFF",ks="",Ss="",kt="",Zc=s=>!!s&&"items"in s,eu=s=>!!s&&(s.type==="scalar"||s.type==="single-quoted-scalar"||s.type==="double-quoted-scalar"||s.type==="block-scalar");function tu(s){switch(s){case ws:return"<BOM>";case ks:return"<DOC>";case Ss:return"<FLOW_END>";case kt:return"<SCALAR>";default:return JSON.stringify(s)}}function Ii(s){switch(s){case ws:return"byte-order-mark";case ks:return"doc-mode";case Ss:return"flow-error-end";case kt:return"scalar";case"---":return"doc-start";case"...":return"doc-end";case"":case`
`:case`\r
`:return"newline";case"-":return"seq-item-ind";case"?":return"explicit-key-ind";case":":return"map-value-ind";case"{":return"flow-map-start";case"}":return"flow-map-end";case"[":return"flow-seq-start";case"]":return"flow-seq-end";case",":return"comma"}switch(s[0]){case" ":case"	":return"space";case"#":return"comment";case"%":return"directive-line";case"*":return"alias";case"&":return"anchor";case"!":return"tag";case"'":return"single-quoted-scalar";case'"':return"double-quoted-scalar";case"|":case">":return"block-scalar-header"}return null}const su=Object.freeze(Object.defineProperty({__proto__:null,BOM:ws,DOCUMENT:ks,FLOW_END:Ss,SCALAR:kt,createScalarToken:Gc,isCollection:Zc,isScalar:eu,prettyToken:tu,resolveAsScalar:Jc,setScalarValue:Qc,stringify:zc,tokenType:Ii,visit:Ke},Symbol.toStringTag,{value:"Module"}));function be(s){switch(s){case void 0:case" ":case`
`:case"\r":case"	":return!0;default:return!1}}const wn=new Set("0123456789ABCDEFabcdef"),nu=new Set("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()"),Ht=new Set(",[]{}"),iu=new Set(` ,[]{}
\r	`),Es=s=>!s||iu.has(s);class Li{constructor(){this.atEnd=!1,this.blockScalarIndent=-1,this.blockScalarKeep=!1,this.buffer="",this.flowKey=!1,this.flowLevel=0,this.indentNext=0,this.indentValue=0,this.lineEndPos=null,this.next=null,this.pos=0}*lex(t,e=!1){if(t){if(typeof t!="string")throw TypeError("source is not a string");this.buffer=this.buffer?this.buffer+t:t,this.lineEndPos=null}this.atEnd=!e;let n=this.next??"stream";for(;n&&(e||this.hasChars(1));)n=yield*this.parseNext(n)}atLineEnd(){let t=this.pos,e=this.buffer[t];for(;e===" "||e==="	";)e=this.buffer[++t];return!e||e==="#"||e===`
`?!0:e==="\r"?this.buffer[t+1]===`
`:!1}charAt(t){return this.buffer[this.pos+t]}continueScalar(t){let e=this.buffer[t];if(this.indentNext>0){let n=0;for(;e===" ";)e=this.buffer[++n+t];if(e==="\r"){const i=this.buffer[n+t+1];if(i===`
`||!i&&!this.atEnd)return t+n+1}return e===`
`||n>=this.indentNext||!e&&!this.atEnd?t+n:-1}if(e==="-"||e==="."){const n=this.buffer.substr(t,3);if((n==="---"||n==="...")&&be(this.buffer[t+3]))return-1}return t}getLine(){let t=this.lineEndPos;return(typeof t!="number"||t!==-1&&t<this.pos)&&(t=this.buffer.indexOf(`
`,this.pos),this.lineEndPos=t),t===-1?this.atEnd?this.buffer.substring(this.pos):null:(this.buffer[t-1]==="\r"&&(t-=1),this.buffer.substring(this.pos,t))}hasChars(t){return this.pos+t<=this.buffer.length}setNext(t){return this.buffer=this.buffer.substring(this.pos),this.pos=0,this.lineEndPos=null,this.next=t,null}peek(t){return this.buffer.substr(this.pos,t)}*parseNext(t){switch(t){case"stream":return yield*this.parseStream();case"line-start":return yield*this.parseLineStart();case"block-start":return yield*this.parseBlockStart();case"doc":return yield*this.parseDocument();case"flow":return yield*this.parseFlowCollection();case"quoted-scalar":return yield*this.parseQuotedScalar();case"block-scalar":return yield*this.parseBlockScalar();case"plain-scalar":return yield*this.parsePlainScalar()}}*parseStream(){let t=this.getLine();if(t===null)return this.setNext("stream");if(t[0]===ws&&(yield*this.pushCount(1),t=t.substring(1)),t[0]==="%"){let e=t.length,n=t.indexOf("#");for(;n!==-1;){const o=t[n-1];if(o===" "||o==="	"){e=n-1;break}else n=t.indexOf("#",n+1)}for(;;){const o=t[e-1];if(o===" "||o==="	")e-=1;else break}const i=(yield*this.pushCount(e))+(yield*this.pushSpaces(!0));return yield*this.pushCount(t.length-i),this.pushNewline(),"stream"}if(this.atLineEnd()){const e=yield*this.pushSpaces(!0);return yield*this.pushCount(t.length-e),yield*this.pushNewline(),"stream"}return yield ks,yield*this.parseLineStart()}*parseLineStart(){const t=this.charAt(0);if(!t&&!this.atEnd)return this.setNext("line-start");if(t==="-"||t==="."){if(!this.atEnd&&!this.hasChars(4))return this.setNext("line-start");const e=this.peek(3);if((e==="---"||e==="...")&&be(this.charAt(3)))return yield*this.pushCount(3),this.indentValue=0,this.indentNext=0,e==="---"?"doc":"stream"}return this.indentValue=yield*this.pushSpaces(!1),this.indentNext>this.indentValue&&!be(this.charAt(1))&&(this.indentNext=this.indentValue),yield*this.parseBlockStart()}*parseBlockStart(){const[t,e]=this.peek(2);if(!e&&!this.atEnd)return this.setNext("block-start");if((t==="-"||t==="?"||t===":")&&be(e)){const n=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0));return this.indentNext=this.indentValue+1,this.indentValue+=n,yield*this.parseBlockStart()}return"doc"}*parseDocument(){yield*this.pushSpaces(!0);const t=this.getLine();if(t===null)return this.setNext("doc");let e=yield*this.pushIndicators();switch(t[e]){case"#":yield*this.pushCount(t.length-e);case void 0:return yield*this.pushNewline(),yield*this.parseLineStart();case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel=1,"flow";case"}":case"]":return yield*this.pushCount(1),"doc";case"*":return yield*this.pushUntil(Es),"doc";case'"':case"'":return yield*this.parseQuotedScalar();case"|":case">":return e+=yield*this.parseBlockScalarHeader(),e+=yield*this.pushSpaces(!0),yield*this.pushCount(t.length-e),yield*this.pushNewline(),yield*this.parseBlockScalar();default:return yield*this.parsePlainScalar()}}*parseFlowCollection(){let t,e,n=-1;do t=yield*this.pushNewline(),t>0?(e=yield*this.pushSpaces(!1),this.indentValue=n=e):e=0,e+=yield*this.pushSpaces(!0);while(t+e>0);const i=this.getLine();if(i===null)return this.setNext("flow");if((n!==-1&&n<this.indentNext&&i[0]!=="#"||n===0&&(i.startsWith("---")||i.startsWith("..."))&&be(i[3]))&&!(n===this.indentNext-1&&this.flowLevel===1&&(i[0]==="]"||i[0]==="}")))return this.flowLevel=0,yield Ss,yield*this.parseLineStart();let o=0;for(;i[o]===",";)o+=yield*this.pushCount(1),o+=yield*this.pushSpaces(!0),this.flowKey=!1;switch(o+=yield*this.pushIndicators(),i[o]){case void 0:return"flow";case"#":return yield*this.pushCount(i.length-o),"flow";case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel+=1,"flow";case"}":case"]":return yield*this.pushCount(1),this.flowKey=!0,this.flowLevel-=1,this.flowLevel?"flow":"doc";case"*":return yield*this.pushUntil(Es),"flow";case'"':case"'":return this.flowKey=!0,yield*this.parseQuotedScalar();case":":{const l=this.charAt(1);if(this.flowKey||be(l)||l===",")return this.flowKey=!1,yield*this.pushCount(1),yield*this.pushSpaces(!0),"flow"}default:return this.flowKey=!1,yield*this.parsePlainScalar()}}*parseQuotedScalar(){const t=this.charAt(0);let e=this.buffer.indexOf(t,this.pos+1);if(t==="'")for(;e!==-1&&this.buffer[e+1]==="'";)e=this.buffer.indexOf("'",e+2);else for(;e!==-1;){let o=0;for(;this.buffer[e-1-o]==="\\";)o+=1;if(o%2===0)break;e=this.buffer.indexOf('"',e+1)}const n=this.buffer.substring(0,e);let i=n.indexOf(`
`,this.pos);if(i!==-1){for(;i!==-1;){const o=this.continueScalar(i+1);if(o===-1)break;i=n.indexOf(`
`,o)}i!==-1&&(e=i-(n[i-1]==="\r"?2:1))}if(e===-1){if(!this.atEnd)return this.setNext("quoted-scalar");e=this.buffer.length}return yield*this.pushToIndex(e+1,!1),this.flowLevel?"flow":"doc"}*parseBlockScalarHeader(){this.blockScalarIndent=-1,this.blockScalarKeep=!1;let t=this.pos;for(;;){const e=this.buffer[++t];if(e==="+")this.blockScalarKeep=!0;else if(e>"0"&&e<="9")this.blockScalarIndent=Number(e)-1;else if(e!=="-")break}return yield*this.pushUntil(e=>be(e)||e==="#")}*parseBlockScalar(){let t=this.pos-1,e=0,n;e:for(let o=this.pos;n=this.buffer[o];++o)switch(n){case" ":e+=1;break;case`
`:t=o,e=0;break;case"\r":{const l=this.buffer[o+1];if(!l&&!this.atEnd)return this.setNext("block-scalar");if(l===`
`)break}default:break e}if(!n&&!this.atEnd)return this.setNext("block-scalar");if(e>=this.indentNext){this.blockScalarIndent===-1?this.indentNext=e:this.indentNext=this.blockScalarIndent+(this.indentNext===0?1:this.indentNext);do{const o=this.continueScalar(t+1);if(o===-1)break;t=this.buffer.indexOf(`
`,o)}while(t!==-1);if(t===-1){if(!this.atEnd)return this.setNext("block-scalar");t=this.buffer.length}}let i=t+1;for(n=this.buffer[i];n===" ";)n=this.buffer[++i];if(n==="	"){for(;n==="	"||n===" "||n==="\r"||n===`
`;)n=this.buffer[++i];t=i-1}else if(!this.blockScalarKeep)do{let o=t-1,l=this.buffer[o];l==="\r"&&(l=this.buffer[--o]);const a=o;for(;l===" ";)l=this.buffer[--o];if(l===`
`&&o>=this.pos&&o+1+e>a)t=o;else break}while(!0);return yield kt,yield*this.pushToIndex(t+1,!0),yield*this.parseLineStart()}*parsePlainScalar(){const t=this.flowLevel>0;let e=this.pos-1,n=this.pos-1,i;for(;i=this.buffer[++n];)if(i===":"){const o=this.buffer[n+1];if(be(o)||t&&Ht.has(o))break;e=n}else if(be(i)){let o=this.buffer[n+1];if(i==="\r"&&(o===`
`?(n+=1,i=`
`,o=this.buffer[n+1]):e=n),o==="#"||t&&Ht.has(o))break;if(i===`
`){const l=this.continueScalar(n+1);if(l===-1)break;n=Math.max(n,l-2)}}else{if(t&&Ht.has(i))break;e=n}return!i&&!this.atEnd?this.setNext("plain-scalar"):(yield kt,yield*this.pushToIndex(e+1,!0),t?"flow":"doc")}*pushCount(t){return t>0?(yield this.buffer.substr(this.pos,t),this.pos+=t,t):0}*pushToIndex(t,e){const n=this.buffer.slice(this.pos,t);return n?(yield n,this.pos+=n.length,n.length):(e&&(yield""),0)}*pushIndicators(){switch(this.charAt(0)){case"!":return(yield*this.pushTag())+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"&":return(yield*this.pushUntil(Es))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"-":case"?":case":":{const t=this.flowLevel>0,e=this.charAt(1);if(be(e)||t&&Ht.has(e))return t?this.flowKey&&(this.flowKey=!1):this.indentNext=this.indentValue+1,(yield*this.pushCount(1))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators())}}return 0}*pushTag(){if(this.charAt(1)==="<"){let t=this.pos+2,e=this.buffer[t];for(;!be(e)&&e!==">";)e=this.buffer[++t];return yield*this.pushToIndex(e===">"?t+1:t,!1)}else{let t=this.pos+1,e=this.buffer[t];for(;e;)if(nu.has(e))e=this.buffer[++t];else if(e==="%"&&wn.has(this.buffer[t+1])&&wn.has(this.buffer[t+2]))e=this.buffer[t+=3];else break;return yield*this.pushToIndex(t,!1)}}*pushNewline(){const t=this.buffer[this.pos];return t===`
`?yield*this.pushCount(1):t==="\r"&&this.charAt(1)===`
`?yield*this.pushCount(2):0}*pushSpaces(t){let e=this.pos-1,n;do n=this.buffer[++e];while(n===" "||t&&n==="	");const i=e-this.pos;return i>0&&(yield this.buffer.substr(this.pos,i),this.pos=e),i}*pushUntil(t){let e=this.pos,n=this.buffer[e];for(;!t(n);)n=this.buffer[++e];return yield*this.pushToIndex(e,!1)}}class Ei{constructor(){this.lineStarts=[],this.addNewLine=t=>this.lineStarts.push(t),this.linePos=t=>{let e=0,n=this.lineStarts.length;for(;e<n;){const o=e+n>>1;this.lineStarts[o]<t?e=o+1:n=o}if(this.lineStarts[e]===t)return{line:e+1,col:1};if(e===0)return{line:0,col:t};const i=this.lineStarts[e-1];return{line:e,col:t-i+1}}}}function Be(s,t){for(let e=0;e<s.length;++e)if(s[e].type===t)return!0;return!1}function kn(s){for(let t=0;t<s.length;++t)switch(s[t].type){case"space":case"comment":case"newline":break;default:return t}return-1}function Vi(s){switch(s==null?void 0:s.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function Jt(s){switch(s.type){case"document":return s.start;case"block-map":{const t=s.items[s.items.length-1];return t.sep??t.start}case"block-seq":return s.items[s.items.length-1].start;default:return[]}}function ze(s){var e;if(s.length===0)return[];let t=s.length;e:for(;--t>=0;)switch(s[t].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break e}for(;((e=s[++t])==null?void 0:e.type)==="space";);return s.splice(t,s.length)}function Sn(s){if(s.start.type==="flow-seq-start")for(const t of s.items)t.sep&&!t.value&&!Be(t.start,"explicit-key-ind")&&!Be(t.sep,"map-value-ind")&&(t.key&&(t.value=t.key),delete t.key,Vi(t.value)?t.value.end?Array.prototype.push.apply(t.value.end,t.sep):t.value.end=t.sep:Array.prototype.push.apply(t.start,t.sep),delete t.sep)}class un{constructor(t){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new Li,this.onNewLine=t}*parse(t,e=!1){this.onNewLine&&this.offset===0&&this.onNewLine(0);for(const n of this.lexer.lex(t,e))yield*this.next(n);e||(yield*this.end())}*next(t){if(this.source=t,this.atScalar){this.atScalar=!1,yield*this.step(),this.offset+=t.length;return}const e=Ii(t);if(e)if(e==="scalar")this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=e,yield*this.step(),e){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+t.length);break;case"space":this.atNewLine&&t[0]===" "&&(this.indent+=t.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=t.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=t.length}else{const n=`Not a YAML token: ${t}`;yield*this.pop({type:"error",offset:this.offset,message:n,source:t}),this.offset+=t.length}}*end(){for(;this.stack.length>0;)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){const t=this.peek(1);if(this.type==="doc-end"&&(!t||t.type!=="doc-end")){for(;this.stack.length>0;)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source});return}if(!t)return yield*this.stream();switch(t.type){case"document":return yield*this.document(t);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(t);case"block-scalar":return yield*this.blockScalar(t);case"block-map":return yield*this.blockMap(t);case"block-seq":return yield*this.blockSequence(t);case"flow-collection":return yield*this.flowCollection(t);case"doc-end":return yield*this.documentEnd(t)}yield*this.pop()}peek(t){return this.stack[this.stack.length-t]}*pop(t){const e=t??this.stack.pop();if(!e)yield{type:"error",offset:this.offset,source:"",message:"Tried to pop an empty stack"};else if(this.stack.length===0)yield e;else{const n=this.peek(1);switch(e.type==="block-scalar"?e.indent="indent"in n?n.indent:0:e.type==="flow-collection"&&n.type==="document"&&(e.indent=0),e.type==="flow-collection"&&Sn(e),n.type){case"document":n.value=e;break;case"block-scalar":n.props.push(e);break;case"block-map":{const i=n.items[n.items.length-1];if(i.value){n.items.push({start:[],key:e,sep:[]}),this.onKeyLine=!0;return}else if(i.sep)i.value=e;else{Object.assign(i,{key:e,sep:[]}),this.onKeyLine=!i.explicitKey;return}break}case"block-seq":{const i=n.items[n.items.length-1];i.value?n.items.push({start:[],value:e}):i.value=e;break}case"flow-collection":{const i=n.items[n.items.length-1];!i||i.value?n.items.push({start:[],key:e,sep:[]}):i.sep?i.value=e:Object.assign(i,{key:e,sep:[]});return}default:yield*this.pop(),yield*this.pop(e)}if((n.type==="document"||n.type==="block-map"||n.type==="block-seq")&&(e.type==="block-map"||e.type==="block-seq")){const i=e.items[e.items.length-1];i&&!i.sep&&!i.value&&i.start.length>0&&kn(i.start)===-1&&(e.indent===0||i.start.every(o=>o.type!=="comment"||o.indent<e.indent))&&(n.type==="document"?n.end=i.start:n.items.push({start:i.start}),e.items.splice(-1,1))}}}*stream(){switch(this.type){case"directive-line":yield{type:"directive",offset:this.offset,source:this.source};return;case"byte-order-mark":case"space":case"comment":case"newline":yield this.sourceToken;return;case"doc-mode":case"doc-start":{const t={type:"document",offset:this.offset,start:[]};this.type==="doc-start"&&t.start.push(this.sourceToken),this.stack.push(t);return}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(t){if(t.value)return yield*this.lineEnd(t);switch(this.type){case"doc-start":{kn(t.start)!==-1?(yield*this.pop(),yield*this.step()):t.start.push(this.sourceToken);return}case"anchor":case"tag":case"space":case"comment":case"newline":t.start.push(this.sourceToken);return}const e=this.startBlockValue(t);e?this.stack.push(e):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(t){if(this.type==="map-value-ind"){const e=Jt(this.peek(2)),n=ze(e);let i;t.end?(i=t.end,i.push(this.sourceToken),delete t.end):i=[this.sourceToken];const o={type:"block-map",offset:t.offset,indent:t.indent,items:[{start:n,key:t,sep:i}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=o}else yield*this.lineEnd(t)}*blockScalar(t){switch(this.type){case"space":case"comment":case"newline":t.props.push(this.sourceToken);return;case"scalar":if(t.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let e=this.source.indexOf(`
`)+1;for(;e!==0;)this.onNewLine(this.offset+e),e=this.source.indexOf(`
`,e)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(t){var n;const e=t.items[t.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,e.value){const i="end"in e.value?e.value.end:void 0,o=Array.isArray(i)?i[i.length-1]:void 0;(o==null?void 0:o.type)==="comment"?i==null||i.push(this.sourceToken):t.items.push({start:[this.sourceToken]})}else e.sep?e.sep.push(this.sourceToken):e.start.push(this.sourceToken);return;case"space":case"comment":if(e.value)t.items.push({start:[this.sourceToken]});else if(e.sep)e.sep.push(this.sourceToken);else{if(this.atIndentedComment(e.start,t.indent)){const i=t.items[t.items.length-2],o=(n=i==null?void 0:i.value)==null?void 0:n.end;if(Array.isArray(o)){Array.prototype.push.apply(o,e.start),o.push(this.sourceToken),t.items.pop();return}}e.start.push(this.sourceToken)}return}if(this.indent>=t.indent){const i=!this.onKeyLine&&this.indent===t.indent,o=i&&(e.sep||e.explicitKey)&&this.type!=="seq-item-ind";let l=[];if(o&&e.sep&&!e.value){const a=[];for(let r=0;r<e.sep.length;++r){const c=e.sep[r];switch(c.type){case"newline":a.push(r);break;case"space":break;case"comment":c.indent>t.indent&&(a.length=0);break;default:a.length=0}}a.length>=2&&(l=e.sep.splice(a[1]))}switch(this.type){case"anchor":case"tag":o||e.value?(l.push(this.sourceToken),t.items.push({start:l}),this.onKeyLine=!0):e.sep?e.sep.push(this.sourceToken):e.start.push(this.sourceToken);return;case"explicit-key-ind":!e.sep&&!e.explicitKey?(e.start.push(this.sourceToken),e.explicitKey=!0):o||e.value?(l.push(this.sourceToken),t.items.push({start:l,explicitKey:!0})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken],explicitKey:!0}]}),this.onKeyLine=!0;return;case"map-value-ind":if(e.explicitKey)if(e.sep)if(e.value)t.items.push({start:[],key:null,sep:[this.sourceToken]});else if(Be(e.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:l,key:null,sep:[this.sourceToken]}]});else if(Vi(e.key)&&!Be(e.sep,"newline")){const a=ze(e.start),r=e.key,c=e.sep;c.push(this.sourceToken),delete e.key,delete e.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:a,key:r,sep:c}]})}else l.length>0?e.sep=e.sep.concat(l,this.sourceToken):e.sep.push(this.sourceToken);else if(Be(e.start,"newline"))Object.assign(e,{key:null,sep:[this.sourceToken]});else{const a=ze(e.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:a,key:null,sep:[this.sourceToken]}]})}else e.sep?e.value||o?t.items.push({start:l,key:null,sep:[this.sourceToken]}):Be(e.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):e.sep.push(this.sourceToken):Object.assign(e,{key:null,sep:[this.sourceToken]});this.onKeyLine=!0;return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const a=this.flowScalar(this.type);o||e.value?(t.items.push({start:l,key:a,sep:[]}),this.onKeyLine=!0):e.sep?this.stack.push(a):(Object.assign(e,{key:a,sep:[]}),this.onKeyLine=!0);return}default:{const a=this.startBlockValue(t);if(a){if(a.type==="block-seq"){if(!e.explicitKey&&e.sep&&!Be(e.sep,"newline")){yield*this.pop({type:"error",offset:this.offset,message:"Unexpected block-seq-ind on same line with key",source:this.source});return}}else i&&t.items.push({start:l});this.stack.push(a);return}}}}yield*this.pop(),yield*this.step()}*blockSequence(t){var n;const e=t.items[t.items.length-1];switch(this.type){case"newline":if(e.value){const i="end"in e.value?e.value.end:void 0,o=Array.isArray(i)?i[i.length-1]:void 0;(o==null?void 0:o.type)==="comment"?i==null||i.push(this.sourceToken):t.items.push({start:[this.sourceToken]})}else e.start.push(this.sourceToken);return;case"space":case"comment":if(e.value)t.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(e.start,t.indent)){const i=t.items[t.items.length-2],o=(n=i==null?void 0:i.value)==null?void 0:n.end;if(Array.isArray(o)){Array.prototype.push.apply(o,e.start),o.push(this.sourceToken),t.items.pop();return}}e.start.push(this.sourceToken)}return;case"anchor":case"tag":if(e.value||this.indent<=t.indent)break;e.start.push(this.sourceToken);return;case"seq-item-ind":if(this.indent!==t.indent)break;e.value||Be(e.start,"seq-item-ind")?t.items.push({start:[this.sourceToken]}):e.start.push(this.sourceToken);return}if(this.indent>t.indent){const i=this.startBlockValue(t);if(i){this.stack.push(i);return}}yield*this.pop(),yield*this.step()}*flowCollection(t){const e=t.items[t.items.length-1];if(this.type==="flow-error-end"){let n;do yield*this.pop(),n=this.peek(1);while(n&&n.type==="flow-collection")}else if(t.end.length===0){switch(this.type){case"comma":case"explicit-key-ind":!e||e.sep?t.items.push({start:[this.sourceToken]}):e.start.push(this.sourceToken);return;case"map-value-ind":!e||e.value?t.items.push({start:[],key:null,sep:[this.sourceToken]}):e.sep?e.sep.push(this.sourceToken):Object.assign(e,{key:null,sep:[this.sourceToken]});return;case"space":case"comment":case"newline":case"anchor":case"tag":!e||e.value?t.items.push({start:[this.sourceToken]}):e.sep?e.sep.push(this.sourceToken):e.start.push(this.sourceToken);return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const i=this.flowScalar(this.type);!e||e.value?t.items.push({start:[],key:i,sep:[]}):e.sep?this.stack.push(i):Object.assign(e,{key:i,sep:[]});return}case"flow-map-end":case"flow-seq-end":t.end.push(this.sourceToken);return}const n=this.startBlockValue(t);n?this.stack.push(n):(yield*this.pop(),yield*this.step())}else{const n=this.peek(2);if(n.type==="block-map"&&(this.type==="map-value-ind"&&n.indent===t.indent||this.type==="newline"&&!n.items[n.items.length-1].sep))yield*this.pop(),yield*this.step();else if(this.type==="map-value-ind"&&n.type!=="flow-collection"){const i=Jt(n),o=ze(i);Sn(t);const l=t.end.splice(1,t.end.length);l.push(this.sourceToken);const a={type:"block-map",offset:t.offset,indent:t.indent,items:[{start:o,key:t,sep:l}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=a}else yield*this.lineEnd(t)}}flowScalar(t){if(this.onNewLine){let e=this.source.indexOf(`
`)+1;for(;e!==0;)this.onNewLine(this.offset+e),e=this.source.indexOf(`
`,e)+1}return{type:t,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(t){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;const e=Jt(t),n=ze(e);return n.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:n,explicitKey:!0}]}}case"map-value-ind":{this.onKeyLine=!0;const e=Jt(t),n=ze(e);return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:n,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(t,e){return this.type!=="comment"||this.indent<=e?!1:t.every(n=>n.type==="newline"||n.type==="space")}*documentEnd(t){this.type!=="doc-mode"&&(t.end?t.end.push(this.sourceToken):t.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop()))}*lineEnd(t){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;case"space":case"comment":default:t.end?t.end.push(this.sourceToken):t.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop())}}}function Di(s){const t=s.prettyErrors!==!1;return{lineCounter:s.lineCounter||t&&new Ei||null,prettyErrors:t}}function ou(s,t={}){const{lineCounter:e,prettyErrors:n}=Di(t),i=new un(e==null?void 0:e.addNewLine),o=new cn(t),l=Array.from(o.compose(i.parse(s)));if(n&&e)for(const a of l)a.errors.forEach(ss(s,e)),a.warnings.forEach(ss(s,e));return l.length>0?l:Object.assign([],{empty:!0},o.streamInfo())}function Bi(s,t={}){const{lineCounter:e,prettyErrors:n}=Di(t),i=new un(e==null?void 0:e.addNewLine),o=new cn(t);let l=null;for(const a of o.compose(i.parse(s),!0,s.length))if(!l)l=a;else if(l.options.logLevel!=="silent"){l.errors.push(new qe(a.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}return n&&e&&(l.errors.forEach(ss(s,e)),l.warnings.forEach(ss(s,e))),l}function lu(s,t,e){let n;typeof t=="function"?n=t:e===void 0&&t&&typeof t=="object"&&(e=t);const i=Bi(s,e);if(!i)return null;if(i.warnings.forEach(o=>ti(i.options.logLevel,o)),i.errors.length>0){if(i.options.logLevel!=="silent")throw i.errors[0];i.errors=[]}return i.toJS(Object.assign({reviver:n},e))}function au(s,t,e){let n=null;if(typeof t=="function"||Array.isArray(t)?n=t:e===void 0&&t&&(e=t),typeof e=="string"&&(e=e.length),typeof e=="number"){const i=Math.round(e);e=i<1?void 0:i>8?{indent:8}:{indent:i}}if(s===void 0){const{keepUndefined:i}=e??t??{};if(!i)return}return Fe(s)&&!n?s.toString(e):new ht(s,n,e).toString(e)}const $n=Object.freeze(Object.defineProperty({__proto__:null,Alias:ds,CST:su,Composer:cn,Document:ht,Lexer:Li,LineCounter:Ei,Pair:se,Parser:un,Scalar:P,Schema:_s,YAMLError:an,YAMLMap:re,YAMLParseError:qe,YAMLSeq:Me,YAMLWarning:_i,isAlias:je,isCollection:Y,isDocument:Fe,isMap:ut,isNode:z,isPair:Q,isScalar:G,isSeq:dt,parse:lu,parseAllDocuments:ou,parseDocument:Bi,stringify:au,visit:We,visitAsync:us},Symbol.toStringTag,{value:"Module"})),$s=s=>(Rs("data-v-e2380313"),s=s(),qs(),s),ru={class:"templates-editor"},cu={key:0,class:"p-error"},uu={class:"toolbar"},du=$s(()=>u("i",{class:"pi pi-copy"},null,-1)),fu=$s(()=>u("i",{class:"pi pi-pencil"},null,-1)),pu=$s(()=>u("i",{class:"pi pi-times mr-2"},null,-1)),hu=$s(()=>u("i",{class:"pi pi-check mr-2"},null,-1)),mu=Tt({__name:"AppConfigChatWootTemplates",props:{modelValue:{type:Object,default:()=>({})}},emits:["update:modelValue"],setup(s,{emit:t}){const{t:e}=X(),n=s,i=t,o=I(!1),l=I(""),a=I(null);function r(m){return!m||Object.keys(m).length===0?"":Object.entries(m).map(([b,$])=>{const k=new $n.Document,T=new P($);return T.type=P.BLOCK_LITERAL,k.set(b,T),String(k).replace(/^---\s*\n/,"").trimEnd()}).join(`

`)}ce(()=>n.modelValue,m=>{o.value||(l.value=r(m||{}),a.value=null)},{deep:!0,immediate:!0});function c(){o.value=!0,a.value=null}function h(){l.value=r(n.modelValue||{}),a.value=null,o.value=!1}function p(){try{const m=$n.parse(l.value||"")??{};if(m&&typeof m=="object"&&!Array.isArray(m)){const f={};for(const[b,$]of Object.entries(m)){if(typeof b!="string")throw new Error("All keys must be strings");if(typeof $!="string")throw new Error(`Value for key "${b}" must be a string`);f[b]=$}i("update:modelValue",f),a.value=null,o.value=!1}else throw new Error("YAML must be a mapping of string keys to string values")}catch(m){a.value=(m==null?void 0:m.message)||String(m)}}const y=q(()=>!!a.value);async function v(){try{await navigator.clipboard.writeText(l.value||"")}catch{}}return(m,f)=>{const b=Fs,$=te,k=oe("tooltip");return w(),A("div",ru,[g(b,{modelValue:l.value,"onUpdate:modelValue":f[0]||(f[0]=T=>l.value=T),spellcheck:"false",autoResize:"",rows:"2",cols:"30",disabled:!o.value,class:fe([{"p-invalid":y.value},"w-full"]),placeholder:"Put your templates here in YAML format..."},null,8,["modelValue","disabled","class"]),y.value?(w(),A("small",cu,S(a.value),1)):D("",!0),u("div",uu,[o.value?(w(),A(ee,{key:1},[g($,{size:"small",class:"mr-2",severity:"secondary",onClick:h},{default:O(()=>[pu,u("span",null,S(d(e)("common.cancel")),1)]),_:1}),g($,{size:"small",class:"ml-2",severity:"success",onClick:p},{default:O(()=>[hu,u("span",null,S(d(e)("common.save")),1)]),_:1})],64)):(w(),A(ee,{key:0},[K((w(),A("a",{href:"#",class:"toolbar-action mr-3",tabindex:0,onClick:Xt(v,["prevent"])},[du,u("span",null,S(d(e)("apps.chatwoot.copy")),1)])),[[k,{value:d(e)("apps.chatwoot.copiedToClipboard")},void 0,{focus:!0,bottom:!0}]]),u("a",{href:"#",class:"toolbar-action",onClick:Xt(c,["prevent"])},[fu,u("span",null,S(d(e)("common.edit")),1)])],64))])])}}}),gu=Pe(mu,[["__scopeId","data-v-e2380313"]]),xi=s=>(Rs("data-v-efaa8723"),s=s(),qs(),s),yu={class:"chatwoot-config"},bu={class:"mb-3"},vu=xi(()=>u("br",null,null,-1)),_u={href:"http://waha.devlike.pro/docs/apps/chatwoot/",target:"_blank",rel:"noopener noreferrer"},wu=xi(()=>u("br",null,null,-1)),ku={href:"https://waha.devlike.pro/blog/apps-chatwoot-config/",target:"_blank",rel:"noopener noreferrer"},Su={class:"field"},$u={for:"url"},Cu={key:0,class:"p-error"},Ou={class:"grid"},Tu={class:"col-6"},Nu={class:"field"},Au={for:"accountId"},Iu={key:0,class:"p-error"},Lu={class:"col-6"},Eu={class:"field"},Vu={for:"accountToken"},Du={key:0,class:"p-error"},Bu={class:"grid"},xu={class:"col-6"},Mu={class:"field"},Pu={for:"inboxId"},ju={class:"pi pi-info-circle"},Uu={key:0,class:"p-error"},Ru={class:"col-6"},qu={class:"field"},Ku={for:"inboxIdentifier"},Fu={key:0,class:"p-error"},Wu={class:"field"},Hu={for:"linkPreview"},Ju={class:"pi pi-info-circle"},Gu={class:"field"},Qu={class:"pi pi-info-circle"},Yu={class:"field"},zu={for:"locale"},Xu={class:"pi pi-info-circle"},Zu={key:0,class:"p-error"},ed={class:"field"},td={class:"pi pi-info-circle"},sd=Tt({__name:"AppConfigChatWoot",props:{modelValue:{type:Object,required:!0},server:{type:Object,required:!0},submitted:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(s,{emit:t}){const{t:e}=X(),n=s,i=t,o=ae(),l=at(),a={url:"",accountId:null,accountToken:"",inboxId:null,inboxIdentifier:"",locale:"en-US",linkPreview:yt.OFF,templates:{},commands:{server:!0}},r=to(ve.defaultsDeep({},ve.cloneDeep(n.modelValue??{}),a));ce(r,v=>{const m=ve.cloneDeep(v);i("update:modelValue",m)},{deep:!0});const c=I([]),h=I(!1),p=[{label:e("apps.chatwoot.linkPreview.off"),value:yt.OFF},{label:e("apps.chatwoot.linkPreview.lq"),value:yt.LQ},{label:e("apps.chatwoot.linkPreview.hq"),value:yt.HQ}];ls(async()=>{await y()});async function y(){if(!(!n.server||!n.server.id))try{h.value=!0,c.value=await l(o.getAppChatWootLocales(n.server.id),void 0,e("apps.chatwoot.failedToLoadLocales"))}catch(v){console.error("Error loading locales:",v)}finally{h.value=!1}}return(v,m)=>{const f=Ne,b=Dn,$=Bn,k=Nt,T=cs,C=oe("tooltip");return w(),A("div",yu,[u("div",bu,[g(d(Ws),{severity:"info"},{default:O(()=>[u("span",null,S(d(e)("apps.chatwoot.help.header")),1),vu,u("a",_u,S(d(e)("apps.chatwoot.help.ChatWootAppPage")),1),wu,u("a",ku,S(d(e)("apps.chatwoot.help.ChatWootConfigArticle")),1)]),_:1})]),u("div",Su,[u("label",$u,S(d(e)("apps.chatwoot.url")),1),g(f,{id:"url",modelValue:r.url,"onUpdate:modelValue":m[0]||(m[0]=_=>r.url=_),placeholder:"https://app.chatwoot.com",class:fe({"p-invalid":s.submitted&&!r.url})},null,8,["modelValue","class"]),s.submitted&&!r.url?(w(),A("small",Cu,S(d(e)("apps.chatwoot.urlRequired")),1)):D("",!0)]),u("div",Ou,[u("div",Tu,[u("div",Nu,[u("label",Au,S(d(e)("apps.chatwoot.accountId")),1),g(b,{id:"accountId",modelValue:r.accountId,"onUpdate:modelValue":m[1]||(m[1]=_=>r.accountId=_),placeholder:d(e)("apps.chatwoot.accountIdPlaceholder"),class:fe({"p-invalid":s.submitted&&!r.accountId})},null,8,["modelValue","placeholder","class"]),s.submitted&&!r.accountId?(w(),A("small",Iu,S(d(e)("apps.chatwoot.accountIdRequired")),1)):D("",!0)])]),u("div",Lu,[u("div",Eu,[u("label",Vu,S(d(e)("apps.chatwoot.accountToken")),1),g($,{id:"accountToken",modelValue:r.accountToken,"onUpdate:modelValue":m[2]||(m[2]=_=>r.accountToken=_),placeholder:d(e)("apps.chatwoot.accountTokenPlaceholder"),feedback:!1,toggleMask:"",class:fe({"p-invalid":s.submitted&&!r.accountToken})},null,8,["modelValue","placeholder","class"]),s.submitted&&!r.accountToken?(w(),A("small",Du,S(d(e)("apps.chatwoot.accountTokenRequired")),1)):D("",!0)])])]),u("div",Bu,[u("div",xu,[u("div",Mu,[u("label",Pu,[H(S(d(e)("apps.chatwoot.inboxId"))+" ",1),K(u("i",ju,null,512),[[C,d(e)("apps.chatwoot.inboxIdTooltip")]])]),g(b,{id:"inboxId",modelValue:r.inboxId,"onUpdate:modelValue":m[3]||(m[3]=_=>r.inboxId=_),placeholder:d(e)("apps.chatwoot.inboxIdPlaceholder"),class:fe({"p-invalid":s.submitted&&!r.inboxId})},null,8,["modelValue","placeholder","class"]),s.submitted&&!r.inboxId?(w(),A("small",Uu,S(d(e)("apps.chatwoot.inboxIdRequired")),1)):D("",!0)])]),u("div",Ru,[u("div",qu,[u("label",Ku,S(d(e)("apps.chatwoot.inboxIdentifier")),1),g($,{id:"inboxIdentifier",modelValue:r.inboxIdentifier,"onUpdate:modelValue":m[4]||(m[4]=_=>r.inboxIdentifier=_),placeholder:d(e)("apps.chatwoot.inboxIdentifierPlaceholder"),feedback:!1,toggleMask:"",class:fe({"p-invalid":s.submitted&&!r.inboxIdentifier})},null,8,["modelValue","placeholder","class"]),s.submitted&&!r.inboxIdentifier?(w(),A("small",Fu,S(d(e)("apps.chatwoot.inboxIdentifierRequired")),1)):D("",!0)])])]),u("div",Wu,[u("label",Hu,[H(S(d(e)("apps.chatwoot.linkPreview.label"))+" ",1),K(u("i",Ju,null,512),[[C,d(e)("apps.chatwoot.linkPreview.tooltip")]])]),g(k,{id:"linkPreview",modelValue:r.linkPreview,"onUpdate:modelValue":m[5]||(m[5]=_=>r.linkPreview=_),options:p,optionLabel:"label",optionValue:"value"},null,8,["modelValue"])]),u("div",Gu,[u("label",null,[H(S(d(e)("apps.chatwoot.commands.title"))+" ",1),K(u("i",Qu,null,512),[[C,d(e)("apps.chatwoot.commands.tooltip")]])]),u("div",null,[g(T,{modelValue:r.commands.server,"onUpdate:modelValue":m[6]||(m[6]=_=>r.commands.server=_),onIcon:"pi pi-check",offIcon:"pi pi-times",onLabel:d(e)("apps.chatwoot.commands.server.on"),offLabel:d(e)("apps.chatwoot.commands.server.off")},null,8,["modelValue","onLabel","offLabel"])])]),u("div",Yu,[u("label",zu,[H(S(d(e)("apps.chatwoot.language"))+" ",1),K(u("i",Xu,null,512),[[C,d(e)("apps.chatwoot.languageTooltip")]])]),g(k,{id:"locale",modelValue:r.locale,"onUpdate:modelValue":m[7]||(m[7]=_=>r.locale=_),options:c.value,optionLabel:"name",optionValue:"locale",placeholder:d(e)("apps.chatwoot.selectLocale"),loading:h.value,class:fe({"p-invalid":s.submitted&&!r.locale}),scrollHeight:"400px"},null,8,["modelValue","options","placeholder","loading","class"]),s.submitted&&!r.locale?(w(),A("small",Zu,S(d(e)("apps.chatwoot.languageRequired")),1)):D("",!0)]),u("div",ed,[u("label",null,[H(S(d(e)("apps.chatwoot.templates.title"))+" ",1),K(u("i",td,null,512),[[C,d(e)("apps.chatwoot.templates.tooltip")]])]),u("div",null,[g(gu,{modelValue:r.templates,"onUpdate:modelValue":m[8]||(m[8]=_=>r.templates=_)},null,8,["modelValue"])])])])}}}),nd=Pe(sd,[["__scopeId","data-v-efaa8723"]]),id={class:"chatwoot-faq"},od={class:"mb-3"},ld={href:"https://waha.devlike.pro/docs/apps/chatwoot",target:"_blank"},ad={class:"mb-4"},rd={class:"mb-1"},cd={class:"p-inputgroup mb-1"},ud={class:"p-message-secondary"},dd={class:"mt-4"},fd={class:"p-inputgroup"},pd=Tt({__name:"AppFAQChatWoot",props:{app:{type:Object,required:!0},session:{type:String,required:!0}},setup(s){const{t}=X(),e=s,n=q(()=>`/webhooks/chatwoot/${e.session}/${e.app.id}`),i=q(()=>`http://waha:3000${n.value}`),o=q(()=>`{WAHA_BASE_URL}${n.value}`);async function l(){await navigator.clipboard.writeText(o.value)}async function a(){await navigator.clipboard.writeText(i.value)}return(r,c)=>{const h=Hs,p=Ne,y=te,v=Js,m=oe("tooltip");return w(),A("div",id,[g(v,{multiple:!0,activeIndex:[1]},{default:O(()=>[g(h,{header:d(t)("apps.chatwoot.aboutApp")},{default:O(()=>[u("div",od,[u("a",ld,S(d(t)("apps.chatwoot.learnMore")),1)])]),_:1},8,["header"]),g(h,{header:d(t)("apps.chatwoot.webhookUrl")},{default:O(()=>[u("div",ad,[u("p",rd,S(d(t)("apps.chatwoot.useWebhookUrl")),1),u("div",cd,[g(p,{value:o.value,disabled:"",placeholder:d(t)("apps.chatwoot.webhookUrlPlaceholder")},null,8,["value","placeholder"]),K(g(y,{label:d(t)("apps.chatwoot.copy"),icon:"pi pi-copy",onClick:l},null,8,["label"]),[[m,{value:d(t)("apps.chatwoot.copiedToClipboard")},void 0,{focus:!0,bottom:!0}]])]),u("small",ud,S(d(t)("apps.chatwoot.replaceBaseUrl")),1)]),u("div",dd,[u("p",null,S(d(t)("apps.chatwoot.exampleSetup")),1),u("div",fd,[g(p,{value:i.value,disabled:"",placeholder:d(t)("apps.chatwoot.exampleUrlPlaceholder")},null,8,["value","placeholder"]),K(g(y,{label:d(t)("apps.chatwoot.copy"),icon:"pi pi-copy",onClick:a},null,8,["label"]),[[m,{value:d(t)("apps.chatwoot.copiedToClipboard")},void 0,{focus:!0,bottom:!0}]])])])]),_:1},8,["header"])]),_:1})])}}}),hd=Pe(pd,[["__scopeId","data-v-68901460"]]),md="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_378_9639)'%3e%3cpath%20d='M12%2024C18.6274%2024%2024%2018.6274%2024%2012C24%205.37258%2018.6274%200%2012%200C5.37258%200%200%205.37258%200%2012C0%2018.6274%205.37258%2024%2012%2024Z'%20fill='%232781F6'%3e%3c/path%3e%3cpath%20d='M17.1256%2017.1258H11.5622C8.4955%2017.1258%205.99976%2014.6299%205.99976%2011.5624C5.99976%208.49591%208.4955%206%2011.5623%206C14.6298%206%2017.1256%208.49591%2017.1256%2011.5624V17.1258Z'%20fill='white'%20stroke='white'%20stroke-width='0.28125'%3e%3c/path%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_378_9639'%3e%3crect%20width='24'%20height='24'%20fill='white'%3e%3c/rect%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",Mi=s=>(Rs("data-v-50742726"),s=s(),qs(),s),gd={class:"chatwoot-label"},yd=Mi(()=>u("img",{src:md,alt:"ChatWoot Icon",class:"chatwoot-icon"},null,-1)),bd=Mi(()=>u("span",null,"ChatWoot",-1)),vd=[yd,bd],_d={__name:"ChatWootLabel",setup(s){return(t,e)=>(w(),A("span",gd,vd))}},js=Pe(_d,[["__scopeId","data-v-50742726"]]),wd={class:"app-edit"},kd={class:"field"},Sd={for:"id"},$d={key:0,class:"p-error"},Cd={class:"field"},Od={for:"app-type"},Td={key:0},Nd={key:1},Ad={key:0,class:"p-error"},Id={class:"field"},Ld={key:0,class:"field"},Ed={class:"card app-config"},Vd=Tt({__name:"AppEdit",props:{modelValue:{type:Object,required:!0},server:{type:Object,required:!0},visible:{type:Boolean,default:!1},isNewApp:{type:Boolean,default:!1},loading:{type:Boolean,default:!1}},emits:["update:modelValue","update:visible","save","cancel"],setup(s,{emit:t}){const{t:e}=X(),n=s,i=q({get:()=>n.visible,set:m=>l("update:visible",m)}),o=q(()=>!n.modelValue.id),l=t;ae(),at();const a=q({get:()=>n.modelValue,set:m=>l("update:modelValue",m)}),r=q({get:()=>{var m;return((m=a.value)==null?void 0:m.enabled)===void 0?!0:!!a.value.enabled},set:m=>{a.value={...a.value,enabled:m}}}),c=I([{name:"ChatWoot",value:"chatwoot",label:"chatwoot"}]),h=I(!1);ce(()=>a.value,m=>{m.id||(a.value={...m,id:p()}),m.enabled===void 0&&(a.value={...m,enabled:!0})},{immediate:!0});function p(){return xn()}function y(){if(h.value=!0,!(!a.value.id||!a.value.app||!a.value.session)){if(a.value.app==="chatwoot"){const m=a.value.config;if(!m||!m.url||!m.accountId||!m.accountToken||!m.inboxId||!m.inboxIdentifier||!m.locale)return}l("save",a.value)}}function v(){h.value=!1,l("update:visible",!1),l("cancel")}return(m,f)=>{const b=Ne,$=Nt,k=cs,T=te,C=rt;return w(),M(C,{visible:i.value,"onUpdate:visible":f[4]||(f[4]=_=>i.value=_),modal:!0,class:"p-fluid",header:n.isNewApp?d(e)("apps.addAppTitle"):d(e)("apps.editAppTitle")},{footer:O(()=>[g(T,{label:d(e)("apps.cancel"),icon:"pi pi-times",onClick:v,text:"",severity:"secondary"},null,8,["label"]),g(T,{label:o.value?d(e)("apps.add"):d(e)("apps.save"),icon:o.value?"pi pi-plus":"pi pi-check",onClick:y,loading:n.loading,text:""},null,8,["label","icon","loading"])]),default:O(()=>[u("div",wd,[u("div",kd,[u("label",Sd,[u("b",null,S(d(e)("apps.appId")),1)]),g(b,{id:"id",modelValue:a.value.id,"onUpdate:modelValue":f[0]||(f[0]=_=>a.value.id=_),disabled:!n.isNewApp,placeholder:"Automatically generated"},null,8,["modelValue","disabled"]),h.value&&!a.value.id?(w(),A("small",$d,S(d(e)("apps.appIdRequired")),1)):D("",!0)]),u("div",Cd,[u("label",Od,[u("b",null,S(d(e)("apps.appType")),1)]),g($,{id:"app-type",modelValue:a.value.app,"onUpdate:modelValue":f[1]||(f[1]=_=>a.value.app=_),options:c.value,optionLabel:"name",optionValue:"value",placeholder:d(e)("apps.selectAppType"),class:fe({"p-invalid":h.value&&!a.value.app}),disabled:!n.isNewApp},{value:O(_=>[_.value?(w(),A("div",Td,[_.value==="chatwoot"?(w(),M(js,{key:0})):D("",!0)])):(w(),A("span",Nd,S(_.placeholder),1))]),option:O(_=>[_.option.value==="chatwoot"?(w(),M(js,{key:0})):D("",!0)]),_:1},8,["modelValue","options","placeholder","class","disabled"]),h.value&&!a.value.app?(w(),A("small",Ad,S(d(e)("apps.appTypeRequired")),1)):D("",!0)]),u("div",Id,[u("label",null,[u("b",null,S(d(e)("apps.enabled.label.edit")),1)]),u("div",null,[g(k,{modelValue:r.value,"onUpdate:modelValue":f[2]||(f[2]=_=>r.value=_),onIcon:"pi pi-check",offIcon:"pi pi-times",onLabel:d(e)("apps.enabled.on"),offLabel:d(e)("apps.enabled.off")},null,8,["modelValue","onLabel","offLabel"])])]),a.value.app?(w(),A("div",Ld,[u("label",null,[u("b",null,S(d(e)("apps.appFAQ")),1)]),a.value.app==="chatwoot"?(w(),M(hd,{key:0,app:a.value,session:a.value.session||""},null,8,["app","session"])):D("",!0),u("label",null,[u("b",null,S(d(e)("apps.appConfiguration")),1)]),u("div",Ed,[a.value.app==="chatwoot"?(w(),M(nd,{key:0,modelValue:a.value.config,"onUpdate:modelValue":f[3]||(f[3]=_=>a.value.config=_),server:s.server,submitted:h.value},null,8,["modelValue","server","submitted"])):D("",!0)])])):D("",!0)])]),_:1},8,["visible","header"])}}}),Dd=Pe(Vd,[["__scopeId","data-v-236f024b"]]),Bd={class:"app-list"},xd={class:"flex justify-content-between align-items-center w-full mb-2"},Md={class:"mb-0"},Pd={class:"pi pi-info-circle"},jd={class:"text-center p-4"},Ud={class:"flex gap-2 justify-content-end"},Rd=Tt({__name:"AppList",props:{server:Object,session:Object,isNewSession:{type:Boolean,default:!1}},setup(s){const t=$t(),e=On(),n=ae(),i=at(),{t:o}=X(),l=s,a=I([]),r=I(!1),c=I(!1),h=I(null),p=I(!1);ls(async()=>{await y()}),ce(()=>[l.server,l.session],async()=>{await y()},{deep:!0});async function y(){if(!l.server||!l.session||!l.session.name){a.value=[];return}try{r.value=!0,a.value=await i(n.getApps(l.server.id,l.session.name),void 0,o("apps.failedToLoad"))}catch(C){console.error("Error loading apps:",C)}finally{r.value=!1}}function v(){if(l.isNewSession){t.add({severity:"info",summary:"Info",detail:o("apps.createSessionFirst"),life:3e3});return}h.value={id:$(),session:l.session.name,app:"chatwoot",config:{},enabled:!0},p.value=!0,c.value=!0}function m(C){h.value={...C},p.value=!1,c.value=!0}function f(C,_){const L=T(C.app);e.require({target:_.currentTarget,message:o("apps.deleteConfirm",{appType:L,id:C.id}),icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-danger p-button-sm",rejectLabel:o("apps.no"),acceptLabel:o("apps.yesDelete"),accept:async()=>{await b(C)},reject:()=>{}})}async function b(C){try{await i(n.deleteApp(l.server.id,C.id),void 0,o("apps.failedToDelete"));const _=T(C.app);t.add({severity:"success",summary:o("apps.deleted"),detail:`${_} (${C.id})`,life:3e3}),await y()}catch(_){console.error("Error deleting app:",_)}}function $(){return xn()}async function k(C){try{const _=T(C.app);return p.value?(await i(n.createApp(l.server.id,C),void 0,o("apps.failedToCreate")),t.add({severity:"success",summary:o("apps.created"),detail:`${_} (${C.id})`,life:3e3})):(await i(n.updateApp(l.server.id,C),void 0,o("apps.failedToUpdate")),t.add({severity:"success",summary:o("apps.updated"),detail:`${_} (${C.id})`,life:3e3})),await y(),c.value=!1,!0}catch(_){return console.error("Error saving app:",_),!1}}function T(C){switch(C){case"chatwoot":return"ChatWoot";default:return C}}return(C,_)=>{const L=te,x=as,N=Zr,W=rs,J=Ks,Z=oe("tooltip");return w(),A("div",Bd,[u("div",xd,[u("div",null,[u("h5",Md,[H(S(d(o)("apps.title"))+" ",1),K(u("i",Pd,null,512),[[Z,d(o)("apps.builtInIntegrations")]])])]),u("div",null,[g(L,{label:d(o)("apps.addApp"),icon:"pi pi-plus",onClick:v,severity:"success",text:""},null,8,["label"])])]),g(W,{value:a.value,loading:r.value,dataKey:"id",paginator:a.value.length>10,rows:10,showGridlines:""},{empty:O(()=>[u("div",jd,S(d(o)("apps.noAppsFound")),1)]),default:O(()=>[g(x,{field:"app",header:d(o)("apps.appType")},{body:O(({data:F})=>[F.app==="chatwoot"?(w(),M(js,{key:0})):(w(),A(ee,{key:1},[H(S(T(F.app)),1)],64))]),_:1},8,["header"]),g(x,{field:"id",header:d(o)("apps.id")},null,8,["header"]),g(x,{header:d(o)("apps.enabled.label.list"),style:{width:"10rem"}},{body:O(({data:F})=>[g(N,{enabled:F.enabled!==!1},null,8,["enabled"])]),_:1},8,["header"]),g(x,{style:{width:"10rem","text-align":"right"}},{body:O(({data:F})=>[u("div",Ud,[K(g(L,{icon:"pi pi-pencil",onClick:me=>m(F),outlined:"",rounded:"",severity:"success"},null,8,["onClick"]),[[Z,d(o)("apps.editApp"),void 0,{top:!0}]]),K(g(L,{icon:"pi pi-trash",onClick:me=>f(F,me),outlined:"",rounded:"",severity:"danger"},null,8,["onClick"]),[[Z,d(o)("apps.deleteApp"),void 0,{top:!0}]])])]),_:1})]),_:1},8,["value","loading","paginator"]),g(J),h.value?(w(),M(Dd,{key:0,modelValue:h.value,"onUpdate:modelValue":_[0]||(_[0]=F=>h.value=F),server:s.server,visible:c.value,"onUpdate:visible":_[1]||(_[1]=F=>c.value=F),isNewApp:p.value,loading:r.value,onSave:k,onCancel:_[2]||(_[2]=F=>c.value=!1)},null,8,["modelValue","server","visible","isNewApp","loading"])):D("",!0)])}}}),qd=Pe(Rd,[["__scopeId","data-v-85accdce"]]),Kd={class:"w-full flex flex-column gap-2"},Fd={key:0},Wd=["innerHTML"],Hd={class:"flex justify-content-end"},Jd={__name:"AppsDialog",props:{visible:{},visibleModifiers:{},session:{},sessionModifiers:{},server:{},serverModifiers:{}},emits:["update:visible","update:session","update:server"],setup(s){const{t}=X(),e=ue(s,"visible"),n=ue(s,"session"),i=ue(s,"server"),o=q(()=>n.value.status==="STOPPED");function l(){e.value=!1}return(a,r)=>{const c=te,h=rt;return w(),M(h,{visible:e.value,"onUpdate:visible":r[0]||(r[0]=p=>e.value=p),modal:!0,class:"p-fluid",maximizable:"",style:{"min-width":"50%"}},{header:O(()=>[g(It,{session:n.value},null,8,["session"])]),footer:O(()=>[u("div",Kd,[o.value?D("",!0):(w(),A("div",Fd,[g(d(Ws),{severity:"warn"},{default:O(()=>[u("span",{innerHTML:d(t)("apps.sessionStatusWarning",{status:n.value.status})},null,8,Wd)]),_:1})])),u("div",Hd,[g(c,{label:d(t)("apps.close"),icon:"pi pi-times",text:"",onClick:l,severity:"secondary"},null,8,["label"])])])]),default:O(()=>[g(qd,{server:i.value,session:n.value,isNewSession:!1},null,8,["server","session"])]),_:1},8,["visible"])}}},Gd={class:"flex justify-content-between"},Qd={class:"flex align-items-center gap-1"},Yd=u("i",{class:"pi pi-whatsapp"},null,-1),zd={class:"mr-1"},Xd=["disabled"],Zd=u("i",{class:"pi pi-refresh"},null,-1),ef=[Zd],tf={class:"flex justify-content-between flex-column sm:flex-row gap-2 sm:gap-0"},sf={class:"flex flex-column"},nf={class:"flex justify-content-between flex-column sm:flex-row gap-2 sm:gap-2"},of={style:{"text-align":"left"},class:"flex flex-column"},lf={class:"text-center"},af={class:"flex gap-2"},rf={class:"my-auto"},cf={key:0,class:"pi pi-info-circle text-orange-400"},uf={class:"flex flex-row gap-2 justify-content-end",style:{order:"2"}},Jf={__name:"SessionTable",setup(s){const t=$t(),{t:e}=X(),n=ae(),{visibleSessions:i,refreshing:o,servers:l}=Us(n),a=I({config:{webhooks:[]}}),r=I(!1),c=I(void 0),h=I(!1),p=I(!1),y=I(!1),v=I(null),m=I(10);I(null);const f=I({}),b=I(null),$=I([]),k=q(()=>$.value.filter(U=>N.value[`session-action-${U.server.id}-${U.name}`])),T=I(!1),C=I(!1),_=I(!1),L=I(!1),x=I(!1),N=I({});function W(U,E){switch(U){case"startSession":T.value=E;break;case"restartSession":C.value=E;break;case"stopSession":_.value=E;break;case"logoutSession":L.value=E;break;case"deleteSession":x.value=E;break}}async function J(U){W(U,!0);try{for(const E of k.value)await N.value[`session-action-${E.server.id}-${E.name}`][U]()}finally{W(U,!1)}}so(()=>{N.value=[]}),no(()=>{Ut()});const Z=I([{field:"name",header:e("sessions.name")},{field:"metadata",header:e("sessions.metadata")},{field:"me",header:e("sessions.me")},{field:"status",header:e("sessions.status")},{field:"server",header:e("sessions.server")}]);function F(){return JSON.parse(localStorage.getItem("sessions.table.columns.hidden"))||[]}const me=F(),ge=I(ve.differenceBy(Z.value,me,"field")),Ae=U=>{ge.value=Z.value.filter(E=>U.includes(E))};function Ie(U){return!ge.value||ge.value.length===0?!0:ve.find(ge.value,{field:U})}const Dt=q(()=>Ie("name")),Bt=q(()=>Ie("metadata")),xt=q(()=>Ie("me")),Mt=q(()=>Ie("status")),Pt=q(()=>Ie("server")),jt=q(()=>ve.differenceBy(Z.value,ge.value,"field"));ce(()=>jt.value,U=>{localStorage.setItem("sessions.table.columns.hidden",JSON.stringify(U))},{deep:!0});const Ut=()=>{f.value={global:{value:null,matchMode:mt.CONTAINS},status:{value:null,matchMode:mt.EQUALS},"server.id":{value:null,matchMode:mt.EQUALS},name:{value:null,matchMode:mt.CONTAINS},"me.id":{value:null,matchMode:mt.CONTAINS}}};function Rt(){const U=l.value.find(E=>E.connected);if(!U){t.add({severity:"error",summary:e("sessions.noConnectedServer"),detail:e("sessions.pleaseConnectToServerFirst"),life:3e3});return}a.value={server:U.id,name:"",config:{metadata:{},webhooks:[],noweb:{markOnline:!0,store:{enabled:!0,fullSync:!0}},webjs:{tagsEventsOn:!1},ignore:null,proxy:{}}},c.value="new",r.value=!0}function j(U){a.value=ve.cloneDeep({name:U.name,status:U.status,server:U.server.id,config:U.config}),c.value="update",r.value=!0}function B(){is("store",async()=>await n.refresh())}function Le(U){h.value=!0,a.value=U}function $e(U){a.value=U,p.value=!0}function He(U){a.value=U,v.value=U.server,y.value=!0}ce(p,U=>{U||(a.value={config:{webhooks:[]}})});const Ee=q(()=>["name","me.id","me.pushName","_metadata"]);return(U,E)=>{const Ve=Cn,Ce=te,Je=$o,Ge=io,De=Ne,we=oo,Cs=Tn,ne=as,R=To,Pi=Gs,ji=Mo,dn=Ln,Ui=Nt,Ri=En,qi=jn,Ki=Uo,Fi=rs,Wi=Ks,Hi=Al,Ji=oa,Gi=Sr,qt=oe("tooltip");return w(),A(ee,null,[u("div",Gd,[u("div",null,[u("h5",Qd,[Yd,u("span",zd,S(d(e)("sessions.title")),1),g(Ve,{refreshing:d(o)},null,8,["refreshing"])])]),u("div",null,[K((w(),A("button",{onClick:B,class:"p-link layout-topbar-button",disabled:d(o)},ef,8,Xd)),[[qt,d(e)("sessions.refresh"),void 0,{top:!0}]])])]),g(Fi,{selection:$.value,"onUpdate:selection":E[8]||(E[8]=V=>$.value=V),value:d(i).length>0?d(i):[],paginator:!0,rows:m.value,rowsPerPageOptions:[5,10,20,50,100,500],dataKey:V=>`${V.server.id}-${V.name}`,rowHover:!0,filters:f.value,"onUpdate:filters":E[9]||(E[9]=V=>f.value=V),filterDisplay:"row",loading:b.value,globalFilterFields:d(Ee),showGridlines:"",style:{"white-space":"nowrap"},sortField:"name",sortOrder:1,resizableColumns:""},{header:O(()=>[u("div",tf,[u("div",sf,[g(Ce,{label:d(e)("sessions.startNew"),icon:"pi pi-play",severity:"success",onClick:Rt},null,8,["label"])]),u("div",nf,[g(Je),u("div",null,[g(we,{iconPosition:"left"},{default:O(()=>[g(Ge,{class:"pi pi-search"}),g(De,{modelValue:f.value.global.value,"onUpdate:modelValue":E[0]||(E[0]=V=>f.value.global.value=V),placeholder:d(e)("sessions.searchByNamePhoneMetadata"),style:{width:"100%"}},null,8,["modelValue","placeholder"])]),_:1})]),u("div",of,[g(Cs,{placeholder:d(e)("sessions.columns"),modelValue:ge.value,options:Z.value,optionLabel:"header",selectedItemsLabel:d(e)("sessions.columns"),maxSelectedLabels:0,"onUpdate:modelValue":Ae},null,8,["placeholder","modelValue","options","selectedItemsLabel"])])])])]),empty:O(()=>[H(S(d(e)("sessions.noSessionsFound")),1)]),loading:O(()=>[H(S(d(e)("sessions.loadingSessions")),1)]),default:O(()=>[g(ne,{selectionMode:"multiple",headerStyle:"width: 3rem"}),d(Dt)?(w(),M(ne,{key:0,field:"name",header:d(e)("sessions.name"),"show-filter-menu":!1,sortable:""},{filter:O(({filterModel:V,filterCallback:de})=>[g(De,{modelValue:f.value.name.value,"onUpdate:modelValue":E[1]||(E[1]=ye=>f.value.name.value=ye),type:"text",placeholder:d(e)("sessions.session")},null,8,["modelValue","placeholder"])]),_:1},8,["header"])):D("",!0),d(Bt)?(w(),M(ne,{key:1,header:d(e)("sessions.metadata")},{body:O(({data:V})=>{var de;return[g(R,{metadata:(de=V.config)==null?void 0:de.metadata},null,8,["metadata"])]}),_:1},8,["header"])):D("",!0),d(xt)?(w(),M(ne,{key:2,header:d(e)("sessions.me")},{body:O(({data:V})=>[u("div",lf,[g(Pi,{session:V},null,8,["session"])])]),filter:O(({filterModel:V,filterCallback:de})=>[g(De,{modelValue:f.value["me.id"].value,"onUpdate:modelValue":E[2]||(E[2]=ye=>f.value["me.id"].value=ye),type:"text",placeholder:d(e)("sessions.mePhoneNumber")},null,8,["modelValue","placeholder"])]),_:1},8,["header"])):D("",!0),d(Mt)?(w(),M(ne,{key:3,field:"status",header:d(e)("sessions.status"),showFilterMenu:!1,style:{width:"9rem"}},{body:O(({data:V})=>[u("div",af,[u("div",null,[g(Xr,{session:V},null,8,["session"])]),u("div",null,[g(ji,{session:V},null,8,["session"])]),u("div",null,[K(g(Ce,{icon:"pi pi-whatsapp",severity:"",rounded:"",outlined:"",disabled:V.status!=="WORKING",onClick:de=>$e(V)},null,8,["disabled","onClick"]),[[qt,d(e)("sessions.chatUI"),void 0,{top:!0}]])]),u("div",null,[K(g(Ce,{icon:"pi pi-code",severity:"secondary",rounded:"",outlined:"",onClick:de=>Le(V)},null,8,["onClick"]),[[qt,d(e)("sessions.sendRequest"),void 0,{top:!0}]])]),u("div",rf,[g(dn,{status:V.status},null,8,["status"])])])]),filter:O(({filterModel:V,filterCallback:de})=>[g(Ui,{modelValue:V.value,"onUpdate:modelValue":ye=>V.value=ye,options:d($r),onChange:ye=>de(),placeholder:d(e)("sessions.any"),class:"p-column-filter",showClear:!0},{option:O(({option:ye})=>[g(dn,{status:ye},null,8,["status"])]),_:2},1032,["modelValue","onUpdate:modelValue","options","onChange","placeholder"])]),_:1},8,["header"])):D("",!0),d(Pt)?(w(),M(ne,{key:4,field:"server.name",filterField:"server.id",header:d(e)("sessions.server"),showFilterMenu:!1},{filter:O(({filterModel:V,filterCallback:de})=>[g(Ri,{placeholder:d(e)("sessions.any"),onChange:ye=>de(),modelValue:V.value,"onUpdate:modelValue":ye=>V.value=ye,showClear:!0,required:!1},null,8,["placeholder","onChange","modelValue","onUpdate:modelValue"])]),body:O(({data:V})=>[H(S(V.server.name)+" ",1),V.assignedWorker&&V.server.name!==V.assignedWorker?K((w(),A("i",cf,null,512)),[[qt,`${d(e)("sessions.assignedWorkerIdDoesNotMatch")}

👉 ${d(e)("sessions.assignedWorkerId")}: ${V.assignedWorker}`]]):D("",!0)]),_:1},8,["header"])):D("",!0),g(ne,{showFilterMenu:!1},{filter:O(()=>[u("div",uf,[g(qi,{group:"dialog",name:`'${d(k).length}' sessions`,"all-disabled":d(k).length===0,"hide-actions":["view","apps"],"is-starting":T.value,"is-restarting":C.value,"is-stopping":_.value,"is-logging-out":L.value,"is-removing":x.value,onStart:E[3]||(E[3]=V=>J("startSession")),onRestart:E[4]||(E[4]=V=>J("restartSession")),onStop:E[5]||(E[5]=V=>J("stopSession")),onLogout:E[6]||(E[6]=V=>J("logoutSession")),onDelete:E[7]||(E[7]=V=>J("deleteSession"))},null,8,["name","all-disabled","is-starting","is-restarting","is-stopping","is-logging-out","is-removing"])])]),body:O(({data:V})=>[g(Ki,{ref:de=>{N.value[`session-action-${V.server.id}-${V.name}`]=de},session:V,disabled:d(k).length!==0,onView:j,onApps:He},null,8,["session","disabled"])]),_:1})]),_:1},8,["selection","value","rows","dataKey","filters","loading","globalFilterFields"]),g(Wi),g(Hi,{visible:p.value,"onUpdate:visible":E[10]||(E[10]=V=>p.value=V),session:a.value,"onUpdate:session":E[11]||(E[11]=V=>a.value=V)},null,8,["visible","session"]),g(Ji,{visible:h.value,"onUpdate:visible":E[12]||(E[12]=V=>h.value=V),session:a.value,"onUpdate:session":E[13]||(E[13]=V=>a.value=V)},null,8,["visible","session"]),g(Gi,{visible:r.value,"onUpdate:visible":E[14]||(E[14]=V=>r.value=V),session:a.value,"onUpdate:session":E[15]||(E[15]=V=>a.value=V),mode:c.value},null,8,["visible","session","mode"]),g(Jd,{visible:y.value,"onUpdate:visible":E[16]||(E[16]=V=>y.value=V),session:a.value,"onUpdate:session":E[17]||(E[17]=V=>a.value=V),server:v.value,"onUpdate:server":E[18]||(E[18]=V=>v.value=V)},null,8,["visible","session","server"])],64)}}};export{$o as _,Jf as a};
