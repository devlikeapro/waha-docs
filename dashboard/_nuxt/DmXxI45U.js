import{u as be,_ as Fe}from"./D_fh1JmE.js";import G from"./B26c7h_H.js";import Ds from"./BUiAOtoR.js";import{u as Q,a as Rs,s as ce,C as ue,W as Es,l as se}from"./CApVz2PD.js";import{R as Te,O as X,N as d,t as a,v as b,P as M,x as e,z as l,W as ye,_ as $e,T as j,X as me,y as B,U as D,L as R,A as p,r as h,o as We,c as U,Y as Ps,B as P,Z as he,M as He,H as ee,$ as Ns,a0 as Ke,a1 as Z,Q as we,a2 as Ts,C as Os,D as Us,a3 as ve,i as ze,a4 as Is,a5 as Ge,a6 as Ms,V as Ls,S as pe}from"./BUgfOEvf.js";import As from"./BAz8ZKEc.js";import de from"./DJDYLUFq.js";import js from"./CxT5MWoU.js";import Qe from"./BAlOQxOm.js";import Oe from"./B1oxaWub.js";import Xe from"./dj_vLwL7.js";import Ye from"./fB5yvR4A.js";import Je from"./Qa00ZqPo.js";import Bs from"./D1_4I9IM.js";import{u as Ue,_ as Ze}from"./Bruop_ER.js";import Ie from"./Ckur-ebU.js";import{_ as Hs,a as qs,b as es}from"./DQVe8rvM.js";import ss from"./o4FhNtjG.js";import Fs from"./DtJBeo54.js";import Me from"./BrN7reVM.js";import{_ as Ws}from"./UHbOh-rn.js";import Ks from"./CWdkhdup.js";import zs from"./Dgo96mep.js";import Gs from"./DXpRs9Jz.js";import Se from"./C72n6ajW.js";import ts from"./Dmmk295T.js";import os from"./BNJpZcsk.js";import Qs from"./BP9VeJEc.js";import Xs from"./DvwUVvFO.js";import ns from"./CTW-GyTr.js";import ls from"./DycnngSg.js";import is from"./BM3u7ZT9.js";import Ys from"./DREJu1z3.js";import Js from"./CAlDgt1t.js";import Zs from"./BskPhBQD.js";import et from"./c3XGlhQj.js";function st(t){return t?Object.keys(t).map(n=>({key:n,value:t[n]})):[]}function tt(t){return t.reduce((n,o)=>(n[o.key]=o.value,n),{})}const ot={key:0},nt={key:1,class:"ml-auto flex align-items-center gap-2 mr-2"},lt=e("label",{for:"show-duplicates"},"Hide Duplicates",-1),it={class:"pi pi-info-circle"},at={__name:"HideDuplicates",setup(t){const n=Q(),{hideDuplicatedSessions:o,servers:s}=Te(n);return n.$subscribe((i,m)=>{Rs(m.hideDuplicatedSessions)}),(i,m)=>{const u=Ds,c=X("tooltip");return d(s)&&d(s).length<2?(a(),b("div",ot)):(a(),b("div",nt,[lt,M(e("i",it,null,512),[[c,`Hide STOPPED sessions with the same "name" .
Useful when you use multiple workers with the same database`]]),l(u,{id:"show-duplicates",modelValue:d(o),"onUpdate:modelValue":m[0]||(m[0]=r=>ye(o)?o.value=r:null)},null,8,["modelValue"])]))}}},rt={class:"metadata"},ut={__name:"Metadata",props:["metadata"],setup(t){return(n,o)=>(a(),b("div",rt,[(a(!0),b(j,null,me(t.metadata,(s,i)=>(a(),b("pre",{key:i},B(i)+"="+B(s),1))),128))]))}},ct=$e(ut,[["__scopeId","data-v-cb7cbf08"]]),dt={key:0,class:"text-center p-1"},pt={class:"text-center"},mt=e("i",{class:"mr-3 pi pi-user",style:{color:"#34d399"}},null,-1),ge={__name:"ContactChip",props:{id:String,name:String,image:String},setup(t){return(n,o)=>{const s=Xe;return a(),b("div",null,[t.name?(a(),b("div",dt,[e("b",pt,B(t.name),1)])):D("",!0),t.id?(a(),R(s,{key:1,label:t.id,image:t.image,icon:"pi pi-user"},{icon:p(()=>[mt]),_:1},8,["label","image"])):D("",!0)])}}},Le={__name:"SessionChip",props:{session:Object},setup(t){const n=t,o=Q(),s=h(null);return We(()=>{var i,m,u;(m=(i=n.session)==null?void 0:i.me)!=null&&m.id&&((u=n.session)==null?void 0:u.status)==="WORKING"&&o.getProfilePicture(n.session.server.id,n.session.name,n.session.me.id).then(c=>{s.value=c.profilePictureURL})}),(i,m)=>{var u,c,r,v;return a(),R(ge,{id:(c=(u=n.session)==null?void 0:u.me)==null?void 0:c.id,name:(v=(r=n.session)==null?void 0:r.me)==null?void 0:v.pushName,image:d(s)},null,8,["id","name","image"])}}},fe={__name:"RefreshButton",props:["refreshing"],setup(t){const n=t,o=U(()=>n.refreshing?"pi pi-refresh pi-spin":"pi pi-refresh");return(s,i)=>{const m=G;return a(),R(m,{icon:d(o),rounded:"",text:"",disabled:t.refreshing},null,8,["icon","disabled"])}}},vt=["src"],as={__name:"Base64Img",props:{data:String,mimetype:String},setup(t){const n=t,o=U(()=>`data:${n.mimetype};base64, ${n.data}`);return(s,i)=>(a(),b("img",{src:o.value,style:{"max-width":"100%"}},null,8,vt))}},ft={key:2,style:{"background-color":"#f8f9fa",padding:"1rem",color:"red","white-space":"pre-wrap"}},rs={__name:"SessionScreenshot",props:{session:Object},setup(t,{expose:n}){const o=Q(),s=t,{data:i,pending:m,error:u,refresh:c}=be(`session-screenshot-${s.session.server.id}-${s.session.name}`,async()=>(await ce(1e3),await o.getScreenshot(s.session.server.id,s.session.name)));return n({refresh:c}),(r,v)=>{const w=Ye,k=Je,g=as;return a(),b(j,null,[d(m)?(a(),b(j,{key:0},[l(w,{mode:"indeterminate",style:{height:"3px"}}),!d(i)&&!d(u)?(a(),R(k,{key:0,width:"100%",height:"20rem"})):D("",!0)],64)):D("",!0),d(i)?(a(),R(g,{key:1,data:d(i).data,mimetype:d(i).mimetype},null,8,["data","mimetype"])):D("",!0),d(u)?(a(),b("pre",ft,""+B(d(u).cause.response.data.message||d(u).cause.response.data||d(u))+`
  `,1)):D("",!0)],64)}}},_t={class:"",style:{"min-width":"20rem"}},ht={class:"flex justify-content-center align-items-center"},gt=e("h5",{class:"m-0"},"Screenshot",-1),bt={class:"m-auto w-full"},yt={__name:"ScreenshotButton",props:["session"],setup(t){const n=t,o=h(null),s=h(null),i=c=>{o.value.toggle(c)},m=()=>{s.value.refresh()},u=U(()=>n.session.status==="STOPPED");return(c,r)=>{const v=G,w=fe,k=rs,g=Bs,V=X("tooltip");return a(),b(j,null,[M(l(v,{disabled:d(u),type:"button",icon:"pi pi-camera",onClick:i,rounded:"",outlined:"",severity:"help"},null,8,["disabled"]),[[V,"Screenshot / QR",void 0,{top:!0}]]),l(g,{ref_key:"op",ref:o,appendTo:"body",showCloseIcon:!0},{default:p(()=>[e("div",_t,[e("div",ht,[gt,l(w,{onClick:m})]),e("div",bt,[l(k,{ref_key:"screenshot",ref:s,session:t.session},null,8,["session"])])])]),_:1},512)],64)}}},$t={class:"flex flex-row gap-2 justify-content-end"},us={__name:"SessionActionButtons",props:["name","isStarting","isRestarting","isStopping","isLoggingOut","isRemoving","allDisabled","hideActions","skipConfirmation","group"],emits:["view","start","restart","stop","logout","delete"],setup(t,{emit:n}){const o=Ps(),s=t,i=n;function m(g){return s.skipConfirmation?!s.skipConfirmation.includes(g):!0}async function u(){if(!m("start")){i("start");return}o.require({group:s.group,target:event.target,message:`Start ${s.name}?`,icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-success p-button-sm",rejectLabel:"No",acceptLabel:"Yes, Start",accept:()=>{i("start")},reject:()=>{}})}const c=U(()=>s.hideActions?!s.hideActions.includes("view"):!0);function r(g){o.require({group:s.group,target:g.target,message:`Restart ${s.name}?`,icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-info p-button-sm",rejectLabel:"No",acceptLabel:"Yes, Restart",accept:()=>{i("restart")},reject:()=>{}})}function v(g){o.require({group:s.group,target:g.target,message:`Stop ${s.name}?`,icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-warning p-button-sm",rejectLabel:"No",acceptLabel:"Yes, Stop",accept:async()=>{i("stop")},reject:()=>{}})}function w(g){o.require({group:s.group,target:g.target,message:`Logout ${s.name}?`,icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-warning p-button-sm",rejectLabel:"No",acceptLabel:"Yes, Logout",accept:async()=>{i("logout")},reject:()=>{}})}function k(g){o.require({group:s.group,target:g.target,message:`Delete ${s.name}?`,icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-danger p-button-sm",rejectLabel:"No",acceptLabel:"Yes, Delete",accept:async()=>{i("delete")},reject:()=>{}})}return(g,V)=>{const y=G,C=ss,f=Fs,E=X("tooltip");return a(),b(j,null,[e("div",$t,[d(c)?M((a(),R(y,{key:0,icon:"pi pi-cog",severity:"help",rounded:"",outlined:"",onClick:V[0]||(V[0]=A=>g.$emit("view")),disabled:t.allDisabled},null,8,["disabled"])),[[E,"Configuration",void 0,{top:!0}]]):D("",!0),M(l(y,{icon:"pi pi-play",severity:"success",rounded:"",outlined:"",onClick:u,loading:t.isStarting,disabled:t.allDisabled},null,8,["loading","disabled"]),[[E,"Start",void 0,{top:!0}]]),M(l(y,{icon:"pi pi-replay",severity:"info",rounded:"",outlined:"",onClick:V[1]||(V[1]=A=>r(A)),loading:t.isRestarting,disabled:t.allDisabled},null,8,["loading","disabled"]),[[E,"Restart",void 0,{top:!0}]]),M(l(y,{icon:"pi pi-stop",severity:"secondary",rounded:"",outlined:"",onClick:V[2]||(V[2]=A=>v(A)),loading:t.isStopping,disabled:t.allDisabled},null,8,["loading","disabled"]),[[E,"Stop",void 0,{top:!0}]]),M(l(y,{icon:"pi pi-sign-out",severity:"warning",rounded:"",outlined:"",onClick:V[3]||(V[3]=A=>w(A)),loading:t.isLoggingOut,disabled:t.allDisabled},null,8,["loading","disabled"]),[[E,"Logout",void 0,{top:!0}]]),M(l(y,{icon:"pi pi-trash",severity:"danger",rounded:"",outlined:"",onClick:V[4]||(V[4]=A=>k(A)),loading:t.isRemoving,disabled:t.allDisabled},null,8,["loading","disabled"]),[[E,"Delete",void 0,{top:!0}]])]),t.group==="popup"?(a(),R(C,{key:0,group:"popup"})):D("",!0),t.group==="dialog"?(a(),R(f,{key:1,group:"dialog"})):D("",!0)],64)}}},wt={class:"flex flex-row gap-2 justify-content-end"},St={__name:"SessionActions",props:["session","disabled"],setup(t,{expose:n}){const o=t,s=Q(),i=Ue(),m=h(!1),u=h(!1),c=h(!1),r=h(!1),v=h(!1),w=U(()=>o.disabled||m.value||u.value||c.value||r.value||v.value);async function k(){const f=o.session;r.value=!0,await i(s.startSession(f.server.id,f.name),"Started","Failed to start session",f.name,f.name).finally(()=>r.value=!1)}async function g(){const f=o.session;v.value=!0,await i(s.restartSession(f.server.id,f.name),"Restarted","Failed to restart session",f.name,f.name).finally(()=>v.value=!1)}async function V(){const f=o.session;m.value=!0,await i(s.stopSession(f.server.id,f.name),"Stopped","Failed to stop session",f.name,f.name).finally(()=>m.value=!1)}async function y(){const f=o.session;u.value=!0,await i(s.logoutSession(f.server.id,f.name),"Logged out","Failed to logout session",f.name,f.name).finally(()=>u.value=!1)}async function C(){const f=o.session;c.value=!0,await i(s.deleteSession(f.server.id,f.name),"Deleted","Failed to delete session",f.name,f.name).finally(()=>c.value=!1)}return n({startSession:k,restartSession:g,stopSession:V,logoutSession:y,deleteSession:C}),(f,E)=>{const A=us;return a(),b("div",wt,[l(A,{group:"popup",name:`'${t.session.name}' session`,onView:E[0]||(E[0]=H=>f.$emit("view",t.session)),onStart:k,onRestart:g,onStop:V,onLogout:y,onDelete:C,"is-starting":d(r),"is-restarting":d(v),"is-stopping":d(m),"is-logging-out":d(u),"is-removing":d(c),"all-disabled":d(w),"hide-actions":[],"skip-confirmation":["start"]},null,8,["name","is-starting","is-restarting","is-stopping","is-logging-out","is-removing","all-disabled"])])}}},xt={class:"p-dialog-title flex gap-2 align-items-center"},kt=e("i",{class:"pi pi-whatsapp"},null,-1),Ct=e("span",null,"(",-1),Vt={class:"ml-1"},Dt=e("span",null,")",-1),Rt=["disabled"],Et=e("i",{class:"pi pi-refresh"},null,-1),Pt=[Et],xe={__name:"SessionHeader",props:{session:Object,refresh:Boolean},setup(t){const n=t,o=Q(),{refreshing:s}=Te(o),i=U(()=>n.session.server.id?n.session.server:o.getServer(n.session.server));async function m(){await o.refresh()}return(u,c)=>{var g,V;const r=Ze,v=Ws,w=Fe,k=X("tooltip");return a(),b("div",xt,[kt,e("span",null,B((g=t.session)==null?void 0:g.name),1),l(r,{status:t.session.status,value:(V=t.session.status)==null?void 0:V.toUpperCase()},null,8,["status","value"]),e("div",null,[Ct,l(v,{connected:i.value.connected},null,8,["connected"]),e("span",Vt,B(i.value.name),1),Dt]),t.refresh?M((a(),b("button",{key:0,onClick:c[0]||(c[0]=y=>m()),class:"p-link layout-topbar-button",disabled:d(s)},Pt,8,Rt)),[[k,"Refresh",void 0,{top:!0}]]):D("",!0),l(w,{refreshing:d(s)},null,8,["refreshing"])])}}},Nt=e("b",null,"Chats UI",-1),Tt=e("br",null,null,-1),Ot=e("b",null,"Live Chat",-1),Ut=e("b",null,"Multiple Agents",-1),It=e("a",{href:"https://waha.devlike.pro/",target:"_blank"},[e("b",null," WAHA API ")],-1),Mt=e("br",null,null,-1),Lt=e("ul",null,[e("li",null,[e("a",{href:"https://waha.devlike.pro/docs/how-to/chats/",target:"_blank"},[e("b",null,"Chats API")]),P(" to get chats overview and messages ")]),e("li",null,[e("a",{href:"https://waha.devlike.pro/docs/how-to/send-messages/",target:"_blank"},[e("b",null,"Send API")]),P(" to send messages to chats ")]),e("li",null,[e("a",{href:"https://waha.devlike.pro/docs/how-to/webhooks/#messageack",target:"_blank"},[e("b",null,"Message ACK")]),P(" to get message status ")]),e("li",null,[e("a",{href:"https://waha.devlike.pro/docs/how-to/webhooks/#websockets",target:"_blank"},[e("b",null,"Websockets")]),P(" to get real-time messages on client side ")])],-1),At=e("a",{href:"https://github.com/devlikeapro/waha-hub/tree/main/ui/components/chat",target:"_blank"},[e("b",null,"Source Code on Github")],-1),jt=e("a",{href:"https://waha.devlike.pro/pricing/#tier-pro",target:"_blank"}," WAHA PRO ",-1),Bt={__name:"ChatPromo",emits:["close"],setup(t,{emit:n}){const o=n;return(s,i)=>{const m=Ks;return a(),R(m,{onClose:i[0]||(i[0]=u=>o("close"))},{default:p(()=>[P(" It's an example "),Nt,P("."),Tt,P(" You can implement "),Ot,P(", "),Ut,P(", and more features using "),It,P(" :"),Mt,Lt,P(" ðŸ‘‰ "),At,P(" (Vue3 + PrimeVue) available for "),jt,P(" supporters! ")]),_:1})}}},Ht={class:"flex"},cs={__name:"MessageAck",props:{ack:Number},setup(t){const n=t,o={ERROR:-1,PENDING:0,SERVER:1,DEVICE:2,READ:3,PLAYED:4},s=U(()=>{switch(n.ack){case o.ERROR:return"pi-exclamation-circle";case o.PENDING:return"pi-clock";case o.SERVER:return"pi-check";case o.DEVICE:return"pi-check";case o.READ:return"pi-check";case o.PLAYED:return"pi-microphone"}}),i=U(()=>{switch(n.ack){case o.ERROR:return"color: red";case o.PENDING:return"color: blue";case o.SERVER:return"";case o.DEVICE:return"";case o.READ:return"color: blue";case o.PLAYED:return"color: blue"}});return(m,u)=>(a(),b("div",Ht,[e("i",{class:he(["pi",d(s)]),style:He(d(i))},null,6),t.ack===o.READ||t.ack===o.DEVICE?(a(),b("i",{key:0,class:he(["pi",d(s)]),style:He([d(i),{"margin-left":"-0.7rem"}])},null,6)):D("",!0)]))}},qt={class:"p-2"},Ft=["innerHTML"],Wt={class:"flex flex-column justify-content-end",style:{height:"100%"}},Kt={__name:"ChatMessage",props:{message:Object},setup(t){return(n,o)=>{const s=Xe;return a(),R(s,null,{default:p(()=>[e("div",qt,[e("p",{innerHTML:t.message.body.replace(/\n/g,"<br>")},null,8,Ft)]),e("div",Wt,[l(cs,{ack:t.message.ack,class:"pb-2"},null,8,["ack"])])]),_:1})}}},zt={class:"flex flex-column gap-2"},Gt={__name:"ChatMessages",props:{messages:Array},setup(t){const n=t,o=h(null);async function s(){await ce(10),o.value&&(o.value.scrollTop=o.value.scrollHeight)}return ee(()=>n.messages,s),(i,m)=>{const u=Kt;return a(),b("div",{class:"my-2 pb-3",style:{width:"100%",height:"100%",overflow:"auto"},ref_key:"scroll",ref:o},[e("div",zt,[(a(!0),b(j,null,me(t.messages,c=>(a(),b(j,null,[c.body?(a(),b("div",{key:0,class:he({"flex justify-content-end":c.fromMe})},[(a(),R(u,{key:c.key,message:c},null,8,["message"]))],2)):D("",!0)],64))),256))])],512)}}},Qt={class:"flex justify-content-between gap-2 my-2"},Xt={class:"flex gap-2 align-items-center"},Yt={__name:"ChatHeader",props:{chat:Object,me:Object,mePicture:Object,fetching:Boolean,fetch:Function},setup(t){return(n,o)=>{var i;const s=fe;return a(),b("div",Qt,[e("div",Xt,[l(ge,{id:t.chat.name||t.chat.id,image:t.chat.picture},null,8,["id","image"])]),l(s,{onClick:t.fetch,refreshing:t.fetching},null,8,["onClick","refreshing"]),l(ge,{id:(i=t.me)==null?void 0:i.pushName,image:t.mePicture},null,8,["id","image"])])}}},Jt={class:"flex gap-1 mt-1"},qe=60,Zt={__name:"ChatPreview",props:{id:String,name:String,picture:String,message:Object},setup(t){const n=t,o=U(()=>{var i,m,u;return((i=n.message)==null?void 0:i.body)?((u=(m=n.message)==null?void 0:m.body)==null?void 0:u.length)>qe?n.message.body.slice(0,qe)+"...":n.message.body:""});return(s,i)=>(a(),b(j,null,[l(ge,{id:n.name||n.id,image:n.picture},null,8,["id","image"]),e("div",Jt,[d(o)?(a(),R(cs,{key:0,ack:t.message.ack,class:"pb-2"},null,8,["ack"])):D("",!0),P(" "+B(d(o)),1)])],64))}},eo={class:"flex justify-content-center align-items-center gap-1"},so=e("div",null," Last 20 Chats ",-1),to={__name:"ChatList",props:{chats:Array,pending:Boolean},emits:["clickOnChat","refreshChats"],setup(t,{emit:n}){const o=n;return(s,i)=>{const m=fe,u=Zt,c=Oe,r=Me;return a(),R(r,{value:t.chats,loading:t.pending,class:"p-datatable--clickable",onRowClick:i[1]||(i[1]=v=>o("clickOnChat",v.data)),scrollable:"",scrollHeight:"100%",rowHover:!0},{default:p(()=>[l(c,null,{header:p(()=>[e("div",eo,[so,l(m,{onClick:i[0]||(i[0]=v=>o("refreshChats")),refreshing:t.pending},null,8,["refreshing"])])]),body:p(({data:v})=>[l(u,{id:v.id,name:v.name,picture:v.picture,message:v.lastMessage},null,8,["id","name","picture","message"])]),_:1})]),_:1},8,["value","loading"])}}},oo={class:"flex justify-content-end",style:{width:"100%"}},no={style:{width:"100%"}},lo={class:"my-auto pl-2"},io={__name:"ChatInputFooter",props:{disabled:Boolean,sendText:Function},setup(t){const n=t,o=h(!1),s=h("");function i(){o.value=!0,n.sendText(s.value).then(()=>{s.value=""}).finally(()=>{o.value=!1})}return(m,u)=>{const c=ts,r=G;return a(),b("div",oo,[e("div",no,[l(c,{modelValue:d(s),"onUpdate:modelValue":u[0]||(u[0]=v=>ye(s)?s.value=v:null),rows:"2",cols:"50",onKeydown:Ns(Ke(i,["ctrl"]),["enter"]),style:{width:"100%"}},null,8,["modelValue","onKeydown"])]),e("div",lo,[l(r,{onClick:i,disabled:t.disabled||!d(s),loading:d(o),label:"",icon:"pi pi-send",class:"p-button-success"},null,8,["disabled","loading"])])])}}},ao={class:"pb-3 flex"},ro={class:"flex align-items-center gap-1"},uo={class:"m-auto pb-2"},co={class:"text-center"},po=e("b",null,"â„¹ï¸ About Chat UI",-1),mo=[po],vo={class:"flex flex-column justify-content-between",style:{height:"100%"}},fo=e("hr",null,null,-1),_o={__name:"SessionChatDialog",props:{visible:{},visibleModifiers:{},session:{},sessionModifiers:{}},emits:["update:visible","update:session"],setup(t){const n=Z(t,"visible"),o=Z(t,"session");ee(n,()=>{n.value||(r.value=null,v.value=[],A())}),we();const s=Q(),{data:i,pending:m,error:u,refresh:c}=be(`session-${o.value.name}-chats`,async()=>await s.getChatsOverview(o.value.server.id,o.value.name,20)),r=h(null),v=h([]),w=h(null);ee(r,()=>{r.value&&H()});const k=h(!1),g=h(20),V=h(0);let y=null;const C=h(ue.DISCONNECTED);function f(){const L=s.getServer(o.value.server.id),I=["message.any"];y=new Es(L,I,o.value.name),y.connect(),C.value=ue.CONNECTING,y.on("open",()=>{C.value=ue.CONNECTED}),y.on("close",()=>{C.value=ue.DISCONNECTED}),y.on("error",()=>{C.value=ue.ERROR}),y.on("event",E)}async function E(L){var x;await ce(100);const I=(x=r.value)==null?void 0:x.id;I&&((L.payload.from===I||L.payload.to===I)&&H(),c())}function A(){y==null||y.stop(),y=null,C.value=ue.DISCONNECTED}function H(){k.value=!0,s.getChatsMessages(o.value.server.id,o.value.name,r.value.id,g.value,V.value,!1).then(L=>{v.value=L.reverse()}).finally(()=>{k.value=!1})}ee(o,()=>{var L,I;(I=(L=o.value)==null?void 0:L.me)!=null&&I.id&&(A(),f(),c(),s.getProfilePicture(o.value.server.id,o.value.name,o.value.me.id).then(x=>{w.value=x.profilePictureURL}))});function N(L){r.value=L}function Y(L){return s.sendText(o.value.server.id,o.value.name,r.value.id,L).then(()=>{ce(100)})}const J=h(!1);return(L,I)=>{const x=xe,$=Le,q=Bt,F=zs,W=Gs,te=Se;return a(),R(te,{visible:n.value,"onUpdate:visible":I[2]||(I[2]=oe=>n.value=oe),modal:!0,maximizable:"",style:{width:"90%",height:"90%"}},{header:p(()=>[e("div",null,[l(x,{session:o.value},null,8,["session"])])]),default:p(()=>[e("div",ao,[e("div",ro,[o.value.me?(a(),R($,{key:0,session:o.value,image:w.value},null,8,["session","image"])):D("",!0),l(Hs,{status:C.value},null,8,["status"])]),e("div",uo,[e("div",co,[e("a",{href:"#",onClick:I[0]||(I[0]=oe=>J.value=!0)},mo)]),J.value?(a(),R(q,{key:0,style:{"max-width":"50em"},onClose:I[1]||(I[1]=oe=>J.value=!1)})):D("",!0)])]),l(W,{style:{"max-height":"90%"}},{default:p(()=>[l(F,{size:30,class:"flex items-center justify-center"},{default:p(()=>[l(to,{chats:d(i),loading:d(m),onClickOnChat:N,onRefreshChats:d(c)},null,8,["chats","loading","onRefreshChats"])]),_:1}),l(F,{size:70,class:"flex flex-column gap-2 justify-content-between p-2"},{default:p(()=>[e("div",vo,[r.value?(a(),b(j,{key:0},[l(Yt,{chat:r.value,me:o.value.me,mePicture:w.value,fetch:H,fetching:k.value},null,8,["chat","me","mePicture","fetching"]),fo,l(Gt,{messages:v.value},null,8,["messages"]),l(io,{disabled:!r.value||k.value,sendText:Y},null,8,["disabled"])],64)):D("",!0)])]),_:1})]),_:1})]),_:1},8,["visible"])}}},ho={class:"-mt-4 p-0 line-height-3 block",style:{"font-family":"monaco, Consolas, 'Lucida Console', monospace"}},go={__name:"CodeHighlight",props:["invalid"],setup(t){const n=t,o=U(()=>n.invalid?"p-invalid p-component p-inputtext":"");return(s,i)=>(a(),b("pre",{class:he(["border-round surface-ground text-900 p-5 overflow-auto",o.value])},[P("        "),e("code",ho,[Ts(s.$slots,"default")])],2))}},Ae=t=>(Os("data-v-aa1b18ec"),t=t(),Us(),t),bo={class:"h-full flex flex-column"},yo={class:"flex justify-content-center align-items-center"},$o=Ae(()=>e("h5",{class:"m-0"},"Request",-1)),wo={class:"flex flex-column justify-content-between h-full"},So={class:"flex flex-column gap-2"},xo={class:"flex gap-2"},ko={class:"text-center"},Co=Ae(()=>e("div",{class:"mb-2"},"Body",-1)),Vo={class:"text-center mt-2"},Do={class:"flex flex-column h-full"},Ro={class:"flex justify-content-center align-items-center"},Eo=Ae(()=>e("h5",{class:"m-0"},"Response",-1)),Po={__name:"SessionRequestResponse",props:["session"],setup(t){const n=Q(),o=t,s=h(null),i=h("POST"),m=h("/api/sendText"),u=h(""),c=h(!1),r=h(!1);function v(f){return JSON.stringify(f,null,2)}function w(f){try{return JSON.parse(f)}catch{return f}}const k=U(()=>({method:i.value,uri:m.value,params:void 0,body:w(u.value)})),g=["GET","POST","PUT","DELETE","PATCH"];async function V(f){await navigator.clipboard.writeText(s.value),f.preventDefault()}async function y(f){await navigator.clipboard.writeText(v(k.value)),f.preventDefault()}async function C(){try{r.value=!1,c.value=!0;const f=await n.callServerAPI(o.session.server.id,k.value);s.value=v(f)}catch(f){r.value=!0,f.response?s.value=v(f.response.data):s.value=v(f)}finally{c.value=!1}}return We(()=>{const f={chatId:"11111111111@c.us",text:"Hi there!",session:o.session.name};u.value=v(f),s.value="..."}),(f,E)=>{const A=G,H=Ie,N=de,Y=ts,J=os,L=go,I=X("tooltip");return a(),b(j,null,[e("div",null,[e("div",bo,[e("div",yo,[$o,M(l(A,{rounded:"",text:"",tabindex:0,icon:"pi pi-copy",onClick:E[0]||(E[0]=x=>y(x))},null,512),[[I,{value:"Copied to clipboard"},void 0,{focus:!0,bottom:!0}]])]),e("div",wo,[e("div",So,[e("div",xo,[l(H,{modelValue:i.value,"onUpdate:modelValue":E[1]||(E[1]=x=>i.value=x),options:g},null,8,["modelValue"]),l(N,{type:"text",class:"w-full",modelValue:m.value,"onUpdate:modelValue":E[2]||(E[2]=x=>m.value=x),placeholder:"API Endpoint"},null,8,["modelValue"])]),e("div",ko,[Co,l(Y,{modelValue:u.value,"onUpdate:modelValue":E[3]||(E[3]=x=>u.value=x),rows:"8",class:"w-full",placeholder:"Request"},null,8,["modelValue"])])]),e("div",Vo,[l(A,{onClick:C,loading:c.value,label:"Send",icon:"pi pi-send","icon-pos":"right"},null,8,["loading"])])])])]),l(J),e("div",null,[e("div",Do,[e("div",Ro,[Eo,M(l(A,{rounded:"",text:"",tabindex:0,icon:"pi pi-copy",onClick:E[4]||(E[4]=x=>V(x))},null,512),[[I,{value:"Copied to clipboard"},void 0,{focus:!0,bottom:!0}]])]),l(L,{class:"m-0 p-4 pretty",invalid:r.value},{default:p(()=>[P(B(s.value),1)]),_:1},8,["invalid"])])])],64)}}},No=$e(Po,[["__scopeId","data-v-aa1b18ec"]]),To={class:"grid pt-4"},Oo={class:"col-12 sm:col-6 h-full"},Uo={class:"grid"},Io={class:"col-12"},Mo={class:""},Lo={class:"flex justify-content-center align-items-center"},Ao={class:"col-12"},jo={class:""},Bo={class:"flex justify-content-center align-items-center"},Ho=e("h5",{class:"m-0"},"Screenshot",-1),qo={class:"m-auto w-full"},Fo={class:"col-12 sm:col-6 h-full card"},Wo={__name:"SessionControl",props:["session"],setup(t){const n=h(null),o=()=>{n.value.refresh()};return(s,i)=>{const m=Le,u=fe,c=rs,r=No;return a(),b("div",To,[e("div",Oo,[e("div",Uo,[e("div",Io,[e("div",Mo,[e("div",Lo,[t.session.me?(a(),R(m,{key:0,session:t.session},null,8,["session"])):D("",!0)])])]),e("div",Ao,[e("div",jo,[e("div",Bo,[Ho,l(u,{onClick:o})]),e("div",qo,[l(c,{ref_key:"screenshot",ref:n,session:t.session},null,8,["session"])])])])])]),e("div",Fo,[l(r,{session:t.session},null,8,["session"])])])}}},Ko={__name:"SessionControlDialog",props:{visible:{},visibleModifiers:{},session:{},sessionModifiers:{}},emits:["update:visible","update:session"],setup(t){const n=Z(t,"visible"),o=Z(t,"session");return we(),(s,i)=>{const m=xe,u=Wo,c=Se;return a(),R(c,{visible:n.value,"onUpdate:visible":i[0]||(i[0]=r=>n.value=r),modal:!0,maximizable:""},{header:p(()=>[l(m,{session:o.value},null,8,["session"])]),default:p(()=>[l(u,{session:o.value},null,8,["session"])]),_:1},8,["visible"])}}},zo={class:"card p-fluid"},Go={class:"flex flex-grow-1 justify-content-center"},Qo={class:"flex flex-grow-1 justify-content-center"},ds={__name:"KeyValueTable",props:ve(["keyColumn","keyColumnName","prefix","entityName"],{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const n=Z(t,"modelValue"),o=t,s=h([]),i=r=>{let{newData:v,index:w}=r;n.value[w]=v},m=r=>{let{data:v,newValue:w,field:k}=r;v[k]=w};function u(){const r=n.value.length+1,v=`${o.prefix}${r}`;n.value.unshift({[o.keyColumn]:v,value:"123"})}function c(r){n.value.splice(r,1)}return(r,v)=>{const w=de,k=Oe,g=G,V=Me,y=X("tooltip");return a(),b("div",zo,[l(V,{editingRows:s.value,"onUpdate:editingRows":v[0]||(v[0]=C=>s.value=C),value:n.value,editMode:"cell",dataKey:o.keyColumn,onRowEditSave:i,onCellEditComplete:m,pt:{table:{style:"min-width: 50rem"},column:{bodycell:({state:C})=>({style:C.d_editing&&"padding-top: 0.6rem; padding-bottom: 0.6rem"})}},resizableColumns:""},{default:p(()=>[l(k,{field:o.keyColumn,header:o.keyColumnName,style:{width:"40%"}},{editor:p(({data:C,field:f})=>[l(w,{modelValue:C[f],"onUpdate:modelValue":E=>C[f]=E},null,8,["modelValue","onUpdate:modelValue"])]),_:1},8,["field","header"]),l(k,{style:{width:"40%"},field:"value",header:"Value"},{editor:p(({data:C,field:f})=>[l(w,{modelValue:C[f],"onUpdate:modelValue":E=>C[f]=E},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),l(k,{style:{"min-width":"1rem"}},{header:p(()=>[e("div",Go,[M(l(g,{label:t.entityName,text:"",icon:"pi pi-plus",severity:"success",onClick:u},null,8,["label"]),[[y,`Add ${t.entityName}`,void 0,{top:!0}]])])]),body:p(({index:C})=>[e("div",Qo,[M(l(g,{label:"",rounded:"",text:"",style:{height:"2rem",width:"2rem"},icon:"pi pi-trash",severity:"warning",onClick:f=>c(C)},null,8,["onClick"]),[[y,"Delete",void 0,{top:!0}]])])]),_:1})]),_:1},8,["editingRows","value","dataKey","pt"])])}}},Xo={class:"flex justify-content-between align-items-center w-full"},Yo={class:"field"},Jo=e("label",{for:"url"},"URL",-1),Zo={class:"field mb-4"},en=e("label",{for:"events"},"Events",-1),sn=e("div",{class:"font-bold mb-2"},"Retries",-1),tn={class:"flex gap-3"},on={class:"field",style:{width:"10em"}},nn=e("label",{for:"retries-attempts"},"Attempts",-1),ln=e("span",{class:"pi pi-plus"},null,-1),an=e("span",{class:"pi pi-minus"},null,-1),rn={class:"field",style:{width:"10em"}},un=e("label",{for:"retries-delay-seconds"},"Delay, seconds",-1),cn=e("span",{class:"pi pi-plus"},null,-1),dn=e("span",{class:"pi pi-minus"},null,-1),pn={class:"field"},mn={for:"retries-delay-policy"},vn={class:"pi pi-info-circle"},fn={style:{"text-transform":"capitalize"}},_n={style:{"text-transform":"capitalize"}},hn={class:"field"},gn=e("label",{for:"hmac"},"HMAC Key (optional)",-1),bn={class:"field"},yn={class:"field flex justify-content-between align-items-center"},$n=e("div",null,[e("label",{for:"hmac"},"Custom Headers (optional)")],-1),wn={__name:"SessionWebhook",props:ve({disabled:Boolean,index:Number},{webhook:{},webhookModifiers:{}}),emits:["update:webhook"],setup(t){const n=Z(t,"webhook"),o=t,s=["constant","linear","exponential"],i=U(()=>{var g;const c=((g=n.value.retries)==null?void 0:g.delaySeconds)??2,r=4,v=Array.from({length:r},(V,y)=>c),w=Array.from({length:r},(V,y)=>c*(y+1)),k=Array.from({length:r},(V,y)=>c*2**y);return[`Constant: ${v.join(", ")}`,`Linear: ${w.join(", ")}`,`Exponential: ${k.join(", ")}`].join(`
`)}),m=qs,u=h(n.value.customHeaders&&n.value.customHeaders.length>0);return ee(u,(c,r)=>{if(r&&!c){n.value.customHeaders=null;return}!r&&c&&(n.value.customHeaders=[{name:"X-Header-1",value:"123"}])}),(c,r)=>{const v=G,w=de,k=Qe,g=Ys,V=Ie,y=ze("font-awesome-icon"),C=ns,f=ds,E=ls,A=is,H=X("tooltip");return a(),R(A,{activeIndex:0},{default:p(()=>[l(E,null,{header:p(()=>[e("div",Xo,[e("div",null," Webhook "+B(o.index+1),1),e("div",null,[M(l(v,{label:"",text:"",rounded:"",style:{height:"2rem",width:"2rem"},icon:"pi pi-trash",severity:"warning",onClick:r[0]||(r[0]=N=>c.$emit("remove"))},null,512),[[H,"Delete Webhook",void 0,{top:!0}]])])])]),default:p(()=>[e("div",Yo,[Jo,l(w,{id:"url",modelValue:n.value.url,"onUpdate:modelValue":r[1]||(r[1]=N=>n.value.url=N),modelModifiers:{trim:!0},required:"true",disabled:t.disabled},null,8,["modelValue","disabled"])]),e("div",Zo,[en,l(k,{id:"events",modelValue:n.value.events,"onUpdate:modelValue":r[2]||(r[2]=N=>n.value.events=N),options:d(m),placeholder:"Select Events","max-selected-labels":1,selectedItemsLabel:"{0} events selected",disabled:t.disabled},null,8,["modelValue","options","disabled"]),e("ul",null,[(a(!0),b(j,null,me(n.value.events,N=>(a(),b("li",{key:N},B(N),1))),128))])]),e("div",null,[sn,e("div",tn,[e("div",on,[nn,l(g,{modelValue:n.value.retries.attempts,"onUpdate:modelValue":r[3]||(r[3]=N=>n.value.retries.attempts=N),inputId:"retries-delay-attempts",showButtons:"",buttonLayout:"horizontal",min:1,step:1,disabled:t.disabled},{incrementbuttonicon:p(()=>[ln]),decrementbuttonicon:p(()=>[an]),_:1},8,["modelValue","disabled"])]),e("div",rn,[un,l(g,{modelValue:n.value.retries.delaySeconds,"onUpdate:modelValue":r[4]||(r[4]=N=>n.value.retries.delaySeconds=N),inputId:"retries-delay-seconds",showButtons:"",buttonLayout:"horizontal",min:1,step:1,disabled:t.disabled},{incrementbuttonicon:p(()=>[cn]),decrementbuttonicon:p(()=>[dn]),_:1},8,["modelValue","disabled"])]),e("div",pn,[e("label",mn,[P(" Retry Policy "),M(e("i",vn,null,512),[[H,d(i)]])]),l(V,{id:"retries-delay-policy",modelValue:n.value.retries.policy,"onUpdate:modelValue":r[5]||(r[5]=N=>n.value.retries.policy=N),options:s,placeholder:"Select Retry Policy","max-selected-labels":1,disabled:t.disabled},{option:p(N=>[e("span",fn,B(N.option),1)]),value:p(N=>[e("span",_n,B(N.value),1)]),_:1},8,["modelValue","disabled"])])])]),e("div",hn,[gn,l(w,{id:"hmac",modelValue:n.value.hmac.key,"onUpdate:modelValue":r[6]||(r[6]=N=>n.value.hmac.key=N),modelModifiers:{trim:!0},disabled:t.disabled},null,8,["modelValue","disabled"])]),e("div",bn,[e("div",yn,[$n,l(C,{modelValue:u.value,"onUpdate:modelValue":r[7]||(r[7]=N=>u.value=N),id:"customHeaders",onLabel:"Headers On",offLabel:"Headers Off"},{icon:p(()=>[l(y,{icon:"fa-solid fa-fingerprint",class:"mr-2"})]),_:1},8,["modelValue"])]),u.value?(a(),R(f,{key:0,modelValue:n.value.customHeaders,"onUpdate:modelValue":r[8]||(r[8]=N=>n.value.customHeaders=N),"entity-name":"Header","key-column":"name","key-column-name":"Header",prefix:"X-Header-"},null,8,["modelValue"])):D("",!0)])]),_:1})]),_:1})}}},Sn={class:"flex flex-column gap-2"},xn={class:"flex justify-content-between align-items-center w-full"},kn=e("h5",null,"ðŸ”„ Webhooks",-1),Cn={class:"pr-2"},Vn={key:0,class:"text-300 text-center"},Dn={__name:"SessionWebhooksField",props:ve({disabled:Boolean},{webhooks:{},webhooksModifiers:{}}),emits:["update:webhooks"],setup(t){const n=Z(t,"webhooks");function o(){const i={url:"https://httpbin.org/post",events:["session.status","message"],hmac:{key:null},retries:{delaySeconds:2,attempts:15,policy:"exponential"},customHeaders:null};n.value.push(i)}function s(i){n.value.splice(i,1)}return(i,m)=>{const u=G,c=wn,r=X("tooltip");return a(),b("div",Sn,[e("div",xn,[kn,e("div",Cn,[M(l(u,{label:"Webhook",text:"",icon:"pi pi-plus",severity:"success",onClick:o},null,512),[[r,"Add Webhook",void 0,{top:!0}]])])]),n.value.length===0?(a(),b("div",Vn," No webhooks configured ")):(a(!0),b(j,{key:1},me(n.value,(v,w)=>(a(),R(c,{webhook:n.value[w],"onUpdate:webhook":k=>n.value[w]=k,index:w,total:n.value.length,onRemove:k=>s(w),disabled:t.disabled},null,8,["webhook","onUpdate:webhook","index","total","onRemove","disabled"]))),256))])}}},Rn=e("div",null,[e("h5",null,[e("i",{class:"pi pi-whatsapp"}),P(" Create Session ")])],-1),En={class:"mb-2"},Pn=e("b",null,"Server",-1),Nn=e("b",null,"Name",-1),Tn={class:"field"},On=e("label",{for:"server"},"Server",-1),Un={key:0,class:"p-invalid"},In={class:"field"},Mn=e("label",{for:"name"},"Name (optional)",-1),Ln={key:0,class:"mb-4"},An=e("div",{class:"mb-3"},[e("h5",null,"ðŸ­ Engine Settings ")],-1),jn={class:"flex flex-column gap-2"},Bn=e("div",null,[e("a",{href:"https://waha.devlike.pro/docs/engines/noweb",target:"_blank"},"Read more about NOWEB settings")],-1),Hn={class:"flex gap-2"},qn={class:"pi pi-info-circle"},Fn={class:"field mt-4"},Wn={class:"field flex justify-content-between align-items-center"},Kn=e("div",null,[e("h5",null,[e("label",{for:"proxy"},"ðŸŒ Proxy")])],-1),zn={key:0,class:"card mb-4"},Gn={class:"field"},Qn=e("label",{for:"proxy-server"},"Server",-1),Xn={key:0,class:"p-invalid"},Yn={class:"flex gap-3"},Jn={class:"field w-full"},Zn=e("label",{for:"proxy-username"},"Username (optional)",-1),el={class:"field w-full"},sl=e("label",{for:"proxy-password"},"Password (optional)",-1),tl={class:"field flex justify-content-between align-items-center"},ol=e("div",null,[e("h5",null,[e("label",{for:"debug"},"ðŸ› ï¸ Debug")])],-1),nl={class:"w-full flex flex-column gap-2"},ll={class:"flex justify-content-end"},il={__name:"SessionDialog",props:ve({mode:String},{visible:{},visibleModifiers:{},session:{},sessionModifiers:{}}),emits:["update:visible","update:session"],setup(t){var L,I;const n=we(),o=Z(t,"visible"),s=Z(t,"session"),i=t,m=U(()=>i.mode==="new"),u=U(()=>i.mode==="update"),c=U(()=>u.value),r=Ue(),v=Q(),w=U(()=>v.getServer(s.value.server)),k=U(()=>{var x,$;return(($=(x=w.value)==null?void 0:x.version)==null?void 0:$.engine)==="NOWEB"});U(()=>{var x,$;return(($=(x=w.value)==null?void 0:x.version)==null?void 0:$.engine)==="WEBJS"});const g=h([]),V=h(!!((I=(L=s.value.config)==null?void 0:L.proxy)!=null&&I.server));ee(s,async(x,$)=>{var q,F,W;V.value=(F=(q=x==null?void 0:x.config)==null?void 0:q.proxy)==null?void 0:F.server,g.value=st((W=x.config)==null?void 0:W.metadata)});const y=h(!1),C=h(!1),f=U(()=>{const x=se.cloneDeep(s.value.config);return V.value||(x.proxy=void 0),x.metadata=tt(g.value),x}),E=U(()=>{const x={...f.value};return k.value||delete x.noweb,{name:s.value.name,config:x}});async function A(){y.value=!0;try{C.value=!0;const x=se.cloneDeep(E.value);await r(v.updateSession(s.value.server,s.value.name,x.config),void 0,"Failed to update session"),n.add({severity:"success",summary:"Updated",detail:s.value.name,life:3e3})}finally{C.value=!1}s.value=void 0,N()}async function H(x){y.value=!0;try{C.value=!0;const $=se.cloneDeep(E.value);$.start=x;const q=await r(v.createSession(s.value.server,$),void 0,"Failed to start session"),F=x?"Started":"Created";n.add({severity:"success",summary:F,detail:q.name,life:3e3})}finally{C.value=!1}s.value=void 0,N()}function N(){y.value=!1,o.value=!1}const Y=U(()=>s.value.status==="STOPPED");async function J(x){await navigator.clipboard.writeText(JSON.stringify({method:"POST",uri:"/api/sessions",body:E.value},null,2)),x.preventDefault()}return(x,$)=>{const q=xe,F=Qs,W=es,te=de,oe=Xs,ne=ze("font-awesome-icon"),le=ns,ke=ls,Ce=is,Ve=ds,De=Dn,Re=Js,re=G,Ee=Se,ie=X("tooltip");return a(),R(Ee,{visible:o.value,"onUpdate:visible":$[15]||($[15]=T=>o.value=T),modal:!0,class:"p-fluid",maximizable:""},Is({footer:p(()=>[e("div",nl,[e("div",null,[u.value&&!Y.value?(a(),R(F,{key:0,severity:"warn"},{default:p(()=>[P(" The session is in '"),e("b",null,B(s.value.status)+"'",1),P(" status, in order to save configuration the session will be restarted. ")]),_:1})):D("",!0)]),e("div",ll,[M(l(re,{label:"Copy",text:"",tabindex:0,icon:"pi pi-copy",severity:"secondary",onClick:$[12]||($[12]=T=>J(T))},null,512),[[ie,{value:"Copied to clipboard"},void 0,{focus:!0,bottom:!0}]]),u.value?D("",!0):(a(),R(re,{key:0,label:"Create",icon:"pi pi-plus",text:"",onClick:$[13]||($[13]=T=>H(!1)),loading:C.value},null,8,["loading"])),u.value?D("",!0):(a(),R(re,{key:1,label:"Create & Start",icon:"pi pi-play",text:"",onClick:$[14]||($[14]=T=>H(!0)),loading:C.value},null,8,["loading"])),u.value?(a(),R(re,{key:2,label:"Update",icon:"pi pi-save",text:"",onClick:A,loading:C.value},null,8,["loading"])):D("",!0)])])]),default:p(()=>[e("div",En,[u.value?(a(),R(F,{key:0,severity:"info"},{default:p(()=>[P(" To change the "),Pn,P(" or "),Nn,P(" - please remove the session and run again. ")]),_:1})):D("",!0)]),e("div",Tn,[On,l(W,{placeholder:"Select Server",modelValue:s.value.server,"onUpdate:modelValue":$[0]||($[0]=T=>s.value.server=T),showClear:!1,required:!0,invalid:y.value&&!s.value.server,disabled:c.value},null,8,["modelValue","invalid","disabled"]),y.value&&!s.value.server?(a(),b("small",Un,"Server is required.")):D("",!0)]),e("div",In,[Mn,l(te,{id:"name",modelValue:s.value.name,"onUpdate:modelValue":$[1]||($[1]=T=>s.value.name=T),modelModifiers:{trim:!0},required:"false",autofocus:"",placeholder:"session_1111111111111",disabled:!m.value},null,8,["modelValue","disabled"])]),k.value?(a(),b("div",Ln,[An,l(Ce,{activeIndex:0},{default:p(()=>[l(ke,{header:"NOWEB"},{header:p(()=>[P(" Â "),l(oe,{value:"New"})]),default:p(()=>[e("div",jn,[Bn,e("div",null,[M((a(),R(le,{modelValue:s.value.config.noweb.markOnline,"onUpdate:modelValue":$[2]||($[2]=T=>s.value.config.noweb.markOnline=T),onLabel:"Presence: online",offLabel:"Presence: offline",disabled:c.value},{icon:p(()=>[l(ne,{icon:"fa-solid fa-sync",class:"mr-2"})]),_:1},8,["modelValue","disabled"])),[[ie,"Send presence when connect for the connected session. If presence online - you don not get notifications in your phone"]])]),e("div",Hn,[e("div",null,[M((a(),R(le,{modelValue:s.value.config.noweb.store.enabled,"onUpdate:modelValue":$[3]||($[3]=T=>s.value.config.noweb.store.enabled=T),onLabel:"Store: Enabled",offLabel:"Store: Disabled",disabled:c.value},{icon:p(()=>[l(ne,{icon:"fa-solid fa-folder",class:"mr-2"})]),_:1},8,["modelValue","disabled"])),[[ie,"Store contacts, chats, messages in the database, so you can get it in API"]])]),e("div",null,[M((a(),R(le,{modelValue:s.value.config.noweb.store.fullSync,"onUpdate:modelValue":$[4]||($[4]=T=>s.value.config.noweb.store.fullSync=T),onLabel:"Store: Full Sync On",offLabel:"Store: Full Sync Off",disabled:c.value},{icon:p(()=>[l(ne,{icon:"fa-solid fa-sync",class:"mr-2"})]),_:1},8,["modelValue","disabled"])),[[ie,`Sync all contacts, chats, messages from the phone at the start.
Otherwise the store can miss some information.`]])])])])]),_:1})]),_:1})])):D("",!0),e("div",null,[e("div",null,[e("h5",null,[P("ðŸ“ Metadata "),M(e("i",qn,null,512),[[ie,"Key value pairs you can attach to Session and will receive it in webhooks, API and search the values on Dashboard."]])])]),l(Ve,{modelValue:g.value,"onUpdate:modelValue":$[5]||($[5]=T=>g.value=T),"entity-name":"Metadata","key-column":"key","key-column-name":"Key",prefix:"user.id."},null,8,["modelValue"])]),e("div",Fn,[l(De,{ref:"webhooks",webhooks:s.value.config.webhooks,"onUpdate:webhooks":$[6]||($[6]=T=>s.value.config.webhooks=T)},null,8,["webhooks"])]),e("div",null,[e("div",Wn,[Kn,l(le,{modelValue:V.value,"onUpdate:modelValue":$[7]||($[7]=T=>V.value=T),id:"proxy",onLabel:"Proxy On",offLabel:"Proxy Off"},{icon:p(()=>[l(ne,{icon:"fa-solid fa-server",class:"mr-2"})]),_:1},8,["modelValue"])]),V.value?(a(),b("div",zn,[e("div",Gn,[Qn,l(te,{id:"proxy-server",modelValue:s.value.config.proxy.server,"onUpdate:modelValue":$[8]||($[8]=T=>s.value.config.proxy.server=T),modelModifiers:{trim:!0},required:"true",invalid:y.value&&!s.value.config.proxy.server,placeholder:"host:port"},null,8,["modelValue","invalid"]),y.value&&!s.value.config.proxy.server?(a(),b("small",Xn,"Server is required.")):D("",!0)]),e("div",Yn,[e("div",Jn,[Zn,l(te,{id:"proxy-username",modelValue:s.value.config.proxy.username,"onUpdate:modelValue":$[9]||($[9]=T=>s.value.config.proxy.username=T),modelModifiers:{trim:!0}},null,8,["modelValue"])]),e("div",el,[sl,l(Re,{id:"proxy-password",modelValue:s.value.config.proxy.password,"onUpdate:modelValue":$[10]||($[10]=T=>s.value.config.proxy.password=T),modelModifiers:{trim:!0},feedback:!1,toggleMask:""},null,8,["modelValue"])])])])):D("",!0)]),e("div",tl,[ol,l(le,{modelValue:s.value.config.debug,"onUpdate:modelValue":$[11]||($[11]=T=>s.value.config.debug=T),onLabel:"Debug Enabled",offLabel:"Debug Disabled",onIcon:"fa fa-bug"},{icon:p(()=>[l(ne,{icon:"fa-solid fa-bug",class:"mr-2"})]),_:1},8,["modelValue"])])]),_:2},[m.value?{name:"header",fn:p(()=>[Rn]),key:"0"}:void 0,m.value?void 0:{name:"header",fn:p(()=>[e("div",null,[l(q,{session:s.value},null,8,["session"])])]),key:"1"}]),1032,["visible"])}}},al=["WORKING","FAILED","STARTING","SCAN_QR_CODE","STOPPED"],rl={class:"",style:{"min-width":"20rem"}},ul={class:"flex justify-content-center align-items-center"},cl=e("h5",{class:"m-0"},"QR",-1),dl={class:"m-auto w-full"},pl={class:"flex justify-content-center"},ml={key:1,style:{"background-color":"#f8f9fa",padding:"1rem",color:"red","white-space":"pre-wrap"}},vl={__name:"QRImage",props:{session:Object},setup(t){const n=Q(),o=t,{data:s,pending:i,error:m,refresh:u}=be(`session-qr-${o.session.server.id}-${o.session.name}`,async()=>(await ce(1e3),await n.getQR(o.session.server.id,o.session.name)));return(c,r)=>{const v=fe,w=Ye,k=Je,g=as;return a(),b("div",rl,[e("div",ul,[cl,l(v,{onClick:d(u)},null,8,["onClick"])]),e("div",dl,[d(i)?(a(),b(j,{key:0},[l(w,{mode:"indeterminate",style:{height:"3px"}}),!d(s)&&!d(m)?(a(),R(k,{key:0,width:"100%",height:"20rem"})):D("",!0)],64)):D("",!0),e("div",pl,[d(s)?(a(),R(g,{key:0,data:d(s).data,mimetype:d(s).mimetype},null,8,["data","mimetype"])):D("",!0),d(m)?(a(),b("pre",ml,""+B(d(m).cause.response.data.message||d(m).cause.response.data||d(m))+`
  `,1)):D("",!0)])])])}}},fl={},_l={class:"pl-4"},hl=Ge('<li> Open <b>WhatsApp</b> on your phone </li><li> Tap <b>More options</b> <i class="pi pi-ellipsis-v"></i> or <b>Settings</b> <i class="pi pi-cog"></i></li><li> Tap <b>Linked Devices</b> &gt; <b>Link a device</b></li><li><b>Link with phone number instead</b> and enter the code </li>',4),gl=[hl];function bl(t,n){return a(),b("ul",_l,gl)}const yl=$e(fl,[["render",bl]]),$l={class:"flex flex-column gap-2 mt-4"},wl={class:"flex justify-content-between gap-2"},Sl={class:"field"},xl={class:"card flex justify-content-center align-items-center"},kl={class:"mx-1",style:{"font-size":"2rem"}},Cl={__name:"PairingCodeSteps",props:["session"],setup(t){const n=t,o=h(null),s=h(!1),i=h("XXXX-XXXX"),m=Ue(),u=Q();function c(v){return v.replace(/\D/g,"")}async function r(){o.value=c(o.value),s.value=!0;try{await ce(1e3);const v=await m(u.getPairingCode(n.session.server.id,n.session.name,o.value),"Request sent","Failed to request code",n.session.name,n.session.name);i.value=v.code}finally{s.value=!1}}return ee(o,se.debounce(v=>{o.value=c(v)},1e3)),(v,w)=>{const k=de,g=G,V=os;return a(),b(j,null,[e("div",$l,[e("form",{onSubmit:Ke(r,["prevent"])},[e("div",wl,[e("div",Sl,[l(k,{id:"phone","input-id":"phone",name:"phone",modelValue:d(o),"onUpdate:modelValue":w[0]||(w[0]=y=>ye(o)?o.value=y:null),modelModifiers:{trim:!0},useGrouping:!1,required:"true",autofocus:"",placeholder:"1213213213 (no +, no dashes -)"},null,8,["modelValue"])]),e("div",null,[l(g,{type:"submit",label:"Show Code",icon:"pi pi-send",loading:d(s)},null,8,["loading"])])])],32)]),d(i)?(a(),b(j,{key:0},[l(V),e("div",null,[l(yl)]),e("div",xl,[e("div",null,[d(i)?(a(!0),b(j,{key:0},me(d(i),y=>(a(),b("span",kl,B(y),1))),256)):D("",!0)])])],64)):D("",!0)],64)}}},Vl={},Dl={class:"pl-4"},Rl=Ge('<li> Open <b>WhatsApp</b> on your phone </li><li> Tap <b>More options</b> <i class="pi pi-ellipsis-v"></i> or <b>Settings</b> <i class="pi pi-cog"></i></li><li> Tap <b>Linked Devices</b> and <b>Link a device</b></li><li> Point your phone to this screen to capture <b>QR code</b></li>',4),El=[Rl];function Pl(t,n){return a(),b("ul",Dl,El)}const Nl=$e(Vl,[["render",Pl]]),Tl=e("i",{class:"pi pi-qrcode mr-2"},null,-1),Ol=e("p",null,[P(" Scan "),e("b",null,"QR Code"),P(" to authorize this session. ")],-1),Ul=e("i",{class:"pi pi-send mr-2"},null,-1),Il=e("p",{class:"m-0"},[P(" Enter "),e("b",null,"Your Phone number"),P(": ")],-1),Ml={__name:"SessionLoginDialog",props:ve(["session"],{visible:{},visibleModifiers:{}}),emits:["update:visible"],setup(t){const n=Z(t,"visible");return(o,s)=>{const i=Zs,m=et,u=Se;return a(),R(u,{visible:n.value,"onUpdate:visible":s[0]||(s[0]=c=>n.value=c),modal:!0,class:"p-fluid",maximizable:""},{header:p(()=>[l(xe,{session:t.session},null,8,["session"])]),default:p(()=>[l(m,null,{default:p(()=>[l(i,null,{header:p(()=>[Tl,P(" Scan QR ")]),default:p(()=>[Ol,l(Nl),e("div",null,[l(vl,{session:t.session},null,8,["session"])])]),_:1}),l(i,null,{header:p(()=>[Ul,P(" Enter Code ")]),default:p(()=>[Il,e("div",null,[l(Cl,{session:t.session},null,8,["session"])])]),_:1})]),_:1})]),_:1},8,["visible"])}}},Ll={__name:"SessionLogin",props:["session"],setup(t){const n=h(!1);return(o,s)=>{const i=G,m=X("tooltip");return a(),b(j,null,[M(l(i,{icon:"pi pi-sign-in",severity:"",rounded:"",outlined:"",onClick:s[0]||(s[0]=u=>n.value=!0),disabled:t.session.status!=="SCAN_QR_CODE"},null,8,["disabled"]),[[m,"Login",void 0,{top:!0}]]),l(Ml,{visible:d(n),"onUpdate:visible":s[1]||(s[1]=u=>ye(n)?n.value=u:null),session:t.session},null,8,["visible","session"])],64)}}},Al={class:"flex justify-content-between"},jl={class:"flex align-items-center gap-1"},Bl=e("i",{class:"pi pi-whatsapp"},null,-1),Hl=e("span",{class:"mr-1"}," Sessions ",-1),ql=["disabled"],Fl=e("i",{class:"pi pi-refresh"},null,-1),Wl=[Fl],Kl={class:"flex justify-content-between flex-column sm:flex-row gap-2 sm:gap-0"},zl={class:"flex flex-column"},Gl={class:"flex justify-content-between flex-column sm:flex-row gap-2 sm:gap-2"},Ql={style:{"text-align":"left"},class:"flex flex-column"},Xl={class:"text-center"},Yl={class:"flex gap-2"},Jl={class:"my-auto"},Zl={key:0,class:"pi pi-info-circle text-orange-400"},ei={class:"flex flex-row gap-2 justify-content-end",style:{order:"2"}},Mi={__name:"SessionTable",setup(t){const n=we(),o=Q(),{visibleSessions:s,refreshing:i,servers:m}=Te(o),u=h({config:{webhooks:[]}}),c=h(!1),r=h(void 0),v=h(!1),w=h(!1),k=h(10);h(null);const g=h({}),V=h(null),y=h([]),C=U(()=>y.value.filter(O=>Y.value[`session-action-${O.server.id}-${O.name}`])),f=h(!1),E=h(!1),A=h(!1),H=h(!1),N=h(!1),Y=h({});function J(O,S){switch(O){case"startSession":f.value=S;break;case"restartSession":E.value=S;break;case"stopSession":A.value=S;break;case"logoutSession":H.value=S;break;case"deleteSession":N.value=S;break}}async function L(O){J(O,!0);try{for(const S of C.value)await Y.value[`session-action-${S.server.id}-${S.name}`][O]()}finally{J(O,!1)}}Ms(()=>{Y.value=[]}),Ls(()=>{Ve()});const I=h([{field:"name",header:"Name"},{field:"metadata",header:"Metadata"},{field:"me",header:"Me"},{field:"status",header:"Status"},{field:"server",header:"Server"}]);function x(){return JSON.parse(localStorage.getItem("sessions.table.columns.hidden"))||[]}const $=x(),q=h(se.differenceBy(I.value,$,"field")),F=O=>{q.value=I.value.filter(S=>O.includes(S))};function W(O){return!q.value||q.value.length===0?!0:se.find(q.value,{field:O})}const te=U(()=>W("name")),oe=U(()=>W("metadata")),ne=U(()=>W("me")),le=U(()=>W("status")),ke=U(()=>W("server")),Ce=U(()=>se.differenceBy(I.value,q.value,"field"));ee(()=>Ce.value,O=>{localStorage.setItem("sessions.table.columns.hidden",JSON.stringify(O))},{deep:!0});const Ve=()=>{g.value={global:{value:null,matchMode:pe.CONTAINS},status:{value:null,matchMode:pe.EQUALS},"server.id":{value:null,matchMode:pe.EQUALS},name:{value:null,matchMode:pe.CONTAINS},"me.id":{value:null,matchMode:pe.CONTAINS}}};function De(){const O=m.value.find(S=>S.connected);if(!O){n.add({severity:"error",summary:"No connected server",detail:"Please connect to a server first",life:3e3});return}u.value={server:O.id,name:"",config:{metadata:{},webhooks:[],noweb:{markOnline:!0,store:{enabled:!0,fullSync:!1}},proxy:{}}},r.value="new",c.value=!0}function Re(O){u.value=se.cloneDeep({name:O.name,status:O.status,server:O.server.id,config:O.config}),r.value="update",c.value=!0}function re(){be("store",async()=>await o.refresh())}function Ee(O){v.value=!0,u.value=O}function ie(O){u.value=O,w.value=!0}ee(w,O=>{O||(u.value={config:{webhooks:[]}})});const T=U(()=>["name","me.id","me.pushName","_metadata"]);return(O,S)=>{const je=Fe,Pe=G,ps=at,ms=As,Ne=de,vs=js,fs=Qe,ae=Oe,_s=ct,hs=Le,gs=yt,Be=Ze,bs=Ie,ys=es,$s=us,ws=St,Ss=Me,xs=ss,ks=_o,Cs=Ko,Vs=il,_e=X("tooltip");return a(),b(j,null,[e("div",Al,[e("div",null,[e("h5",jl,[Bl,Hl,l(je,{refreshing:d(i)},null,8,["refreshing"])])]),e("div",null,[M((a(),b("button",{onClick:re,class:"p-link layout-topbar-button",disabled:d(i)},Wl,8,ql)),[[_e,"Refresh",void 0,{top:!0}]])])]),l(Ss,{selection:y.value,"onUpdate:selection":S[8]||(S[8]=_=>y.value=_),value:d(s).length>0?d(s):[],paginator:!0,rows:k.value,rowsPerPageOptions:[5,10,20,50,100,500],dataKey:_=>`${_.server.id}-${_.name}`,rowHover:!0,filters:g.value,"onUpdate:filters":S[9]||(S[9]=_=>g.value=_),filterDisplay:"row",loading:V.value,globalFilterFields:d(T),showGridlines:"",style:{"white-space":"nowrap"},sortField:"name",sortOrder:1,resizableColumns:""},{header:p(()=>[e("div",Kl,[e("div",zl,[l(Pe,{label:"Start New",icon:"pi pi-play",severity:"success",onClick:De})]),e("div",Gl,[l(ps),e("div",null,[l(vs,{iconPosition:"left"},{default:p(()=>[l(ms,{class:"pi pi-search"}),l(Ne,{modelValue:g.value.global.value,"onUpdate:modelValue":S[0]||(S[0]=_=>g.value.global.value=_),placeholder:"Search by Name, Phone, Metadata",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),e("div",Ql,[l(fs,{placeholder:"Columns",modelValue:q.value,options:I.value,optionLabel:"header",selectedItemsLabel:"Columns",maxSelectedLabels:0,"onUpdate:modelValue":F},null,8,["modelValue","options"])])])])]),empty:p(()=>[P(" No sessions found")]),loading:p(()=>[P(" Loading sessions...")]),default:p(()=>[l(ae,{selectionMode:"multiple",headerStyle:"width: 3rem"}),d(te)?(a(),R(ae,{key:0,field:"name",header:"Name","show-filter-menu":!1,sortable:""},{filter:p(({filterModel:_,filterCallback:K})=>[l(Ne,{modelValue:g.value.name.value,"onUpdate:modelValue":S[1]||(S[1]=z=>g.value.name.value=z),type:"text",placeholder:"Session"},null,8,["modelValue"])]),_:1})):D("",!0),d(oe)?(a(),R(ae,{key:1,header:"Metadata"},{body:p(({data:_})=>{var K;return[l(_s,{metadata:(K=_.config)==null?void 0:K.metadata},null,8,["metadata"])]}),_:1})):D("",!0),d(ne)?(a(),R(ae,{key:2,header:"Me"},{body:p(({data:_})=>[e("div",Xl,[l(hs,{session:_},null,8,["session"])])]),filter:p(({filterModel:_,filterCallback:K})=>[l(Ne,{modelValue:g.value["me.id"].value,"onUpdate:modelValue":S[2]||(S[2]=z=>g.value["me.id"].value=z),type:"text",placeholder:"Me (Phone Number)"},null,8,["modelValue"])]),_:1})):D("",!0),d(le)?(a(),R(ae,{key:3,field:"status",header:"Status",showFilterMenu:!1,style:{width:"9rem"}},{body:p(({data:_})=>[e("div",Yl,[e("div",null,[l(Ll,{session:_},null,8,["session"])]),e("div",null,[l(gs,{session:_},null,8,["session"])]),e("div",null,[M(l(Pe,{icon:"pi pi-whatsapp",severity:"",rounded:"",outlined:"",disabled:_.status!=="WORKING",onClick:K=>ie(_)},null,8,["disabled","onClick"]),[[_e,"Chat UI",void 0,{top:!0}]])]),e("div",null,[M(l(Pe,{icon:"pi pi-code",severity:"secondary",rounded:"",outlined:"",onClick:K=>Ee(_)},null,8,["onClick"]),[[_e,"Send Request",void 0,{top:!0}]])]),e("div",Jl,[l(Be,{status:_.status,value:_.status.toUpperCase()},null,8,["status","value"])])])]),filter:p(({filterModel:_,filterCallback:K})=>[l(bs,{modelValue:_.value,"onUpdate:modelValue":z=>_.value=z,options:d(al),onChange:z=>K(),placeholder:"Any",class:"p-column-filter",showClear:!0},{option:p(({option:z})=>[l(Be,{status:z,value:z},null,8,["status","value"])]),_:2},1032,["modelValue","onUpdate:modelValue","options","onChange"])]),_:1})):D("",!0),d(ke)?(a(),R(ae,{key:4,field:"server.name",filterField:"server.id",header:"Server",showFilterMenu:!1},{filter:p(({filterModel:_,filterCallback:K})=>[l(ys,{placeholder:"Any",onChange:z=>K(),modelValue:_.value,"onUpdate:modelValue":z=>_.value=z,showClear:!0,required:!1},null,8,["onChange","modelValue","onUpdate:modelValue"])]),body:p(({data:_})=>[P(B(_.server.name)+" ",1),_.assignedWorker&&_.server.name!==_.assignedWorker?M((a(),b("i",Zl,null,512)),[[_e,`Assigned Worker ID does not match

ðŸ‘‰ Assigned Worker ID: ${_.assignedWorker}`]]):D("",!0)]),_:1})):D("",!0),l(ae,{showFilterMenu:!1},{filter:p(()=>[e("div",ei,[l($s,{group:"dialog",name:`'${d(C).length}' sessions`,"all-disabled":d(C).length===0,"hide-actions":["view"],"is-starting":f.value,"is-restarting":E.value,"is-stopping":A.value,"is-logging-out":H.value,"is-removing":N.value,onStart:S[3]||(S[3]=_=>L("startSession")),onRestart:S[4]||(S[4]=_=>L("restartSession")),onStop:S[5]||(S[5]=_=>L("stopSession")),onLogout:S[6]||(S[6]=_=>L("logoutSession")),onDelete:S[7]||(S[7]=_=>L("deleteSession"))},null,8,["name","all-disabled","is-starting","is-restarting","is-stopping","is-logging-out","is-removing"])])]),body:p(({data:_})=>[l(ws,{ref:K=>{Y.value[`session-action-${_.server.id}-${_.name}`]=K},session:_,disabled:d(C).length!==0,onView:Re},null,8,["session","disabled"])]),_:1})]),_:1},8,["selection","value","rows","dataKey","filters","loading","globalFilterFields"]),l(xs),l(ks,{visible:w.value,"onUpdate:visible":S[10]||(S[10]=_=>w.value=_),session:u.value,"onUpdate:session":S[11]||(S[11]=_=>u.value=_)},null,8,["visible","session"]),l(Cs,{visible:v.value,"onUpdate:visible":S[12]||(S[12]=_=>v.value=_),session:u.value,"onUpdate:session":S[13]||(S[13]=_=>u.value=_)},null,8,["visible","session"]),l(Vs,{visible:c.value,"onUpdate:visible":S[14]||(S[14]=_=>c.value=_),session:u.value,"onUpdate:session":S[15]||(S[15]=_=>u.value=_),mode:r.value},null,8,["visible","session","mode"])],64)}}};export{at as _,Mi as a};
