<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=preload href=/fonts/vendor/jost/jost-v4-latin-regular.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/vendor/jost/jost-v4-latin-500.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/vendor/jost/jost-v4-latin-700.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href="/main.bc38a07753a3bc302a0816d5b0f9af72374aadf3e5d31ab5d6cf744aa9dc7fe70c0a72dd0b0bbcc21ea8a34fedcf3465ce76833aa7c8cd384bf452fd598f583a.css" integrity="sha512-vDigd1OjvDAqCBbVsPmvcjdKrfPl0xq11s90Sqncf+cMCnLdCwu8wh6oo0/tzzRlznaDOqfIzThL9FL9WY9YOg==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><base href=/docs/how-to/config/><link rel=canonical href=/docs/how-to/config/><title>‚öôÔ∏è Configuration | WAHA</title>
<meta name=description content="Configuration"><link rel=manifest href=/manifest.webmanifest><meta property="og:url" content="/docs/how-to/config/"><meta property="og:site_name" content="WAHA"><meta property="og:title" content="‚öôÔ∏è Configuration"><meta property="og:description" content="Configuration"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:published_time" content="2020-10-06T08:48:45+00:00"><meta property="article:modified_time" content="2020-10-06T08:48:45+00:00"><meta property="og:image" content="/cover.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/cover.png"><meta name=twitter:title content="‚öôÔ∏è Configuration"><meta name=twitter:description content="Configuration"><meta name=twitter:site content="@getdoks"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"/","name":"Whats App HTTP API","position":1},{"@type":"ListItem","item":"/docs/","name":"Docs","position":2},{"@type":"ListItem","item":"/docs/how-to/","name":"How to Guides","position":3},{"@type":"ListItem","name":"Configuration","position":4}]}</script><link href=https://unpkg.com/aos@2.3.1/dist/aos.css rel=stylesheet><script src=https://unpkg.com/aos@2.3.1/dist/aos.js></script><script>document.addEventListener("DOMContentLoaded",function(){const t=["GET","POST","PUT","DELETE","PATCH","HEAD","OPTIONS","CONNECT","TRACE"],e=new RegExp(`^(${t.join("|")})\\b`);document.querySelectorAll("code.language-http .line .err").forEach(t=>{const n=t.textContent;e.test(n)&&(t.innerHTML=n.replace(e,function(e){return`<span class="http-method http-method-${e.toUpperCase()}">${e}</span>`}))})})</script></head><body class="single section docs"><p>You can configure WhatsApp API behaviour via environment variables, by adding <code>-e WHATSAPP_VARNAME=value</code> at the
begging of the command line or by using <a href=https://docs.docker.com/engine/reference/commandline/run/>other options</a></p><div class=expressive-code><figure class="frame is-terminal not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker run -it -e <span class=s2>&#34;WAHA_WORKER_ID=waha&#34;</span> -e <span class=nv>WAHA_PRINT_QR</span><span class=o>=</span>False devlikeapro/waha</span></span></code></pre></div></figure></div><p>It&rsquo;s not necessary to always run such a long command - you can save all data in
<a href=https://github.com/devlikeapro/waha/blob/core/docker-compose.yaml>docker-compose.yaml</a>
file as described on <a href=/docs/how-to/install/><strong>üîß Install & Update</strong></a>.</p><p>The following environment variables can be used to configure the WAHA.</p><h2 id=common>Common</h2><ul><li><code>WHATSAPP_API_PORT=3000</code>: The port number that the HTTP server will listen on. The default value is <code>3000</code>.<ul><li><code>PORT=3000</code> is also supported (for Heroku compatibility)</li></ul></li><li><code>WHATSAPP_API_HOSTNAME=localhost</code>: The hostname for the HTTP server. The default value is <code>localhost</code>.</li><li><code>WHATSAPP_API_SCHEMA=https</code> - it just changes <code>media.url</code> schema when you receive media (with files) messages.<ul><li>In order to properly configure SSL follow <a href=/blog/setting-up-https-for-waha/><strong>Step-by-step guide on how to set up HTTPS for WAHA</strong></a></li></ul></li><li><code>WAHA_BASE_URL</code> - will be used to construct the <code>media.url</code> field in the webhook events.<ul><li>By default, it&rsquo;s <code>{WHATSAPP_API_SCHEMA}://{WHATSAPP_API_HOSTNAME}:{WHATSAPP_API_PORT}</code>.</li></ul></li><li><code>WAHA_DEBUG_MODE=false</code> - enables some API only for development or troubleshooting purposes. Disabled by default.</li><li><code>TZ=Europe/Warsaw</code> - set the timezone for the container. The default value is <code>UTC</code>. Find <a href=https://en.wikipedia.org/wiki/List_of_tz_database_time_zones>your timezone in the list</a>.</li></ul><h2 id=logging>Logging</h2><p>Options you can use to control the way how WAHA output the logs:</p><ul><li><code>WAHA_LOG_FORMAT</code> - supports formats:<ul><li><code>WAHA_LOG_FORMAT=PRETTY</code> - good for local development, <strong>default</strong> format</li><li><code>WAHA_LOG_FORMAT=JSON</code> - can be useful if you&rsquo;re using central logging management system</li></ul></li><li><code>WAHA_LOG_LEVEL</code> - how much information to log <code>error | warn | info | debug | trace</code>.<ul><li>üëâ Do not set <code>debug</code> and <code>trace</code> in production, it gives too many logs.</li></ul></li><li><code>WAHA_HTTP_LOG_LEVEL=info</code> - controls the level of <code>request completed</code> log (HTTP access), you can set it to <code>error | warn | info | debug | trace</code>.</li><li><code>DEBUG=1</code> - you can set this environment variable as a shortcut for <code>WAHA_LOG_LEVEL=debug</code>, <code>DEBUG=1</code> overrides the <code>WAHA_LOG_LEVEL</code> to <code>debug</code> if both defined.
üëâ Learn more about logging configuration on <a href=/docs/how-to/observability/><strong>üîç Observability</strong></a> page.</li></ul><h2 id=sessions>Sessions</h2><ul><li><code>WAHA_AUTO_START_DELAY_SECONDS=0</code> - when docker container restarts, WAHA starts all <code>STOPPED</code> session (or all session if you set <code>WAHA_RESTART_ALL_SESSIONS=True</code>). You can set the delay between session restarts in seconds.<ul><li>By default, it&rsquo;s <code>0</code>.</li><li><strong>WEBJS</strong> - consider setting it to <code>5</code> if you have many sessions</li><li><strong>NOWEB</strong> - it&rsquo;s fine to leave to <code>0</code> or you can increase to <code>1</code> if you experience issues with starting sessions.</li></ul></li><li><code>WAHA_PRINT_QR=True</code> - set this variable to <code>False</code> to disable printing QR codes to the console. By default, <code>True</code>.</li><li><code>WAHA_WORKER_ID=waha1</code> - set the worker ID for the session.<ul><li>Workers restore sessions if worker got restarted. If you have multiple workers, each worker will restore its own sessions.</li></ul></li><li><code>WHATSAPP_RESTART_ALL_SESSIONS=True</code>: Set this variable to <code>True</code> to start all <strong>STOPPED</strong> sessions after container
restarts. By default, this variable is set to <code>False</code>.</li></ul><p>Rarely used:</p><ul><li><code>WAHA_WORKER_RESTART_SESSIONS=True</code> - restart all sessions when the worker is restarted. By default, <code>True</code>.</li><li><code>WHATSAPP_START_SESSION=session1,session2</code>: This variable can be used to start sessions with the specified names right
after launching the API. Separate session names with a comma.</li><li><code>WAHA_ZIPPER=ZIPUNZIP</code> - use <code>zip</code> and <code>unzip</code> system binaries to pack <strong>WEBJS</strong> authentication data. Disabled by default.<ul><li>It&rsquo;s relevant if you&rsquo;re using <strong>WEBJS + MongoDB</strong>. Install <code>zip</code> and <code>unzip</code> if you don&rsquo;t use our official docker image and set the variable</li></ul></li></ul><p>Read more:</p><ul><li><a href=/docs/how-to/sessions/><strong>üñ•Ô∏è Sessions</strong></a></li><li><a href=/docs/how-to/storages/#sessions><strong>üóÑÔ∏è Storages</strong></a></li></ul><h3 id=webjs>WEBJS</h3><p>You can use some of the following environment variables to configure the <a href=/docs/how-to/engines/#webjs><strong>WEBJS</strong></a> session:</p><ul><li><code>WAHA_WEBJS_CACHE_TYPE=local</code> - enable cache (aka use the latest version) for the <strong>web page</strong> in the browser. By default, it&rsquo;s <code>none</code> (no cache)</li><li><code>WAHA_WEBJS_WEB_VERSION=2.3000.XXXX</code> - set the version of the WhatsApp Web to use. By default, we&rsquo;re using the latest compatible version. Only works with <code>local</code> cache type.</li></ul><h2 id=webhooks>Webhooks</h2><p>üí° You can open <a href=https://webhook.site>https://webhook.site</a> and paste UUID from it to <code>url</code> field,
and you&rsquo;ll see all requests immediately in your browser to intercept the webhook&rsquo;s payload.</p><h3 id=global-webhooks>Global webhooks</h3><p>There&rsquo;s a way how you can configure
<a href=/docs/how-to/events/#webhooks><strong>üîÑ Webhooks</strong></a>
for <strong>all sessions</strong> at once - by settings these environment variables:</p><ul><li><code>WHATSAPP_HOOK_URL=https://webhook.site/11111111-1111-1111-1111-11111111</code> - to set up a URL for the webhook</li><li><code>WHATSAPP_HOOK_EVENTS=message,message.any,state.change</code> - specify events.<ul><li><code>WHATSAPP_HOOK_EVENTS=*</code> - subscribe to all events.</li><li>We don&rsquo;t suggest using <code>*</code> or all events for production, it can generate a lot of requests.</li></ul></li><li><code>WHATSAPP_HOOK_HMAC_KEY=your-secret-key</code> - the same as <code>hmac.key</code> field in the webhook configuration.</li><li><code>WHATSAPP_HOOK_RETRIES_POLICY=linear</code> - the same as <code>retries.policy</code> field in the webhook configuration.</li><li><code>WHATSAPP_HOOK_RETRIES_DELAY_SECONDS=2</code> - the same as <code>retries.delaySeconds</code> field in the webhook configuration.</li><li><code>WHATSAPP_HOOK_RETRIES_ATTEMPTS=4</code></li><li><code>WHATSAPP_HOOK_CUSTOM_HEADERS=X-My-Custom-Header-1:Value;X-My-Custom-Header-2:Value</code> - the same as <code>customHeaders</code> field in the webhook configuration.<ul><li>Use <code>Header:Value</code> format and separate them by <code>;</code>.</li></ul></li></ul><p>That webhook configuration <strong>does not appear</strong> in <code>session.config</code> field in <code>GET /api/sessions/</code> request.</p><p>üí° You can open <a href=https://webhook.site>https://webhook.site</a> and paste URL from it to <code>url</code> field,
and you&rsquo;ll see all requests immediately in your browser to intercept the webhook&rsquo;s payload.</p><h3 id=session-webhooks>Session webhooks</h3><p>You can configure webhook when you start session by setting <code>config.webhook</code> fields.</p><p>Read more about it on <a href=/docs/how-to/sessions/#configure-webhook><strong>üñ•Ô∏è Sessions</strong></a>.</p><h2 id=swagger>Swagger</h2><ul><li><code>WHATSAPP_SWAGGER_CONFIG_ADVANCED=true</code> - enables advanced configuration options for Swagger documentation - you can customize host, port and base URL for the requests.
Disabled by default.</li><li><code>WHATSAPP_SWAGGER_ENABLED=false</code> - disables Swagger documentation. Enabled by default. Available in <strong>WAHA Plus</strong> only.</li><li><code>WHATSAPP_SWAGGER_USERNAME=admin</code> and <code>WHATSAPP_SWAGGER_PASSWORD=admin</code> - these variables can be used to protect the Swagger panel
with <code>admin / admin</code> credentials. This does not affect API access. Available in <strong>WAHA Plus</strong> only.</li></ul><p>Read more about Swagger configuration on <a href=/docs/how-to/swagger/><strong>üìö Swagger</strong></a>.</p><h2 id=proxy>Proxy</h2><h3 id=global-proxy>Global proxy</h3><p>If you need to use a proxy, you can set the following environment variables:</p><ul><li><code>WHATSAPP_PROXY_SERVER=localhost:3128</code>: Use this variable to set the proxy server in the format <code>host:port</code>, without http or https.</li><li><code>WHATSAPP_PROXY_SERVER_USERNAME=username</code> and <code>WHATSAPP_PROXY_SERVER_PASSWORD=password</code>: Use these variables to set up credentials for the proxy.</li><li><code>WHATSAPP_PROXY_SERVER_LIST=host1.example.com:3138,host2.example.com:3138</code>: Use this variable to set a comma-separated list of addresses to use, using a round-robin algorithm to choose the server for the session.</li><li><code>WHATSAPP_PROXY_SERVER_INDEX_PREFIX=proxy-</code>: Use this variable to parse the session name for the prefix and find the appropriate session.
For example, if you have set <code>WHATSAPP_PROXY_SERVER_LIST=host-first:80,host-second:80,host-third:80</code> and <code>WHATSAPP_PROXY_SERVER_INDEX_PREFIX=proxy-</code> and you run <code>proxy-3</code> session, the <code>host-third:80</code> proxy will be chosen for that session.
This is a way to select a proxy from while you start session.</li></ul><h3 id=session-proxy>Session proxy</h3><p>You can configure proxy when you start session by setting <code>config.proxy</code> fields.
Read more about it on <a href=/docs/how-to/sessions/#configure-proxy><strong>Session page</strong> -></a>.</p><p>Keep in mind that session&rsquo;s proxy configuration takes precedence over proxy configuration set by environment variables!</p><h2 id=https>HTTPS</h2><p>üí° We recommend handling HTTPS termination with a reverse proxy like Nginx - kindly follow
<a href=/docs/how-to/install/><strong>üîß Install & Update - Additional Steps</strong></a> to set up Nginx with Let&rsquo;s Encrypt.</p><p>However, you can enable HTTPS directly in WAHA by setting the following environment variables:</p><ul><li><code>WAHA_HTTPS_ENABLED=true</code>: Set this variable to <code>true</code> to enable HTTPS. By default, it&rsquo;s <code>false</code>.</li><li><code>WAHA_HTTPS_PATH_KEY=/path/to/key.pem</code>: The path to the key file for HTTPS. By default <code>./.secrets/privkey.pem</code></li><li><code>WAHA_HTTPS_PATH_CERT=/path/to/cert.pem</code>: The path to the certificate file for HTTPS. By default <code>./.secrets/cert.pem</code></li><li><code>WAHA_HTTPS_PATH_CA=/path/to/ca.pem</code>: The path to the CA file for HTTPS. By default <code>./.secrets/chain.pem</code></li></ul><p>Read more about HTTPS options and how to configure it on <a href=/docs/how-to/security/><strong>üîí Security</strong></a> page.</p><h2 id=security>Security</h2><p><b>Security is available in <a href=/docs/how-to/waha-plus/>WAHA Plus </a>only.</b></p><ul><li><code>WHATSAPP_API_KEY=mysecret</code>: If you set this variable, you must include the <code>X-Api-Key: mysecret</code> header in all
requests to the API. This will protect the API with a secret code.</li><li><code>WHATSAPP_SWAGGER_USERNAME=admin</code> and <code>WHATSAPP_SWAGGER_PASSWORD=admin</code>: These variables can be used to protect the
Swagger panel with <code>admin / admin</code> credentials. This does not affect API access.
Read more about security settings for Swagger and API on <a href=/docs/how-to/security/>*üîí Security**</a>.</li></ul><h2 id=files>Files</h2><p><b>Files configuration is available in <a href=/docs/how-to/waha-plus/>WAHA Plus </a>only.</b></p><h3 id=files---local>Files - Local</h3><p>The following environment variables can be used to configure the file storage options for the WAHA:</p><ul><li><code>WHATSAPP_FILES_MIMETYPES</code>: This variable can be used to download only specific mimetypes from messages.
By default, all files are downloaded. The mimetypes must be separated by a comma, without spaces.
For example: <code>audio,image/png,image/gif</code>. To choose a specific type, use a prefix (like <code>audio,image</code>). See usage below.</li><li><code>WHATSAPP_DOWNLOAD_MEDIA=true</code> - this variable can be used to <strong>completely</strong> disable downloading media files. By default, all files are downloaded.
Set this variable to <code>WHATSAPP_DOWNLOAD_MEDIA=false</code> to disable downloading media files.<ul><li>Under the hood, it sets <code>WHATSAPP_FILES_MIMETYPES=mimetype/ignore-all-media</code> to ignore all media files.</li></ul></li><li><code>WHATSAPP_FILES_LIFETIME</code>: This variable can be used to set the time (in seconds) after which files will be removed to
free up space. The default value is <code>180</code>.<ul><li>Set this variable to <code>0</code> to disable the file lifetime.</li></ul></li><li><code>WHATSAPP_FILES_FOLDER</code>: This variable can be used to set the folder where files from chats (images, voice messages)
will be stored. The default value is <code>/tmp/whatsapp-files</code>.<ul><li>The folder must be mounted to the host machine to keep the files between container restarts. <a href=/docs/how-to/storages/#media>Read more about how to persist files -></a></li></ul></li><li>Also read more about <a href=/docs/how-to/storages/#media>Media Storages on the dedicated page -></a></li></ul><p>üí° Even if WAHA doesn&rsquo;t process the message media because of <code>WHATSAPP_FILES_MIMETYPES</code> or <code>WHATSAPP_DOWNLOAD_MEDIA</code>
you&rsquo;ll get a webhook event with <code>hasMedia: True</code> field, but with no <code>media.url</code>.</p><div class=expressive-code><figure class="frame has-title not-content"><figcaption class=header><span class=title>message</span></figcaption><div class=highlight title=message><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;event&#34;</span><span class=p>:</span> <span class=s2>&#34;message&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;session&#34;</span><span class=p>:</span> <span class=s2>&#34;default&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;payload&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;hasMedia&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;media&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=kc>null</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;mimetype&#34;</span><span class=p>:</span> <span class=s2>&#34;video/mp4&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;filename&#34;</span><span class=p>:</span> <span class=kc>null</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;error&#34;</span><span class=p>:</span> <span class=kc>null</span> <span class=c1>// if there was an error during file download
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></figure></div><p>üëâ Learn more on <a href=/docs/how-to/storages/><strong>üóÑÔ∏è Storages</strong></a> page.</p><h3 id=files---s3>Files - S3</h3><ul><li><code>WAHA_MEDIA_STORAGE=S3</code> - enable the S3 storage</li><li><code>WAHA_S3_REGION=eu-west-1</code> - the region of the S3 bucket</li><li><code>WAHA_S3_BUCKET=waha</code> - the name of the S3 bucket</li><li><code>WAHA_S3_ACCESS_KEY_ID=minioadmin</code> - the access key of the S3 bucket</li><li><code>WAHA_S3_SECRET_ACCESS_KEY=minioadmin</code> - the secret access key of the S3 bucket</li><li><code>WAHA_S3_ENDPOINT=http://127.0.0.1:9000</code> - the endpoint of the S3 bucket (not required for AWS S3)</li><li><code>WAHA_S3_FORCE_PATH_STYLE=True</code> - force path style for the S3 bucket (not required for AWS S3)</li><li><code>WAHA_S3_PROXY_FILES</code> - proxy media files through WAHA (<code>False</code> by default)<ul><li><code>WAHA_S3_PROXY_FILES=False</code> - generate pre-signed URLs for media files and send them to the client in <code>media.url</code></li><li><code>WAHA_S3_PROXY_FILES=True</code> - WAHA will proxy media files through itself in <code>media.url</code></li></ul></li></ul><p>üëâ Learn more on <a href=/docs/how-to/storages/><strong>üóÑÔ∏è Storages</strong></a> page.</p><h2 id=health-check>Health Check</h2><p><b>Health check is available in <a href=/docs/how-to/waha-plus/>WAHA Plus </a>only.</b></p><p>The following environment variables can be used to configure the <a href=/docs/how-to/observability/>Health Check -></a>:</p><ul><li><code>WHATSAPP_HEALTH_MEDIA_FILES_THRESHOLD_MB</code> - the threshold in MB for the media files storage. The default value is <code>100</code>.</li><li><code>WHATSAPP_HEALTH_SESSIONS_FILES_THRESHOLD_MB</code> - the threshold in MB for the sessions files storage. The default value is <code>100</code>.</li><li><code>WHATSAPP_HEALTH_MONGODB_TIMEOUT</code> - the timeout in milliseconds for the MongoDB health check. The default value is <code>5000</code>.</li></ul><p>üëâ Learn more on <a href=/docs/how-to/observability/><strong>üîç Observability</strong></a> page.</p><p>This line is from <code>./layouts/_default/single.html</code>.</p><script async src=/js/bootstrap.c673c84373e66019f7895efc74b3b3b940071832aaa8a85e73218087d535e71b.js integrity="sha256-xnPIQ3PmYBn3iV78dLOzuUAHGDKqqKhecyGAh9U15xs="></script><script async src=/js/app.c17553444ec7c62f781ddbaa011948f6d85a1bab49420047d68a2b89852a8b36.js integrity="sha256-wXVTRE7Hxi94HduqARlI9thaG6tJQgBH1ooriYUqizY="></script><script async src=/js/docsearch.cfae25fd02560b1d08c4065fa744efbf59bdaf3e4d6a7bf8652794f322a813c9.js integrity="sha256-z64l/QJWCx0IxAZfp0Tvv1m9rz5Nanv4ZSeU8yKoE8k="></script></body></html>